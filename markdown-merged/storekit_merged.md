# storekit

*Merged documentation for storekit*

---

# StoreKit

## 

Use the StoreKit framework to provide the following features and services for your apps and In-App Purchases:

The StoreKit framework also provides functionality for [doc://com.apple.storekit/documentation/StoreKit/external-purchase](doc://com.apple.storekit/documentation/StoreKit/external-purchase), [doc://com.apple.storekit/documentation/StoreKit/external-link-account](doc://com.apple.storekit/documentation/StoreKit/external-link-account), [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding), and [doc://com.apple.storekit/documentation/StoreKit/StoreDownloaderExtension](doc://com.apple.storekit/documentation/StoreKit/StoreDownloaderExtension).

## Topics

### In-App Purchase

- [in-app-purchase](../com.apple.storekit/StoreKit/in-app-purchase.md)
- [understanding-storekit-workflows](../com.apple.storekit/StoreKit/understanding-storekit-workflows.md)
- [getting-started-with-in-app-purchases-using-storekit-views](../com.apple.storekit/StoreKit/getting-started-with-in-app-purchases-using-storekit-views.md)

### App transaction

- [supporting-business-model-changes-by-using-the-app-transaction](../com.apple.storekit/StoreKit/supporting-business-model-changes-by-using-the-app-transaction.md)
- [AppTransaction](../com.apple.storekit/StoreKit/AppTransaction.md)

### Messages

- [Message](../com.apple.storekit/StoreKit/Message.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)
- [DisplayMessageAction](../com.apple.storekit/StoreKit/DisplayMessageAction.md)

### Reviews

- [requesting-app-store-reviews](../com.apple.storekit/StoreKit/requesting-app-store-reviews.md)
- [RequestReviewAction](../com.apple.storekit/StoreKit/RequestReviewAction.md)
- [SKStoreReviewController](../com.apple.storekit/StoreKit/SKStoreReviewController.md)

### Recommendations

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [SKStoreProductViewController](../com.apple.storekit/StoreKit/SKStoreProductViewController.md)
- [SKOverlay](../com.apple.storekit/StoreKit/SKOverlay.md)

### Background assets extension

- [StoreDownloaderExtension](../com.apple.storekit/StoreKit/StoreDownloaderExtension.md)

### Payment method binding

- [PaymentMethodBinding](../com.apple.storekit/StoreKit/PaymentMethodBinding.md)

### Ad network attribution

- [ad-network-attribution](../com.apple.storekit/StoreKit/ad-network-attribution.md)

### External Purchase

- [external-purchase](../com.apple.storekit/StoreKit/external-purchase.md)

### External link account

- [external-link-account](../com.apple.storekit/StoreKit/external-link-account.md)

### Deprecated

- [SKCloudServiceSetupViewController](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController.md)
- [SKCloudServiceController](../com.apple.storekit/StoreKit/SKCloudServiceController.md)

### Articles

- [supporting-subscription-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-subscription-offer-codes-in-your-app.md)

## See Also

- [AppStoreServerAPI](../com.apple.AppStoreServerAPI.md)
- [StoreKitTest](../com.apple.StoreKitTest.md)
- [AppStoreServerNotifications](../com.apple.AppStoreServerNotifications.md)
- [AppStoreConnectAPI](../com.apple.AppStoreConnectAPI.md)
- [AdvancedCommerceAPI](../com.apple.AdvancedCommerceAPI.md)
- [AppStoreReceipts](../com.apple.AppStoreReceipts.md)

---


# Detailed Documentation


## AppStoreMerchandisingKind


### PresentationResult


#### dismissed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
case dismissed
```

## See Also

- [purchaseCompleted(_:)](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind/PresentationResult/purchaseCompleted(_:).md)

---


#### purchaseCompleted(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
case purchaseCompleted(Product.PurchaseResult)
```

## See Also

- [dismissed](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind/PresentationResult/dismissed.md)

---


### PresentationResult

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
enum PresentationResult
```

## Topics

### Enumeration cases

- [dismissed](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind/PresentationResult/dismissed.md)
- [purchaseCompleted(_:)](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind/PresentationResult/purchaseCompleted(_:).md)

---


### subscriptionBundle(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
static func subscriptionBundle(_ groupID: String) -> AppStoreMerchandisingKind
```

---


## AppTransaction


### appID

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let appID: UInt64?
```

## 

The App Store assigns this value. This value is the app’s Apple ID in App Store Connect. In the [doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/sandbox](doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/sandbox) and [doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/xcode](doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/xcode) environments, this value is `nil`.

## See Also

- [bundleID](../com.apple.storekit/StoreKit/AppTransaction/bundleID.md)
- [appVersion](../com.apple.storekit/StoreKit/AppTransaction/appVersion.md)
- [originalAppVersion](../com.apple.storekit/StoreKit/AppTransaction/originalAppVersion.md)
- [appVersionID](../com.apple.storekit/StoreKit/AppTransaction/appVersionID.md)

---


### appTransactionID

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.4, macOS 15.4, tvOS 18.4, watchOS 11.4, visionOS 2.4)
var appTransactionID: String { get }
```

## 

The App Store generates a single, globally unique `appTransactionID` for each Apple Account that downloads your app and for each family group member for apps that support Family Sharing.

This value remains the same for the same Apple Account and app if the customer redownloads the app on any device, receives a refund, repurchases the app, or changes the storefront. For apps that support Family Sharing, the `appTransactionID` is unique for each family group member.

The `appTransactionID` is available even if a customer makes no in-app purchases.

The App Store server and StoreKit provide the `appTransactionID` in the following APIs:

- This symbol, `appTransactionID`, in the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) object
- [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/appTransactionID](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/appTransactionID), in the subscription renewal information [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo)
- [doc://com.apple.storekit/documentation/StoreKit/Transaction/appTransactionID](doc://com.apple.storekit/documentation/StoreKit/Transaction/appTransactionID), in the transaction information [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction)
- In transaction and subscription renewal information you receive from notifications, [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2)
- In transaction and subscription renewal information you receive from the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI)

---


### appVersion

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let appVersion: String
```

## 

This value is the version string you entered in Xcode. This value is a machine-readable string composed of one to three period-separated integers, such as `10.4.1`.

## See Also

- [bundleID](../com.apple.storekit/StoreKit/AppTransaction/bundleID.md)
- [originalAppVersion](../com.apple.storekit/StoreKit/AppTransaction/originalAppVersion.md)
- [appID](../com.apple.storekit/StoreKit/AppTransaction/appID.md)
- [appVersionID](../com.apple.storekit/StoreKit/AppTransaction/appVersionID.md)

---


### appVersionID

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let appVersionID: UInt64?
```

## 

The App Store assigns this value. In the [doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/sandbox](doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/sandbox) and [doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/xcode](doc://com.apple.storekit/documentation/StoreKit/AppStore/Environment/xcode) environments, this value is `nil`.

## See Also

- [bundleID](../com.apple.storekit/StoreKit/AppTransaction/bundleID.md)
- [appVersion](../com.apple.storekit/StoreKit/AppTransaction/appVersion.md)
- [originalAppVersion](../com.apple.storekit/StoreKit/AppTransaction/originalAppVersion.md)
- [appID](../com.apple.storekit/StoreKit/AppTransaction/appID.md)

---


### bundleID

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let bundleID: String
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/bundleID](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/bundleID) is the bundle identifier string that you entered in Xcode. For more information, see [https://help.apple.com/xcode/mac/current/#/deve70ea917b](https://help.apple.com/xcode/mac/current/#/deve70ea917b)

## See Also

- [appVersion](../com.apple.storekit/StoreKit/AppTransaction/appVersion.md)
- [originalAppVersion](../com.apple.storekit/StoreKit/AppTransaction/originalAppVersion.md)
- [appID](../com.apple.storekit/StoreKit/AppTransaction/appID.md)
- [appVersionID](../com.apple.storekit/StoreKit/AppTransaction/appVersionID.md)

---


### deviceVerification

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let deviceVerification: Data
```

## 

For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID).

## See Also

- [deviceVerificationNonce](../com.apple.storekit/StoreKit/AppTransaction/deviceVerificationNonce.md)
- [signedDate](../com.apple.storekit/StoreKit/AppTransaction/signedDate.md)

---


### deviceVerificationNonce

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let deviceVerificationNonce: UUID
```

## 

For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID).

## See Also

- [deviceVerification](../com.apple.storekit/StoreKit/AppTransaction/deviceVerification.md)
- [signedDate](../com.apple.storekit/StoreKit/AppTransaction/signedDate.md)

---


### environment

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let environment: AppStore.Environment
```

## See Also

- [Environment](../com.apple.storekit/StoreKit/AppStore/Environment.md)

---


### jsonRepresentation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var jsonRepresentation: Data { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/jsonRepresentation](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/jsonRepresentation) is UTF-8 string data that contains the same information as the properties of the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction). You can use this JSON data to decode the app transaction information into your own data type instead of using [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) properties directly.

The JSON Web Signature (JWS) Compact Serialization for the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) is available in the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59) property of the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult). The JWS string consists of three Base64URL-encoded components, separated by a period: a header, a payload, and a signature. The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/jsonRepresentation](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/jsonRepresentation) is the Base64URL-decoded payload component.

> **NOTE:** If you send the app transaction to your server or store it, use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj) and validate the signature before parsing it.

---


### originalAppVersion

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let originalAppVersion: String
```

## 

Use this value to determine which app version the customer first purchased or downloaded. This value is comparable to the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/appVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/appVersion) value.

The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion) remains constant and doesn’t change when the customer upgrades the app. The string value contains the original value of the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/CFBundleShortVersionString](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/CFBundleShortVersionString) for apps running in macOS, and the original value of the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/CFBundleVersion](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/CFBundleVersion) for apps running on all other platforms.

In the sandbox testing environment, the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion) value is always `1.0`.

For more information about using the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion), see [doc://com.apple.storekit/documentation/StoreKit/supporting-business-model-changes-by-using-the-app-transaction](doc://com.apple.storekit/documentation/StoreKit/supporting-business-model-changes-by-using-the-app-transaction).

## See Also

- [bundleID](../com.apple.storekit/StoreKit/AppTransaction/bundleID.md)
- [appVersion](../com.apple.storekit/StoreKit/AppTransaction/appVersion.md)
- [appID](../com.apple.storekit/StoreKit/AppTransaction/appID.md)
- [appVersionID](../com.apple.storekit/StoreKit/AppTransaction/appVersionID.md)

---


### originalPlatform

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let originalPlatform: AppStore.Platform
```

## See Also

- [Platform](../com.apple.storekit/StoreKit/AppStore/Platform.md)

---


### originalPlatformStringRepresentation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.4, macOS 15.4, tvOS 18.4, watchOS 11.4, visionOS 2.4)
var originalPlatformStringRepresentation: String { get }
```

---


### originalPurchaseDate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let originalPurchaseDate: Date
```

## 

The original purchase date remains the same, even if the customer deletes and reinstalls the app.

In the sandbox testing environment, the original purchase date is always 2013-08-01 12 AM PDT, which is 1375340400000 milliseconds in UNIX epoch time.

## See Also

- [preorderDate](../com.apple.storekit/StoreKit/AppTransaction/preorderDate.md)

---


### preorderDate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let preorderDate: Date?
```

## 

This date is present if your app is available for preorder and the customer places an order before your app is available in the App Store. When your app becomes available, the App Store fulfills the customer’s order. The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/preorderDate](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/preorderDate) remains the same.

Use this date to recognize customers who place preorders.

For more infomation about preorders, see [https://developer.apple.com/app-store/pre-orders/](https://developer.apple.com/app-store/pre-orders/).

## See Also

- [originalPurchaseDate](../com.apple.storekit/StoreKit/AppTransaction/originalPurchaseDate.md)

---


### refresh()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func refresh() async throws -> VerificationResult<AppTransaction>
```

## 

Returns a [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult) with a single [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

## 

This method queries the App Store server to refresh the app transaction information. This method returns a [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult) that contains the App Store-signed app transaction information for your app.

> **IMPORTANT:** Calling [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/refresh()](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/refresh()) displays a system prompt that asks users to authenticate with their App Store credentials. Call this function only in response to an explicit user action, like tapping or clicking a button.

Use this method to get an [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) in the following cases:

- The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/shared](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/shared) property throws an error.
- The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/shared](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/shared) property returns an unverified ([doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unverified(_:_:)](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unverified(_:_:)) ) result.

This method throws an error if the user cancels the authentication prompt, if there’s no network connectivity, or if the call fails to update the app transaction.

---


### shared

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var shared: VerificationResult<AppTransaction> { get async throws }
```

## 

Use this property to get a [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult) that contains the App Store-signed app transaction information for your app, including the first time the app launches. StoreKit automatically keeps the app transaction up-to-date.

This property throws an error if the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) isn’t available or if the user isn’t authenticated with the App Store. Getting an [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) may require network connectivity.

The following example shows how to get the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

```swift
do {
    let verificationResult = try await AppTransaction.shared

    switch verificationResult {
    case .verified(let appTransaction):
        // StoreKit verified that the user purchased this app and
        // the properties in the AppTransaction instance.
        // Add your code here.
    case .unverified(let appTransaction, let verificationError):
        // The app transaction didn't pass StoreKit's verification.        
        // Handle unverified app transaction information according
        // to your business model.
        // Add your code here.
    }
}
catch {
  // Handle errors.
}

```

If your app fails to get an [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) by accessing the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/shared](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/shared) property, see [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/refresh()](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/refresh()).

---


### signedDate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let signedDate: Date
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/signedDate](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/signedDate) to verify whether the certificate used to sign the app transaction was valid when the App Store signed the transaction.

## See Also

- [deviceVerification](../com.apple.storekit/StoreKit/AppTransaction/deviceVerification.md)
- [deviceVerificationNonce](../com.apple.storekit/StoreKit/AppTransaction/deviceVerificationNonce.md)

---


## CompactPickerSubscriptionStoreControlStyle


### Placement


#### automatic

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
static var automatic: CompactPickerSubscriptionStoreControlStyle.Placement { get }
```

## See Also

- [bottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/buttonsInBottomBar.md)
- [scrollView](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/scrollView.md)

---


#### bottomBar

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
static var bottomBar: CompactPickerSubscriptionStoreControlStyle.Placement { get }
```

## 

The bottom bar conditonally applies a special visual treatment when it overlaps the main content of the subscription store view. The content within the bottom bar doesn’t scroll with the rest of the content in the main scroll view.

## See Also

- [automatic](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/automatic.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/buttonsInBottomBar.md)
- [scrollView](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/scrollView.md)

---


#### buttonsInBottomBar

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
static var buttonsInBottomBar: CompactPickerSubscriptionStoreControlStyle.Placement { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/automatic.md)
- [bottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/bottomBar.md)
- [scrollView](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/scrollView.md)

---


#### scrollView

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
static var scrollView: CompactPickerSubscriptionStoreControlStyle.Placement { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/automatic.md)
- [bottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/buttonsInBottomBar.md)

---


### Placement

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
struct Placement
```

## Topics

### Getting a placement

- [automatic](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/automatic.md)
- [bottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/buttonsInBottomBar.md)
- [scrollView](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement/scrollView.md)

---


## EntitlementTaskState


### failure(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case failure(any Error)
```

## See Also

- [loading](../com.apple.storekit/StoreKit/EntitlementTaskState/loading.md)
- [success(_:)](../com.apple.storekit/StoreKit/EntitlementTaskState/success(_:).md)

---


### flatMap(_:)-66eb8

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func flatMap<NewValue>(_ transform: (Value) async throws -> EntitlementTaskState<NewValue>) async rethrows -> EntitlementTaskState<NewValue>
```

## See Also

- [flatMap(_:)-7gsnv](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-7gsnv.md)
- [map(_:)-8ly3v](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-8ly3v.md)
- [map(_:)-250dk](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-250dk.md)

---


### flatMap(_:)-7gsnv

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func flatMap<NewValue>(_ transform: (Value) throws -> EntitlementTaskState<NewValue>) rethrows -> EntitlementTaskState<NewValue>
```

## Parameters

- **transform**: 

## See Also

- [flatMap(_:)-66eb8](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-66eb8.md)
- [map(_:)-8ly3v](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-8ly3v.md)
- [map(_:)-250dk](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-250dk.md)

---


### loading

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case loading
```

## See Also

- [success(_:)](../com.apple.storekit/StoreKit/EntitlementTaskState/success(_:).md)
- [failure(_:)](../com.apple.storekit/StoreKit/EntitlementTaskState/failure(_:).md)

---


### map(_:)-250dk

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func map<NewValue>(_ transform: (Value) async throws -> NewValue) async rethrows -> EntitlementTaskState<NewValue>
```

## See Also

- [flatMap(_:)-7gsnv](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-7gsnv.md)
- [flatMap(_:)-66eb8](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-66eb8.md)
- [map(_:)-8ly3v](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-8ly3v.md)

---


### map(_:)-8ly3v

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func map<NewValue>(_ transform: (Value) throws -> NewValue) rethrows -> EntitlementTaskState<NewValue>
```

## See Also

- [flatMap(_:)-7gsnv](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-7gsnv.md)
- [flatMap(_:)-66eb8](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-66eb8.md)
- [map(_:)-250dk](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-250dk.md)

---


### success(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case success(Value)
```

## See Also

- [loading](../com.apple.storekit/StoreKit/EntitlementTaskState/loading.md)
- [failure(_:)](../com.apple.storekit/StoreKit/EntitlementTaskState/failure(_:).md)

---


## ExternalLinkAccount


### canOpen

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static var canOpen: Bool { get async }
```

## 

Check this property before showing any user-interface controls that enable people to open the external link account.

Don’t check this property again in response to user input; instead, call [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()) immediately.

> **IMPORTANT:** Only show user-interface controls that call the [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()) method if this property is `true`. The [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()) method always throws an error when [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen) is `false`.

## See Also

- [open()](../com.apple.storekit/StoreKit/ExternalLinkAccount/open().md)

---


### open()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static func open() async throws
```

## 

Call this method in response to deliberate user interaction, for example, tapping a button. Call [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen) to determine whether to display a button or other user-interface control. If [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen) is `false`, this method always throws a [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError) instance.

## See Also

- [canOpen](../com.apple.storekit/StoreKit/ExternalLinkAccount/canOpen.md)

---


## ExternalPurchaseLink


### eligibleURLs

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var eligibleURLs: [URL]? { get async }
```

## 

Use this property if your app configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list key.

Use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs) to get the array of external purchase links for the current storefront that your app has configured in the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list key. Your app can select from any of the eligible URLs. Call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)) with the URL you choose.

The [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs) array is `nil` if any of the following is true:

- The current App Store storefront doesn’t allow external purchase or the person isn’t eligible to make external purchases.
- Your app doesn’t configure the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) entitlement.
- Your app doesn’t configure any links for the current storefront in the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list key

If this value is `nil` and your app also configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink) property list key, check [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen) to determine whether your app can continue to provide an external purchase link.

Otherwise, if this value is `nil`, check [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) to determine whether your app can offer in-app purchases using the StoreKit [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments).

## See Also

- [SKExternalPurchaseMultiLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseMultiLink.md)
- [open(url:)](../com.apple.storekit/StoreKit/ExternalPurchaseLink/open(url:).md)

---


### open(url:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func open(url: URL) async throws
```

## Parameters

- **url**: An eligible external purchase link that you select from the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs) array.

## 

Call this method if your app configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list key to attempt to open the eligible external purchase link, `url`. Call this asynchronous method as shown below:

```swift
if let eligibleURLs = await ExternalPurchaseLink.eligibleURLs {
    let url = chooseTheUrl(eligibleURLs) // Supply a function to choose one of the eligible URLs.
    try await ExternalPurchaseLink.open(url: url)
  }
```

To use this method, follow these steps:

1. Check the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs) array. If the array contains one or more links, your app can display the user-interface controls to enable deliberate user interaction before offering an external purchase link.
2. Select one of the eligible links.
3. In response to deliberate user interaction, such as tapping a button, call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)) with the link you select.

The system displays the continuation sheet that enables the user to choose whether to continue to view the external purchase link. This asynchronous method returns before the system presents the continuation sheet, and can throw an error.

If the person chooses to continue, this method opens the link that you provide in the `url` parameter, and appends an external purchase token and the app’s bundleID to the URL. For example, StoreKit opens the following link on the default browser if your destination URL is `https://site.example.com`:

```http
https://site.example.com?externalPurchaseToken=ewoJImFwcEFwcGxlSWQiOjEyMzQ1Njc4OTAsCgkiYnVuZGxlSWQiOiJjb20uZXhhbXBsZSIsCgkidG9rZW5DcmVhdGlvbkRhdGUiOjE3MDYxNjk2MDAwMDAsCgkiZXh0ZXJuYWxQdXJjaGFzZUlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIgp9&bundleId=com.example
```

> **IMPORTANT:** Record and use the external purchase token to report the customer’s external purchases to Apple. For more information, see [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

### 

This method throws a [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError) if any of the following are true:

- Your app doesn’t have the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link.allowed-regions or [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) entitlement.
- You haven’t configured external purchase links for the current App Store storefront in the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list key.
- The current App Store storefront doesn’t support external purchases.
- The person is ineligible to make external purchases.
- A network or system error occurs.

For more information about App Store storefronts, see [doc://com.apple.storekit/documentation/StoreKit/Storefront](doc://com.apple.storekit/documentation/StoreKit/Storefront).

## See Also

- [SKExternalPurchaseMultiLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseMultiLink.md)
- [eligibleURLs](../com.apple.storekit/StoreKit/ExternalPurchaseLink/eligibleURLs.md)

---


## Message


### Reason-swift.struct


#### billingIssue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static let billingIssue: Message.Reason
```

## 

If an auto-renewable subscription fails to renew due to a billing issue, the subscription enters a billing retry state, and the App Store sends a message with the [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue) reason.

When a billing issue is in effect, StoreKit displays a Billing Problem message sheet when your app launches, or when your app asks to display it.



The sheet informs people of the billing issue, and displays an in-app sheet to enable them to correct the issue without leaving your app. Note that people can also resolve billing issues outside of your app by navigating to the manage payments section in Apple Account settings. For more information, see [https://support.apple.com/en-us/HT213276](https://support.apple.com/en-us/HT213276).

Apple attempts to renew the subscription during the billing retry period, up to 60 days. During this period, the App Store sends the [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue) message in the following intervals:

| Billing retry interval | Message frequency |
| --- | --- |
| Days 1–3 | Every 24 hours |
| Days 4–16 | Every 72 hours |
| Days 17–30 | Every 96 hours |
| Days 31–60 | Every 120 hours |

The App Store stops sending further messages when the user resolves the billing issue, cancels the subscription, or when the billing retry period ends. StoreKit ensures that the sheet appears only if the message is applicable when your app calls [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)) or [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction).

For more information about the billing retry state, see [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) in  [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo).

### 

You can simulate billing issues in the sandbox environment to test how the system presents the [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue) message in your app, and how your app handles it if you choose to delay or suppress its presentation. For more information, including step-by-step test cases, see [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases).

## See Also

- [generic](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/generic.md)
- [priceIncreaseConsent](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/priceIncreaseConsent.md)
- [winBackOffer](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/winBackOffer.md)

---


#### generic

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static let generic: Message.Reason
```

## See Also

- [billingIssue](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/billingIssue.md)
- [priceIncreaseConsent](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/priceIncreaseConsent.md)
- [winBackOffer](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/winBackOffer.md)

---


#### localizedDescription

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var localizedDescription: String { get }
```

---


#### priceIncreaseConsent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static let priceIncreaseConsent: Message.Reason
```

## 

For more information about managing prices, see [https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers](https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers) and [https://help.apple.com/app-store-connect/#/devc9870599e](https://help.apple.com/app-store-connect/#/devc9870599e).

## See Also

- [billingIssue](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/billingIssue.md)
- [generic](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/generic.md)
- [winBackOffer](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/winBackOffer.md)

---


#### winBackOffer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static let winBackOffer: Message.Reason
```

## 

If the customer is eligible for a win-back offer, StoreKit displays the win-back offer message when the app launches. If your app customizes the way it displays win-back offers, you can suppress this message, as described in [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).

For more information, see [doc://com.apple.storekit/documentation/StoreKit/merchandising-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/merchandising-win-back-offers-in-your-app).

## See Also

- [billingIssue](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/billingIssue.md)
- [generic](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/generic.md)
- [priceIncreaseConsent](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/priceIncreaseConsent.md)

---


### Messages-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct Messages
```

## 

The `Message.Messages` structure provides a sequence of messages that the App Store sends to your app. Iterate over the contents of this structure asynchronously to retrieve each message if your app needs to delay the message.

Don’t create this structure directly. Instead, use [doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property](doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property) method to retrieve the messages.

## See Also

- [messages-swift.type.property](../com.apple.storekit/StoreKit/Message/messages-swift.type.property.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Message/reason-swift.property.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)

---


### Reason-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct Reason
```

## 

The message reason informs your app of the purpose of the message. Your app can optionally use this information when it handles the messages.

For information about handling App Store messages, see [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).

## Topics

### Getting the message reasons

- [billingIssue](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/billingIssue.md)
- [generic](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/generic.md)
- [priceIncreaseConsent](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/priceIncreaseConsent.md)
- [winBackOffer](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/winBackOffer.md)

### Getting the localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Message/Reason-swift.struct/localizedDescription.md)

## See Also

- [Message](../com.apple.storekit/StoreKit/Message.md)
- [DisplayMessageAction](../com.apple.storekit/StoreKit/DisplayMessageAction.md)

---


### display(in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor func display(in scene: UIWindowScene) throws
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that StoreKit uses to display the App Store message.

## 

The system displays the message if the message is applicable; for example, if the user has previously seen the same App Store message, the system may determine whether to display the message again.

> **NOTE:** If your app uses SwiftUI views, use [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction) instead of [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)).

For more information about using [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)), see [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).

---


### messages-swift.type.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var messages: Message.Messages { get }
```

## 

If your app doesn’t implement this message listener, StoreKit retrieves any messages from the App Store each time your app launches, and presents them by default.

For more information about listening for and displaying messages, see [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).

## See Also

- [reason-swift.property](../com.apple.storekit/StoreKit/Message/reason-swift.property.md)
- [Messages-swift.struct](../com.apple.storekit/StoreKit/Message/Messages-swift.struct.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)

---


### reason-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
let reason: Message.Reason
```

## See Also

- [messages-swift.type.property](../com.apple.storekit/StoreKit/Message/messages-swift.type.property.md)
- [Messages-swift.struct](../com.apple.storekit/StoreKit/Message/Messages-swift.struct.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)

---


## PaymentMethodBinding


### PaymentMethodBindingError


#### invalidPinningID

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
case invalidPinningID
```

## 

For more information about the identifier, see [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/id](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/id).

## See Also

- [failed](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/failed.md)
- [notEligible](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/notEligible.md)

---


#### notEligible

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
case notEligible
```

## See Also

- [failed](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/failed.md)
- [invalidPinningID](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/invalidPinningID.md)

---


### PaymentMethodBindingError

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
enum PaymentMethodBindingError
```

## 

The methods of [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding) may return these errors, as well as the [doc://com.apple.storekit/documentation/StoreKit/StoreKitError/userCancelled](doc://com.apple.storekit/documentation/StoreKit/StoreKitError/userCancelled) error.

## Topics

### Getting error codes

- [failed](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/failed.md)
- [invalidPinningID](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/invalidPinningID.md)
- [notEligible](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError/notEligible.md)

---


### bind()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func bind() async throws
```

## 

> **IMPORTANT:** This method displays a system prompt that asks users to authenticate with their Apple Account. Call this method only after an explicit user action, like tapping or clicking a button.

This method displays an Apple sheet that asks the user to confirm whether to add the payment method associated with the in-app binding ID ([doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/id](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/id)). If the user confirms adding the payment method, it becomes the user’s primary payment method for media purchases and subscriptions from Apple.

The binding succeeds if this method doesn’t throw an error.

This method throws an error in any of the following conditions:

- The user cancels the sheet and doesn’t confirm the payment method update.
- The in-app binding ID (`id`) is invalid or expired.
- The user isn’t eligible.
- The app isn’t entitled to use this API.

For more information about the errors, see [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/PaymentMethodBindingError](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/PaymentMethodBindingError) and [doc://com.apple.storekit/documentation/StoreKit/StoreKitError/userCancelled](doc://com.apple.storekit/documentation/StoreKit/StoreKitError/userCancelled).

---


### init(id:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
init(id: String) async throws
```

## Parameters

- **id**: The in-app binding identifier that your server receives from the Apple server when your server initiates payment method binding.

## 

This method succeeds if the app is entitled to use this API, the `id` is valid and unexpired, and the user is eligible. Otherwise, it throws an error. See [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/PaymentMethodBindingError](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/PaymentMethodBindingError) and [doc://com.apple.storekit/documentation/StoreKit/StoreKitError/userCancelled](doc://com.apple.storekit/documentation/StoreKit/StoreKitError/userCancelled) for the error information.

This method determines if the user is eligible, and requires that they’re signed in to the App Store.

> **IMPORTANT:** This method may display a system prompt that asks users to sign in with their Apple Account. Call this method only after an explicit user action, like tapping or clicking a button.

Note that it’s possible that the system determines a user isn’t eligible after it prompts for authentication.

---


## ProductView


### init(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(_ configuration: ProductViewStyleConfiguration) where Icon == ProductViewStyleConfiguration.Icon, PlaceholderIcon == ProductViewStyleConfiguration.Icon
```

## Parameters

- **configuration**: A configuration for a product view style.

## 

Use this initializer within the [doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle/makeBody(configuration:)) method of a [doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle) to create an instance of the product view you want to style. This is useful for custom product view styles that modify the current style, rather than implementing a new style.

The following code example shows how to create and use custom styles by composing standard styles:

```swift
struct SpinnerWhenLoadingStyle: ProductViewStyle {
    public func makeBody(configuration: Configuration) -> some View {
        switch configuration.state {
        case .loading:
            ProgressView()
                .progressView(.circular)
        default:
            ProductView(configuration)
        }
    }
}
// Use the following elsewhere in the code.
ProductView(id: "com.example.product")
    .productViewStyle(SpinnerWhenLoadingStyle())
```

---


### init(_:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(_ product: Product, @ViewBuilder icon: @escaping (ProductIconPhase) -> Icon) where PlaceholderIcon == EmptyView
```

## Parameters

- **product**: The product to merchandise.
- **icon**: A closure that receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) as an input, which indicates the state of the loading operation of the product’s promoted image, and returns the view to display for the specified phase.

## 

The product view asynchronously loads and displays the product’s promotional image.

The [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) value indicates whether the promotional image is loading, unavailable, or whether it succeeded or failed to load. Use the [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) to monitor current loading phase, and to decide the image to return in the `icon` closure.

## See Also

- [init(_:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(_:prefersPromotionalIcon:icon:).md)
- [init(_:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(_:prefersPromotionalIcon:).md)

---


### init(_:prefersPromotionalIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(_ product: Product, prefersPromotionalIcon: Bool = true) where Icon == EmptyView, PlaceholderIcon == EmptyView
```

## Parameters

- **product**: The product to merchandise.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use the promotional image from the App Store, if it’s available. If this value is `true` and a promotional image for the product is available, the view displays it.

## 

If the product has a promotional image available, the view displays it. Otherwise, the view doesn’t show an image.

If you set the `prefersPromotionalIcon` parameter to `false`, the view doesn’t show an image even if the product has a promotional image available.

> **TIP:** To gain more control over the image that decorates this view, use the [doc://com.apple.storekit/documentation/StoreKit/ProductView/init(_:icon:)](doc://com.apple.storekit/documentation/StoreKit/ProductView/init(_:icon:)) initializer. It receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase), which enables you to supply an image for each phase of the image-loading process.

## See Also

- [init(_:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(_:prefersPromotionalIcon:icon:).md)
- [init(_:icon:)](../com.apple.storekit/StoreKit/ProductView/init(_:icon:).md)

---


### init(_:prefersPromotionalIcon:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(_ product: Product, prefersPromotionalIcon: Bool = false, @ViewBuilder icon: () -> Icon) where PlaceholderIcon == EmptyView
```

## Parameters

- **product**: The product to merchandise.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use the promotional image from the App Store, if it’s available. If this value is `true` and a promotional image for the product is available, the view displays it instead of the view you provide in the `icon` parameter.
- **icon**: A closure that returns the image to use for decorating the in-app purchase product.

## 

If `prefersPromotionalIcon` is `true` and the product has a promotional image, the view displays the promotional image instead of the view you provide in `icon`.

The following example shows how to create a product view using a custom icon:

```swift
ProductView(product) {
    Image(systemName: "star.fill")
        .foregroundStyle(.yellow)
}
```

> **TIP:** To gain more control over the image that decorates this view, use the [doc://com.apple.storekit/documentation/StoreKit/ProductView/init(_:icon:)](doc://com.apple.storekit/documentation/StoreKit/ProductView/init(_:icon:)) initializer. It receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase), which enables you to supply an image for each phase of the image-loading process.

## See Also

- [init(_:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(_:prefersPromotionalIcon:).md)
- [init(_:icon:)](../com.apple.storekit/StoreKit/ProductView/init(_:icon:).md)

---


### init(id:icon:placeholderIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(id productID: Product.ID, @ViewBuilder icon: @escaping (ProductIconPhase) -> Icon, @ViewBuilder placeholderIcon: () -> PlaceholderIcon)
```

## Parameters

- **productID**: The product identifier to load from the App Store.
- **icon**: A closure that receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) as an input, which indicates the state of the loading operation of the product’s promotional image, and returns the view to display for the specified phase.
- **placeholderIcon**: A closure that returns an icon to display until the system finishes loading the product from the App Store.

## 

The product view shows the `placeholderIcon` until the system finishes loading the product. After the product finishes loading, the view asynchronously loads and displays the product’s promotional image. Use the [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) to monitor the current loading state of the product’s promotional image.

If the product is unavailable, the view displays the `placeholderIcon` as a fallback.

The [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) value indicates whether the promotional image is loading, unavailable, or whether it succeeded or failed to load. Use the phase to decide what to draw. While the image’s loading operation is in the [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase/loading](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase/loading) phase, consider displaying the same view that you provide in the `placeholderIcon` closure. For more information, see [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase).

## See Also

- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)

---


### init(id:prefersPromotionalIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(id productID: Product.ID, prefersPromotionalIcon: Bool = false) where Icon == EmptyView, PlaceholderIcon == EmptyView
```

## Parameters

- **productID**: The product identifier to load from the App Store.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use the promotional image from the App Store, if it’s available. If this parameter is `false`, the system ignores any promotional images.

## 

By default, the view doesn’t show an icon. If you set the `prefersPromotionalIcon` parameter to `true`, the view displays a placeholder icon while loading, and replaces the placeholder with the promotional image for the product.

> **TIP:** To gain more control over the image that decorates this view, use the [doc://com.apple.storekit/documentation/StoreKit/ProductView/init(id:icon:placeholderIcon:)](doc://com.apple.storekit/documentation/StoreKit/ProductView/init(id:icon:placeholderIcon:)) initializer. It receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase), which enables you to supply an image for each phase of the image-loading process.

## See Also

- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:icon:placeholderIcon:).md)

---


### init(id:prefersPromotionalIcon:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(id productID: Product.ID, prefersPromotionalIcon: Bool = false, @ViewBuilder icon: () -> Icon) where PlaceholderIcon == AutomaticProductPlaceholderIcon
```

## Parameters

- **productID**: The product identifier to load from the App Store.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use the promotional image from the App Store, if it’s available. If this value is `true` and a promotional image for the product is available, the view displays it instead of the view you provide in the `icon` parameter.
- **icon**: A closure that returns the image the view displays when the system finishes loading the product from the App Store.

## 

The product view displays a placeholder icon until the system finishes loading the product. After the product loads, the system uses the view you provide in the `icon` parameter, by default. If `prefersPromotionalIcon` is `true` and the product has a promotional image, the view displays the promotional image as its icon instead of the provided view.

> **TIP:** To gain more control over the image that decorates this view, use the [doc://com.apple.storekit/documentation/StoreKit/ProductView/init(id:icon:placeholderIcon:)](doc://com.apple.storekit/documentation/StoreKit/ProductView/init(id:icon:placeholderIcon:)) initializer. It receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase), which enables you to supply an image for each phase of the image-loading process.

## See Also

- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:icon:placeholderIcon:).md)

---


### init(id:prefersPromotionalIcon:icon:placeholderIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(id productID: Product.ID, prefersPromotionalIcon: Bool = false, @ViewBuilder icon: () -> Icon, @ViewBuilder placeholderIcon: () -> PlaceholderIcon)
```

## Parameters

- **productID**: The product identifier to load from the App Store.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use the promotional image from the App Store, if it’s available. If this value is `true` and a promotional image for the product is available, the view displays it instead of the view you provide in the `icon` parameter.
- **icon**: A closure that returns the image the view displays when the system successfully finishes loading the product from the App Store.
- **placeholderIcon**: A closure that returns the image that the view uses while the system loads the product from the App Store.

## 

The product view displays the custom `placeholderIcon` until the system finishes loading the product. After the product loads, the system uses the view you provide in the `icon` parameter by default. If `prefersPromotionalIcon` is `true` and the product has a promotional image, the view displays the promotional image as its image instead of the view that `icon` provides.

The following code example shows how to create a product view using the `icon` and a custom `placeholderIcon`:

```swift
ProductView(id: "com.example.product") {
    Image(systemName: "star.fill")
        .foregroundStyle(.yellow)
} placeholderIcon: {
    Image(systemName: "star.fill")
        .foregroundStyle(.gray)
}
```

> **TIP:** To gain more control over the image that decorates this view, use the [doc://com.apple.storekit/documentation/StoreKit/ProductView/init(id:icon:placeholderIcon:)](doc://com.apple.storekit/documentation/StoreKit/ProductView/init(id:icon:placeholderIcon:)) initializer. It receives a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase), which enables you to supply an image for each phase of the image-loading process.

## See Also

- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:icon:placeholderIcon:).md)

---


## PurchaseIntent


### PurchaseIntents

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
struct PurchaseIntents
```

## See Also

- [intents](../com.apple.storekit/StoreKit/PurchaseIntent/intents.md)

---


### intents

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
static var intents: PurchaseIntent.PurchaseIntents { get }
```

## 

Your app receives a purchase intent when customers initiate a purchase outside of your app by selecting a promoted product on the App Store, or redeeming a win-back offer. Use the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product) object to complete your app’s purchase workflow, including finishing the purchase, unlocking the product, and any other workflows specific to your app.

The following example code receives the purchase intent, and calls a method to complete the purchase workflow:

```swift
func purchaseProduct(_ product: Product) async {
    // Complete the purchase workflow.
    do {
        try await product.purchase()
    }
    catch {
        // Add your code to handle errors.
    }
    // Add your code for the remaining purchase workflow.
}

for await purchaseIntent in PurchaseIntent.intents {
    // Receive the purchase intent and then complete the purchase workflow.
    await purchaseProduct(purchaseIntent.product)
}

```

## See Also

- [PurchaseIntents](../com.apple.storekit/StoreKit/PurchaseIntent/PurchaseIntents.md)

---


## RequestReviewAction


### callAsFunction()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor func callAsFunction()
```

## 

Don’t call this method directly. SwiftUI calls it when you call the [doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction](doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction) instance that you get from the [doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/requestReview](doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/requestReview) environment value.

For information about how Swift uses the [doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction/callAsFunction()](doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction/callAsFunction())method to simplify call site syntax, see [https://docs.swift.org/swift-book/ReferenceManual/Declarations.html#ID622](https://docs.swift.org/swift-book/ReferenceManual/Declarations.html#ID622) in *The Swift Programming Language*.

---


## SKANError-swift.struct


### Code

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
enum Code
```

## Topics

### Error Codes

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/unsupported.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code/init(rawValue:).md)

## See Also

- [SKANErrorDomain](../com.apple.storekit/StoreKit/SKANErrorDomain.md)
- [SKANError-swift.struct](../com.apple.storekit/StoreKit/SKANError-swift.struct.md)

---


### adNetworkIdMissing

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var adNetworkIdMissing: SKANError.Code { get }
```

## 

The value you specify for your ad network identifier in your ad impresion must match the value in the `Info.plist`. ``An app that participates in ad campaigns by displaying ads must include the ad network identifiers in its `Info.plist`. For more information, see [doc://com.apple.storekit/documentation/StoreKit/configuring-a-source-app](doc://com.apple.storekit/documentation/StoreKit/configuring-a-source-app).

## See Also

- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### errorDomain

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var errorDomain: String { get }
```

---


### impressionMissingRequiredValue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var impressionMissingRequiredValue: SKANError.Code { get }
```

## 

Check that your instance of [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) provides all of the required values.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### impressionNotFound

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var impressionNotFound: SKANError.Code { get }
```

## 

This error may occur if an app calls [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) before calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)).

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### impressionTooShort

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var impressionTooShort: SKANError.Code { get }
```

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### invalidAdvertisedAppId

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var invalidAdvertisedAppId: SKANError.Code { get }
```

## 

Ad networks provide an advertised app identifier when signing an ad impression. If you’re providing a StoreKit-rendered ad, check that the value you set for [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier) in [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) is a valid app identifer. If you’re providing a view-through ad, check the value of [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier).

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### invalidCampaignId

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var invalidCampaignId: SKANError.Code { get }
```

## 

Check that the campaign identifier is a valid value. For more information, see [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier) for StoreKit-rendered ads, and [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier) for view-through ads.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### invalidConversionValue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var invalidConversionValue: SKANError.Code { get }
```

## 

Apps provide a conversion value when calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)) or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)). Check that the conversion value you provide is within the allowed range.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### invalidSourceAppId

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var invalidSourceAppId: SKANError.Code { get }
```

## 

Check that the value you provide for [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier) or [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier) is correct and matches the App Store ID of the app that’s displaying the ad.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### invalidVersion

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var invalidVersion: SKANError.Code { get }
```

## 

Ad networks provide an SKAdNetwork version number when preparing an ad impression, in [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkVersion](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkVersion) or [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version). Check that the version number is valid and that you follow the version-specific instructions to generate a signature. For more information about versions, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### mismatchedSourceAppId

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var mismatchedSourceAppId: SKANError.Code { get }
```

## 

Check that the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier) you provide in the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) object matches the app identifier of the app displaying the ad.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### unknown

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var unknown: SKANError.Code { get }
```

## 

If this error appears, continue processing the ad; an ad impression may succeed despite this error.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


### unsupported

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var unsupported: SKANError.Code { get }
```

## 

For information about supported features by version number, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes). For example, to provide view-through ads, use SKAdNetwork version 2.2 or later.

## See Also

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


## SKAdImpression


### adCampaignIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adCampaignIdentifier: NSNumber { get set }
```

## 

Ad networks set their own campaign identifiers, which must be an integer `>=1` and `<=100.`

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### adDescription

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adDescription: String? { get set }
```

## 

This property is not used.

## See Also

- [adType](../com.apple.storekit/StoreKit/SKAdImpression/adType.md)
- [adPurchaserName](../com.apple.storekit/StoreKit/SKAdImpression/adPurchaserName.md)

---


### adImpressionIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adImpressionIdentifier: String { get set }
```

## 

Ad networks set the value of this property to a random value (nonce) at the time of the ad impression.

> **IMPORTANT:** When you generate [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature), which is the signature value, you must sign the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adImpressionIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adImpressionIdentifier) as an all-lowercase UUID string representation.

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### adNetworkIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adNetworkIdentifier: String { get set }
```

## 

Set this property to your ad network ID.

Ad networks obtain an ad network identifier during registration. Ad networks must share their ad network identifiers with participating app developers. Apps that display ads must include the ad network ID in their `Info.plist` to initiate the app install validation process. For more information about acquiring your ad network ID, see [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network).

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### adPurchaserName

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adPurchaserName: String? { get set }
```

## 

This property is not used.

## See Also

- [adType](../com.apple.storekit/StoreKit/SKAdImpression/adType.md)
- [adDescription](../com.apple.storekit/StoreKit/SKAdImpression/adDescription.md)

---


### adType

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adType: String? { get set }
```

## 

This property is not used.

## See Also

- [adDescription](../com.apple.storekit/StoreKit/SKAdImpression/adDescription.md)
- [adPurchaserName](../com.apple.storekit/StoreKit/SKAdImpression/adPurchaserName.md)

---


### advertisedAppStoreItemIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var advertisedAppStoreItemIdentifier: NSNumber { get set }
```

## 

Set this property to the App Store item identifier of the app that you’re advertising.

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
init(sourceAppStoreItemIdentifier: NSNumber, advertisedAppStoreItemIdentifier: NSNumber, adNetworkIdentifier: String, adCampaignIdentifier: NSNumber, adImpressionIdentifier: String, timestamp: NSNumber, signature: String, version: String)
```

## See Also

- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### sourceAppStoreItemIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var sourceAppStoreItemIdentifier: NSNumber { get set }
```

## 

Set this property to the App Store item identifier of the app that’s displaying the ad.

If you’re using a development-signed build to display the ads and not an app from App Store during testing, use `0` as the item identifier.

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### sourceIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var sourceIdentifier: NSNumber { get set }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier) key is available for ad impressions that use SKAdNetwork 4 and later. The [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier), also known as the *hierarchical source identifier*, replaces and extends the campaign identifier value, [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier).

Ad networks and developers define the meaning of the hierarchical source identifier. This integer can have up to four digits. You can encode information about your advertisement in each set of digits; you may receive two, three, or all four digits of the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier) in the first winning postback, depending on the ad impression’s postback data tier. For more information about the value you may get in the postback, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

> **NOTE:** An install-validation postback represents this integer as a string in its `source-identifier` parameter. For more details about the parameters of an install-validation postback, see [doc://com.apple.storekit/documentation/StoreKit/identifying-the-parameters-in-install-validation-postbacks](doc://com.apple.storekit/documentation/StoreKit/identifying-the-parameters-in-install-validation-postbacks).

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


### version

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var version: String { get set }
```

## 

Set this instance property to the SKAdNetwork version you’re using to sign the view-through ad impression. View-through ads are available starting in version 2.2. For more information about versions and availability, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

## See Also

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

---


## SKCloudServiceController


### authorizationStatus()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
class func authorizationStatus() -> SKCloudServiceAuthorizationStatus
```

## 

The type of authorization for music library access. See [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus) for a list of possible values.

## 

Use the authorization status to determine in what ways you can access the user’s music library.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)
- [requesting-access-to-apple-music-library](../com.apple.storekit/StoreKit/requesting-access-to-apple-music-library.md)
- [requestAuthorization(_:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestAuthorization(_:).md)
- [SKCloudServiceAuthorizationStatus](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus.md)

---


### requestAuthorization(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
class func requestAuthorization(_ completionHandler: @escaping (SKCloudServiceAuthorizationStatus) -> Void)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
class func requestAuthorization() async -> SKCloudServiceAuthorizationStatus
```

## Parameters

- **completionHandler**: A block that is called when authorization is granted or denied by the user.

## 

You can use this method to ask the user for permission to play Apple Music tracks or to add tracks to the music library.

## See Also

- [requesting-access-to-apple-music-library](../com.apple.storekit/StoreKit/requesting-access-to-apple-music-library.md)
- [authorizationStatus()](../com.apple.storekit/StoreKit/SKCloudServiceController/authorizationStatus().md)
- [SKCloudServiceAuthorizationStatus](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus.md)

---


### requestCapabilities(completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestCapabilities(completionHandler: @escaping (SKCloudServiceCapability, (any Error)?) -> Void)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestCapabilities() async throws -> SKCloudServiceCapability
```

## Parameters

- **completionHandler**: A block that is called when the device’s current capabilities are determined. The block takes the following parameters:

## 

## See Also

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

---


### requestPersonalizationToken(forClientToken:withCompletionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
func requestPersonalizationToken(forClientToken clientToken: String, withCompletionHandler completionHandler: @escaping (String?, (any Error)?) -> Void)
```

## See Also

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)

---


### requestStorefrontCountryCode(completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestStorefrontCountryCode(completionHandler: @escaping (String?, (any Error)?) -> Void)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestStorefrontCountryCode() async throws -> String
```

## Parameters

- **completionHandler**: A block that is called when the storefront country code is returned. The block takes the following parameters:

## 

You need to get the appropriate storefront country code before you specify a product as each country or region contains different products.

## See Also

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

---


### requestStorefrontIdentifier(completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestStorefrontIdentifier(completionHandler: @escaping (String?, (any Error)?) -> Void)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestStorefrontIdentifier() async throws -> String
```

## Parameters

- **completionHandler**: A block that is called when the storefront ID is returned. The block takes the following parameters:

## 

You need to get the appropriate storefront before you specify a product, because product identifiers are meaningful within the context of a store.

## See Also

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

---


### requestUserToken(forDeveloperToken:completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestUserToken(forDeveloperToken developerToken: String, completionHandler: @escaping (String?, (any Error)?) -> Void)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func requestUserToken(forDeveloperToken developerToken: String) async throws -> String
```

## Parameters

- **developerToken**: A signed and encrypted JWT token used to authenticate the developer in Apple Music API requests.
- **completionHandler**: A completion block that includes the following parameters:

## 

Use this method with your developer token to get a token that authenticates the user in personalized Apple Music API requests. Note that personalized requests return user-specific data. Errors 401 and 403 only occur when requesting a music user token. They do not occur for any of the other Apple Music API requests.

## See Also

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

---


## SKCloudServiceSetupMessageIdentifier


### addMusic

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let addMusic: SKCloudServiceSetupMessageIdentifier
```

## See Also

- [connect](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/connect.md)
- [join](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/join.md)
- [playMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/playMusic.md)

---


### connect

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let connect: SKCloudServiceSetupMessageIdentifier
```

## See Also

- [addMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/addMusic.md)
- [join](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/join.md)
- [playMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/playMusic.md)

---


### join

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let join: SKCloudServiceSetupMessageIdentifier
```

## See Also

- [addMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/addMusic.md)
- [connect](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/connect.md)
- [playMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/playMusic.md)

---


### playMusic

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let playMusic: SKCloudServiceSetupMessageIdentifier
```

## See Also

- [addMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/addMusic.md)
- [connect](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/connect.md)
- [join](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/join.md)

---


## SKDownload


### contentIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var contentIdentifier: String { get }
```

## 

Each piece of downloadable content associated with a product has its own unique identifier. The content identifier is specified in App Store Connect when you add the content.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)
- [expectedContentLength](../com.apple.storekit/StoreKit/SKDownload/expectedContentLength.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKDownload/contentVersion.md)
- [transaction](../com.apple.storekit/StoreKit/SKDownload/transaction.md)
- [contentLength](../com.apple.storekit/StoreKit/SKDownload/contentLength.md)

---


### contentLength

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
var contentLength: Int64 { get }
```

**Platforms:** macOS

```swift
@NSCopying var contentLength: NSNumber { get }
```

## See Also

- [expectedContentLength](../com.apple.storekit/StoreKit/SKDownload/expectedContentLength.md)
- [contentIdentifier](../com.apple.storekit/StoreKit/SKDownload/contentIdentifier.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKDownload/contentVersion.md)
- [transaction](../com.apple.storekit/StoreKit/SKDownload/transaction.md)

---


### contentURL(forProductID:)

## Declaration

**Platforms:** Mac Catalyst, macOS

```swift
class func contentURL(forProductID productID: String) -> URL?
```

## Parameters

- **productID**: The product identifier.

## 

The local location for the previously downloaded flie.

## 

Use this method to locate the content on subsequent launches of your app.

## See Also

- [deleteContent(forProductID:)](../com.apple.storekit/StoreKit/SKDownload/deleteContent(forProductID:).md)

---


### contentURL

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var contentURL: URL? { get }
```

## 

The value of this property is valid only when the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState) property is set to [doc://com.apple.storekit/documentation/StoreKit/SKDownloadState/finished](doc://com.apple.storekit/documentation/StoreKit/SKDownloadState/finished). The URL becomes invalid after the transaction object associated with the download is finalized.

## See Also

- [error](../com.apple.storekit/StoreKit/SKDownload/error.md)

---


### contentVersion

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var contentVersion: String { get }
```

## 

The version string must be formatted as a series of integers separated by periods.

## See Also

- [expectedContentLength](../com.apple.storekit/StoreKit/SKDownload/expectedContentLength.md)
- [contentIdentifier](../com.apple.storekit/StoreKit/SKDownload/contentIdentifier.md)
- [transaction](../com.apple.storekit/StoreKit/SKDownload/transaction.md)
- [contentLength](../com.apple.storekit/StoreKit/SKDownload/contentLength.md)

---


### deleteContent(forProductID:)

## Declaration

**Platforms:** Mac Catalyst, macOS

```swift
class func deleteContent(forProductID productID: String)
```

## Parameters

- **productID**: The product identifier.

## See Also

- [contentURL(forProductID:)](../com.apple.storekit/StoreKit/SKDownload/contentURL(forProductID:).md)

---


### downloadState

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
var downloadState: SKDownloadState { get }
```

## 

After you queue a download object, the payment queue object calls your transaction observer when the state of the download object changes. Your transaction observer should read the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState) property and use it to determine how to proceed. For more information on the different states, see [doc://com.apple.storekit/documentation/StoreKit/SKDownloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownloadState).

## See Also

- [state](../com.apple.storekit/StoreKit/SKDownload/state.md)
- [progress](../com.apple.storekit/StoreKit/SKDownload/progress.md)
- [timeRemaining](../com.apple.storekit/StoreKit/SKDownload/timeRemaining.md)
- [SKDownloadTimeRemainingUnknown](../com.apple.storekit/StoreKit/SKDownloadTimeRemainingUnknown.md)
- [SKDownloadState](../com.apple.storekit/StoreKit/SKDownloadState.md)

---


### error

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var error: (any Error)? { get }
```

## 

The value of this property is valid only when the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState) property is set to [doc://com.apple.storekit/documentation/StoreKit/SKDownloadState/failed](doc://com.apple.storekit/documentation/StoreKit/SKDownloadState/failed).

## See Also

- [contentURL](../com.apple.storekit/StoreKit/SKDownload/contentURL.md)

---


### expectedContentLength

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var expectedContentLength: Int64 { get }
```

## See Also

- [contentIdentifier](../com.apple.storekit/StoreKit/SKDownload/contentIdentifier.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKDownload/contentVersion.md)
- [transaction](../com.apple.storekit/StoreKit/SKDownload/transaction.md)
- [contentLength](../com.apple.storekit/StoreKit/SKDownload/contentLength.md)

---


### progress

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var progress: Float { get }
```

## 

The value of this property is a floating point number between `0.0` and `1.0`, inclusive, where `0.0` means no data has been download and `1.0` means all the data has been downloaded. Typically, your app uses the value of this property to update a user interface element, such as a progress bar, that displays how much of the file has been downloaded.

Do not use the value of this property to determine whether the download has completed. Instead, use the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState) property.

## See Also

- [state](../com.apple.storekit/StoreKit/SKDownload/state.md)
- [timeRemaining](../com.apple.storekit/StoreKit/SKDownload/timeRemaining.md)
- [SKDownloadTimeRemainingUnknown](../com.apple.storekit/StoreKit/SKDownloadTimeRemainingUnknown.md)
- [SKDownloadState](../com.apple.storekit/StoreKit/SKDownloadState.md)
- [downloadState](../com.apple.storekit/StoreKit/SKDownload/downloadState.md)

---


### state

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var state: SKDownloadState { get }
```

## 

After you queue a download object, the payment queue object calls your transaction observer when the state of the download object changes. Your transaction observer should read the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/state](doc://com.apple.storekit/documentation/StoreKit/SKDownload/state) property and use it to determine how to proceed. For more information on the different states, see [doc://com.apple.storekit/documentation/StoreKit/SKDownloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownloadState).

## See Also

- [progress](../com.apple.storekit/StoreKit/SKDownload/progress.md)
- [timeRemaining](../com.apple.storekit/StoreKit/SKDownload/timeRemaining.md)
- [SKDownloadTimeRemainingUnknown](../com.apple.storekit/StoreKit/SKDownloadTimeRemainingUnknown.md)
- [SKDownloadState](../com.apple.storekit/StoreKit/SKDownloadState.md)
- [downloadState](../com.apple.storekit/StoreKit/SKDownload/downloadState.md)

---


### timeRemaining

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var timeRemaining: TimeInterval { get }
```

## 

The system attempts to estimate how long it will take to finish downloading the file. If it cannot create a good estimate, the value of this property is set to [doc://com.apple.storekit/documentation/StoreKit/SKDownloadTimeRemainingUnknown](doc://com.apple.storekit/documentation/StoreKit/SKDownloadTimeRemainingUnknown).

## See Also

- [state](../com.apple.storekit/StoreKit/SKDownload/state.md)
- [progress](../com.apple.storekit/StoreKit/SKDownload/progress.md)
- [SKDownloadTimeRemainingUnknown](../com.apple.storekit/StoreKit/SKDownloadTimeRemainingUnknown.md)
- [SKDownloadState](../com.apple.storekit/StoreKit/SKDownloadState.md)
- [downloadState](../com.apple.storekit/StoreKit/SKDownload/downloadState.md)

---


## SKError


### clientInvalid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var clientInvalid: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### cloudServiceNetworkConnectionFailed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var cloudServiceNetworkConnectionFailed: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### cloudServicePermissionDenied

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var cloudServicePermissionDenied: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### cloudServiceRevoked

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var cloudServiceRevoked: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### ineligibleForOffer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var ineligibleForOffer: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


### invalidOfferIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var invalidOfferIdentifier: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### invalidOfferPrice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var invalidOfferPrice: SKError.Code { get }
```

## 

An offer price can become invalid if you change the price of the base subscription such that it is lower than the offer price. Offers must always represent a discounted price.

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### invalidSignature

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var invalidSignature: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### missingOfferParams

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var missingOfferParams: SKError.Code { get }
```

## 

This error appears if all parameters of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount) are not present.

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


### overlayCancelled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var overlayCancelled: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


### overlayInvalidConfiguration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var overlayInvalidConfiguration: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


### overlayPresentedInBackgroundScene

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var overlayPresentedInBackgroundScene: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


### overlayTimeout

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var overlayTimeout: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


### paymentCancelled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var paymentCancelled: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### paymentInvalid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var paymentInvalid: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### paymentNotAllowed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var paymentNotAllowed: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### privacyAcknowledgementRequired

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var privacyAcknowledgementRequired: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### storeProductNotAvailable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var storeProductNotAvailable: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### unauthorizedRequestData

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var unauthorizedRequestData: SKError.Code { get }
```

## 

To use [doc://com.apple.storekit/documentation/StoreKit/SKPayment/requestData](doc://com.apple.storekit/documentation/StoreKit/SKPayment/requestData), an app must have a required entitlement.

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)

---


### unsupportedPlatform

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
static var unsupportedPlatform: SKError.Code { get }
```

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)

---


## SKOverlay


### AppClipConfiguration


#### init(position:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
init(position: SKOverlay.Position)
```

## Parameters

- **position**: The position of the overlay on the screen.

## See Also

- [position](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/position.md)
- [Position](../com.apple.storekit/StoreKit/SKOverlay/Position.md)

---


### AppConfiguration


#### adAttributionReengagementURL

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var adAttributionReengagementURL: URL? { get set }
```

## See Also

- [appImpression](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/appImpression.md)

---


#### additionalValue(forKey:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func additionalValue(forKey key: String) -> Any?
```

## Parameters

- **key**: The string that identifies an additional value.

## 

The associated value of the key.

## 

Additional values are values you use to verify and associate an app installation with an ad campaign. For more information, see [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork).

## See Also

- [campaignToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/campaignToken.md)
- [providerToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/providerToken.md)
- [setAdditionalValue(_:forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/setAdditionalValue(_:forKey:).md)

---


#### appIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var appIdentifier: String { get set }
```

## See Also

- [init(appIdentifier:position:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/init(appIdentifier:position:).md)
- [position](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/position.md)
- [Position](../com.apple.storekit/StoreKit/SKOverlay/Position.md)

---


#### appImpression

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var appImpression: AppImpression? { get set }
```

## See Also

- [adAttributionReengagementURL](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/adAttributionReengagementURL.md)

---


#### campaignToken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var campaignToken: String? { get set }
```

## 

A campaign token is a 40-byte string that represents an ad campaign. By setting the `campaignToken`, you can measure the effectiveness of an Apple Services Performance Partners Program link or an App Store Connect Analytics campaign.

For more information, see [https://apple.com/itunes/affiliates](https://apple.com/itunes/affiliates) and [https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/About.html#//apple_ref/doc/uid/TP40011225](https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/About.html#//apple_ref/doc/uid/TP40011225).

## See Also

- [providerToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/providerToken.md)
- [setAdditionalValue(_:forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/setAdditionalValue(_:forKey:).md)
- [additionalValue(forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/additionalValue(forKey:).md)

---


#### customProductPageIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var customProductPageIdentifier: String? { get set }
```

## 

The identifier, referred to as the product variant identifier, identifies specific variant product pages from App Store Connect for your app.

---


#### init(appIdentifier:position:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
init(appIdentifier: String, position: SKOverlay.Position)
```

## Parameters

- **appIdentifier**: The iTunes identifier of the recommended app.
- **position**: The position of the overlay on the screen.

## See Also

- [appIdentifier](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/appIdentifier.md)
- [position](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/position.md)
- [Position](../com.apple.storekit/StoreKit/SKOverlay/Position.md)

---


#### latestReleaseID

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var latestReleaseID: String? { get set }
```

---


#### providerToken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var providerToken: String? { get set }
```

## 

When you set a provider token, you must also set the [doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppConfiguration/campaignToken](doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppConfiguration/campaignToken).

When promoting your own apps, set your own provider token using `providerToken`. This allows you to track a promotion’s effectiveness independently from any affiliate campaign that shares the same campaign token.

When promoting apps by other developers, set `providerToken` using their provider token. This allows those developers to track the effectiveness of your App Store Connect Analytics campaign.

## See Also

- [campaignToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/campaignToken.md)
- [setAdditionalValue(_:forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/setAdditionalValue(_:forKey:).md)
- [additionalValue(forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/additionalValue(forKey:).md)

---


#### setAdImpression(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
func setAdImpression(_ impression: SKAdImpression)
```

---


#### setAdditionalValue(_:forKey:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func setAdditionalValue(_ value: Any?, forKey key: String)
```

## Parameters

- **value**: The value to associate with the `key`.
- **key**: The string that identifies an additional value.

## 

Set additional values to verify and associate an app installation with an ad campaign. For more information, see [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork).

## See Also

- [campaignToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/campaignToken.md)
- [providerToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/providerToken.md)
- [additionalValue(forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/additionalValue(forKey:).md)

---


#### userDismissible

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var userDismissible: Bool { get set }
```

---


### Position


#### bottom

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
case bottom
```

## See Also

- [bottomRaised](../com.apple.storekit/StoreKit/SKOverlay/Position/bottomRaised.md)

---


#### bottomRaised

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
case bottomRaised
```

## 

Use this position in case your app uses a [doc://com.apple.documentation/documentation/UIKit/UITabBar](doc://com.apple.documentation/documentation/UIKit/UITabBar).

## See Also

- [bottom](../com.apple.storekit/StoreKit/SKOverlay/Position/bottom.md)

---


### TransitionContext


#### addAnimation(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
func addAnimation(_ block: @escaping () -> Void)
```

## Parameters

- **block**: A closure that sets animatable view properties and runs on the main thread.

## See Also

- [startFrame](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/startFrame.md)
- [endFrame](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/endFrame.md)

---


#### endFrame

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var endFrame: CGRect { get }
```

## See Also

- [addAnimation(_:)](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/addAnimation(_:).md)
- [startFrame](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/startFrame.md)

---


#### startFrame

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var startFrame: CGRect { get }
```

## See Also

- [addAnimation(_:)](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/addAnimation(_:).md)
- [endFrame](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/endFrame.md)

---


### AppClipConfiguration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
class AppClipConfiguration
```

## Topics

### Creating an App Clip Configuration

- [init(position:)](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/init(position:).md)
- [position](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/position.md)
- [Position](../com.apple.storekit/StoreKit/SKOverlay/Position.md)

### Verifying Advertising Campaigns

- [campaignToken](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/campaignToken.md)
- [providerToken](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/providerToken.md)
- [setAdditionalValue(_:forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/setAdditionalValue(_:forKey:).md)
- [additionalValue(forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/additionalValue(forKey:).md)

### Promoting the Latest App Version

- [latestReleaseID](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/latestReleaseID.md)

### Advertising Another App

- [customProductPageIdentifier](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/customProductPageIdentifier.md)

## See Also

- [init(configuration:)](../com.apple.storekit/StoreKit/SKOverlay/init(configuration:).md)
- [configuration-swift.property](../com.apple.storekit/StoreKit/SKOverlay/configuration-swift.property.md)
- [AppConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration.md)
- [Configuration-swift.class](../com.apple.storekit/StoreKit/SKOverlay/Configuration-swift.class.md)

---


### AppConfiguration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
class AppConfiguration
```

## Topics

### Creating an App Configuration

- [init(appIdentifier:position:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/init(appIdentifier:position:).md)
- [appIdentifier](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/appIdentifier.md)
- [position](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/position.md)
- [Position](../com.apple.storekit/StoreKit/SKOverlay/Position.md)

### Dismissing the Overlay

- [userDismissible](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/userDismissible.md)

### Verifying Advertising Campaigns

- [campaignToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/campaignToken.md)
- [providerToken](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/providerToken.md)
- [setAdditionalValue(_:forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/setAdditionalValue(_:forKey:).md)
- [additionalValue(forKey:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/additionalValue(forKey:).md)

### Promoting the Latest App Version

- [latestReleaseID](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/latestReleaseID.md)

### Advertising Another App

- [customProductPageIdentifier](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/customProductPageIdentifier.md)

### Setting an Ad Impression

- [setAdImpression(_:)](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/setAdImpression(_:).md)

### Instance Properties

- [adAttributionReengagementURL](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/adAttributionReengagementURL.md)
- [appImpression](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration/appImpression.md)

## See Also

- [init(configuration:)](../com.apple.storekit/StoreKit/SKOverlay/init(configuration:).md)
- [configuration-swift.property](../com.apple.storekit/StoreKit/SKOverlay/configuration-swift.property.md)
- [AppClipConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration.md)
- [Configuration-swift.class](../com.apple.storekit/StoreKit/SKOverlay/Configuration-swift.class.md)

---


### Configuration-swift.class

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
class Configuration
```

## See Also

- [init(configuration:)](../com.apple.storekit/StoreKit/SKOverlay/init(configuration:).md)
- [configuration-swift.property](../com.apple.storekit/StoreKit/SKOverlay/configuration-swift.property.md)
- [AppConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration.md)
- [AppClipConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration.md)

---


### Position

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
enum Position
```

## Topics

### Describing the Overlay’s Position

- [bottom](../com.apple.storekit/StoreKit/SKOverlay/Position/bottom.md)
- [bottomRaised](../com.apple.storekit/StoreKit/SKOverlay/Position/bottomRaised.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKOverlay/Position/init(rawValue:).md)

## See Also

- [init(position:)](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/init(position:).md)
- [position](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration/position.md)

---


### TransitionContext

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
class TransitionContext
```

## 

For more information on animating UI changes while the system presents or dismisses an overlay, see [doc://com.apple.storekit/documentation/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:)](doc://com.apple.storekit/documentation/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:)) and [doc://com.apple.storekit/documentation/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:)](doc://com.apple.storekit/documentation/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:)).

## Topics

### Adding an Animation

- [addAnimation(_:)](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/addAnimation(_:).md)
- [startFrame](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/startFrame.md)
- [endFrame](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext/endFrame.md)

## See Also

- [storeOverlayWillStartPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:).md)
- [storeOverlayDidFinishPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishPresentation(_:transitionContext:).md)
- [storeOverlayWillStartDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:).md)
- [storeOverlayDidFinishDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishDismissal(_:transitionContext:).md)

---


### configuration-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@NSCopying var configuration: SKOverlay.Configuration { get }
```

## See Also

- [init(configuration:)](../com.apple.storekit/StoreKit/SKOverlay/init(configuration:).md)
- [AppConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration.md)
- [AppClipConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration.md)
- [Configuration-swift.class](../com.apple.storekit/StoreKit/SKOverlay/Configuration-swift.class.md)

---


### dismiss(in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor class func dismiss(in scene: UIWindowScene)
```

## Parameters

- **scene**: The window scene used to display the overlay.

---


### init(configuration:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
init(configuration: SKOverlay.Configuration)
```

## Parameters

- **configuration**: The object that represents the overlay’s attributes; for example, its position on the screen.

## 

Pass an [doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppConfiguration](doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppConfiguration) as the `configuration` parameter if you want to display the overlay in an app. To recommend an App Clip’s corresponding app, pass an [doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppClipConfiguration](doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppClipConfiguration) object to the initializer. For more information, see [doc://com.apple.documentation/documentation/AppClip/recommending-your-app-to-app-clip-users](doc://com.apple.documentation/documentation/AppClip/recommending-your-app-to-app-clip-users).

## See Also

- [configuration-swift.property](../com.apple.storekit/StoreKit/SKOverlay/configuration-swift.property.md)
- [AppConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration.md)
- [AppClipConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration.md)
- [Configuration-swift.class](../com.apple.storekit/StoreKit/SKOverlay/Configuration-swift.class.md)

---


### present(in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor func present(in scene: UIWindowScene)
```

## Parameters

- **scene**: The window scene used to display the overlay.

---


## SKPayment


### applicationUsername

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var applicationUsername: String? { get }
```

## 

For more information on how to set and use this property, see [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername).

## See Also

- [productIdentifier](../com.apple.storekit/StoreKit/SKPayment/productIdentifier.md)
- [quantity](../com.apple.storekit/StoreKit/SKPayment/quantity.md)
- [requestData](../com.apple.storekit/StoreKit/SKPayment/requestData.md)

---


### init(product:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
convenience init(product: SKProduct)
```

## Parameters

- **product**: The product the user wishes to purchase.

## 

A new payment object.

## 

This [https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/ObjectCreation.html#//apple_ref/doc/uid/TP40008195-CH39](https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/ObjectCreation.html#//apple_ref/doc/uid/TP40008195-CH39) uses the `productIdentifier` property obtained from the `product` parameter to create and return a new payment with that identifier. The quantity property defaults to `1`.

To create a [doc://com.apple.storekit/documentation/StoreKit/SKPayment](doc://com.apple.storekit/documentation/StoreKit/SKPayment) object with a quantity greater than `1`, create a `SKMutablePayment` object, adjust its `quantity` property and then add it to the payment queue.

```objc
SKMutablePayment *myPayment = [SKMutablePayment paymentWithProduct: myProduct];
myPayment.quantity = 2;
[[SKPaymentQueue defaultQueue] addPayment:myPayment];
```

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)

---


### paymentDiscount

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@NSCopying var paymentDiscount: SKPaymentDiscount? { get }
```

## See Also

- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

---


### productIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var productIdentifier: String { get }
```

## 

The product identifier is a string previously agreed on between your app and the Apple App Store.

## See Also

- [quantity](../com.apple.storekit/StoreKit/SKPayment/quantity.md)
- [requestData](../com.apple.storekit/StoreKit/SKPayment/requestData.md)
- [applicationUsername](../com.apple.storekit/StoreKit/SKPayment/applicationUsername.md)

---


### quantity

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var quantity: Int { get }
```

## 

The default value is 1, the minimum value is 1, and the maximum value is 10.

## See Also

- [productIdentifier](../com.apple.storekit/StoreKit/SKPayment/productIdentifier.md)
- [requestData](../com.apple.storekit/StoreKit/SKPayment/requestData.md)
- [applicationUsername](../com.apple.storekit/StoreKit/SKPayment/applicationUsername.md)

---


### requestData

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var requestData: Data? { get }
```

## 

The default value is `nil`. If [doc://com.apple.storekit/documentation/StoreKit/SKPayment/requestData](doc://com.apple.storekit/documentation/StoreKit/SKPayment/requestData) is not `nil`, your payment request will be rejected.

## See Also

- [productIdentifier](../com.apple.storekit/StoreKit/SKPayment/productIdentifier.md)
- [quantity](../com.apple.storekit/StoreKit/SKPayment/quantity.md)
- [applicationUsername](../com.apple.storekit/StoreKit/SKPayment/applicationUsername.md)

---


### simulatesAskToBuyInSandbox

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var simulatesAskToBuyInSandbox: Bool { get }
```

---


## SKPaymentDiscount


### init(identifier:keyIdentifier:nonce:signature:timestamp:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
init(identifier: String, keyIdentifier: String, nonce: UUID, signature: String, timestamp: NSNumber)
```

---


### keyIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var keyIdentifier: String { get }
```

## 

You generate and download keys from App Store Connect. See the “KEY ID” column in App Store Connect to use as the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/keyIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/keyIdentifier).

## See Also

- [identifier](../com.apple.storekit/StoreKit/SKPaymentDiscount/identifier.md)

---


### nonce

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var nonce: UUID { get }
```

## 

Your server generates a unique [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/nonce](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/nonce) when it creates the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature) string for the payment discount. The string representation of the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/nonce](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/nonce) must be lowercase.

You can use a [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/nonce](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/nonce) one time; generate a new one for every buy request.

## See Also

- [signature](../com.apple.storekit/StoreKit/SKPaymentDiscount/signature.md)
- [timestamp](../com.apple.storekit/StoreKit/SKPaymentDiscount/timestamp.md)

---


### signature

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signature: String { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature) is a string signed with your private key that represents the properties of a specific promotional offer. To keep your private key secure, generate the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature) on a server.

Generate the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature) using the Elliptic Curve Digital Signature Algorithm (ECDSA) with SHA 256. For more information, see [doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers](doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers).

## See Also

- [nonce](../com.apple.storekit/StoreKit/SKPaymentDiscount/nonce.md)
- [timestamp](../com.apple.storekit/StoreKit/SKPaymentDiscount/timestamp.md)

---


### timestamp

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@NSCopying var timestamp: NSNumber { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/timestamp](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/timestamp) keeps the payment discount active for 24 hours.

## See Also

- [nonce](../com.apple.storekit/StoreKit/SKPaymentDiscount/nonce.md)
- [signature](../com.apple.storekit/StoreKit/SKPaymentDiscount/signature.md)

---


## SKPaymentQueue


### add(_:)-4vct1

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func add(_ payment: SKPayment)
```

## Parameters

- **payment**: A payment request.

## 

An application should always have at least one observer of the payment queue before adding payment requests.

The payment request must have a product identifier registered with the Apple App Store and a quantity greater than `0`. If either property is invalid, [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-4vct1](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-4vct1) throws an exception.

When a payment request is added to the queue, the payment queue processes that request with the Apple App Store and arranges for payment from the user. When that transaction is complete or if a failure occurs, the payment queue sends the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction) object that encapsulates the request to all transaction observers.

## See Also

- [delegate](../com.apple.storekit/StoreKit/SKPaymentQueue/delegate.md)
- [transactions](../com.apple.storekit/StoreKit/SKPaymentQueue/transactions.md)
- [finishTransaction(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/finishTransaction(_:).md)

---


### add(_:)-5ciz2

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func add(_ observer: any SKPaymentTransactionObserver)
```

## Parameters

- **observer**: The observer to add to the queue.

## 

Your application should add an observer to the payment queue during application initialization. If there are no observers attached to the queue, the payment queue does not synchronize its list of pending transactions with the Apple App Store, because there is no observer to respond to updated transactions.

If an application quits when transactions are still being processed, those transactions are not lost. The next time the application launches, the payment queue resumes processing the transactions. Your application should always expect to be notified of completed transactions.

If more than one transaction observer is attached to the payment queue, no guarantees are made as to the order which they will be called. It is safe for multiple observers to call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)), but not recommended. It is recommended that you use a single observer to process and finish the transaction.

## See Also

- [transactions](../com.apple.storekit/StoreKit/SKPaymentQueue/transactions.md)
- [transactionObservers](../com.apple.storekit/StoreKit/SKPaymentQueue/transactionObservers.md)
- [remove(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/remove(_:).md)

---


### canMakePayments()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class func canMakePayments() -> Bool
```

## 

The Boolean value that this method returns is identical to the value of the type property [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) in the [doc://com.apple.storekit/documentation/StoreKit/AppStore](doc://com.apple.storekit/documentation/StoreKit/AppStore) object. For more information about using and interpreting this value, see the type property page [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments).

---


### cancel(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func cancel(_ downloads: [SKDownload])
```

## Parameters

- **downloads**: An array of [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects to cancel.

## See Also

- [start(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/start(_:).md)
- [pause(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/pause(_:).md)
- [resume(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/resume(_:).md)

---


### finishTransaction(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func finishTransaction(_ transaction: SKPaymentTransaction)
```

## Parameters

- **transaction**: The transaction to finish.

## 

Transactions on the payment queue are persistent until they are completed. StoreKit calls your observer’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) method every time your app launches or resumes from background to tell you about transactions in the queue. After you’ve finished processing a transaction in your app, always call the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) method to finish the transaction and remove it from the queue.

Call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) only after the app has finished all work it performs to complete the transaction. The transaction’s state determines which steps you might take:

- For a failed transaction ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed)), update your user interface, track information in analytics, and perform other similar tasks.
- For a successful transaction ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored)), perform all necessary actions to unlock the functionality the user has purchased before finishing the transaction. For example, if you are downloading content, finish the transaction only after the downloads are complete.

If you validate receipts, validate them before completing the transaction, and take one of the paths described above.

In rare circumstances, this call might fail, and you’ll receive updates for that transaction again. For this reason, you should record information in your app about the transactions it has processed and which steps the app has already completed. That way, you don’t repeat steps that shouldn’t be performed multiple times. For example, if you are processing a consumable transaction, you only want to add the consumable benefit once.

If you call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) on a transaction that is in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing) state, StoreKit raises an exception.

## See Also

- [paymentQueue(_:updatedTransactions:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:).md)
- [delegate](../com.apple.storekit/StoreKit/SKPaymentQueue/delegate.md)
- [transactions](../com.apple.storekit/StoreKit/SKPaymentQueue/transactions.md)
- [add(_:)-4vct1](../com.apple.storekit/StoreKit/SKPaymentQueue/add(_:)-4vct1.md)

---


### pause(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func pause(_ downloads: [SKDownload])
```

## Parameters

- **downloads**: An array of [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects to pause.

## See Also

- [start(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/start(_:).md)
- [cancel(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/cancel(_:).md)
- [resume(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/resume(_:).md)

---


### presentCodeRedemptionSheet()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func presentCodeRedemptionSheet()
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()) function displays a system sheet where customers can enter and redeem offer codes. If you generate offer codes in App Store Connect, call this function to enable customers to redeem the offer. For information on implementing offer codes, see [doc://com.apple.storekit/documentation/StoreKit/implementing-offer-codes-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-offer-codes-in-your-app).

> **NOTE:** For apps with more than one scene, and on iOS 16 or later and iPadOS 16 or later, use [doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)](doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)) or [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)) instead.

When your app calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()), the system determines where to display the screen. Use [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()) to support devices running iOS 14 through iOS 15, and iPadOS 14 through iPadOS 15.

> **IMPORTANT:** Set up offer codes in App Store Connect before calling this API. Customers can only redeem these offers in your app through the redemption sheet; don’t use a custom UI.

For information on configuring and generating offer codes, see [https://help.apple.com/app-store-connect/#/dev6a098e4b1](https://help.apple.com/app-store-connect/#/dev6a098e4b1).

This method applies to offer codes only; it doesn’t apply to promo codes for apps or in-app purchases. For more information on promo codes, see [https://help.apple.com/app-store-connect/#/dev50869de4a](https://help.apple.com/app-store-connect/#/dev50869de4a).

This function doesn’t affect Mac apps built with Mac Catalyst.

---


### remove(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func remove(_ observer: any SKPaymentTransactionObserver)
```

## Parameters

- **observer**: The observer to remove.

## 

If there are no observers attached to the queue, the payment queue does not synchronize its list of pending transactions with the Apple App Store, because there is no observer to respond to updated transactions.

## See Also

- [transactions](../com.apple.storekit/StoreKit/SKPaymentQueue/transactions.md)
- [add(_:)-5ciz2](../com.apple.storekit/StoreKit/SKPaymentQueue/add(_:)-5ciz2.md)
- [transactionObservers](../com.apple.storekit/StoreKit/SKPaymentQueue/transactionObservers.md)

---


### restoreCompletedTransactions()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func restoreCompletedTransactions()
```

## 

Use this method to restore finished transactions—that is, transactions for which you have already called [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)). You call this method in one of the following situations:

- To install purchases on additional devices
- To restore purchases for an application that the user deleted and reinstalled

When you create a new product to be sold in your store, you choose whether that product can be restored or not. See the [https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267](https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267) for more information.

The payment queue delivers a new transaction for each previously completed transaction that can be restored. Each transaction includes a copy of the original transaction.

After the transactions are delivered, the payment queue calls the observer’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:)) method. If an error occurred while restoring transactions, the observer will be notified through its [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:restoreCompletedTransactionsFailedWithError:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:restoreCompletedTransactionsFailedWithError:)) method.

This method has no effect in the following situations:

- All transactions are unfinished.
- The user did not purchase anything that is restorable.
- You tried to restore items that are not restorable, such as a non-renewing subscription or a consumable product.
- Your app’s build version does not meet the guidelines for the `CFBundleVersion` key.

> **IMPORTANT:** If you are using the [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) API and managing transactions using the [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) API, use [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) to determine which in-app purchases the customer is currently entitled to. The [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) function doesn’t affect transactions in the [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) API. In rare cases when a user suspects the app isn’t showing all the transactions, call [doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()](doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()) in response to an explicit user action, like tapping a button.

## See Also

- [restoreCompletedTransactions(withApplicationUsername:)](../com.apple.storekit/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:).md)

---


### restoreCompletedTransactions(withApplicationUsername:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func restoreCompletedTransactions(withApplicationUsername username: String?)
```

## Parameters

- **username**: An opaque identifier for the user’s account on your system.

## See Also

- [applicationUsername](../com.apple.storekit/StoreKit/SKPayment/applicationUsername.md)
- [restoreCompletedTransactions()](../com.apple.storekit/StoreKit/SKPaymentQueue/restoreCompletedTransactions().md)

---


### resume(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func resume(_ downloads: [SKDownload])
```

## Parameters

- **downloads**: An array of [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects to resume.

## See Also

- [start(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/start(_:).md)
- [cancel(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/cancel(_:).md)
- [pause(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/pause(_:).md)

---


### showPriceConsentIfNeeded()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func showPriceConsentIfNeeded()
```

## 

Call this method if the system called your delegate’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:)) method, and you chose to delay showing the price consent sheet.

This function displays the price consent sheet if both of the following are true:

- You’ve increased the price of the subscription in App Store Connect.
- The subscriber hasn’t yet responded to a price consent query.

Otherwise, this function has no effect.

> **NOTE:** When you increase the price of a subscription, Apple informs affected subscribers through an email, push notification, and in-app price consent sheet and asks them to agree to the new price. If they don’t agree or take no action, their subscription expires at the end of their current billing cycle. For more information, see [https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers](https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers) and [https://help.apple.com/app-store-connect/#/devc9870599e](https://help.apple.com/app-store-connect/#/devc9870599e).

In Mac apps built with Mac Catalyst, this function has no effect.

## See Also

- [paymentQueueShouldShowPriceConsent(_:)](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:).md)

---


### start(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
func start(_ downloads: [SKDownload])
```

## Parameters

- **downloads**: An array of [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects to begin downloading.

## 

In order for a download object to be queued, it must be associated with a transaction that has been successfully purchased, but not yet finished.

## See Also

- [cancel(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/cancel(_:).md)
- [pause(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/pause(_:).md)
- [resume(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/resume(_:).md)

---


### transactionObservers

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var transactionObservers: [any SKPaymentTransactionObserver] { get }
```

## See Also

- [add(_:)-5ciz2](../com.apple.storekit/StoreKit/SKPaymentQueue/add(_:)-5ciz2.md)
- [remove(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/remove(_:).md)

---


## SKPaymentQueueDelegate


### paymentQueue(_:shouldContinue:in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func paymentQueue(_ paymentQueue: SKPaymentQueue, shouldContinue transaction: SKPaymentTransaction, in newStorefront: SKStorefront) -> Bool
```

## 

StoreKit calls this delegate method if the storefront changes while processing a transaction.

- Return `true` if you wish to continue the transaction within the updated storefront.
- Return `false` to stop the transaction. The transaction will fail with the error [doc://com.apple.storekit/documentation/StoreKit/SKError/Code/storeProductNotAvailable](doc://com.apple.storekit/documentation/StoreKit/SKError/Code/storeProductNotAvailable). In this case, consider displaying a message to the user indicating that the product isn’t available in the current storefront.

If the delegate isn’t implemented, [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueue(_:shouldContinue:in:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueue(_:shouldContinue:in:)) defaults to `true`.

This call times out after approximately one second, defaulting to `false` and causing the transaction to fail. The delegate should return as quickly as possible. Don’t perform any networking calls in this method. Your app should cache product availability information locally before starting a transaction.

See [doc://com.apple.storekit/documentation/StoreKit/SKStorefront](doc://com.apple.storekit/documentation/StoreKit/SKStorefront) for more information.

---


### paymentQueueShouldShowPriceConsent(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
optional func paymentQueueShouldShowPriceConsent(_ paymentQueue: SKPaymentQueue) -> Bool
```

## 

This method applies only to auto-renewable subscription price increases that require customer consent.

The default return value for this optional method is `true`. By default, the system displays the price consent sheet when you increase the subscription price in App Store Connect and the subscriber hasn’t yet taken action.

The system calls your delegate’s method, if appropriate, when you add the first observer to [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue), and any time the app comes to foreground.

If you return `false`, the system won’t show the price consent sheet. You can choose to display it later by calling [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/showPriceConsentIfNeeded()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/showPriceConsentIfNeeded()). You may want to delay showing the sheet if it would interrupt your user’s interaction in your app.

> **NOTE:** When you increase the price of an auto-renewable subscription and it requires customer consent, Apple informs affected subscribers through an email, push notification, and an in-app price consent sheet and asks them to agree to the new price. If they don’t agree or take no action, their subscription expires at the end of their current billing cycle. For more information, see [https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers](https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers) and [https://help.apple.com/app-store-connect/#/devc9870599e](https://help.apple.com/app-store-connect/#/devc9870599e).

In Mac apps built with Mac Catalyst, the system doesn’t show the price consent sheet regardless of the return value.

## See Also

- [showPriceConsentIfNeeded()](../com.apple.storekit/StoreKit/SKPaymentQueue/showPriceConsentIfNeeded().md)

---


## SKPaymentTransactionObserver


### paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func paymentQueue(_ queue: SKPaymentQueue, didRevokeEntitlementsForProductIdentifiers productIdentifiers: [String])
```

## Parameters

- **queue**: The payment queue that calls the delegate method.
- **productIdentifiers**: The list of product identifiers with revoked entitlements.

## 

The system calls this delegate method whenever App Store revokes in-app purchases for a family member based on changes in Family Sharing, or when the purchaser gets a refund for an in-app purchase. Implement this method in your payment queue observer to reestablish a user’s access to products. Revoked transactions have the `cancellation_date` populated in the receipt.

For products with Family Sharing enabled, the following conditions may trigger this method in the family member’s app:

- The purchaser receives a refund for a non-consumable or an auto-renewable subscription they shared.
- The purchaser leaves the family group in which they were sharing subscriptions or non-consumables.
- The purchaser disables Family Sharing for a non-consumable or stops sharing a subscription.
- The purchaser hides an app, which makes their non-consumable purchase unavailable for sharing.
- The family member leaves the group and no longer gets access to shared purchases.
- The family organizer stops sharing payment in iCloud family settings. This change affects non-consumables.

By leaving a family group, or disabling sharing in any of the ways listed above, family members are no longer entitled to family-shared purchases. The `productIdentifiers` parameter contains the revoked product IDs. Your app needs to check the receipt on the device, which the system automatically updates prior to calling this method, and provide the correct level of access for the in-app purchases.

If you receive [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications), your server receives a [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) `REVOKE` for the family member when the conditions listed above occur.

> **IMPORTANT:** Always check the receipt to determine the users’s correct level of access for the product. A user may lose access through Family Sharing, but may have purchased the product directly.

StoreKit also calls this method in the purchaser’s app when the purchaser receives a refund for a non-consumable or an auto-renewable subscription, regardless if the product is shared with the family. If you receive [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications), your server receives a [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) `REFUND` for the purchaser.

If you use server-side receipt validation with the App Store, call your server to reprocess the receipt and update your purchase records.

## See Also

- [supporting-family-sharing-in-your-app](../com.apple.storekit/StoreKit/supporting-family-sharing-in-your-app.md)
- [isFamilyShareable](../com.apple.storekit/StoreKit/SKProduct/isFamilyShareable.md)

---


### paymentQueue(_:removedTransactions:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func paymentQueue(_ queue: SKPaymentQueue, removedTransactions transactions: [SKPaymentTransaction])
```

## Parameters

- **queue**: The payment queue that updated the transactions.
- **transactions**: An array of the transactions that were removed.

## 

Your application does not typically need to implement this method but might implement it to update its own user interface to reflect that a transaction has been completed.

## See Also

- [paymentQueue(_:updatedTransactions:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:).md)

---


### paymentQueue(_:restoreCompletedTransactionsFailedWithError:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func paymentQueue(_ queue: SKPaymentQueue, restoreCompletedTransactionsFailedWithError error: any Error)
```

## Parameters

- **queue**: The payment queue that was restoring transactions.
- **error**: The error that occurred.

## See Also

- [paymentQueueRestoreCompletedTransactionsFinished(_:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:).md)

---


### paymentQueue(_:shouldAddStorePayment:for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
optional func paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment, for product: SKProduct) -> Bool
```

## Parameters

- **queue**: The payment queue the app uses to make the payment request.
- **payment**: The payment request.
- **product**: The in-app purchase product.

## 

Return `true` to continue the transaction in your app.

## 

Return `false` to defer or cancel the transaction.

If you return `false`, you can continue the transaction later by manually adding the [doc://com.apple.storekit/documentation/StoreKit/SKPayment](doc://com.apple.storekit/documentation/StoreKit/SKPayment) `payment` to the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue) `queue`.

## 

The system calls this delegate method when the user starts an in-app purchase in the App Store, and the transaction continues in your app. Specifically, if your app is already installed, StoreKit calls this method automatically.

If your app isn’t installed when the user starts the in-app purchase in the App Store, the user receives a notification when the app installation is complete. StoreKit calls this method when the user taps the notification. Otherwise, if the user opens the app manually, StoreKit calls this method only if they open the app soon after they initiate the purchase.

> **IMPORTANT:** To enable promoted in-app purchases, your app needs to use either [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) (starting in iOS 16.4) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)) (starting in iOS 11). Don’t use both at the same time. If necessary, use conditional compilation to identify the OS version the app is running in. For more information, see [doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version](doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version).

For more information, see [doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases).

## See Also

- [promoting-in-app-purchases](../com.apple.storekit/StoreKit/promoting-in-app-purchases.md)

---


### paymentQueue(_:updatedDownloads:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
optional func paymentQueue(_ queue: SKPaymentQueue, updatedDownloads downloads: [SKDownload])
```

## Parameters

- **queue**: The payment queue that updated the downloads.
- **downloads**: The download objects that were updated.

## 

When a download object is updated, its [doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState) property describes how it changed.

---


### paymentQueue(_:updatedTransactions:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func paymentQueue(_ queue: SKPaymentQueue, updatedTransactions transactions: [SKPaymentTransaction])
```

## Parameters

- **queue**: The payment queue that updated the transactions.
- **transactions**: An array of the transactions that were updated.

## 

The application should process each transaction by examining the transaction’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) property. If [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased), payment was successfully received for the desired functionality. The application should make the functionality available to the user. If [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed), the application can read the transaction’s error property to return a meaningful error to the user.

Once a transaction is processed, it should be removed from the payment queue by calling the payment queue’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) method, passing the transaction as a parameter.

> **IMPORTANT:** Once the transaction is finished, StoreKit can’t tell you that this item is already purchased. It is important that applications process the transaction completely before calling [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)
- [paymentQueue(_:removedTransactions:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:removedTransactions:).md)

---


### paymentQueueDidChangeStorefront(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func paymentQueueDidChangeStorefront(_ queue: SKPaymentQueue)
```

## 

See [doc://com.apple.storekit/documentation/StoreKit/SKStorefront](doc://com.apple.storekit/documentation/StoreKit/SKStorefront) for more information.

---


### paymentQueueRestoreCompletedTransactionsFinished(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func paymentQueueRestoreCompletedTransactionsFinished(_ queue: SKPaymentQueue)
```

## Parameters

- **queue**: The payment queue that restored the transactions.

## 

This method is called after all restorable transactions have been processed by the payment queue. Your application is not required to do anything in this method.

## See Also

- [paymentQueue(_:restoreCompletedTransactionsFailedWithError:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:restoreCompletedTransactionsFailedWithError:).md)

---


## SKProductDiscount


### PaymentMode-swift.enum


#### freeTrial

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case freeTrial
```

## 

With a free trial payment mode, the price is 0, so users pay nothing during the discount period.



## See Also

- [payAsYouGo](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo.md)
- [payUpFront](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront.md)

---


#### init(rawValue:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
init?(rawValue: UInt)
```

---


#### payAsYouGo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case payAsYouGo
```

## 

With a pay as you go payment mode, users pay the discounted price at each billing period during the discount period.



## See Also

- [payUpFront](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront.md)
- [freeTrial](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial.md)

---


#### payUpFront

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case payUpFront
```

## 

With a pay up front payment mode, users pay the discounted price one time, and receive the product for duration of the discount period.



## See Also

- [payAsYouGo](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo.md)
- [freeTrial](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial.md)

---


### Type-swift.enum


#### introductory

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case introductory
```

## 

For more information, see [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app).

## See Also

- [subscription](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum/subscription.md)

---


### PaymentMode-swift.enum

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum PaymentMode
```

## 

The payment mode indicates if the discount price is charged one time, multiple times, or if the discount is a free trial.

The payment mode may determine the wording you choose to phrase the offer in your app’s UI.

## Topics

### Discount Price Payment Modes

- [payAsYouGo](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo.md)
- [payUpFront](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront.md)
- [freeTrial](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum/init(rawValue:).md)

## See Also

- [price](../com.apple.storekit/StoreKit/SKProductDiscount/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProductDiscount/priceLocale.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/paymentMode-swift.property.md)

---


### Type-swift.enum

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum `Type`
```

## Topics

### Types of Offers

- [introductory](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum/introductory.md)
- [subscription](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum/subscription.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum/init(rawValue:).md)

## See Also

- [identifier](../com.apple.storekit/StoreKit/SKProductDiscount/identifier.md)
- [type-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/type-swift.property.md)

---


### identifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var identifier: String? { get }
```

## 

You set up offers and their identifiers in App Store Connect.

## See Also

- [type-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/type-swift.property.md)
- [Type-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum.md)

---


### numberOfPeriods

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var numberOfPeriods: Int { get }
```

## 

A product discount may be available for one or more periods. The period, defined in [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/subscriptionPeriod](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/subscriptionPeriod), is a set number of days, weeks, months, or years.

The total length of time that a product discount is available is calculated by multiplying the [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/numberOfPeriods](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/numberOfPeriods) by the period.

Note that the discount period is independent of the product subscription period.

## See Also

- [subscriptionPeriod](../com.apple.storekit/StoreKit/SKProductDiscount/subscriptionPeriod.md)

---


### paymentMode-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var paymentMode: SKProductDiscount.PaymentMode { get }
```

## 

The payment mode indicates how the product discount [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/price](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/price) is charged:

- One or more times, for [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo) mode
- Once in advance, for [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront) mode
- No initial charge, for [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial) mode.

Use the payment mode to display an accurate description of the product discount in your UI. For design guidance, see [https://developer.apple.com/ios/human-interface-guidelines/technologies/in-app-purchase/](https://developer.apple.com/ios/human-interface-guidelines/technologies/in-app-purchase/).

## See Also

- [price](../com.apple.storekit/StoreKit/SKProductDiscount/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProductDiscount/priceLocale.md)
- [PaymentMode-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum.md)

---


### price

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var price: NSDecimalNumber { get }
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/priceLocale](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/priceLocale) to format the price.

## See Also

- [priceLocale](../com.apple.storekit/StoreKit/SKProductDiscount/priceLocale.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/paymentMode-swift.property.md)
- [PaymentMode-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum.md)

---


### priceLocale

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var priceLocale: Locale { get }
```

## 

Use the locale to format the [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/price](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/price).

## See Also

- [price](../com.apple.storekit/StoreKit/SKProductDiscount/price.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/paymentMode-swift.property.md)
- [PaymentMode-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum.md)

---


### type-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var type: SKProductDiscount.Type { get }
```

## See Also

- [identifier](../com.apple.storekit/StoreKit/SKProductDiscount/identifier.md)
- [Type-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum.md)

---


## SKProductStorePromotionController


### default()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
class func `default`() -> Self
```

---


### fetchStorePromotionOrder(completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func fetchStorePromotionOrder(completionHandler: (([SKProduct], (any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func promotionOrder() async throws -> [SKProduct]
```

## 

This function returns an array of promoted products whose order is overridden on the given device.

If all the products appear in the default order, this method returns an empty array.

## See Also

- [update(storePromotionOrder:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:).md)

---


### fetchStorePromotionVisibility(for:completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func fetchStorePromotionVisibility(for product: SKProduct, completionHandler: ((SKProductStorePromotionVisibility, (any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func promotionVisibility(for product: SKProduct) async throws -> SKProductStorePromotionVisibility
```

## 

The default visibility for a promoted product is set in App Store Connect. Call [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:)) to determine if a product’s visibility is set to the default value or if it has been overridden to be hidden or shown.

## See Also

- [update(storePromotionVisibility:for:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/update(storePromotionVisibility:for:completionHandler:).md)
- [SKProductStorePromotionVisibility](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility.md)

---


### update(storePromotionOrder:completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func update(storePromotionOrder promotionOrder: [SKProduct], completionHandler: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func update(promotionOrder: [SKProduct]) async throws
```

## 

The default order of promoted in-app purchase products is set in App Store Connect. You can override this order per device. For example, you can promote an in-app purchase product that unlocks a specific level in your game when a user reaches the level immediately before the specified level.

To override the default product order, put the product information for the subset of products you want to reorder into an array, in the order you want them to appear in. Pass the array to the [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)) method. The products in the array are shown at the beginning of the list, followed by the remaining in-app purchase products, which are listed in the same relative order that you set in App Store Connect.

To cancel order overrides, send an empty product array to the [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)) method.  The in-app purchase products will be displayed in the default order.

## See Also

- [fetchStorePromotionOrder(completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/fetchStorePromotionOrder(completionHandler:).md)

---


### update(storePromotionVisibility:for:completionHandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func update(storePromotionVisibility promotionVisibility: SKProductStorePromotionVisibility, for product: SKProduct, completionHandler: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
func update(promotionVisibility: SKProductStorePromotionVisibility, for product: SKProduct) async throws
```

## 

An in-app purchase product’s default visibility setting is set up in App Store Connect.  You can override the default setting, or return it to the default set in App Store Connect using the values in [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionVisibility](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionVisibility).

Visibility settings apply per device.

## See Also

- [fetchStorePromotionVisibility(for:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:).md)
- [SKProductStorePromotionVisibility](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility.md)

---


## SKProductSubscriptionPeriod


### numberOfUnits

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var numberOfUnits: Int { get }
```

## 

A subscription period duration is calculated by multiplying the number of units by the [doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/unit](doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/unit).

For example, if the number of units is `3`, and the unit is [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/month](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/month), the subscription period is 3 months.

## See Also

- [unit](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod/unit.md)
- [PeriodUnit](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit.md)

---


### unit

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var unit: SKProduct.PeriodUnit { get }
```

## 

The units used to specify a subscription period include day, week, month, and year, as defined in [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit).

To calculate the duration of one subscription period, multiply the [doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/unit](doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/unit) by the number of units ([doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/numberOfUnits](doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/numberOfUnits)).

## See Also

- [numberOfUnits](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod/numberOfUnits.md)
- [PeriodUnit](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit.md)

---


## SKProductsRequest


### init(productIdentifiers:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
init(productIdentifiers: Set<String>)
```

## Parameters

- **productIdentifiers**: The list of product identifiers for the products you wish to retrieve descriptions of.

## 

The initialized request object.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)

---


## SKProductsRequestDelegate


### productsRequest(_:didReceive:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func productsRequest(_ request: SKProductsRequest, didReceive response: SKProductsResponse)
```

## Parameters

- **request**: The product request sent to the Apple App Store.
- **response**: Detailed information about the list of products.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)

---


## SKProductsResponse


### invalidProductIdentifiers

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var invalidProductIdentifiers: [String] { get }
```

## 

The App Store may not recognize your product identifiers unless you meet following criteria, as applicable:

- Agree to the latest Apple Developer Program License Agreement.
- Complete all the financial agreements as described in the [https://help.apple.com/itunes-connect/developer/#/devb6df5ee51](https://help.apple.com/itunes-connect/developer/#/devb6df5ee51). When you renew your developer membership, see if you need to make updates to your agreements. When your developer membership expires, your financial agreements expire as well.
- Your app uses an explicit App ID.
- Clear the in-app purchases for sale in App Store Connect. See [https://help.apple.com/app-store-connect/#/dev360aba524](https://help.apple.com/app-store-connect/#/dev360aba524).
- Modified in-app purchases are available to the App Store servers.
- The product identifier specified in App Store Connect matches the identifier used by the [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) object in your app.
- Upload the content of your product to App Store Connect.  See [https://help.apple.com/xcode/mac/current/#/dev285fb60ce](https://help.apple.com/xcode/mac/current/#/dev285fb60ce).

For more troubleshooting information, see [doc://com.apple.storekit/documentation/StoreKit/fetching-product-information-from-the-app-store](doc://com.apple.storekit/documentation/StoreKit/fetching-product-information-from-the-app-store).

## See Also

- [products](../com.apple.storekit/StoreKit/SKProductsResponse/products.md)

---


### products

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var products: [SKProduct] { get }
```

## 

The array consists of a list of [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) objects.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)
- [invalidProductIdentifiers](../com.apple.storekit/StoreKit/SKProductsResponse/invalidProductIdentifiers.md)

---


## SKRequest


### cancel()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func cancel()
```

## 

When you cancel a request, the delegate is not called with an error.

## See Also

- [start()](../com.apple.storekit/StoreKit/SKRequest/start().md)

---


### delegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
weak var delegate: (any SKRequestDelegate)? { get set }
```

## 

The delegate must adopt the [doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate](doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate) protocol, although most subclasses of [doc://com.apple.storekit/documentation/StoreKit/SKRequest](doc://com.apple.storekit/documentation/StoreKit/SKRequest) provide a more specific protocol to implement.

## See Also

- [SKRequestDelegate](../com.apple.storekit/StoreKit/SKRequestDelegate.md)

---


### start()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func start()
```

## 

The results for a request are sent to the request’s delegate.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)
- [cancel()](../com.apple.storekit/StoreKit/SKRequest/cancel().md)

---


## SKRequestDelegate


### request(_:didFailWithError:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func request(_ request: SKRequest, didFailWithError error: any Error)
```

## Parameters

- **request**: The request that failed.
- **error**: The error that caused the request to fail.

## 

When the request fails, your application should release the request. The [doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/requestDidFinish(_:)](doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/requestDidFinish(_:)) method is not called after this method is called.

---


### requestDidFinish(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
optional func requestDidFinish(_ request: SKRequest)
```

## Parameters

- **request**: The request that completed.

## 

This method is called after all processing of the request has been completed. Typically, subclasses of [doc://com.apple.storekit/documentation/StoreKit/SKRequest](doc://com.apple.storekit/documentation/StoreKit/SKRequest) require the delegate to implement additional methods to receive the response. When this method is called, your delegate receives no further communication from the request and can release it.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)

---


## StoreKitError


### networkError(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case networkError(URLError)
```

## See Also

- [systemError(_:)](../com.apple.storekit/StoreKit/StoreKitError/systemError(_:).md)
- [userCancelled](../com.apple.storekit/StoreKit/StoreKitError/userCancelled.md)
- [notAvailableInStorefront](../com.apple.storekit/StoreKit/StoreKitError/notAvailableInStorefront.md)
- [notEntitled](../com.apple.storekit/StoreKit/StoreKitError/notEntitled.md)
- [unknown](../com.apple.storekit/StoreKit/StoreKitError/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/StoreKitError/unsupported.md)

---


### notAvailableInStorefront

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case notAvailableInStorefront
```

## See Also

- [networkError(_:)](../com.apple.storekit/StoreKit/StoreKitError/networkError(_:).md)
- [systemError(_:)](../com.apple.storekit/StoreKit/StoreKitError/systemError(_:).md)
- [userCancelled](../com.apple.storekit/StoreKit/StoreKitError/userCancelled.md)
- [notEntitled](../com.apple.storekit/StoreKit/StoreKitError/notEntitled.md)
- [unknown](../com.apple.storekit/StoreKit/StoreKitError/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/StoreKitError/unsupported.md)

---


### notEntitled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case notEntitled
```

## See Also

- [networkError(_:)](../com.apple.storekit/StoreKit/StoreKitError/networkError(_:).md)
- [systemError(_:)](../com.apple.storekit/StoreKit/StoreKitError/systemError(_:).md)
- [userCancelled](../com.apple.storekit/StoreKit/StoreKitError/userCancelled.md)
- [notAvailableInStorefront](../com.apple.storekit/StoreKit/StoreKitError/notAvailableInStorefront.md)
- [unknown](../com.apple.storekit/StoreKit/StoreKitError/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/StoreKitError/unsupported.md)

---


### systemError(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case systemError(any Error)
```

## See Also

- [networkError(_:)](../com.apple.storekit/StoreKit/StoreKitError/networkError(_:).md)
- [userCancelled](../com.apple.storekit/StoreKit/StoreKitError/userCancelled.md)
- [notAvailableInStorefront](../com.apple.storekit/StoreKit/StoreKitError/notAvailableInStorefront.md)
- [notEntitled](../com.apple.storekit/StoreKit/StoreKitError/notEntitled.md)
- [unknown](../com.apple.storekit/StoreKit/StoreKitError/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/StoreKitError/unsupported.md)

---


### userCancelled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case userCancelled
```

## See Also

- [networkError(_:)](../com.apple.storekit/StoreKit/StoreKitError/networkError(_:).md)
- [systemError(_:)](../com.apple.storekit/StoreKit/StoreKitError/systemError(_:).md)
- [notAvailableInStorefront](../com.apple.storekit/StoreKit/StoreKitError/notAvailableInStorefront.md)
- [notEntitled](../com.apple.storekit/StoreKit/StoreKitError/notEntitled.md)
- [unknown](../com.apple.storekit/StoreKit/StoreKitError/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/StoreKitError/unsupported.md)

---


## StoreView


### init(ids:icon:placeholderIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(ids productIDs: some Collection<String>, @ViewBuilder icon: @escaping (Product, ProductIconPhase) -> Icon, @ViewBuilder placeholderIcon: () -> PlaceholderIcon)
```

## Parameters

- **productIDs**: The product identifiers to load from the App Store.
- **icon**: A closure that receives a [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) and a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) as input. The [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) indicates the state of the loading operation of the product’s promotional image. The closure returns the view to display for the given product and phase value.
- **placeholderIcon**: A closure that returns the view that the store view uses while the products are loading. The store view uses the same placeholder image for all the products.

## 

The store view shows the custom `placeholderIcon` until all products finish loading. After the products finish loading, the view asynchronously loads and displays each product’s promotional image.

Use the [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) to monitor the current loading state of a product’s promotional image, and provide a view for each phase. Consider returning the view provided in the `placeholderIcon` closure for during the [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase/loading](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase/loading) phase. For more information, see [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase).

If a product is unavailable, the store view uses the view that the `placeholderIcon` closure provides as a fallback.

## See Also

- [init(ids:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:).md)
- [init(ids:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:).md)
- [init(ids:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:placeholderIcon:).md)

---


### init(ids:prefersPromotionalIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(ids productIDs: some Collection<String>, prefersPromotionalIcon: Bool = false) where Icon == EmptyView, PlaceholderIcon == EmptyView
```

## Parameters

- **productIDs**: The product identifiers to load from the App Store.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use promotional images from the App Store, if they’re available. If this parameter is `false`, the system ignores promotional images.

## See Also

- [init(ids:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:).md)
- [init(ids:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(ids:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:icon:placeholderIcon:).md)

---


### init(ids:prefersPromotionalIcon:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(ids productIDs: some Collection<String>, prefersPromotionalIcon: Bool = false, @ViewBuilder icon: @escaping (Product) -> Icon) where PlaceholderIcon == AutomaticProductPlaceholderIcon
```

## Parameters

- **productIDs**: The product identifiers to load from the App Store.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use promotional images from the App Store, if they’re available. If this parameter is `false`, the system ignores promotional images.
- **icon**: A closure that returns the image the view displays when the products finish loading from the App Store.

## 

The store view shows a placeholder icon until all products finish loading. Then, the view uses the image that you provide in `icon`, by default. If you set `prefersPromotionalIcon` to `true`, the view uses the promotional image instead of the `icon` for any products that have promotional images available.

## See Also

- [init(ids:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:).md)
- [init(ids:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(ids:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:icon:placeholderIcon:).md)

---


### init(ids:prefersPromotionalIcon:icon:placeholderIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(ids productIDs: some Collection<String>, prefersPromotionalIcon: Bool = false, @ViewBuilder icon: @escaping (Product) -> Icon, @ViewBuilder placeholderIcon: () -> PlaceholderIcon)
```

## Parameters

- **productIDs**: The product identifiers to load from the App Store.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use a promotional image from the App Store, if it’s available. If this parameter is `false`, the system ignores promotional images.
- **icon**: A closure that returns the image the view displays when the products finish loading from the App Store.
- **placeholderIcon**: A closure that returns the image that the view uses while the products are loading. The view uses the same placeholder image for all the products.

## 

The store view shows the custom placeholder icon until all products finish loading. After the view finishes loading the products, it uses the image you provide, by default. If you set `prefersPromotionalIcon` to `true`, any products that have an available promotional image use the promotional image instead.

The following example shows how to create a store view using an icon and a custom placeholder icon:

```swift
StoreView(ids: [
    "com.example.product1",
    "com.example.product2"
]) { product in
     Image(systemName: "star.fill")
         .foregroundStyle(.yellow)
 } placeholderIcon: {
      Image(systemName: "star.fill")
         .foregroundStyle(.gray)
 }
```

## See Also

- [init(ids:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:).md)
- [init(ids:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:).md)
- [init(ids:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:icon:placeholderIcon:).md)

---


### init(products:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(products: some Collection<Product>, @ViewBuilder icon: @escaping (Product, ProductIconPhase) -> Icon) where PlaceholderIcon == EmptyView
```

## Parameters

- **products**: The products to merchandise.
- **icon**: A closure that receives a [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) and a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) as input. The [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) indicates the state of the loading operation of the product’s promotional image. The closure returns the view to display for the given product and phase value.

## 

The store view asynchronously loads and displays each product’s promotional image. Use the [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) to monitor the current loading phase of the product’s promotional image, and provide an image for each phase. For more information about the loading phases, see [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase).

## See Also

- [init(products:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(products:prefersPromotionalIcon:).md)
- [init(products:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(products:prefersPromotionalIcon:icon:).md)

---


### init(products:prefersPromotionalIcon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(products: some Collection<Product>, prefersPromotionalIcon: Bool = false) where Icon == EmptyView, PlaceholderIcon == EmptyView
```

## Parameters

- **products**: The products to merchandise.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use promotional images from the App Store, if they’re available. If this parameter is `false`, the system ignores promotional images.

## 

By default, the store view doesn’t show promotional images. If you set `prefersPromotionalIcon` to `true`, the store view uses each product’s promotional image as its icon.

## See Also

- [init(products:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(products:prefersPromotionalIcon:icon:).md)
- [init(products:icon:)](../com.apple.storekit/StoreKit/StoreView/init(products:icon:).md)

---


### init(products:prefersPromotionalIcon:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(products: some Collection<Product>, prefersPromotionalIcon: Bool = false, @ViewBuilder icon: @escaping (Product) -> Icon) where PlaceholderIcon == EmptyView
```

## Parameters

- **products**: The products to merchandise.
- **prefersPromotionalIcon**: A Boolean value that indicates whether to use promotional images from the App Store, if they’re available. If this parameter is `false`, the system ignores promotional images.
- **icon**: A closure that returns the image the view displays when the products finish loading from the App Store.

## 

If you set `prefersPromotionalIcon` to `true`, the view uses promotional images for products that have a promotional image available.

The following code example shows how to create a store view using a custom icon:

```swift
StoreView(products: [
          product1,
          product2,
          // Add products as needed.
 ]) { product in
    Image(systemName: "star.fill")
        .foregroundStyle(.yellow)
    }  
```

## See Also

- [init(products:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(products:prefersPromotionalIcon:).md)
- [init(products:icon:)](../com.apple.storekit/StoreKit/StoreView/init(products:icon:).md)

---


## Storefront


### Storefronts

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Storefronts
```

## See Also

- [updates](../com.apple.storekit/StoreKit/Storefront/updates.md)

---


### countryCode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let countryCode: String
```

## 

This property uses the ISO 3166-1 Alpha-3 country code representation.

## See Also

- [current](../com.apple.storekit/StoreKit/Storefront/current.md)
- [id](../com.apple.storekit/StoreKit/Storefront/id.md)

---


### current

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var current: Storefront? { get async }
```

## 

Use [doc://com.apple.storekit/documentation/StoreKit/Storefront/current](doc://com.apple.storekit/documentation/StoreKit/Storefront/current) to determine a customer’s current storefront region and offer in-app products suitable for that region. You maintain your own list of product identifiers and the storefronts in which you make them available.

## See Also

- [Storefront](../com.apple.storekit/StoreKit/Storefront.md)
- [updates](../com.apple.storekit/StoreKit/Storefront/updates.md)

---


## SubscriptionOfferViewButtonKind


### detailLink

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
static var detailLink: SubscriptionOfferViewButtonKind { get }
```

---


## SubscriptionOptionGroup


### init(_:content:)-24grh

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: some StringProtocol, @StoreContentBuilder content: () -> Content)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:content:)-2nlpw

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: LocalizedStringKey, @StoreContentBuilder content: () -> Content)
```

## See Also

- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:content:marketingContent:)-550q0

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: some StringProtocol, @StoreContentBuilder content: () -> Content, @ViewBuilder marketingContent: () -> MarketingContent)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:content:marketingContent:)-9jybc

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: LocalizedStringKey, @StoreContentBuilder content: () -> Content, @ViewBuilder marketingContent: () -> MarketingContent)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:isIncluded:)-5f3ml

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: some StringProtocol, isIncluded: @escaping (Product) -> Bool) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:isIncluded:)-uhqa

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: LocalizedStringKey, isIncluded: @escaping (Product) -> Bool) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:isIncluded:marketingContent:)-4d72a

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: some StringProtocol, isIncluded: @escaping (Product) -> Bool, @ViewBuilder marketingContent: () -> MarketingContent) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(_:isIncluded:marketingContent:)-8vmdm

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ label: LocalizedStringKey, isIncluded: @escaping (Product) -> Bool, @ViewBuilder marketingContent: () -> MarketingContent) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(content:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@StoreContentBuilder content: () -> Content)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(content:label:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@StoreContentBuilder content: () -> Content, @ViewBuilder label: () -> Label)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(content:label:marketingContent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@StoreContentBuilder content: () -> Content, @ViewBuilder label: () -> Label, @ViewBuilder marketingContent: () -> MarketingContent)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(content:marketingContent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@StoreContentBuilder content: () -> Content, @ViewBuilder marketingContent: () -> MarketingContent)
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(isIncluded:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(isIncluded: @escaping (Product) -> Bool) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(isIncluded:label:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(isIncluded: @escaping (Product) -> Bool, @ViewBuilder label: () -> Label) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(isIncluded:label:marketingContent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(isIncluded: @escaping (Product) -> Bool, @ViewBuilder label: () -> Label, @ViewBuilder marketingContent: () -> MarketingContent) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

---


### init(isIncluded:marketingContent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(isIncluded: @escaping (Product) -> Bool, @ViewBuilder marketingContent: () -> MarketingContent) where Content == Never
```

## See Also

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)

---


## SubscriptionOptionGroupStyle


### links

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var links: LinksSubscriptionOptionGroupStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/automatic.md)
- [tabs](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/tabs.md)

---


### tabs

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
static var tabs: TabsSubscriptionOptionGroupStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/automatic.md)
- [links](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/links.md)

---


## SubscriptionStoreButtonLabel


### action-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
var action: SubscriptionStoreButtonLabel { get }
```

## See Also

- [displayName-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.property.md)
- [multiline-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.property.md)
- [price-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.property.md)
- [singleLine-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.property.md)

---


### action-swift.type.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
static var action: SubscriptionStoreButtonLabel { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/automatic.md)
- [displayName-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.type.property.md)
- [multiline-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.type.property.md)
- [price-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.type.property.md)
- [singleLine-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.type.property.md)

---


### displayName-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
var displayName: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.property.md)
- [multiline-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.property.md)
- [price-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.property.md)
- [singleLine-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.property.md)

---


### displayName-swift.type.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
static var displayName: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.type.property.md)
- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/automatic.md)
- [multiline-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.type.property.md)
- [price-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.type.property.md)
- [singleLine-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.type.property.md)

---


### multiline-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
var multiline: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.property.md)
- [displayName-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.property.md)
- [price-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.property.md)
- [singleLine-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.property.md)

---


### multiline-swift.type.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
static var multiline: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.type.property.md)
- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/automatic.md)
- [displayName-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.type.property.md)
- [price-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.type.property.md)
- [singleLine-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.type.property.md)

---


### price-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
var price: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.property.md)
- [displayName-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.property.md)
- [multiline-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.property.md)
- [singleLine-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.property.md)

---


### price-swift.type.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
static var price: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.type.property.md)
- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/automatic.md)
- [displayName-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.type.property.md)
- [multiline-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.type.property.md)
- [singleLine-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.type.property.md)

---


### singleLine-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
var singleLine: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.property.md)
- [displayName-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.property.md)
- [multiline-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.property.md)
- [price-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.property.md)

---


### singleLine-swift.type.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
static var singleLine: SubscriptionStoreButtonLabel { get }
```

## See Also

- [action-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.type.property.md)
- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/automatic.md)
- [displayName-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.type.property.md)
- [multiline-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.type.property.md)
- [price-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.type.property.md)

---


## SubscriptionStoreControlBackground


### gradientMaterial

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
static var gradientMaterial: SubscriptionStoreControlBackground { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/automatic.md)
- [gradientMaterialOnScroll](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/gradientMaterialOnScroll.md)

---


### gradientMaterialOnScroll

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static var gradientMaterialOnScroll: SubscriptionStoreControlBackground { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/automatic.md)
- [gradientMaterial](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/gradientMaterial.md)

---


## SubscriptionStoreControlPlacementKey


### leading

## Declaration

**Platforms:** tvOS

```swift
static var leading: SubscriptionStoreControlPlacementKey { get }
```

## See Also

- [bottom](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/bottom.md)
- [scrollView](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/scrollView.md)
- [trailing](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/trailing.md)
- [bottomBar](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/buttonsInBottomBar.md)

---


### trailing

## Declaration

**Platforms:** tvOS

```swift
static var trailing: SubscriptionStoreControlPlacementKey { get }
```

## See Also

- [bottom](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/bottom.md)
- [leading](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/leading.md)
- [scrollView](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/scrollView.md)
- [bottomBar](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/buttonsInBottomBar.md)

---


## SubscriptionStoreControlStyle


### Body

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
associatedtype Body : View
```

## See Also

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)

---


### Configuration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias Configuration = SubscriptionStoreControlStyleConfiguration
```

## See Also

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

---


### SubscribeButton

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias SubscribeButton = SubscriptionStoreButton
```

## See Also

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

---


### SubscriptionPicker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
typealias SubscriptionPicker = SubscriptionStorePicker
```

## See Also

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

---


### SubscriptionPickerOption

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
typealias SubscriptionPickerOption = SubscriptionStorePickerOption
```

## See Also

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

---


### buttons

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency static var buttons: ButtonsSubscriptionStoreControlStyle { get }
```

## 

You can also use [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)) with [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/buttons](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/buttons) as the parameter to construct this style.

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)
- [prominentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/prominentPicker.md)
- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)
- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)
- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

---


### compactPicker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor @preconcurrency static var compactPicker: CompactPickerSubscriptionStoreControlStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)
- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)
- [prominentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/prominentPicker.md)
- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)
- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)

---


### makeBody(configuration:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@ViewBuilder @MainActor @preconcurrency func makeBody(configuration: Self.Configuration) -> Self.Body
```

## Parameters

- **configuration**: The properties of a subscription store control that includes the list of auto-renewable subscriptions to merchandise.

## 

A view which provides UI controls to subscribe to a subscription service.

## 

Implement this method to define a custom subscription store control style which conforms to the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle). Use the `configuration` input — a value of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration) — to access the collection of subscription options to merchandise, and other properties of the controls. Return a view that provides controls for someone to choose an option from the configuration and subscribe. The following code example defines a style that adds price comparison captions to buttons:

```swift
struct PriceComparisonButtonsSubscriptionStoreControlStyle: SubscriptionStoreControlStyle {

    func makeBody(configuration: Configuration) -> some View {
        ForEach(configuration.options) { option in
            VStack {
                Button(localizedPrice(for: option), action: option.subscribe)
                if let priceComparison = priceComparison(for: option, allOptions: configuration.allOptions) {
                    Text(priceComparison)
                }
            }
        }
    }

    // Helper methods for localizing text
    
    private func localizedPrice(for option: Configuration.Option) -> LocalizedStringKey {
        // Use 'displayPrice' and 'subscriptionPeriod' on 'option' to localize the price.
        // For example: "$9.99/month"
    }
    
    private func priceComparison(for option: Configuration.Option, allOptions: [Product]) -> LocalizedStringKey? {
        guard let subscriptionPeriod = option.subscriptionPeriod, subscriptionPeriod != .monthly else {
            return nil
        }
        let monthlyOption = allOptions.first { otherOption in 
            otherOption.subscriptionPeriod == .monthly && otherOption.groupLevel == option.groupLevel
        }
        guard let monthlyOption else { 
            return nil
        }
        // Create a localized string to represent the savings of subscribing to 'option' compared to paying per
        // month with 'monthlyOption'. For example, "Save $20.00 per year compared to the monthly option".
    }
}
```

The `PriceComparisonButtonsSubscriptionStoreControlStyle` structure in the example code provides a button to subscribe to each option in the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) property of the `configuration`, along with an optional informative caption for options with durations longer than one month. By calling the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) method when a button is triggered, the subscription store view automatically manages a purchase task with the appropriate purchase options. The buttons automatically use the same button style as standard subscription store control styles, but you can customize this using [doc://com.apple.documentation/documentation/SwiftUI/View/buttonStyle(_:)-66fbx](doc://com.apple.documentation/documentation/SwiftUI/View/buttonStyle(_:)-66fbx).

Since the control style creates a [doc://com.apple.documentation/documentation/SwiftUI/VStack](doc://com.apple.documentation/documentation/SwiftUI/VStack) for each option, the subscription store view automatically lays out the stacks appropriately. You could instead provide an explicit layout container around [doc://com.apple.documentation/documentation/SwiftUI/ForEach](doc://com.apple.documentation/documentation/SwiftUI/ForEach) to customize the spacing and alignment of the buttons.

To handle cases where the monthly plans aren’t visible, the control style uses the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property to compute price comparsions instead of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options).

The control style reads properties of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) using dynamic member lookup, such as [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/subscriptionPeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/subscriptionPeriod).

Whenever any of the properties of `configuration` change, the system calls your [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)) method again to display an updated view.

The above example provides a button per plan, but not all control styles need to work this way. For example, you could combine multiple controls together with buttons, such as [doc://com.apple.documentation/documentation/SwiftUI/Picker](doc://com.apple.documentation/documentation/SwiftUI/Picker) or [doc://com.apple.documentation/documentation/SwiftUI/Toggle](doc://com.apple.documentation/documentation/SwiftUI/Toggle), and use state to implement more complicated interactions.

### 

The `PriceComparisonButtonsSubscriptionStoreControlStyle` in the example code above uses the [doc://com.apple.documentation/documentation/SwiftUI/Button](doc://com.apple.documentation/documentation/SwiftUI/Button) type to add buttons, but you can also use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreButton](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreButton) view to modify the standard subscribe button. When within the scope of a type conforming to [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle), you can simply spell this view as `SubscribeButton`.

For example, the following update to the `PriceComparisonButtonsSubscriptionStoreControlStyle` example code uses `SubscribeButton` instead of [doc://com.apple.documentation/documentation/SwiftUI/Button](doc://com.apple.documentation/documentation/SwiftUI/Button):

```swift
struct PriceComparisonButtonsSubscriptionStoreControlStyle: SubscriptionStoreControlStyle {

    func makeBody(configuration: Configuration) -> some View {
        ForEach(configuration.options) { option in
            VStack {
                SubscribeButton(option)
                if let priceComparison = priceComparison(for: option, allOptions: configuration.allOptions) {
                    Text(priceComparison)
                }
            }
            .subscriptionStoreButtonLabel(.price)
        }
    }

    // Helper method for localizing text     
    private func priceComparison(for option: Configuration.Option, allOptions: [Product]) -> LocalizedStringKey? {
        // Create a localized string to represent the savings of subscribing to 'option' compared to paying per
        // month with 'monthlyOption'. For example, "Save $20.00 per year compared to the monthly option".
    }
}
```

The updated custom style no longer needs to implement a custom `localizedPrice(for:)` method, instead the `SubscribeButton` automatically creates the localized label. The custom style uses the `subscriptionStoreButtonLabel(_:)` view modifier to only show the price in the button’s label.

You can also create custom control styles which modify the standard subscription picker control by using the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker) type. When within the scope of a type conforming to [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle), you can simply spell this view as `SubscriptionPicker`. For example, you can create a style to modify the standard subscription picker to use a custom label for the picker options:

```swift
struct SimpleCustomPickerOptionLabelSubscriptionStoreControlStyle: SubscriptionStoreControlStyle {

    func makeBody(configuration: Configuration) -> some View {
        SubscriptionPicker(configuration) { option in 
            HStack {
                VStack {
                    Text(option.displayName)
                    if option.activeOffer != nil {
                        Label("Special Offer", systemImage: "star")
                            .symbolVariant(.fill)
                            .foregroundStyle(.tint)
                            .font(.caption)
                            .padding(4)
                            .background(.secondary, .rect(cornerRadius: 4)
                    }
                }
                Spacer()
                Image(systemName: "checkmark")
                    .foregroundStyle(.tint)
                    .opacity(option.isSelected ? 1.0 : 0.0)
            }
        } confirmation: { option in 
            SubscribeButton(option)
        }
    }
}
```

The `SimpleCustomPickerOptionLabelSubscriptionStoreControlStyle` in the example code provides a picker control to select a plan from the `configuration` by providing the `configuration` value to the `SubscriptionPicker` view.

The first closure provided to the subscription picker receives a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) value, and returns a view to use as the label for each picker option. The subscription picker calls this closure once for each option in the configuration’s [doc://com.apple.documentation/documentation/IOUSBHost/IOUSBHostIsochronousTransaction/options](doc://com.apple.documentation/documentation/IOUSBHost/IOUSBHostIsochronousTransaction/options) property. The style uses the [doc://com.apple.storekit/documentation/StoreKit/Product/displayName](doc://com.apple.storekit/documentation/StoreKit/Product/displayName) property of [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) via dynamic member lookup to indicate which plan the picker option corresponds to. If the subscription store is configured to merchandise an offer, the custom style shows a label by checking `offer` . The style uses the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected) property to adjust the visibility of a checkmark indicating the selected plan. The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected) property is available instead of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) when declaring subscription picker option labels.

The second closure provided to the subscription picker receives a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) value, providing a control to confirm the currently selected plan. The custom style only provides custom picker option, and uses the standard subscribe button for the confirmation content. The standard subscribe button displays the price of the selected option.

You can also access the standard subscription picker option label by using [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePickerOption).

## See Also

- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

---


### pagedPicker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency static var pagedPicker: PagedPickerSubscriptionStoreControlStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)
- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)
- [prominentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/prominentPicker.md)
- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)
- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

---


### pagedProminentPicker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor @preconcurrency static var pagedProminentPicker: PagedProminentPickerSubscriptionStoreControlStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)
- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)
- [prominentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/prominentPicker.md)
- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)
- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

---


### picker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency static var picker: PickerSubscriptionStoreControlStyle { get }
```

## 

You can also use [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)) with [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/picker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/picker) as the parameter to construct this style.

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)
- [prominentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/prominentPicker.md)
- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)
- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)
- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

---


### prominentPicker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
@MainActor @preconcurrency static var prominentPicker: ProminentPickerSubscriptionStoreControlStyle { get }
```

## 

You can also use [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)) with [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/prominentPicker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/prominentPicker) as the parameter to construct this style.

## See Also

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)
- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)
- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)
- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)
- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

---


## SubscriptionStorePicker


### init(_:pickerOptionContent:confirmation:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ configuration: SubscriptionStoreControlStyleConfiguration, @ViewBuilder pickerOptionContent: @escaping (SubscriptionStoreControlStyleConfiguration.PickerOption) -> PickerContent, @ViewBuilder confirmation: @escaping (SubscriptionStoreControlStyleConfiguration.Option) -> ConfirmationContent)
```

## See Also

- [init(pickerContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(pickerContent:confirmation:).md)

---


### init(_:selection:pickerOptionContent:confirmation:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ configuration: SubscriptionStoreControlStyleConfiguration, selection: Binding<SubscriptionStoreControlStyleConfiguration.Option?>, @ViewBuilder pickerOptionContent: @escaping (SubscriptionStoreControlStyleConfiguration.PickerOption) -> PickerContent, @ViewBuilder confirmation: @escaping (SubscriptionStoreControlStyleConfiguration.Option) -> ConfirmationContent)
```

## See Also

- [init(selection:pickerContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(selection:pickerContent:confirmation:).md)

---


### init(pickerContent:confirmation:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@ViewBuilder pickerContent: () -> PickerContent, @ViewBuilder confirmation: @escaping (SubscriptionStoreControlStyleConfiguration.Option) -> ConfirmationContent)
```

## See Also

- [init(_:pickerOptionContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(_:pickerOptionContent:confirmation:).md)

---


### init(selection:pickerContent:confirmation:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(selection: Binding<SubscriptionStoreControlStyleConfiguration.Option?>, @ViewBuilder pickerContent: () -> PickerContent, @ViewBuilder confirmation: @escaping (SubscriptionStoreControlStyleConfiguration.Option) -> ConfirmationContent)
```

## See Also

- [init(_:selection:pickerOptionContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(_:selection:pickerOptionContent:confirmation:).md)

---


## advancedcommerceproduct


### purchaseoption


#### onstorefrontchange(shouldcontinuepurchase:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func onStorefrontChange(shouldContinuePurchase: @escaping (Storefront) -> Bool) -> AdvancedCommerceProduct.PurchaseOption
```

## Parameters

- **shouldContinuePurchase**: A closure that returns a Boolean value that determines whether the purchase continues when the storefront changes to `Storefront` during the purchase process.

## 

The default is `true` if you don’t include this option in the purchase options.

---


### alltransactions

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var allTransactions: Transaction.Transactions { get }
```

## See Also

- [currentEntitlements](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/currentEntitlements.md)
- [latestTransaction](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/latestTransaction.md)

---


### latesttransaction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var latestTransaction: VerificationResult<Transaction>? { get async }
```

## 

This value is `nil` if the customer hasn’t made any purchases associated with the generic product ID.

## See Also

- [allTransactions](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/allTransactions.md)
- [currentEntitlements](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/currentEntitlements.md)

---


### purchase(compactjws:confirmin:options:)-54lkw

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS, visionOS

```swift
func purchase(compactJWS: String, confirmIn viewController: UIViewController, options: Set<AdvancedCommerceProduct.PurchaseOption> = []) async throws -> AdvancedCommerceProduct.PurchaseResult
```

## Parameters

- **compactJWS**: The compact JSON Web Signature (JWS) string for the operation.
- **viewController**: The window the system uses to display purchase confirmation UI in proximity to.
- **options**: A set of purchase options.

## 

The result of the purchase.

## 

> **NOTE:** A `PurchaseError`, `StoreKitError`, or `InvalidRequest` error.

## See Also

- [PurchaseOption](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseOption.md)
- [purchase(compactJWS:confirmIn:options:)-7x4bh](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-7x4bh.md)
- [purchase(compactJWS:options:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:options:).md)
- [PurchaseResult](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseResult.md)

---


### purchase(compactjws:confirmin:options:)-7x4bh

## Declaration

**Platforms:** macOS

```swift
func purchase(compactJWS: String, confirmIn window: NSWindow, options: Set<AdvancedCommerceProduct.PurchaseOption> = []) async throws -> AdvancedCommerceProduct.PurchaseResult
```

## Parameters

- **compactJWS**: The compact JSON Web Signature (JWS) string for the operation.
- **window**: The window the system uses to display purchase confirmation UI in proximity to.
- **options**: A set of purchase options.

## 

The result of the purchase.

## 

> **NOTE:** A `PurchaseError`, `StoreKitError`, or `InvalidRequest` error.

## See Also

- [PurchaseOption](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseOption.md)
- [purchase(compactJWS:confirmIn:options:)-54lkw](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-54lkw.md)
- [purchase(compactJWS:options:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:options:).md)
- [PurchaseResult](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseResult.md)

---


### purchase(compactjws:options:)

## Declaration

**Platforms:** watchOS

```swift
@MainActor func purchase(compactJWS: String, options: Set<AdvancedCommerceProduct.PurchaseOption> = []) async throws -> AdvancedCommerceProduct.PurchaseResult
```

## Parameters

- **compactJWS**: The compact JSON Web Signature (JWS) string for the operation.
- **options**: A set of purchase options.

## 

The result of the purchase.

## 

> **NOTE:** A `PurchaseError`, `StoreKitError`, or `InvalidRequest` error.

## See Also

- [PurchaseOption](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseOption.md)
- [purchase(compactJWS:confirmIn:options:)-7x4bh](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-7x4bh.md)
- [purchase(compactJWS:confirmIn:options:)-54lkw](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-54lkw.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseResult.md)

---


### purchaseoption

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct PurchaseOption
```

## Topics

### Type Methods

- [onStorefrontChange(shouldContinuePurchase:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseOption/onStorefrontChange(shouldContinuePurchase:).md)

## See Also

- [purchase(compactJWS:confirmIn:options:)-7x4bh](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-7x4bh.md)
- [purchase(compactJWS:confirmIn:options:)-54lkw](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-54lkw.md)
- [purchase(compactJWS:options:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:options:).md)
- [PurchaseResult](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseResult.md)

---


### purchaseresult

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias PurchaseResult = Product.PurchaseResult
```

## See Also

- [PurchaseOption](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseOption.md)
- [purchase(compactJWS:confirmIn:options:)-7x4bh](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-7x4bh.md)
- [purchase(compactJWS:confirmIn:options:)-54lkw](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-54lkw.md)
- [purchase(compactJWS:options:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:options:).md)

---


## appstore


### environment


#### production

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let production: AppStore.Environment
```

## See Also

- [sandbox](../com.apple.storekit/StoreKit/AppStore/Environment/sandbox.md)
- [xcode](../com.apple.storekit/StoreKit/AppStore/Environment/xcode.md)

---


#### sandbox

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let sandbox: AppStore.Environment
```

## See Also

- [production](../com.apple.storekit/StoreKit/AppStore/Environment/production.md)
- [xcode](../com.apple.storekit/StoreKit/AppStore/Environment/xcode.md)

---


#### xcode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let xcode: AppStore.Environment
```

## See Also

- [production](../com.apple.storekit/StoreKit/AppStore/Environment/production.md)
- [sandbox](../com.apple.storekit/StoreKit/AppStore/Environment/sandbox.md)

---


### platform


#### ios

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let iOS: AppStore.Platform
```

## See Also

- [macOS](../com.apple.storekit/StoreKit/AppStore/Platform/macOS.md)
- [tvOS](../com.apple.storekit/StoreKit/AppStore/Platform/tvOS.md)
- [visionOS](../com.apple.storekit/StoreKit/AppStore/Platform/visionOS.md)

---


#### macos

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let macOS: AppStore.Platform
```

## See Also

- [iOS](../com.apple.storekit/StoreKit/AppStore/Platform/iOS.md)
- [tvOS](../com.apple.storekit/StoreKit/AppStore/Platform/tvOS.md)
- [visionOS](../com.apple.storekit/StoreKit/AppStore/Platform/visionOS.md)

---


#### tvos

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let tvOS: AppStore.Platform
```

## See Also

- [iOS](../com.apple.storekit/StoreKit/AppStore/Platform/iOS.md)
- [macOS](../com.apple.storekit/StoreKit/AppStore/Platform/macOS.md)
- [visionOS](../com.apple.storekit/StoreKit/AppStore/Platform/visionOS.md)

---


#### visionos

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let visionOS: AppStore.Platform
```

## See Also

- [iOS](../com.apple.storekit/StoreKit/AppStore/Platform/iOS.md)
- [macOS](../com.apple.storekit/StoreKit/AppStore/Platform/macOS.md)
- [tvOS](../com.apple.storekit/StoreKit/AppStore/Platform/tvOS.md)

---


### ageratingcode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var ageRatingCode: Int? { get async }
```

## 

An integer representing the current age rating code, or `nil` if the age rating is unavailable.

## 

Use this property to fetch the age rating for your app and compare it with the last known age rating to check if it has changed.

The following is an example of getting the age rating for an app:

```swift
func getAgeRatingCode() async -> Int? {
    guard let ageRatingCode = await AppStore.ageRatingCode else {
        print("Age rating code unavailable")
        return nil
    }
    return ageRatingCode
}
```

---


### canmakepayments

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var canMakePayments: Bool { get }
```

## 

Use [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) to determine at runtime whether a person can authorize payments. If the value is `false`, a person can’t authorize payments, so don’t offer In-App Purchases or external purchases.

> **IMPORTANT:** Your app might need to alter its behavior or appearance when people can’t make purchases. For example, don’t enable your user interface for making In-App Purchases or external purchases when purchases are blocked.

The following conditions can cause the value of [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) to be `false`:

- A person sets the Content & Privacy Restrictions in Screen Time to prevent purchases. For more information, see [https://support.apple.com/en-us/HT201304](https://support.apple.com/en-us/HT201304).
- The device has a mobile device management (MDM) profile that prevents purchases. For more information, see [doc://com.apple.documentation/documentation/DeviceManagement](doc://com.apple.documentation/documentation/DeviceManagement).

If [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) is `true` and your app uses only StoreKit [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs, the person can authorize purchases in the App Store and your app can offer In-App Purchases.

### 

If your app has the entitlements to use the [doc://com.apple.storekit/documentation/StoreKit/external-purchase](doc://com.apple.storekit/documentation/StoreKit/external-purchase) APIs, determine at runtime whether to use the [doc://com.apple.storekit/documentation/StoreKit/external-purchase](doc://com.apple.storekit/documentation/StoreKit/external-purchase) API or the [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs by following these steps, in order:

1. Check [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments). If [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) is `false`, don’t offer either external purchases or In-App Purchases. If [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) if `true`, continue to step 2.
2. Check the External Purchase API values: [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen), [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent), and [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible). If any value is `true`, use only the [doc://com.apple.storekit/documentation/StoreKit/external-purchase](doc://com.apple.storekit/documentation/StoreKit/external-purchase) APIs to offer external purchases.
3. If all the values ([doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen), [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent), and [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible)) are `false`, and [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) is `true`, use StoreKit [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs to offer In-App Purchases.

> **NOTE:** The StoreKit APIs always enable your app to view existing transactions and receive auto-renewable subscription renewals, so your app can support your customer’s existing purchases made through the App Store.

---


### deviceverificationid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var deviceVerificationID: UUID? { get }
```

## 

Use this property to verify whether an App Store-signed JSON Web Signature (JWS) is valid for the current device. The JWS may be one of the following:

- A [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) representing a signed transaction
- A [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj) representing a signed subscription renewal information
- A [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59) representing a signed app transaction.

To verify that the JWS is valid for the current device, follow these steps:

1. Append the lowercased UUID string representation of this property, [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID), after the lowercased UUID string representation of the device verification nonce. For a transaction, the nonce is [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerificationNonce](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerificationNonce). For subscription renewal information, the nonce is [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerificationNonce](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerificationNonce). For an app transaction, the nonce is [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerificationNonce](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerificationNonce).
2. Compute the SHA-384 hash of the appended UUID strings.
3. Verify that the SHA-384 digest is equal to the device verification property. For a transaction, the device verification property is [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification). For subscription renewal information, the device verification property is [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerification). For an app transaction, the device verifcation property is [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerification).

---


### platform

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Platform
```

## 

You choose a platform for your app when you add the new app in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/create-an-app-record/add-a-new-app/](https://developer.apple.com/help/app-store-connect/create-an-app-record/add-a-new-app/).

The platform values in `AppStore.Platform` are the same as those in App Store Connect.

## Topics

### Getting platform values

- [iOS](../com.apple.storekit/StoreKit/AppStore/Platform/iOS.md)
- [macOS](../com.apple.storekit/StoreKit/AppStore/Platform/macOS.md)
- [tvOS](../com.apple.storekit/StoreKit/AppStore/Platform/tvOS.md)
- [visionOS](../com.apple.storekit/StoreKit/AppStore/Platform/visionOS.md)

## See Also

- [originalPlatform](../com.apple.storekit/StoreKit/AppTransaction/originalPlatform.md)

---


### presentmerchandising(_:from:)-8bblo

## Declaration

**Platforms:** macOS

```swift
@MainActor static func presentMerchandising(_ kind: AppStoreMerchandisingKind, from window: NSWindow) async throws -> AppStoreMerchandisingKind.PresentationResult
```

---


### presentmerchandising(_:from:)-hkrd

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
@MainActor static func presentMerchandising(_ kind: AppStoreMerchandisingKind, from controller: UIViewController) async throws -> AppStoreMerchandisingKind.PresentationResult
```

---


### presentoffercoderedeemsheet(from:)

## Declaration

**Platforms:** macOS

```swift
@MainActor static func presentOfferCodeRedeemSheet(from controller: NSViewController) async throws
```

## Parameters

- **controller**: An [doc://com.apple.documentation/documentation/AppKit/NSViewController](doc://com.apple.documentation/documentation/AppKit/NSViewController) that StoreKit uses to display the offer code redemption sheet.

## 

This method displays a system sheet in the view, where customers can enter and redeem offer codes. Use this method if you generate offer codes in App Store Connect and your app uses AppKit.

> **IMPORTANT:** Set up offer codes in App Store Connect before calling this API. Customers can only redeem these offers in your app through the redemption sheet; don’t use a custom UI.

For more information on offer codes, see [doc://com.apple.storekit/documentation/StoreKit/supporting-offer-codes-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-offer-codes-in-your-app).

When customers redeem an offer code, StoreKit emits the resulting transaction in [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates). Set up a transaction listener as soon as your app launches to receive new transactions while the app is running.

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [presentOfferCodeRedeemSheet(in:)](../com.apple.storekit/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:).md)
- [offerCodeRedemption(isPresented:onCompletion:)](../com.apple.SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:).md)

---


### presentoffercoderedeemsheet(in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor static func presentOfferCodeRedeemSheet(in scene: UIWindowScene) async throws
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that StoreKit uses to display the offer code redemption sheet.

## 

The [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)) method displays a system sheet in the window scene, where customers can enter and redeem offer codes. If you generate offer codes in App Store Connect, call this function to enable customers to redeem the offer. To display the sheet using SwiftUI, see [doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)](doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)).

> **IMPORTANT:** Set up offer codes in App Store Connect before calling this API. Customers can only redeem these offers in your app through the redemption sheet; don’t use a custom UI.

For more information on offer codes, see [doc://com.apple.storekit/documentation/StoreKit/supporting-offer-codes-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-offer-codes-in-your-app).

When customers redeem an offer code, StoreKit emits the resulting transaction in [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates). Set up a transaction listener as soon as your app launches to receive new transactions while the app is running. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).

In Mac apps built with Mac Catalyst, this method throws a [doc://com.apple.storekit/documentation/StoreKit/StoreKitError/unknown](doc://com.apple.storekit/documentation/StoreKit/StoreKitError/unknown) error.

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [offerCodeRedemption(isPresented:onCompletion:)](../com.apple.SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:).md)
- [presentOfferCodeRedeemSheet(from:)](../com.apple.storekit/StoreKit/AppStore/presentOfferCodeRedeemSheet(from:).md)

---


### requestreview(in:)-1q8qs

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor static func requestReview(in scene: UIWindowScene)
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that StoreKit uses to present the rating and review request interface.

## 

When you call this method in your shipping app and the system displays a rating and review request view, the system handles the entire process for you. Although you normally call this method when it makes sense in the user experience flow of your app, App Store policy governs the actual display of a rating and review request view. When your app calls this API, StoreKit uses the following criteria:

- If the person hasn’t rated or reviewed your app on this device, StoreKit displays the ratings and review request a maximum of three times within a 365-day period.
- If the person has rated or reviewed your app on this device, StoreKit displays the ratings and review request if the app version is new, and if more than 365 days have passed since the person’s previous review.

> **NOTE:** Because this method may not present an alert, don’t call [doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview()](doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview()) or [doc://com.apple.storekit/documentation/StoreKit/AppStore/requestReview(in:)-1q8qs](doc://com.apple.storekit/documentation/StoreKit/AppStore/requestReview(in:)-1q8qs) in response to a button tap or other user action.

It’s up to your app to decide on the best timing for requesting reviews. For design guidance, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews](https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews).

### 

When your app calls this method while it’s in development mode, StoreKit always displays the rating and review request view, so you can test the user interface and experience. However, this method has no effect in apps that you distribute for beta testing using TestFlight.

### 

Your customers can review your app at any time on the App Store. To make it easier for people to leave reviews, you may include a persistent link to your App Store product page in your app’s settings or configuration screens. Append the query parameter `action=write-review` to your product page URL to automatically open the App Store page where users can write a review.

## See Also

- [RequestReviewAction](../com.apple.storekit/StoreKit/RequestReviewAction.md)
- [requestReview(in:)-4r0y9](../com.apple.storekit/StoreKit/AppStore/requestReview(in:)-4r0y9.md)

---


### requestreview(in:)-4r0y9

## Declaration

**Platforms:** macOS

```swift
@MainActor static func requestReview(in controller: NSViewController)
```

## Parameters

- **controller**: The [doc://com.apple.documentation/documentation/AppKit/NSViewController](doc://com.apple.documentation/documentation/AppKit/NSViewController) that StoreKit uses to present the rating and review request interface.

## 

When you call this method in your shipping app and the system displays a rating and review request view, the system handles the entire process for you. Although you normally call this method when it makes sense in the user experience flow of your app, App Store policy governs the actual display of a rating and review request view. When your app calls this API, StoreKit uses the following criteria:

- If the person hasn’t rated or reviewed your app on this device, StoreKit displays the ratings and review request a maximum of three times within a 365-day period.
- If the person has rated or reviewed your app on this device, StoreKit displays the ratings and review request if the app version is new, and if more than 365 days have passed since the person’s previous review.

> **NOTE:** Because this method may not present an alert, don’t call [doc://com.apple.storekit/documentation/StoreKit/AppStore/requestReview(in:)-4r0y9](doc://com.apple.storekit/documentation/StoreKit/AppStore/requestReview(in:)-4r0y9) in response to a button tap or other user action.

It’s up to your app to decide on the best timing for requesting reviews. For design guidance, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews](https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews).

### 

When your app calls this method while it’s in development mode, StoreKit always displays the rating and review request view, so you can test the user interface and experience. However, this method has no effect in apps that you distribute for beta testing using TestFlight.

### 

Your customers can review your app at any time on the App Store. To make it easier for people to leave reviews, you may include a persistent link to your App Store product page in your app’s settings or configuration screens. Append the query parameter `action=write-review` to your product page URL to automatically open the App Store page where users can write a review.

## See Also

- [RequestReviewAction](../com.apple.storekit/StoreKit/RequestReviewAction.md)
- [requestReview(in:)-1q8qs](../com.apple.storekit/StoreKit/AppStore/requestReview(in:)-1q8qs.md)

---


### showmanagesubscriptions(in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor static func showManageSubscriptions(in scene: UIWindowScene) async throws
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that the system displays the sheet on.

## 

Use this function to display the manage subscriptions sheet within your app. Consider adding a manage subscriptions option to your app. For design guidance on supporting this functionality, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/auto-renewable-subscriptions/#helping-people-manage-their-subscriptions](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/auto-renewable-subscriptions/#helping-people-manage-their-subscriptions).

The [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)) function presents a manage subscription sheet that’s the same as what customers can view in their account settings in the App Store app or by choosing Settings > Apple Account > Subscriptions on an iOS or iPadOS device. The sheet displays the customer’s currently active subscription for your app and the options to view, upgrade, downgrade, or cancel their subscription.

If you’re using SwiftUI, call the [doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)](doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:))view modifier.

Avoid showing the user interface for this feature in Mac apps built with Mac Catalyst and on iOS apps running on Mac computers with Apple silicon because this sheet isn’t supported in macOS.

- In Mac apps built with Mac Catalyst, enclose the code in a compilation conditional block that uses the `targetEnvironment():` platform condition. For more information on Mac Catalyst, see [doc://com.apple.documentation/documentation/UIKit/creating-a-mac-version-of-your-ipad-app](doc://com.apple.documentation/documentation/UIKit/creating-a-mac-version-of-your-ipad-app).
- For iOS apps running on Apple silicon, if [doc://com.apple.documentation/documentation/Foundation/ProcessInfo/isiOSAppOnMac](doc://com.apple.documentation/documentation/Foundation/ProcessInfo/isiOSAppOnMac) is `true,` avoid showing the user interface for this feature.

### 

Test the managing subscriptions functionality in the sandbox environment and StoreKit testing in Xcode. For more information about testing, see [doc://com.apple.storekit/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox](doc://com.apple.storekit/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox) and [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

## See Also

- [showManageSubscriptions(in:subscriptionGroupID:)](../com.apple.storekit/StoreKit/AppStore/showManageSubscriptions(in:subscriptionGroupID:).md)

---


### showmanagesubscriptions(in:subscriptiongroupid:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor static func showManageSubscriptions(in scene: UIWindowScene, subscriptionGroupID: String) async throws
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that the system displays the sheet on.
- **subscriptionGroupID**: The subscription group identifier that the subscription belongs to.

## See Also

- [showManageSubscriptions(in:)](../com.apple.storekit/StoreKit/AppStore/showManageSubscriptions(in:).md)

---


### sync()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func sync() async throws
```

## 

Include some mechanism in your app, such as a Restore Purchases button, to let users restore their in-app purchases. In rare cases when a user suspects the app isn’t showing all the transactions, call [doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()](doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()). By calling [doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()](doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()), you force the app to obtain transaction information and subscription status from the App Store.

> **IMPORTANT:** Calling [doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()](doc://com.apple.storekit/documentation/StoreKit/AppStore/sync())displays a system prompt that asks users to authenticate with their App Store credentials. Call this function only in response to an explicit user action, like tapping or clicking a button.

In regular operations, there’s no need to call [doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()](doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()). StoreKit automatically keeps up to date transaction information and subscription status available to your app. When users reinstall your app or download it on a new device, the app automatically has all transactions available to it upon initial launch. There’s no need for users to ask your app to restore transactions — your app can immediately get the current entitlements using [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) and transaction history using [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all). For more information about transactions, see [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

---


## compactsubscriptionofferviewstyle


### init()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
nonisolated init()
```

---


## displaymessageaction


### callasfunction(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor func callAsFunction(_ message: Message) throws
```

## Parameters

- **message**: The App Store message to display.

## 

Don’t call this method directly. SwiftUI calls it when you call the [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction) structure using `message` as an argument.

For information about how Swift uses the [doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction/callAsFunction()](doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction/callAsFunction()) method to simplify call site syntax, see [https://docs.swift.org/swift-book/ReferenceManual/Declarations.html#ID622](https://docs.swift.org/swift-book/ReferenceManual/Declarations.html#ID622) in *The Swift Programming Language*.

---


## externalpurchase


### noticeresult


#### continuedwithexternalpurchasetoken(token:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case continuedWithExternalPurchaseToken(token: String)
```

## Parameters

- **token**: The external purchase token.

## 

When your app calls [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()) and it results in this value: [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)), your app can proceed to present external purchases.

> **IMPORTANT:** Record and use the token to report the customer’s external purchases to Apple. For more information, see [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

``

## See Also

- [cancelled](../com.apple.storekit/StoreKit/ExternalPurchase/NoticeResult/cancelled.md)

---


### canpresent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var canPresent: Bool { get async }
```

## 

Check this property, as shown below, to determine whether your app can successfully call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()) to inform people before showing external purchases:

```swift
await externalPurchase.canPresent 
```

Check the value of this property again whenever the App Store storefront changes by using the [doc://com.apple.storekit/documentation/StoreKit/Storefront/updates](doc://com.apple.storekit/documentation/StoreKit/Storefront/updates) asynchronous sequence of [doc://com.apple.storekit/documentation/StoreKit/Storefront](doc://com.apple.storekit/documentation/StoreKit/Storefront).

This property is `true` if all the following conditions are met:

- The current App Store storefront allows external purchase, and the person is eligible to make external purchases.
- Your app configures the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase.allowed-regions entitlement, or it configures the  [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase) entitlement and the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchase](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchase), including the country code for the current App Store storefront.

Otherwise, this property is `false`.

When this property is `false`, check [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) to determine whether your app can offer in-app purchases using the StoreKit [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments).

## See Also

- [presentNoticeSheet()](../com.apple.storekit/StoreKit/ExternalPurchase/presentNoticeSheet().md)
- [NoticeResult](../com.apple.storekit/StoreKit/ExternalPurchase/NoticeResult.md)
- [SKExternalPurchase](../com.apple.BundleResources/Information-Property-List/SKExternalPurchase.md)

---


### presentnoticesheet()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func presentNoticeSheet() async throws -> ExternalPurchase.NoticeResult
```

## 

This method returns [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult).

## 

This method is only available to apps with the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase.allowed-regions or [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase) entitlement. For more information, see [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase).

Call this method each time your app is ready to present an external purchase. To use this method, follow these steps:

1. Call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent). If it’s `false`, don’t call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()) and don’t show external purchases.
2. If [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent) is `true`, display buttons or other user-interface elements to enable deliberate user interaction. Then, in response to a deliberate user interaction such as tapping a button, call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()) as shown below:

```swift
try await ExternalPurchase.presentNoticeSheet()
```

1. If the result is [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)) your app can show external purchases. Otherwise, you must not show external purchases.

> **IMPORTANT:** Record and use the token from the result to report to Apple the customer’s external purchases. For more information on reporting, see [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

This method throws a [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError) in any of the following conditions:

- The current App Store storefront doesn’t support external purchases.
- The person is ineligible to make external purchases.
- Your app doesn’t have the necessary entitlement.
- Your app doesn’t configure external purchase for the current App Store storefront in [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchase](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchase) when it has the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase) entitlement.
- A network or system error occurs.

This method also throws a [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError) if its functionality is unavailable for the following reasons:

- Your app is built with Mac Catalyst and you compile with an SDK earlier than iOS 17.4 or iPadOS 17.4.
- Your app is a compatible iPad or iPhone app running in macOS or visionOS and uses an SDK earlier than iOS 17.4 or iPadOS 17.4.

For apps compiled with SDKs earlier than iOS 17.4 or iPadOS 17.4, your app can show external purchases if the result is `ExternalPurchase.NoticeResult.continued`.

## See Also

- [canPresent](../com.apple.storekit/StoreKit/ExternalPurchase/canPresent.md)
- [NoticeResult](../com.apple.storekit/StoreKit/ExternalPurchase/NoticeResult.md)
- [SKExternalPurchase](../com.apple.BundleResources/Information-Property-List/SKExternalPurchase.md)

---


## externalpurchasecustomlink


### noticeresult


#### continued

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case continued
```

## See Also

- [cancelled](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeResult/cancelled.md)

---


### noticetype


#### browser

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case browser
```

## 

After displaying a notice with this notice type using [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)), if the customer chooses to continue, the app goes to the background and presents external purchases in a destination outside of the app.

## See Also

- [withinApp](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType/withinApp.md)

---


#### withinapp

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case withinApp
```

## 

After displaying a notice with this notice type using [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)), if the customer chooses to continue, the app displays the destination in a web view or native experience within the app.

## See Also

- [browser](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType/browser.md)

---


### token


#### value

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let value: String
```

## 

For information about the token, see [doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens](doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens).

---


### iseligible

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var isEligible: Bool { get async }
```

## 

Check this value if your app configures any of the following entitlements:

- [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions)
- doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link-streaming.allowed-regions
- [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link)
- [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming)

If [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) is `true`, your app can use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API.

This value is `true` if all the following conditions are met:

- The current App Store storefront allows external purchases and the person can make purchases.
- Your app configures any of the entitlements listed above.
- Your app configures the current App Store storefront in the property list key associated with the entitlement, [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) or [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions), or has an entitlement that includes the current App Store storefront.

If [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) is `false`, don’t use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API. The methods of the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API throw errors at runtime when [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) is `false`.

---


### noticeresult

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum NoticeResult
```

## 

This value is the result of calling [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)).

If the value is [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued), the customer choses to continue and your app can communicate and promote offers for purchase in a distribution channel of your choice. Otherwise, don’t continue.

## Topics

### Getting notice results

- [cancelled](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeResult/cancelled.md)
- [continued](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued.md)

## See Also

- [showNotice(type:)](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/showNotice(type:).md)
- [NoticeType](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType.md)

---


### noticetype

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum NoticeType
```

## 

Provide a notice type value when you call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)).

## Topics

### Getting notice types

- [browser](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType/browser.md)
- [withinApp](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType/withinApp.md)

## See Also

- [showNotice(type:)](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/showNotice(type:).md)
- [NoticeResult](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeResult.md)

---


### shownotice(type:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func showNotice(type: ExternalPurchaseCustomLink.NoticeType) async throws -> ExternalPurchaseCustomLink.NoticeResult
```

## Parameters

- **type**: An [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeType](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeType) value you select that determines the disclosure sheet the system displays.

## 

Returns [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued) to indicate the customer chooses to continue, or [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/cancelled](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/cancelled) to indicate the customer chooses not to continue to view external purchases. This method throws an error if your app isn’t eligible, at runtime, to use this API.

## 

Use this method if your app configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) or [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions) property list keys.

Call this method to display the system disclosure sheet before your app continues to communicate and promote offers for purchase in a distribution channel of your choice. Call this method in response to a deliberate customer action, such as tapping a button.

Select the notice type based on how your app communicates the offers if the customer chooses to continue:

- Use [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeType/browser](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeType/browser) if the app goes to the background, and promotes offers in a destination outside of the app.
- Use [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeType/withinApp](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeType/withinApp) if the app promotes offers in a web view or native experience within the app.

Continue to communicate and promote offers if [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)) returns [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/NoticeResult/continued); otherwise don’t continue.

For example code that calls this method, see [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink).

## See Also

- [NoticeType](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType.md)
- [NoticeResult](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeResult.md)

---


### token(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func token(for tokenType: String) async throws -> ExternalPurchaseCustomLink.Token?
```

## Parameters

- **tokenType**: A string that indicates the token type. Valid string values are: `ACQUISITION`, `SERVICES`

## 

Returns an external purchase token of the type you specify, or returns `nil` if there isn’t an active token of the specified type. This method throws an error if your app isn’t eligible to use this API.

## 

Use this method to request tokens when your app uses the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API. Request the `ACQUISITION` and `SERVICES` token types when your app launches and immediately associate the tokens with a customer account on your server. You can also call this method at any other time, such as before communicating or promoting offers. The method returns the token, of each type, until it expires.

> **TIP:** Request a token before every potential transaction to ensure you have a current token.

### 

Decode the token to read its contents, including its expiration date. For more information, see [doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens](doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens). For a code example that shows requesting tokens, see [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink).

Report tokens and all transactions associated with the tokens from your server, using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

## See Also

- [Token](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/Token.md)
- [receiving-and-decoding-external-purchase-tokens](../com.apple.storekit/StoreKit/receiving-and-decoding-external-purchase-tokens.md)

---


### token

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Token
```

## 

StoreKit returns an external purchase token of this type when you call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) function. For more information, see [doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens](doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens).

## Topics

### Getting the token value

- [value](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/Token/value.md)

## See Also

- [ExternalPurchaseCustomLink](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink.md)
- [com.apple.developer.storekit.custom-purchase-link.allowed-regions](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions.md)
- [com.apple.developer.storekit.external-purchase-link](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link.md)
- [SKExternalPurchaseCustomLinkRegions](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions.md)
- [testing-transactions-that-use-custom-link-tokens](../com.apple.storekit/StoreKit/testing-transactions-that-use-custom-link-tokens.md)

---


## product


### collectiontaskstate


#### success(_:unavailable:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case success([Product], unavailable: [Product.ID])
```

## See Also

- [loading](../com.apple.storekit/StoreKit/Product/CollectionTaskState/loading.md)
- [failure(_:)](../com.apple.storekit/StoreKit/Product/CollectionTaskState/failure(_:).md)

---


### producttype


#### autorenewable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let autoRenewable: Product.ProductType
```

## See Also

- [consumable](../com.apple.storekit/StoreKit/Product/ProductType/consumable.md)
- [nonConsumable](../com.apple.storekit/StoreKit/Product/ProductType/nonConsumable.md)
- [nonRenewable](../com.apple.storekit/StoreKit/Product/ProductType/nonRenewable.md)

---


#### consumable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let consumable: Product.ProductType
```

## See Also

- [nonConsumable](../com.apple.storekit/StoreKit/Product/ProductType/nonConsumable.md)
- [nonRenewable](../com.apple.storekit/StoreKit/Product/ProductType/nonRenewable.md)
- [autoRenewable](../com.apple.storekit/StoreKit/Product/ProductType/autoRenewable.md)

---


#### nonconsumable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let nonConsumable: Product.ProductType
```

## See Also

- [consumable](../com.apple.storekit/StoreKit/Product/ProductType/consumable.md)
- [nonRenewable](../com.apple.storekit/StoreKit/Product/ProductType/nonRenewable.md)
- [autoRenewable](../com.apple.storekit/StoreKit/Product/ProductType/autoRenewable.md)

---


#### nonrenewable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let nonRenewable: Product.ProductType
```

## See Also

- [consumable](../com.apple.storekit/StoreKit/Product/ProductType/consumable.md)
- [nonConsumable](../com.apple.storekit/StoreKit/Product/ProductType/nonConsumable.md)
- [autoRenewable](../com.apple.storekit/StoreKit/Product/ProductType/autoRenewable.md)

---


### promotioninfo


#### visibility-swift.enum


##### appstoreconnectdefault

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
case appStoreConnectDefault
```

## 

When a promoted in-app purchase has a visibility value of [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault), the in-app purchase is:

- Visible if the setting in App Store Connect makes it visible
- Hidden if the setting in App Store Connect makes it hidden

Use this value to control the visibility for promoted in-app purchases in App Store Connect, globally, for all users. For example, if you have a product to promote on a holiday, start by manually setting it as hidden using App Store Connect. On the holiday, change the setting to make the promotion visible. If the promotion visibility in the app is the default ([doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault)), it becomes visible for all users automatically.

For more information about the visibility settings in App Store Connect, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

## See Also

- [hidden](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden.md)
- [visible](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/visible.md)

---


##### hidden

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
case hidden
```

## 

A promoted in-app purchase with this visibility setting isn’t visible on the App Store on a user’s device.

## See Also

- [appStoreConnectDefault](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault.md)
- [visible](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/visible.md)

---


##### visible

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
case visible
```

## 

A promoted in-app purchase with this visibility setting is visible on the App Store on a user’s device.

## See Also

- [appStoreConnectDefault](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault.md)
- [hidden](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden.md)

---


#### currentorder

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static var currentOrder: [Product.PromotionInfo] { get async throws }
```

## 

This asynchronous array returns a list of [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) objects in the custom order they appear in on the device.

> **NOTE:** This list is empty if you don’t override the order, and the App Store displays the products in their default order.

For information about setting the default order using App Store Connect, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

---


#### update()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
func update() async throws
```

## 

If you change the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) value by setting it directly, call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()) to save your changes to the App Store server. Changes take effect after you call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()) or [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)).

## See Also

- [updateAll(_:)](../com.apple.storekit/StoreKit/Product/PromotionInfo/updateAll(_:).md)

---


#### updateall(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static func updateAll(_ promotions: some Collection<Product.PromotionInfo>) async throws
```

## Parameters

- **promotions**: A collection of [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) objects that you list in the order they are to appear in the App Store on the user’s device. Use an empty collection to cancel previous changes.

## 

Call this static method to set the order of promoted in-app purchases for the user. Calling this method overrides any previous order and visibility that you set for this user.

To remove a promoted in-app purchase so it doesn’t display for a user, there are two options:

- Don’t include it in the `promotions` collection.
- Change its [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) value to [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden).

To set the order of promoted in-app purchases using product identifiers instead of [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) objects, see [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)).

### 

To cancel the order and visibility changes you make, send an empty collection in `promotions`. All in-app purchases then display in the default order.

## See Also

- [update()](../com.apple.storekit/StoreKit/Product/PromotionInfo/update().md)

---


#### updateproductorder(byid:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static func updateProductOrder(byID order: some Collection<String>) async throws
```

## Parameters

- **order**: A collection of product identifiers ([doc://com.apple.storekit/documentation/StoreKit/Product/id](doc://com.apple.storekit/documentation/StoreKit/Product/id)) in the order that you want the promoted in-app purchases to appear, from first to last. Use an empty list to cancel previous changes.

## 

Call this static method to override the default order of promoted in-app purchases on the current device. You provide the product identifiers of the promoted in-app purchases to set their order.

To hide a promoted in-app purchase so it doesn’t display in the App Store for the user, don’t include its product identifier when calling this method. You may want to do this, for example, if the user has already purchased the product, or if it isn’t relevant to them for some other reason.

To set the order using [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) objects instead of product identifiers, see [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)).

### 

To cancel the order and visibility changes you make, send an empty collection in the `order` parameter. All in-app purchases then display in the default order.

```swift
// Cancel overrides by using an empty collection.
do {
    try await Product.PromotionInfo.updateProductOrder(byID: [])
}
catch {
    <#Handle error.#>
}
```

---


#### updateproductvisibility(_:for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static func updateProductVisibility(_ visibility: Product.PromotionInfo.Visibility, for productID: Product.ID) async throws
```

## Parameters

- **visibility**: A visibility value of [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum) that determines whether a promoted in-app purchase appears in the App Store on the user’s device.
- **productID**: The product identifier of the promoted in-app purchase.

## 

Call this method to change the visibility setting for a promoted in-app purchase. Changes take effect after you call this method.

The following code example updates a promoted product’s visibility after the user purchases it. The purchased product is hidden to avoid showing it again on the device.

```swift
// Update visibility to hide a promoted product after the user purchases it.
let purchasedProductIdentifier = "com.example.ExampleApp.product1"

do {
  try await Product.PromotionInfo.updateProductVisibility(.hidden, for: purchasedProductIdentifier)
}
catch {
  <#Handle Error#>
}
```

## See Also

- [visibility-swift.property](../com.apple.storekit/StoreKit/Product/PromotionInfo/visibility-swift.property.md)
- [Visibility-swift.enum](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum.md)

---


#### visibility-swift.enum

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
enum Visibility
```

## 

Use the visibility states to set the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) of a promoted in-app purchase. Call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()) to save your changes.

The visibility states have the following effects on the user’s device:

- [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/visible](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/visible) makes the promoted in-app purchase visible in the App Store.
- [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden) hides the promoted in-app purchase in the App Store.
- [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault) let’s you control the visibility using settings in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

## Topics

### Getting visibility states

- [appStoreConnectDefault](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault.md)
- [hidden](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden.md)
- [visible](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum/visible.md)

## See Also

- [visibility-swift.property](../com.apple.storekit/StoreKit/Product/PromotionInfo/visibility-swift.property.md)
- [updateProductVisibility(_:for:)](../com.apple.storekit/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:).md)

---


#### visibility-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
var visibility: Product.PromotionInfo.Visibility
```

## 

To override the visibility of a promoted in-app purchase, set the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) value and then call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()) to save the change. You can also call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:)) to set the visibility.

The default value is [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault).

## See Also

- [Visibility-swift.enum](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum.md)
- [updateProductVisibility(_:for:)](../com.apple.storekit/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:).md)

---


### purchaseerror


#### invalidoffersignature

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case invalidOfferSignature
```

## See Also

- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferIdentifier.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/PurchaseError/productUnavailable.md)
- [purchaseNotAllowed](../com.apple.storekit/StoreKit/Product/PurchaseError/purchaseNotAllowed.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/Product/PurchaseError/ineligibleForOffer.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferPrice.md)
- [invalidQuantity](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidQuantity.md)
- [missingOfferParameters](../com.apple.storekit/StoreKit/Product/PurchaseError/missingOfferParameters.md)

---


#### invalidquantity

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case invalidQuantity
```

## See Also

- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferIdentifier.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/PurchaseError/productUnavailable.md)
- [purchaseNotAllowed](../com.apple.storekit/StoreKit/Product/PurchaseError/purchaseNotAllowed.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/Product/PurchaseError/ineligibleForOffer.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferPrice.md)
- [invalidOfferSignature](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferSignature.md)
- [missingOfferParameters](../com.apple.storekit/StoreKit/Product/PurchaseError/missingOfferParameters.md)

---


#### missingofferparameters

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case missingOfferParameters
```

## See Also

- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferIdentifier.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/PurchaseError/productUnavailable.md)
- [purchaseNotAllowed](../com.apple.storekit/StoreKit/Product/PurchaseError/purchaseNotAllowed.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/Product/PurchaseError/ineligibleForOffer.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferPrice.md)
- [invalidOfferSignature](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferSignature.md)
- [invalidQuantity](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidQuantity.md)

---


#### productunavailable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case productUnavailable
```

## See Also

- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferIdentifier.md)
- [purchaseNotAllowed](../com.apple.storekit/StoreKit/Product/PurchaseError/purchaseNotAllowed.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/Product/PurchaseError/ineligibleForOffer.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferPrice.md)
- [invalidOfferSignature](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferSignature.md)
- [invalidQuantity](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidQuantity.md)
- [missingOfferParameters](../com.apple.storekit/StoreKit/Product/PurchaseError/missingOfferParameters.md)

---


#### purchasenotallowed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case purchaseNotAllowed
```

## See Also

- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferIdentifier.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/PurchaseError/productUnavailable.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/Product/PurchaseError/ineligibleForOffer.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferPrice.md)
- [invalidOfferSignature](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferSignature.md)
- [invalidQuantity](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidQuantity.md)
- [missingOfferParameters](../com.apple.storekit/StoreKit/Product/PurchaseError/missingOfferParameters.md)

---


### purchaseoption


#### subscriptionrenewalbehavior


##### cancelimmediately

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case cancelImmediately
```

## 

Choose this option for test cases that require an auto-renewable subscription that won’t renew.

## See Also

- [renewUntilNow](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior/renewUntilNow.md)

---


##### renewuntilnow

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case renewUntilNow
```

## 

Choose this option to create test cases that require an auto-renewable subscription that continues to renew. If you set the purchase date in [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/purchaseDate(_:renewalBehavior:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/purchaseDate(_:renewalBehavior:))to the past, the testing environment generates transactions for all the subscription renewals up to the current date.

## See Also

- [cancelImmediately](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior/cancelImmediately.md)

---


#### appaccounttoken(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func appAccountToken(_ token: UUID) -> Product.PurchaseOption
```

## Parameters

- **token**: A UUID you provide to associate with the purchase.

## 

An instance of [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption) to use in [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)).

## 

When you set the app account token in the purchase options, the App Store returns the same app account token value in the resulting transaction, in [doc://com.apple.storekit/documentation/StoreKit/Transaction/appAccountToken](doc://com.apple.storekit/documentation/StoreKit/Transaction/appAccountToken).

## See Also

- [winBackOffer(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/winBackOffer(_:).md)
- [promotionalOffer(offerID:keyID:nonce:signature:timestamp:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:keyID:nonce:signature:timestamp:).md)
- [promotionalOffer(offerID:signature:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:signature:).md)
- [quantity(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/quantity(_:).md)

---


#### codeoffer(referencename:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func codeOffer(referenceName: String) -> Product.PurchaseOption
```

## Parameters

- **referenceName**: The reference name of the offer code to apply to the transaction. You need to set up offer codes in your StoreKit configuration file.

## 

Use this purchase option when you test your app in Xcode using [doc://com.apple.documentation/documentation/StoreKitTest](doc://com.apple.documentation/documentation/StoreKitTest) and call [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/buyProduct(identifier:options:)](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/buyProduct(identifier:options:)).

Set up the offer codes to use in this call in your StoreKit configuration file. For more information, see [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

When you apply this option, the purchase transaction simulates a customer redeeming an offer code and includes the offer code you specify.

## See Also

- [purchaseDate(_:renewalBehavior:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/purchaseDate(_:renewalBehavior:).md)
- [SubscriptionRenewalBehavior](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior.md)
- [promotionalOffer(id:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(id:).md)

---


#### custom(key:value:)-3g3nc

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func custom(key: String, value: String) -> Product.PurchaseOption
```

## Parameters

- **key**: The key for this custom option.
- **value**: The string value you assign to this custom option.

## 

This custom purchase option doesn’t have any effect.

## See Also

- [custom(key:value:)-80cvh](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-80cvh.md)
- [custom(key:value:)-8tjim](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-8tjim.md)
- [custom(key:value:)-7rju9](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-7rju9.md)

---


#### custom(key:value:)-7rju9

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func custom(key: String, value: Double) -> Product.PurchaseOption
```

## Parameters

- **key**: The key for this custom option.
- **value**: The numerical value you assign to this custom option.

## 

This custom purchase option doesn’t have any effect.

## See Also

- [custom(key:value:)-80cvh](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-80cvh.md)
- [custom(key:value:)-3g3nc](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-3g3nc.md)
- [custom(key:value:)-8tjim](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-8tjim.md)

---


#### custom(key:value:)-80cvh

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func custom(key: String, value: Data) -> Product.PurchaseOption
```

## Parameters

- **key**: The key for this custom option.
- **value**: The data value you assign to this custom option.

## 

Use this custom option with the [doc://com.apple.documentation/documentation/AdvancedCommerceAPI](doc://com.apple.documentation/documentation/AdvancedCommerceAPI).

## See Also

- [custom(key:value:)-3g3nc](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-3g3nc.md)
- [custom(key:value:)-8tjim](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-8tjim.md)
- [custom(key:value:)-7rju9](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-7rju9.md)

---


#### custom(key:value:)-8tjim

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func custom(key: String, value: Bool) -> Product.PurchaseOption
```

## Parameters

- **key**: The key for this custom option.
- **value**: The Boolean value you assign to this custom option.

## 

This custom purchase option doesn’t have any effect.

## See Also

- [custom(key:value:)-80cvh](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-80cvh.md)
- [custom(key:value:)-3g3nc](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-3g3nc.md)
- [custom(key:value:)-7rju9](../com.apple.storekit/StoreKit/Product/PurchaseOption/custom(key:value:)-7rju9.md)

---


#### introductoryoffereligibility(compactjws:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.4, macOS 15.4, tvOS 18.4, watchOS 11.4, visionOS 2.4)
static func introductoryOfferEligibility(compactJWS: String) -> Product.PurchaseOption
```

## Parameters

- **compactJWS**: The signed JWT string with the introductory offer eligibility for the purchase.

---


#### promotionaloffer(_:compactjws:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 26.0, macOS 26.0, tvOS 26.0, watchOS 26.0, visionOS 26.0)
static func promotionalOffer(_ offerID: String, compactJWS: String) -> [Product.PurchaseOption]
```

## Parameters

- **offerID**: The `id` property of the `SubscriptionOffer` to apply.
- **compactJWS**: The JWS signature used to validate a promotional offer.

---


#### promotionaloffer(id:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func promotionalOffer(id identifier: String) -> Product.PurchaseOption
```

## Parameters

- **identifier**: The identifier of the promotional offer to apply to the transaction. You need to set up identifiers in your StoreKit configuration file.

## 

Use this purchase option when you test your app in Xcode using [doc://com.apple.documentation/documentation/StoreKitTest](doc://com.apple.documentation/documentation/StoreKitTest) and call [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/buyProduct(identifier:options:)](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/buyProduct(identifier:options:)). This method makes it possible to test promotional offers without supplying a signature.

Set up the promotional offer identifiers that you use in this call in your StoreKit configuration file. For more information, see [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

When you apply this option, the purchase transaction simulates a customer redeeming a promotional offer, and includes the promotional offer you specify.

## See Also

- [purchaseDate(_:renewalBehavior:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/purchaseDate(_:renewalBehavior:).md)
- [SubscriptionRenewalBehavior](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior.md)
- [codeOffer(referenceName:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/codeOffer(referenceName:).md)

---


#### promotionaloffer(offerid:keyid:nonce:signature:timestamp:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func promotionalOffer(offerID: String, keyID: String, nonce: UUID, signature: Data, timestamp: Int) -> Product.PurchaseOption
```

## Parameters

- **offerID**: The subscription-offer identifier, [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer/id](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer/id).
- **keyID**: The key ID of the subscription key.
- **nonce**: The antireplay value used in the signature. Use lowercase.
- **signature**: The cryptographic signature of the offer parameters, which you generate on your server.
- **timestamp**: The UNIX time, in milliseconds, when you generate the signature.

## 

An instance of [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption) to use in [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)).

## 

For information about `keyID`, `nonce`, `signature`, and `timestamp`, see [doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers](doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers). If you’re providing an [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/appAccountToken(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/appAccountToken(_:)) in the purchase options, you must include that value when you generate the `signature`. Use lowercase for the UUID string representations of the app account token and the `nonce` in the signature.

You can offer a discounted or free period of service for auto-renewable subscriptions on iOS, iPadOS, macOS, and tvOS using promotional offers. Before you can provide promotional offers in your app, you must set up the offers in your App Store Connect account. To configure your offer, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions).

## See Also

- [appAccountToken(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/appAccountToken(_:).md)
- [winBackOffer(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/winBackOffer(_:).md)
- [promotionalOffer(offerID:signature:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:signature:).md)
- [quantity(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/quantity(_:).md)

---


#### promotionaloffer(offerid:signature:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func promotionalOffer(offerID: String, signature: Product.SubscriptionOffer.Signature) -> Product.PurchaseOption
```

## See Also

- [appAccountToken(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/appAccountToken(_:).md)
- [winBackOffer(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/winBackOffer(_:).md)
- [promotionalOffer(offerID:keyID:nonce:signature:timestamp:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:keyID:nonce:signature:timestamp:).md)
- [quantity(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/quantity(_:).md)

---


#### purchasedate(_:renewalbehavior:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func purchaseDate(_ date: Date, renewalBehavior: Product.PurchaseOption.SubscriptionRenewalBehavior = .renewUntilNow) -> Product.PurchaseOption
```

## Parameters

- **date**: The purchase date for the transaction. Specify a date in the past or the current moment. Dates in the future aren’t valid.
- **renewalBehavior**: The renewal behavior for the auto-renewable subscription in this transaction, whether it renews continuously from the purchase date, or it cancels after the first period. By default, the subscription renews.

## 

Use this purchase option when you test your app in Xcode using [doc://com.apple.documentation/documentation/StoreKitTest](doc://com.apple.documentation/documentation/StoreKitTest) and call [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/buyProduct(identifier:options:)](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/buyProduct(identifier:options:)).

Use this purchase option to create useful transactions for your test cases. For example, use a date in the past with the default `renewalBehavior` to generate a full history of subscription renewals to test. Or, use a date in the past with the [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior/cancelImmediately](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior/cancelImmediately) behavior to simulate an account of a customer who canceled their subscription.

## See Also

- [SubscriptionRenewalBehavior](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior.md)
- [codeOffer(referenceName:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/codeOffer(referenceName:).md)
- [promotionalOffer(id:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(id:).md)

---


#### quantity(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func quantity(_ quantity: Int) -> Product.PurchaseOption
```

## Parameters

- **quantity**: The number of items the customer is purchasing. The default value is 1. The maximum value is 10.

## 

An instance of [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption) to use in [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)).

## 

The quantity applies to consumable in-app purchases and non-renewing subscriptions.

## See Also

- [appAccountToken(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/appAccountToken(_:).md)
- [winBackOffer(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/winBackOffer(_:).md)
- [promotionalOffer(offerID:keyID:nonce:signature:timestamp:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:keyID:nonce:signature:timestamp:).md)
- [promotionalOffer(offerID:signature:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:signature:).md)

---


#### simulatesasktobuyinsandbox(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func simulatesAskToBuyInSandbox(_ simulateAskToBuy: Bool) -> Product.PurchaseOption
```

## Parameters

- **simulateAskToBuy**: Set to `true` to simulate a child’s account asking permission to make a purchase.

## 

An instance of [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption) to use in [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)).

## 

For information about testing Ask to Buy scenarios, see [doc://com.apple.storekit/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox](doc://com.apple.storekit/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox).

For information about purchases made using Ask to Buy, see [https://support.apple.com/en-us/HT201089](https://support.apple.com/en-us/HT201089).

---


#### subscriptionrenewalbehavior

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum SubscriptionRenewalBehavior
```

## 

Use the subscription renewal behavior values when you use the [doc://com.apple.documentation/documentation/StoreKitTest/SKTestTransaction/purchaseDate](doc://com.apple.documentation/documentation/StoreKitTest/SKTestTransaction/purchaseDate) option to test your app in Xcode using [doc://com.apple.documentation/documentation/StoreKitTest](doc://com.apple.documentation/documentation/StoreKitTest).

## Topics

### Renewal behaviors in the testing environment

- [cancelImmediately](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior/cancelImmediately.md)
- [renewUntilNow](../com.apple.storekit/StoreKit/Product/PurchaseOption/SubscriptionRenewalBehavior/renewUntilNow.md)

## See Also

- [purchaseDate(_:renewalBehavior:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/purchaseDate(_:renewalBehavior:).md)
- [codeOffer(referenceName:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/codeOffer(referenceName:).md)
- [promotionalOffer(id:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(id:).md)

---


#### winbackoffer(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func winBackOffer(_ offer: Product.SubscriptionOffer) -> Product.PurchaseOption
```

## Parameters

- **offer**: The [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer) instance that represents the win-back offer to apply to the purchase.

## 

To test win-back offers in Xcode, set up the offers in your StoreKit configuration file. For more information, see [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

## See Also

- [appAccountToken(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/appAccountToken(_:).md)
- [promotionalOffer(offerID:keyID:nonce:signature:timestamp:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:keyID:nonce:signature:timestamp:).md)
- [promotionalOffer(offerID:signature:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:signature:).md)
- [quantity(_:)](../com.apple.storekit/StoreKit/Product/PurchaseOption/quantity(_:).md)

---


### purchaseresult


#### pending

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case pending
```

## 

If a pending purchase succeeds, StoreKit delivers the resulting [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) in the transaction [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).

## See Also

- [success(_:)](../com.apple.storekit/StoreKit/Product/PurchaseResult/success(_:).md)
- [userCancelled](../com.apple.storekit/StoreKit/Product/PurchaseResult/userCancelled.md)

---


### subscriptioninfo


#### renewalinfo


##### advancedcommerceinfo-swift.struct


###### item


####### priceincreaseinfo-swift.struct


######## status-swift.struct


######### accepted

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let accepted: Product.SubscriptionInfo.RenewalInfo.AdvancedCommerceInfo.Item.PriceIncreaseInfo.Status
```

## See Also

- [pending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/Status-swift.struct/pending.md)
- [scheduled](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/Status-swift.struct/scheduled.md)

---


######### scheduled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let scheduled: Product.SubscriptionInfo.RenewalInfo.AdvancedCommerceInfo.Item.PriceIncreaseInfo.Status
```

## See Also

- [pending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/Status-swift.struct/pending.md)
- [accepted](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/Status-swift.struct/accepted.md)

---


######## dependentskus

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let dependentSKUs: [String]
```

## 

You can provide a list of SKUs and create a contingency scenario in which a person’s refusal to agree to a price increase results in the App Store canceling other, bundled services (the *dependent SKUs*). If the price increase requires a personʼs consent, and they don’t consent but instead cancel the subscription in the Manage Subscriptions view, the App Store cancels the dependent SKUs.

> **IMPORTANT:** You can’t create chains of dependent SKUs; for example, if SKU A has a dependent SKU B, B can’t have its own dependent SKU, C. However, B can have its own price increase.

## See Also

- [price](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/price.md)
- [status-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/status-swift.property.md)

---


####### details-swift.typealias

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias Details = Transaction.AdvancedCommerceInfo.Item.Details
```

---


####### priceincreaseinfo-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let priceIncreaseInfo: Product.SubscriptionInfo.RenewalInfo.AdvancedCommerceInfo.Item.PriceIncreaseInfo?
```

## See Also

- [details-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/details-swift.property.md)

---


####### priceincreaseinfo-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct PriceIncreaseInfo
```

## Topics

### Information about a price increase

- [dependentSKUs](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/dependentSKUs.md)
- [price](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/price.md)
- [status-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/status-swift.property.md)

### Structures

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/Item/PriceIncreaseInfo-swift.struct/Status-swift.struct.md)

---


###### consistencytoken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let consistencyToken: String
```

## See Also

- [description](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/displayName.md)
- [items](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct/taxCode.md)

---


##### expirationreason-swift.struct


###### autorenewdisabled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let autoRenewDisabled: Product.SubscriptionInfo.RenewalInfo.ExpirationReason
```

## See Also

- [billingError](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError.md)
- [didNotConsentToPriceIncrease](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/didNotConsentToPriceIncrease.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/productUnavailable.md)
- [unknown](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/unknown.md)

---


###### billingerror

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let billingError: Product.SubscriptionInfo.RenewalInfo.ExpirationReason
```

## 

Check the value of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) to determine whether an auto-renewable subscription is in a billing retry state.

## See Also

- [autoRenewDisabled](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/autoRenewDisabled.md)
- [didNotConsentToPriceIncrease](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/didNotConsentToPriceIncrease.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/productUnavailable.md)
- [unknown](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/unknown.md)

---


###### didnotconsenttopriceincrease

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let didNotConsentToPriceIncrease: Product.SubscriptionInfo.RenewalInfo.ExpirationReason
```

## 

The customer didn’t consent to an auto-renewable subscription price increase that requires their consent, or to a subscription offer conversion that requires their consent, so the subscription expired.

For more information about subscription price increases that require customer consent, see [https://developer.apple.com/help/app-store-connect/reference/auto-renewable-subscription-price-increase-thresholds](https://developer.apple.com/help/app-store-connect/reference/auto-renewable-subscription-price-increase-thresholds). For more information about offer conversions that require customer consent, see [https://developer.apple.com/help/app-store-connect/reference/consent-for-subscription-offer-conversions](https://developer.apple.com/help/app-store-connect/reference/consent-for-subscription-offer-conversions).

## See Also

- [autoRenewDisabled](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/autoRenewDisabled.md)
- [billingError](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/productUnavailable.md)
- [unknown](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/unknown.md)

---


##### priceincreasestatus-swift.enum


###### agreed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case agreed
```

## 

There are two types of price increases for auto-renewable subscriptions: those that require customer consent, and those that don’t require customer consent. For a price increase that requires customer consent, this value indicates that the customer consented to the price increase. For a price increase that doesn’t require customer consent, this value indicates that the App Store informed the customer of the price increase and the subscription is subject to the price increase.

For more information about this value, see [doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions](doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions).

## See Also

- [noIncreasePending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/noIncreasePending.md)
- [pending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending.md)

---


###### noincreasepending

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case noIncreasePending
```

## 

For more information about this value, see [doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions](doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions).

## See Also

- [agreed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/agreed.md)
- [pending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending.md)

---


##### currentproductid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let currentProductID: String
```

---


##### eligiblewinbackofferids

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let eligibleWinBackOfferIDs: [String]
```

## 

Use this list to select an eligible win-back offer for a customer. The array contains strings that represent offer identifiers for win-back offers. You provide the offer identifier in App Store Connect when you configure a win-back offer.

The App Store sets the order of the eligible win-back offer IDs for each customer, with the best offer first. The order takes into account the available offers you configure in App Store Connect for the customer’s most recent subscription in the subscription group. Subscriptions in a Billing Grace Period or billing retry state aren’t eligible for win-back offers.

Get the complete offer details by searching for the identifier in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/winBackOffers](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/winBackOffers) property of the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) instance. To add the offer to a purchase when a customer accepts the offer, use the [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/winBackOffer(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/winBackOffer(_:)) purchase option. For more information, see [doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app).

When you test win-back offers with StoreKit Testing in Xcode, the system lists the offers in no particular order. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-xcode](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-xcode).

You can also use the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI) to get a list of eligible win-back offers, on your server. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-All-Subscription-Statuses](doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-All-Subscription-Statuses) and [doc://com.apple.documentation/documentation/AppStoreServerAPI/eligibleWinBackOfferIds](doc://com.apple.documentation/documentation/AppStoreServerAPI/eligibleWinBackOfferIds).

For information about configuring win-back offers in App Store Connect, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers).

## See Also

- [offer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer.md)
- [Offer-swift.struct](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct.md)

---


##### expirationreason-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let expirationReason: Product.SubscriptionInfo.RenewalInfo.ExpirationReason?
```

## 

This optional value is `nil` if the auto-renewable subscription is active and hasn’t expired.

## See Also

- [state](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state.md)
- [autoRenewPreference](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/autoRenewPreference.md)
- [willAutoRenew](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/willAutoRenew.md)
- [ExpirationReason-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct.md)

---


##### expirationreason-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct ExpirationReason
```

## Topics

### Getting the expiration reason

- [autoRenewDisabled](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/autoRenewDisabled.md)
- [billingError](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError.md)
- [didNotConsentToPriceIncrease](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/didNotConsentToPriceIncrease.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/productUnavailable.md)
- [unknown](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/unknown.md)

### Getting a localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/localizedDescription.md)

## See Also

- [state](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state.md)
- [autoRenewPreference](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/autoRenewPreference.md)
- [willAutoRenew](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/willAutoRenew.md)
- [expirationReason-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property.md)

---


##### graceperiodexpirationdate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let gracePeriodExpirationDate: Date?
```

## 

This value is `nil` if the subscription is not in a billing grace period.

This date is present if you enable Billing Grace Period for your app and the subscription is in the billing grace period. Ensure that your app provides full service for the subscription throughout the grace period, which ends on the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate).

A billing grace period occurs at the start of a billing retry state. Throughout the billing grace period, the value of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) is `true`, which indicates that Apple is attempting to automatically renew the subscription.

For information about supporting Billing Grace Period, see [https://help.apple.com/app-store-connect/#/dev58bda3212](https://help.apple.com/app-store-connect/#/dev58bda3212) and [doc://com.apple.storekit/documentation/StoreKit/reducing-involuntary-subscriber-churn](doc://com.apple.storekit/documentation/StoreKit/reducing-involuntary-subscriber-churn).

## See Also

- [isInBillingRetry](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry.md)

---


##### isinbillingretry

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let isInBillingRetry: Bool
```

## 

This field indicates whether Apple is attempting to automatically renew an expired subscription. If a subscription expires due to a billing issue, a value of `true` indicates that Apple is still trying to renew the subscription. If the subscription is in a billing grace period, the optional [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate) contains a date.

Use the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) value along with [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) for more insight, as the following table shows:

| Values | Description |
| --- | --- |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) is `false,`   [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) is `nil` | The auto-renewable subscription is active and not in a billing retry period.   The subscription is entitled to service. |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) is `true,`  [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) is [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError),  [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate) has a date | The auto-renewable subscription is in a billing grace period.   The subscription is entitled to service until the date in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate). |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) is `true,`  [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) is [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError),  [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate) is `nil` | The auto-renewable subscription is in a billing retry period.   The subscription is not entitled to service. |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) is `false,`   [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) is [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/billingError) | The auto-renewable subscription expired and billing retry wasn’t able to recover the subscription.  The subscription is not entitled to service. |

## See Also

- [gracePeriodExpirationDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate.md)

---


##### originaltransactionid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let originalTransactionID: UInt64
```

---


##### priceincreasestatus-swift.enum

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@frozen enum PriceIncreaseStatus
```

## 

For more information, see [doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions](doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions).

## Topics

### Getting Price Increase Status

- [noIncreasePending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/noIncreasePending.md)
- [agreed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/agreed.md)
- [pending](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending.md)

### Getting a Localized Description

- [localizedDescription](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/localizedDescription.md)

## See Also

- [managing-price-increases-for-auto-renewable-subscriptions](../com.apple.storekit/StoreKit/managing-price-increases-for-auto-renewable-subscriptions.md)
- [priceIncreaseStatus-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/priceIncreaseStatus-swift.property.md)

---


##### priceincreasestatus-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let priceIncreaseStatus: Product.SubscriptionInfo.RenewalInfo.PriceIncreaseStatus
```

## 

For more information about price increase status, see [doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions](doc://com.apple.storekit/documentation/StoreKit/managing-price-increases-for-auto-renewable-subscriptions).

## See Also

- [managing-price-increases-for-auto-renewable-subscriptions](../com.apple.storekit/StoreKit/managing-price-increases-for-auto-renewable-subscriptions.md)
- [PriceIncreaseStatus-swift.enum](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum.md)

---


##### recentsubscriptionstartdate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, macCatalyst 16.0)
var recentSubscriptionStartDate: Date { get }
```

## 

> **IMPORTANT:** Don’t use the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/recentSubscriptionStartDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/recentSubscriptionStartDate) date to calculate days of paid service. For more information about paid days of service, see [https://developer.apple.com/app-store/subscriptions/#revenue-after-one-year](https://developer.apple.com/app-store/subscriptions/#revenue-after-one-year).

## See Also

- [renewalDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalDate.md)

---


##### renewaldate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 17.0, macOS 14.0, tvOS 17.0, watchOS 10.0, macCatalyst 17.0)
var renewalDate: Date? { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalDate) is a value that’s always present for auto-renewable subscriptions, even for expired subscriptions. This date indicates the expiration date of the most recent auto-renewable subscription purchase, including renewals, and may be in the past. For subscriptions that renew successfully, the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalDate) is the date when the subscription renews.

## See Also

- [recentSubscriptionStartDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/recentSubscriptionStartDate.md)

---


##### renewalprice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
var renewalPrice: Decimal? { get }
```

## 

This value represents the renewal price of the auto-renewable subscription, in units of the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currency](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currency).

If the next billing period includes an offer specified by the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer) property, the renewal price value reflects the discount.

> **IMPORTANT:** For financial and accounting purposes, use the App Store Connect reporting tools. For more information, see [https://developer.apple.com/help/app-store-connect/getting-paid/download-financial-reports](https://developer.apple.com/help/app-store-connect/getting-paid/download-financial-reports) and [https://developer.apple.com/help/app-store-connect/measure-app-performance/overview-of-reporting-tools](https://developer.apple.com/help/app-store-connect/measure-app-performance/overview-of-reporting-tools).

## See Also

- [currency](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/currency.md)

---


##### willautorenew

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let willAutoRenew: Bool
```

## See Also

- [state](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state.md)
- [autoRenewPreference](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/autoRenewPreference.md)
- [expirationReason-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property.md)
- [ExpirationReason-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct.md)

---


#### renewalstate


##### expired

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let expired: Product.SubscriptionInfo.RenewalState
```

## See Also

- [subscribed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed.md)
- [inBillingRetryPeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod.md)
- [inGracePeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod.md)
- [revoked](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/revoked.md)

---


##### inbillingretryperiod

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let inBillingRetryPeriod: Product.SubscriptionInfo.RenewalState
```

## See Also

- [subscribed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed.md)
- [expired](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/expired.md)
- [inGracePeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod.md)
- [revoked](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/revoked.md)

---


##### ingraceperiod

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let inGracePeriod: Product.SubscriptionInfo.RenewalState
```

## 

An auto-renewable subscription in this state is entitled to service.

## See Also

- [subscribed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed.md)
- [expired](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/expired.md)
- [inBillingRetryPeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod.md)
- [revoked](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/revoked.md)

---


##### revoked

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let revoked: Product.SubscriptionInfo.RenewalState
```

## See Also

- [subscribed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed.md)
- [expired](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/expired.md)
- [inBillingRetryPeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod.md)
- [inGracePeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod.md)

---


##### subscribed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let subscribed: Product.SubscriptionInfo.RenewalState
```

## 

An auto-renewable subscription in this state is entitled to service.

## See Also

- [expired](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/expired.md)
- [inBillingRetryPeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod.md)
- [inGracePeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod.md)
- [revoked](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/revoked.md)

---


#### status-swift.struct


##### statuses

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Statuses
```

## See Also

- [updates](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/updates.md)
- [all](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/all.md)

---


#### grouplevel

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 17.0, macOS 14.0, tvOS 17.0, watchOS 10.0)
var groupLevel: Int { get }
```

## 

If you offer multiple auto-renewable subscriptions with different price tiers, you can assign each to a level in App Store Connect. Ranking your subscriptions determines the upgrade, downgrade, and crossgrade paths available.

Subscriptions with the highest level of service within a subscription group have a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel) value of `1`. Subscriptions with lower levels of service or content have [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel) values of `2` or greater. For example, when comparing two subscriptions, moving from a subscription with a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel) of `2` to a subscription with a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupLevel) of `1` represents an upgrade.

For more information on ranking, see [https://developer.apple.com/app-store/subscriptions/#ranking](https://developer.apple.com/app-store/subscriptions/#ranking). For information on assigning subscription levels in App Store Connect, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/offer-auto-renewable-subscriptions/#assign-subscription-levels](https://developer.apple.com/help/app-store-connect/manage-subscriptions/offer-auto-renewable-subscriptions/#assign-subscription-levels).

> **NOTE:** On systems earlier than iOS 17, macOS 14, tvOS 17, and watchOS 10, this property returns a sentinel value of `0` when you test your app using StoreKit Testing in Xcode or if there’s an unexpected server error.

## See Also

- [subscriptionGroupID](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/subscriptionGroupID.md)
- [groupDisplayName](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/groupDisplayName.md)

---


#### introductoryoffer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let introductoryOffer: Product.SubscriptionOffer?
```

## 

This value is `nil` if you don’t set up an introductory offer in App Store Connect. Use [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer) to determine whether the customer is eligible for an introductory offer.

## See Also

- [isEligibleForIntroOffer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer.md)
- [isEligibleForIntroOffer(for:)](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer(for:).md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)

---


#### iseligibleforintrooffer(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func isEligibleForIntroOffer(for groupID: String) async -> Bool
```

## Parameters

- **groupID**: The subscription group identifier to check eligibility for an introductory offer.

## 

`true` if the customer is eligible for an introductory offer on any auto-renewable subscription within the subscription group; `false` otherwise.

## 

This value may be `true` even if you haven’t set up an introductory offer in App Store Connect.

## See Also

- [isEligibleForIntroOffer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer.md)
- [introductoryOffer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/introductoryOffer.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)

---


#### iseligibleforintrooffer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var isEligibleForIntroOffer: Bool { get async }
```

## 

This value is `true` if the customer is eligible for an introductory offer on this auto-renewable subscription, or any auto-renewable subscription in the same subscription group; this value is `false` otherwise. This value may be `true` even if you haven’t set up an introductory offer in App Store Connect. The following example illustrates checking the [doc://com.apple.storekit/documentation/StoreKit/Product/subscription](doc://com.apple.storekit/documentation/StoreKit/Product/subscription) property of a product to determine whether the user is eligible for an introductory offer.

```swift
func eligibleForIntro(product: Product) async throws -> Bool {
    guard let renewableSubscription = product.subscription else {
        // No renewable subscription is available for this product.
        return false
    }
    if await renewableSubscription.isEligibleForIntroOffer {
        // The product is eligible for an introductory offer.
        return true
    }
    return false
}
```

To specify a customer’s eligibility for an introductory offer, see [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/introductoryOfferEligibility(compactJWS:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/introductoryOfferEligibility(compactJWS:)).

## See Also

- [isEligibleForIntroOffer(for:)](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer(for:).md)
- [introductoryOffer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/introductoryOffer.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)

---


#### promotionaloffers

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let promotionalOffers: [Product.SubscriptionOffer]
```

## 

This array is empty if you haven’t set up promotional offers in App Store Connect.

For more information about promotional offers, see [https://help.apple.com/app-store-connect/#/dev16dfca448](https://help.apple.com/app-store-connect/#/dev16dfca448).

---


#### renewalinfo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct RenewalInfo
```

## 

`Product.SubscriptionInfo.RenewalInfo` provides information about the next subscription renewal period. Check the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state) to determine whether the subscription will be active (subscribed), expired, or in another state at the next renewal period.

## Topics

### Getting the environment

- [environment](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/environment.md)

### Getting the transaction ID

- [originalTransactionID](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/originalTransactionID.md)

### Identifying the account

- [appAccountToken](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/appAccountToken.md)
- [appTransactionID](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/appTransactionID.md)

### Getting the product ID

- [currentProductID](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/currentProductID.md)

### Getting subscription dates

- [recentSubscriptionStartDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/recentSubscriptionStartDate.md)
- [renewalDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalDate.md)

### Getting the renewal or expiration state

- [state](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state.md)
- [autoRenewPreference](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/autoRenewPreference.md)
- [willAutoRenew](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/willAutoRenew.md)
- [expirationReason-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property.md)
- [ExpirationReason-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct.md)

### Getting offers

- [offer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer.md)
- [Offer-swift.struct](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct.md)
- [eligibleWinBackOfferIDs](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs.md)

### Getting the renewal price and currency

- [renewalPrice](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalPrice.md)
- [currency](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/currency.md)

### Getting billing status

- [isInBillingRetry](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry.md)
- [gracePeriodExpirationDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate.md)

### Getting the price increase status

- [managing-price-increases-for-auto-renewable-subscriptions](../com.apple.storekit/StoreKit/managing-price-increases-for-auto-renewable-subscriptions.md)
- [priceIncreaseStatus-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/priceIncreaseStatus-swift.property.md)
- [PriceIncreaseStatus-swift.enum](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum.md)

### Verifying subscription renewal information

- [deviceVerification](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerification.md)
- [deviceVerificationNonce](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerificationNonce.md)
- [signedDate](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/signedDate.md)

### Getting subscription renewal info in JSON format

- [jsonRepresentation](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/jsonRepresentation.md)

### Getting renewal information for Advanced Commerce API

- [advancedCommerceInfo-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/advancedCommerceInfo-swift.property.md)
- [AdvancedCommerceInfo-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/AdvancedCommerceInfo-swift.struct.md)

### Deprecated

- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offerID.md)
- [offerType](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offerType.md)
- [currencyCode](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/currencyCode.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offerPaymentModeStringRepresentation.md)
- [offerPeriodStringRepresentation](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offerPeriodStringRepresentation.md)

## See Also

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)
- [SubscriptionRenewalInfo](../com.apple.storekit/StoreKit/SubscriptionRenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)
- [SubscriptionRenewalState](../com.apple.storekit/StoreKit/SubscriptionRenewalState.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/SubscriptionPeriod.md)

---


#### renewalstate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct RenewalState
```

## 

A subscription’s renewal state indicates whether an auto-renewable subscription is entitled to service. Subscriptions in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed) and [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod) states are entitled to service.

Subscriptions in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/expired](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/expired), [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod), and [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/revoked](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/revoked) states aren’t entitled to service if the customer doesn’t have other [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct) items that give them entitlement to service for that subscription. For example, a customer may have a status in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/expired](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/expired) state for a subscription that they purchased individually, and another status in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed) state for the same subscription, which they get through Family Sharing. In that case, the customer has an entitlement to service for that subscription.

For more information about Family Sharing, see [doc://com.apple.storekit/documentation/StoreKit/supporting-family-sharing-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-family-sharing-in-your-app). For more information about entitlements, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements).

## Topics

### Getting the renewal state

- [subscribed](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed.md)
- [expired](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/expired.md)
- [inBillingRetryPeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inBillingRetryPeriod.md)
- [inGracePeriod](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod.md)
- [revoked](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/revoked.md)

### Getting a localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState/localizedDescription.md)

## See Also

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)
- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [SubscriptionRenewalInfo](../com.apple.storekit/StoreKit/SubscriptionRenewalInfo.md)
- [SubscriptionRenewalState](../com.apple.storekit/StoreKit/SubscriptionRenewalState.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/SubscriptionPeriod.md)

---


#### status(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func status(for groupID: String) async throws -> [Product.SubscriptionInfo.Status]
```

## Parameters

- **groupID**: The subscription group identifier of the subscription to get status for.

## 

An array of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct). This array is empty if the customer has never subscribed to a product in this subscription group.

## 

To get the subscription group identifier of a subscription, see [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/subscriptionGroupID](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/subscriptionGroupID) in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo), or [doc://com.apple.storekit/documentation/StoreKit/Transaction/subscriptionGroupID](doc://com.apple.storekit/documentation/StoreKit/Transaction/subscriptionGroupID) in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction). You originally create subscription group identifiers when you set up in-app purchases in App Store Connect. For more information, see [https://help.apple.com/app-store-connect/#/dev75708c031](https://help.apple.com/app-store-connect/#/dev75708c031).

Users can only buy one auto-renewable subscription within a group at a time. However, the returned array may contain multiple status values if your subscription supports Family Sharing, and the person has access to other subscriptions in the group through Family Sharing. For more information about Family Sharing, see [https://developer.apple.com/news/?id=ksfkdwpr](https://developer.apple.com/news/?id=ksfkdwpr).

## See Also

- [status-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/status-swift.property.md)
- [status(transactionID:)](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/status(transactionID:).md)
- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)

---


#### status(transactionid:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func status(transactionID: UInt64) async throws -> SubscriptionStatus?
```

## See Also

- [status-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/status-swift.property.md)
- [status(for:)](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/status(for:).md)
- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)

---


#### status-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var status: [Product.SubscriptionInfo.Status] { get async throws }
```

## 

This array is empty if the customer was never subscribed to a product in this subscription group.

The array can have more than one subscription status if your subscription supports Family Sharing. Provide the customer with service for the subscription based on the highest level of service where the state is [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed).

## See Also

- [status(for:)](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/status(for:).md)
- [status(transactionID:)](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/status(transactionID:).md)
- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)

---


#### status-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Status
```

## 

The subscription status provides renewal information signed by the App Store for subscriptions that a customer purchases.

## Topics

### Monitoring subscription status changes

- [updates](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/updates.md)
- [all](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/all.md)
- [Statuses](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/Statuses.md)

### Getting subscription status information

- [state](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/state.md)
- [renewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo.md)
- [transaction](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct/transaction.md)
- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)

## See Also

- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [SubscriptionRenewalInfo](../com.apple.storekit/StoreKit/SubscriptionRenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)
- [SubscriptionRenewalState](../com.apple.storekit/StoreKit/SubscriptionRenewalState.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/SubscriptionPeriod.md)

---


#### winbackoffers

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let winBackOffers: [Product.SubscriptionOffer]
```

## 

This list of win-back offers doesn’t take customer eligibility into account, and includes the available offers you’ve configured for the subscription. The customer may not be eligible for all the win-back offers in this array. To get the win-back offers that the customer is eligible for, use [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs) in the subscription renewal information.

For more information about win-back offers, see [doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app).

---


### subscriptionoffer


#### signature


##### init(keyid:nonce:timestamp:signature:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
init(keyID: String, nonce: UUID, timestamp: Int, signature: Data)
```

## Parameters

- **keyID**: A string that identifies the private key you use to generate the signature. You set up this key in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/generate-keys-for-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/generate-keys-for-in-app-purchases).
- **nonce**: A one-time UUID value that your server generates. Generate a new nonce for each signature. The string representation of the nonce you use in the signature must be lowercase.
- **timestamp**: A timestamp your server generates in UNIX time format, in milliseconds. The timestamp keeps the offer active for 24 hours.
- **signature**: The cryptographic signature your server generates to sign the promotional offer.

---


##### keyid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var keyID: String
```

## See Also

- [nonce](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/Signature/nonce.md)
- [signature](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/Signature/signature.md)
- [timestamp](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/Signature/timestamp.md)

---


#### offertype

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct OfferType
```

## Topics

### Getting offer types

- [introductory](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType/introductory.md)
- [promotional](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType/promotional.md)
- [winBack](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType/winBack.md)

### Getting a localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType/localizedDescription.md)

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [supporting-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/supporting-win-back-offers-in-your-app.md)
- [merchandising-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/merchandising-win-back-offers-in-your-app.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)

---


### subscriptionperiod


#### unit-swift.enum


##### formatstyle


###### format(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func format(_ value: Product.SubscriptionPeriod.Unit) -> String
```

---


##### formatstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct FormatStyle
```

## Topics

### Formatting subscription period units

- [format(_:)](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/FormatStyle/format(_:).md)

## See Also

- [formatted(_:)](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/formatted(_:).md)

---


##### formatted(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func formatted<S>(_ format: S) -> S.FormatOutput where S : FormatStyle, S.FormatInput == Product.SubscriptionPeriod.Unit
```

## See Also

- [FormatStyle](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/FormatStyle.md)

---


#### daterange(referencedate:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, macCatalyst 16.0)
func dateRange(referenceDate: Date = .now) -> Range<Date>
```

## Parameters

- **referenceDate**: A date you provide that indicates the lower bound of the returned date range. The default value is [doc://com.apple.documentation/documentation/Foundation/Date/now](doc://com.apple.documentation/documentation/Foundation/Date/now).

## 

The subscription period represented by two dates that are the lower bound and upper bound of the subscription period of the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod) instance.

## 

The date range calculates a single subscription period starting from the date you provide in `referenceDate`.

For example, if the subscription period of the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod) instance is one month, and the `referenceDate` is February 1, the date range contains February 1 and March 1. If the `referenceDate` is Feb 15, the date range contains February 15 and March 15.

Use the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/dateRange(referenceDate:)](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/dateRange(referenceDate:)) with a [doc://com.apple.documentation/documentation/Foundation/Date/ComponentsFormatStyle](doc://com.apple.documentation/documentation/Foundation/Date/ComponentsFormatStyle) to get a human-readable string representation of the subscription period.

Get the format style ([doc://com.apple.documentation/documentation/Foundation/Date/ComponentsFormatStyle](doc://com.apple.documentation/documentation/Foundation/Date/ComponentsFormatStyle)) corresponding to product’s storefront using the [doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle](doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle).

---


#### everysixmonths

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var everySixMonths: Product.SubscriptionPeriod { get }
```

## See Also

- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### everythreedays

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var everyThreeDays: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### everythreemonths

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var everyThreeMonths: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### everytwomonths

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var everyTwoMonths: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### everytwoweeks

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var everyTwoWeeks: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### formatted(_:referencedate:)-3t7wd

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, macCatalyst 16.0)
func formatted<S>(_ format: S, referenceDate: Date = .now) -> S.FormatOutput where S : FormatStyle, S.FormatInput == Range<Date>
```

## Parameters

- **format**: A format style that has a date range input. The format style for a product is [doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle](doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle).
- **referenceDate**: The lower bound date for a date range representing the subscription period. The default value is [doc://com.apple.documentation/documentation/Foundation/Date/now](doc://com.apple.documentation/documentation/Foundation/Date/now).

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/formatted(_:referenceDate:)-3t7wd](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/formatted(_:referenceDate:)-3t7wd) method with [doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle](doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle) to format the subscription period for the App Store locale, as the following example shows.

```swift
// Get a human-readable representation of a subscription period.
subscriptionPeriod.formatted(product.subscriptionPeriodFormatStyle, referenceDate: /* some date */)

```

## See Also

- [formatted(_:referenceDate:)-8s3ar](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/formatted(_:referenceDate:)-8s3ar.md)

---


#### formatted(_:referencedate:)-8s3ar

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func formatted<S>(_ format: S, referenceDate: Date = .now) -> S.FormatOutput where S : FormatStyle, S.FormatInput == Duration
```

## Parameters

- **format**: A format style that has a duration as an input.
- **referenceDate**: The starting date of the subscription period. The default value is [doc://com.apple.documentation/documentation/Foundation/Date/now](doc://com.apple.documentation/documentation/Foundation/Date/now).

## See Also

- [formatted(_:referenceDate:)-3t7wd](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/formatted(_:referenceDate:)-3t7wd.md)

---


#### monthly

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var monthly: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### unit-swift.enum

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum Unit
```

## Topics

### Getting the subscription period units

- [day](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/day.md)
- [month](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/month.md)
- [week](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/week.md)
- [year](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/year.md)

### Getting localized and debug descriptions

- [localizedDescription](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/localizedDescription.md)

### Getting the formatted description

- [formatted(_:)](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/formatted(_:).md)
- [FormatStyle](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum/FormatStyle.md)

## See Also

- [value](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/value.md)
- [unit-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/unit-swift.property.md)

---


#### unit-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let unit: Product.SubscriptionPeriod.Unit
```

## 

The units used to specify a subscription period include day, week, month, and year, as defined in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum).

To calculate the duration of one subscription period, multiply the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/unit-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/unit-swift.property) by the number of units ([doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/value](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/value)).

## See Also

- [value](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/value.md)
- [Unit-swift.enum](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/Unit-swift.enum.md)

---


#### weekly

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var weekly: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [yearly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/yearly.md)

---


#### yearly

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.0, macOS 15.0, tvOS 18.0, watchOS 11.0, visionOS 2.0)
static var yearly: Product.SubscriptionPeriod { get }
```

## See Also

- [everySixMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everySixMonths.md)
- [everyThreeDays](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeDays.md)
- [everyThreeMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyThreeMonths.md)
- [everyTwoMonths](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoMonths.md)
- [everyTwoWeeks](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/everyTwoWeeks.md)
- [monthly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/monthly.md)
- [weekly](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod/weekly.md)

---


### subscriptionrelationship


#### crossgrade

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let crossgrade: Product.SubscriptionRelationship
```

## See Also

- [all](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/all.md)
- [current](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/current.md)
- [downgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/downgrade.md)
- [upgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/upgrade.md)

---


#### downgrade

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let downgrade: Product.SubscriptionRelationship
```

## See Also

- [all](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/all.md)
- [crossgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/crossgrade.md)
- [current](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/current.md)
- [upgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/upgrade.md)

---


#### upgrade

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let upgrade: Product.SubscriptionRelationship
```

## See Also

- [all](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/all.md)
- [crossgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/crossgrade.md)
- [current](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/current.md)
- [downgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/downgrade.md)

---


### collectiontaskstate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum CollectionTaskState
```

## Topics

### Collection task states

- [loading](../com.apple.storekit/StoreKit/Product/CollectionTaskState/loading.md)
- [success(_:unavailable:)](../com.apple.storekit/StoreKit/Product/CollectionTaskState/success(_:unavailable:).md)
- [failure(_:)](../com.apple.storekit/StoreKit/Product/CollectionTaskState/failure(_:).md)

### Instance Properties

- [products](../com.apple.storekit/StoreKit/Product/CollectionTaskState/products.md)

## See Also

- [TaskState](../com.apple.storekit/StoreKit/Product/TaskState.md)

---


### currententitlement

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var currentEntitlement: VerificationResult<Transaction>? { get async }
```

## 

This value is `nil` if the customer isn’t currently entitled to this product. Current entitlement information applies only to non-consumables, non-renewing subscriptions, and auto-renewable subscriptions. The following example checks the current entitlement for a product.

```swift
guard let verificationResult = await product.currentEntitlement else {
    // The user isn’t currently entitled to this product.
    return
}

switch verificationResult {
case .verified(let transaction):
    // Check the transaction and give the user access to purchased 
    // content as appropriate.
    ...
case .unverified(let transaction, let verificationError):
    // Handle unverified transactions based 
    // on your business model.
    ...
}
```

---


### displayprice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let displayPrice: String
```

## 

Use this string to display the price, formatted for the locale. The storefront that the user’s device is connected to determines the locale. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Storefront](doc://com.apple.storekit/documentation/StoreKit/Storefront).

To perform arithmetic calculations with the price, use the [doc://com.apple.storekit/documentation/StoreKit/Product/price](doc://com.apple.storekit/documentation/StoreKit/Product/price) property instead.

## See Also

- [displayName](../com.apple.storekit/StoreKit/Product/displayName.md)
- [description](../com.apple.storekit/StoreKit/Product/description.md)
- [price](../com.apple.storekit/StoreKit/Product/price.md)
- [priceFormatStyle](../com.apple.storekit/StoreKit/Product/priceFormatStyle.md)
- [subscriptionPeriodFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodFormatStyle.md)
- [subscriptionPeriodUnitFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodUnitFormatStyle.md)

---


### priceformatstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, macCatalyst 16.0)
var priceFormatStyle: Decimal.FormatStyle.Currency { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/Product/priceFormatStyle](doc://com.apple.storekit/documentation/StoreKit/Product/priceFormatStyle) value is a localized number suitable for display. Use this value for localizing numbers derived from the [doc://com.apple.storekit/documentation/StoreKit/Product/price](doc://com.apple.storekit/documentation/StoreKit/Product/price) property, such as to calculate the price of two products as `$(`price * 2`)`.

To display the [doc://com.apple.storekit/documentation/StoreKit/Product/price](doc://com.apple.storekit/documentation/StoreKit/Product/price) directly, rather than making calculations, use the [doc://com.apple.storekit/documentation/StoreKit/Product/displayPrice](doc://com.apple.storekit/documentation/StoreKit/Product/displayPrice) string instead.

> **NOTE:** When using [doc://com.apple.storekit/documentation/StoreKit/Product/priceFormatStyle](doc://com.apple.storekit/documentation/StoreKit/Product/priceFormatStyle) on systems earlier than iOS 16, macOS 13, tvOS 16, and watchOS 9, the property may return a format style with a sentinel locale identifier of `“xx_XX”` in uncommon cases, including if the server has an error, or while testing your app using StoreKit Testing in Xcode. For StoreKit testing, use a later OS version.

## See Also

- [displayName](../com.apple.storekit/StoreKit/Product/displayName.md)
- [description](../com.apple.storekit/StoreKit/Product/description.md)
- [displayPrice](../com.apple.storekit/StoreKit/Product/displayPrice.md)
- [price](../com.apple.storekit/StoreKit/Product/price.md)
- [subscriptionPeriodFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodFormatStyle.md)
- [subscriptionPeriodUnitFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodUnitFormatStyle.md)

---


### products(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func products<Identifiers>(for identifiers: Identifiers) async throws -> [Product] where Identifiers : Collection, Identifiers.Element == String
```

## Parameters

- **identifiers**: A collection of unique in-app purchase product identifiers that you previously configured in App Store Connect. StoreKit ignores any duplicate identifiers in the collection.

## 

An array of products, returned from the App Store.

## 

Use this method to get an instance of [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product). Your app must have its product identifiers available to provide them to this function. The following example illustrates requesting two products using hard-coded identifiers.

```swift
let productIdentifiers = ["com.example.productA", "com.example.productB"]
let appProducts = try await Product.products(for: productIdentifiers)
```

You initially create product identifiers when you configure in-app purchases in App Store Connect; for more information, see [https://help.apple.com/app-store-connect/#/devae49fb316](https://help.apple.com/app-store-connect/#/devae49fb316). Your app can store or retrieve product identifiers in several ways, such as embedding the identifiers in the app bundle, or fetching them from your server.

If any identifiers are invalid or the App Store can’t find them, the App Store excludes them from the return value. The [doc://com.apple.storekit/documentation/StoreKit/Product/products(for:)](doc://com.apple.storekit/documentation/StoreKit/Product/products(for:)) function can throw a [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError) for system-related errors.

> **TIP:** Use a single request to fetch a large volume of products.

---


### promotioninfo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
struct PromotionInfo
```

## 

The `Product.PromotionInfo` structure represents promoted in-app purchases available in your app. You set up promoted in-app purchases using App Store Connect, including their default display order and visibility settings. Use this API to override and customize their order and visibility. Overrides are per device. They can take effect after the user launches the app at least once.

You don’t instantiate this structure. To get a list of `Product.PromotionInfo` objects, call the static method [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)) with a list of product identifiers that represent your promoted in-app purchases. Then call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/currentOrder](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/currentOrder) to get the list of `Product.PromotionInfo` objects. To change their order, call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)) with the promoted in-app purchases listed in the desired order. To change the order using product identifiers, call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)).

To prevent a promoted in-app purchase from appearing in the App Store on the device, there are two options:

- Hide the product by setting the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) value to [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/hidden) and calling [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()), or call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:)).
- Remove the product from the list by excluding it when you call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)) or [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)).

To cancel your overrides and return to the default order and visibility, call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)) or [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)) with an empty array.

For more information about promoting in-app purchases, see [doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app).

## Topics

### Getting the product ID

- [productID](../com.apple.storekit/StoreKit/Product/PromotionInfo/productID.md)

### Managing promotion order

- [updateProductOrder(byID:)](../com.apple.storekit/StoreKit/Product/PromotionInfo/updateProductOrder(byID:).md)

### Getting overridden order

- [currentOrder](../com.apple.storekit/StoreKit/Product/PromotionInfo/currentOrder.md)

### Managing promotion visibility

- [visibility-swift.property](../com.apple.storekit/StoreKit/Product/PromotionInfo/visibility-swift.property.md)
- [Visibility-swift.enum](../com.apple.storekit/StoreKit/Product/PromotionInfo/Visibility-swift.enum.md)
- [updateProductVisibility(_:for:)](../com.apple.storekit/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:).md)

### Updating order and visibility

- [update()](../com.apple.storekit/StoreKit/Product/PromotionInfo/update().md)
- [updateAll(_:)](../com.apple.storekit/StoreKit/Product/PromotionInfo/updateAll(_:).md)

## See Also

- [supporting-promoted-in-app-purchases-in-your-app](../com.apple.storekit/StoreKit/supporting-promoted-in-app-purchases-in-your-app.md)
- [PurchaseIntent](../com.apple.storekit/StoreKit/PurchaseIntent.md)
- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)

---


### purchase(confirmin:options:)-3bivf

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS, visionOS

```swift
func purchase(confirmIn viewController: UIViewController, options: Set<Product.PurchaseOption> = []) async throws -> Product.PurchaseResult
```

## Parameters

- **viewController**: The view controller to show purchase confirmation UI in proximity to.
- **options**: A set of options to configure the purchase.

## 

The result of the purchase

## 

> **NOTE:** A `PurchaseError` or `StoreKitError`.

## See Also

- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [purchase(confirmIn:options:)-6dj6y](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-6dj6y.md)
- [purchase(confirmIn:options:)-8eai6](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-8eai6.md)
- [PurchaseOption](../com.apple.storekit/StoreKit/Product/PurchaseOption.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)
- [PurchaseError](../com.apple.storekit/StoreKit/Product/PurchaseError.md)

---


### purchase(confirmin:options:)-6dj6y

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS, visionOS

```swift
@MainActor func purchase(confirmIn scene: some UIScene, options: Set<Product.PurchaseOption> = []) async throws -> Product.PurchaseResult
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIScene](doc://com.apple.documentation/documentation/UIKit/UIScene) the system uses to show the purchase confirmation UI.
- **options**: A set of options ([doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption)) you can associate with the purchase.

## 

The result of the purchase, [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult).

## 

StoreKit provides several APIs you can use to enable customers to initiate a purchase. Before using [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y), consider the following APIs and choose the one that best suits your app’s implementation:

- Use [doc://com.apple.storekit/documentation/StoreKit/PurchaseAction](doc://com.apple.storekit/documentation/StoreKit/PurchaseAction) for apps that use [doc://com.apple.documentation/documentation/SwiftUI](doc://com.apple.documentation/documentation/SwiftUI) on any platform, including multi-scene apps for visionOS.
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y) for apps that use [doc://com.apple.documentation/documentation/UIKit](doc://com.apple.documentation/documentation/UIKit).
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-8eai6](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-8eai6) for apps that run on macOS and use [doc://com.apple.documentation/documentation/AppKit](doc://com.apple.documentation/documentation/AppKit).
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) for apps that runs on watchOS.

> **IMPORTANT:** If you use StoreKit views such as [doc://com.apple.storekit/documentation/StoreKit/ProductView](doc://com.apple.storekit/documentation/StoreKit/ProductView), [doc://com.apple.storekit/documentation/StoreKit/StoreView](doc://com.apple.storekit/documentation/StoreKit/StoreView), or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView) you don’t need to call any other API to initiate a purchase. StoreKit manages the purchase action automatically, including presenting the purchase confirmation UI. For more information, see [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views).

This method may throw a [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseError](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseError) or [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError).

## See Also

- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [purchase(confirmIn:options:)-3bivf](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-3bivf.md)
- [purchase(confirmIn:options:)-8eai6](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-8eai6.md)
- [PurchaseOption](../com.apple.storekit/StoreKit/Product/PurchaseOption.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)
- [PurchaseError](../com.apple.storekit/StoreKit/Product/PurchaseError.md)

---


### purchase(confirmin:options:)-8eai6

## Declaration

**Platforms:** macOS

```swift
func purchase(confirmIn window: NSWindow, options: Set<Product.PurchaseOption> = []) async throws -> Product.PurchaseResult
```

## Parameters

- **window**: The window to show purchase confirmation UI in proximity to.
- **options**: A set of options to configure the purchase.

## 

The result of the purchase

## 

> **NOTE:** A `PurchaseError` or `StoreKitError`.

## See Also

- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [purchase(confirmIn:options:)-6dj6y](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-6dj6y.md)
- [purchase(confirmIn:options:)-3bivf](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-3bivf.md)
- [PurchaseOption](../com.apple.storekit/StoreKit/Product/PurchaseOption.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)
- [PurchaseError](../com.apple.storekit/StoreKit/Product/PurchaseError.md)

---


### purchase(options:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
@MainActor func purchase(options: Set<Product.PurchaseOption> = []) async throws -> Product.PurchaseResult
```

## Parameters

- **options**: A set of options you can associate with the purchase.

## 

Returns a [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult).

## 

StoreKit provides several APIs you can use to enable customers to initiate a purchase. Before using [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) consider the following APIs and choose the one that best suits your app’s implementation:

- Use [doc://com.apple.storekit/documentation/StoreKit/PurchaseAction](doc://com.apple.storekit/documentation/StoreKit/PurchaseAction) for apps that use [doc://com.apple.documentation/documentation/SwiftUI](doc://com.apple.documentation/documentation/SwiftUI) on any platform, including multi-scene apps for visionOS.
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y) for apps that use [doc://com.apple.documentation/documentation/UIKit](doc://com.apple.documentation/documentation/UIKit).
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-8eai6](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-8eai6) for apps that run on macOS and use [doc://com.apple.documentation/documentation/AppKit](doc://com.apple.documentation/documentation/AppKit).
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) for apps that runs on watchOS.

> **IMPORTANT:** If you use StoreKit views such as [doc://com.apple.storekit/documentation/StoreKit/ProductView](doc://com.apple.storekit/documentation/StoreKit/ProductView), [doc://com.apple.storekit/documentation/StoreKit/StoreView](doc://com.apple.storekit/documentation/StoreKit/StoreView), or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView) you don’t need to call any other API to initiate a purchase. StoreKit manages the purchase action automatically, including presenting the purchase confirmation UI. For more information, see [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views).

### 

Call the [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) method when a customer initiates a purchase, either within your app or after selecting a promoted in-app purchase on the App Store. This method brings up the system-confirmation sheet. The user can confirm to complete the transaction or cancel it.

Include the purchase options to provide additional information about the purchase, such as:

- [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/appAccountToken(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/appAccountToken(_:)) to associate the purchase with the resulting transaction
- [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:keyID:nonce:signature:timestamp:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/promotionalOffer(offerID:keyID:nonce:signature:timestamp:)), if the customer is redeeming a promotional offer for an auto-renewable subscription
- [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/quantity(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/quantity(_:)), if the customer is purchasing more than one of the product

The following example illustrates calling [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) using the `options` parameter to provide an app account token:

```swift
let appAccountToken = <# Generate an app account token. #>
let purchaseResult = try await product.purchase(options: [
    .appAccountToken(appAccountToken)
])
```

If you’re testing your app in the sandbox environment, test an Ask to Buy scenario by setting the [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/simulatesAskToBuyInSandbox(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/simulatesAskToBuyInSandbox(_:)) purchase option to `true`. For more information about Ask to Buy, see [https://support.apple.com/en-us/HT201089](https://support.apple.com/en-us/HT201089).

This method may throw a [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseError](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseError) or [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError).

For more information about purchases that users initiate on the App Store, see [doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases).

## See Also

- [PurchaseAction](../com.apple.storekit/StoreKit/PurchaseAction.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)

---


### purchaseerror

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum PurchaseError
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) function may throw a purchase error.

## Topics

### Getting Purchase Error Codes

- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferIdentifier.md)
- [productUnavailable](../com.apple.storekit/StoreKit/Product/PurchaseError/productUnavailable.md)
- [purchaseNotAllowed](../com.apple.storekit/StoreKit/Product/PurchaseError/purchaseNotAllowed.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/Product/PurchaseError/ineligibleForOffer.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferPrice.md)
- [invalidOfferSignature](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidOfferSignature.md)
- [invalidQuantity](../com.apple.storekit/StoreKit/Product/PurchaseError/invalidQuantity.md)
- [missingOfferParameters](../com.apple.storekit/StoreKit/Product/PurchaseError/missingOfferParameters.md)

## See Also

- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [purchase(confirmIn:options:)-6dj6y](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-6dj6y.md)
- [purchase(confirmIn:options:)-3bivf](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-3bivf.md)
- [purchase(confirmIn:options:)-8eai6](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-8eai6.md)
- [PurchaseOption](../com.apple.storekit/StoreKit/Product/PurchaseOption.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)

---


### subscriptionoffer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SubscriptionOffer
```

## 

You set up subscription offers, such as introductory offers and win-back offers, in App Store Connect.

For more information about subscription offers, see [https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers](https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers). For information about configuring the various types of subscription offers in App Store Connect, see:

- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-offer-codes/](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-offer-codes/)
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-introductory-offers-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-introductory-offers-for-auto-renewable-subscriptions)
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions)
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers)

## Topics

### Getting the subscription offer identifier

- [id](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/id.md)

### Getting the subscription offer type

- [type](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/type.md)
- [OfferType](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType.md)

### Getting price information

- [displayPrice](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/displayPrice.md)
- [price](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/price.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/paymentMode-swift.property.md)
- [PaymentMode-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/PaymentMode-swift.struct.md)

### Getting the subscription duration

- [period](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/period.md)
- [periodCount](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/periodCount.md)

### Creating a subscription offer signature

- [Signature](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/Signature.md)

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [supporting-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/supporting-win-back-offers-in-your-app.md)
- [merchandising-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/merchandising-win-back-offers-in-your-app.md)
- [OfferType](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType.md)

---


### subscriptionperiodformatstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, macCatalyst 16.0)
var subscriptionPeriodFormatStyle: Date.ComponentsFormatStyle { get }
```

## 

Use this format style to format text that describes a subscription period, including its length and unit, such as “1 week”, “2 months”, and so on. Use this style with the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/formatted(_:referenceDate:)-3t7wd](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod/formatted(_:referenceDate:)-3t7wd) method on [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionPeriod) to format the subscription period for the App Store locale.

> **NOTE:** When using [doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle](doc://com.apple.storekit/documentation/StoreKit/Product/subscriptionPeriodFormatStyle) on systems earlier than iOS 16, macOS 13, tvOS 16, and watchOS 9, the property may return a format style with a sentinel locale identifier of `“xx_XX”` in uncommon cases, including if the server has an error, or while testing your app using StoreKit Testing in Xcode. For StoreKit testing, use a later OS version.

## See Also

- [displayName](../com.apple.storekit/StoreKit/Product/displayName.md)
- [description](../com.apple.storekit/StoreKit/Product/description.md)
- [displayPrice](../com.apple.storekit/StoreKit/Product/displayPrice.md)
- [price](../com.apple.storekit/StoreKit/Product/price.md)
- [priceFormatStyle](../com.apple.storekit/StoreKit/Product/priceFormatStyle.md)
- [subscriptionPeriodUnitFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodUnitFormatStyle.md)

---


### subscriptionperiodunitformatstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var subscriptionPeriodUnitFormatStyle: Product.SubscriptionPeriod.Unit.FormatStyle { get }
```

## See Also

- [displayName](../com.apple.storekit/StoreKit/Product/displayName.md)
- [description](../com.apple.storekit/StoreKit/Product/description.md)
- [displayPrice](../com.apple.storekit/StoreKit/Product/displayPrice.md)
- [price](../com.apple.storekit/StoreKit/Product/price.md)
- [priceFormatStyle](../com.apple.storekit/StoreKit/Product/priceFormatStyle.md)
- [subscriptionPeriodFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodFormatStyle.md)

---


### subscriptionrelationship

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SubscriptionRelationship
```

## Topics

### Getting subscription relationships

- [all](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/all.md)
- [crossgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/crossgrade.md)
- [current](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/current.md)
- [downgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/downgrade.md)
- [upgrade](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship/upgrade.md)

---


### taskstate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum TaskState
```

## Topics

### Task states

- [loading](../com.apple.storekit/StoreKit/Product/TaskState/loading.md)
- [success(_:)](../com.apple.storekit/StoreKit/Product/TaskState/success(_:).md)
- [unavailable](../com.apple.storekit/StoreKit/Product/TaskState/unavailable.md)
- [failure(_:)](../com.apple.storekit/StoreKit/Product/TaskState/failure(_:).md)

### Instance Properties

- [product](../com.apple.storekit/StoreKit/Product/TaskState/product.md)

## See Also

- [CollectionTaskState](../com.apple.storekit/StoreKit/Product/CollectionTaskState.md)

---


## producticonphase


### promotionalicon

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var promotionalIcon: Image? { get }
```

## 

This value is `nil` while the image is loading, or if the system can’t access the promotional image for any reason. Use this value as a convenience to access the image in code that doesn’t depend on the reason an image may not be accessible.

For information about setting up promotional images, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

---


### unavailable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case unavailable
```

## 

You set up promotional images for in-app purchases in App Store Connect.

## See Also

- [loading](../com.apple.storekit/StoreKit/ProductIconPhase/loading.md)
- [success(_:)](../com.apple.storekit/StoreKit/ProductIconPhase/success(_:).md)
- [failure(_:)](../com.apple.storekit/StoreKit/ProductIconPhase/failure(_:).md)

---


## productviewstyle


### compact

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
@MainActor @preconcurrency static var compact: CompactProductViewStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/ProductViewStyle/automatic.md)
- [large](../com.apple.storekit/StoreKit/ProductViewStyle/large.md)
- [regular](../com.apple.storekit/StoreKit/ProductViewStyle/regular.md)

---


### large

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor @preconcurrency static var large: LargeProductViewStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/ProductViewStyle/automatic.md)
- [compact](../com.apple.storekit/StoreKit/ProductViewStyle/compact.md)
- [regular](../com.apple.storekit/StoreKit/ProductViewStyle/regular.md)

---


### regular

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency static var regular: RegularProductViewStyle { get }
```

## See Also

- [automatic](../com.apple.storekit/StoreKit/ProductViewStyle/automatic.md)
- [compact](../com.apple.storekit/StoreKit/ProductViewStyle/compact.md)
- [large](../com.apple.storekit/StoreKit/ProductViewStyle/large.md)

---


## productviewstyleconfiguration


### hascurrententitlement

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let hasCurrentEntitlement: Bool
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/ProductViewStyleConfiguration/hasCurrentEntitlement](doc://com.apple.storekit/documentation/StoreKit/ProductViewStyleConfiguration/hasCurrentEntitlement) property to determine whether a purchase may succeed, for a porduct that people can purchase only once. For example, if hasCurrentEntitlement is false, you may choose not to display a purchase button for the product, because the person has already purchased it.

> **IMPORTANT:** Don’t use this value to determine whether to enable access to the product; check the in-app purchase transaction information instead ([doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction)).

## See Also

- [product](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/product.md)
- [state](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/state.md)

---


### icon-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let icon: ProductViewStyleConfiguration.Icon
```

## See Also

- [Icon-swift.struct](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/Icon-swift.struct.md)

---


### icon-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct Icon
```

## See Also

- [icon-swift.property](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/icon-swift.property.md)

---


### purchase()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func purchase()
```

## 

Use this method instead of calling [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:))directly on the product.

---


## purchaseaction


### callasfunction(_:compactjws:options:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency func callAsFunction(_ advancedCommerceProduct: AdvancedCommerceProduct, compactJWS: String, options: Set<AdvancedCommerceProduct.PurchaseOption> = []) async throws -> AdvancedCommerceProduct.PurchaseResult
```

---


### callasfunction(_:options:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency func callAsFunction(_ product: Product, options: Set<Product.PurchaseOption> = []) async throws -> Product.PurchaseResult
```

## Parameters

- **product**: The in-app purchase [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) the customer is purchasing.
- **options**: A set of options you may associate with the purchase ([doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption)).

## 

The result of the purchase, [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult).

## 

Don’t call this method directly. SwiftUI calls it when you call the [doc://com.apple.storekit/documentation/StoreKit/PurchaseAction](doc://com.apple.storekit/documentation/StoreKit/PurchaseAction) structure with the `product` and `options` as arguments.

This method may throw a [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseError](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseError) or [doc://com.apple.storekit/documentation/StoreKit/StoreKitError](doc://com.apple.storekit/documentation/StoreKit/StoreKitError).

For information about how Swift uses the [doc://com.apple.storekit/documentation/StoreKit/PurchaseAction/callAsFunction(_:options:)](doc://com.apple.storekit/documentation/StoreKit/PurchaseAction/callAsFunction(_:options:)) method to simplify call site syntax, see [https://docs.swift.org/swift-book/documentation/the-swift-programming-language/declarations/#Methods-with-Special-Names](https://docs.swift.org/swift-book/documentation/the-swift-programming-language/declarations/#Methods-with-Special-Names) in *The Swift Programming Language*.

---


## skadnetwork


### coarseconversionvalue


#### high

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static let high: SKAdNetwork.CoarseConversionValue
```

## 

This constant has no special meaning. It’s up to the app or ad network to determine its meaning as needed.

## See Also

- [low](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/low.md)
- [medium](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/medium.md)
- [init(rawValue:)](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/init(rawValue:).md)

---


#### low

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static let low: SKAdNetwork.CoarseConversionValue
```

## 

This constant has no special meaning. It’s up to the app or ad network to determine its meaning as needed.

## See Also

- [high](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/high.md)
- [medium](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/medium.md)
- [init(rawValue:)](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/init(rawValue:).md)

---


#### medium

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
static let medium: SKAdNetwork.CoarseConversionValue
```

## 

This constant has no special meaning. It’s up to the app or ad network to determine its meaning as needed.

## See Also

- [high](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/high.md)
- [low](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/low.md)
- [init(rawValue:)](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/init(rawValue:).md)

---


### coarseconversionvalue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
struct CoarseConversionValue
```

## 

When you provide the coarse conversion value to the [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)) or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) methods, use the static constants [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/low](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/low), [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/medium](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/medium), or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/high](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/high).

These constants have no special meaning. The app or ad network can define their meaning, as is useful for their ad campaigns. The app is responsible for assigning a coarse conversion value, as well as the fine conversion value, when it calls one of the conversion value methods. You can determine how the coarse and fine conversion values relate to the types of conversion events you want to measure.

## Topics

### Providing coarse conversion values

- [high](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/high.md)
- [low](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/low.md)
- [medium](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/medium.md)
- [init(rawValue:)](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue/init(rawValue:).md)

## See Also

- [updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:).md)
- [updatePostbackConversionValue(_:coarseValue:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:).md)
- [updatePostbackConversionValue(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:).md)

---


### endimpression(_:completionhandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func endImpression(_ impression: SKAdImpression, completionHandler completion: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func endImpression(_ impression: SKAdImpression) async throws
```

## Parameters

- **impression**: An instance of [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) with the properties set for the view-through ad that you presented. This must be the same instance you provide in [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)).
- **completion**: The callback handler you provide to handle any tasks relevant to concluding the ad impression.

## 

Call this method when you end the presentation of a view-through ad and it’s no longer visible to the user. To help ensure it’s a valid impression, StoreKit only records the impression if the ad displays for a minimum amount of time. That minimum is 2 seconds on devices running iOS 15.4 and iPadOS 15.4 and later, and 3 seconds on devices running earlier versions of iOS and iPadOS. If the app displays the ad for fewer than the minimum number of seconds, StoreKit doesn’t record the ad impression for attribution.

> **NOTE:** To ensure that SKAdNetwork records the impression, call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) after the impression ends, regardless of whether [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)) returns an error in the completion handler.

StoreKit records a maximum of 15 view-through ad impressions per source app for various products before discarding the oldest-recorded impression.

For more information about ad impressions and attributions, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

## See Also

- [generating-the-signature-to-validate-view-through-ads](../com.apple.storekit/StoreKit/generating-the-signature-to-validate-view-through-ads.md)
- [SKAdImpression](../com.apple.storekit/StoreKit/SKAdImpression.md)
- [startImpression(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/startImpression(_:completionHandler:).md)

---


### registerappforadnetworkattribution()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func registerAppForAdNetworkAttribution()
```

## 

Apps that an ad network campaign advertise call this method or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)) when the app first launches. Both methods generate an install notification, which is the cryptographically signed data that validates that a user installed and launched this app as a result of an ad.

In iOS 15.4 and earlier, the first call to [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution()](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution()) generates the notification if the device has attribution data for that app, and starts a 24-hour timer. Subsequent calls to this method have no effect, unless the ad already has a conversion value set, in which case calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution()](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution()) resets the conversion value to `0`. You may, however, call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)) to provide an updated conversion value and restart the timer.

The device sends one or more install notifications to ad network postback URLs within 0-24 hours after the timer expires. For more information about attribution-winning and non-winning postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

Ad networks must verify the postback after receiving it. For more information, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

## See Also

- [updateConversionValue(_:)](../com.apple.storekit/StoreKit/SKAdNetwork/updateConversionValue(_:).md)

---


### startimpression(_:completionhandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func startImpression(_ impression: SKAdImpression, completionHandler completion: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func startImpression(_ impression: SKAdImpression) async throws
```

## Parameters

- **impression**: An instance of [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) with the properties set for the view-through ad that you’re presenting.
- **completion**: The callback handler you provide to handle any tasks relevant to the start of the ad impression.

## 

Call this method when you start presenting the view-through ad to the user. If you call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)) more than once for the same advertised app before calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)), the latest impression overwrites the earlier impression.

Call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) when the impression ends and is no longer visible to the user.

> **NOTE:** To ensure that SKAdNetwork records the impression, call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) after the impression ends, regardless of whether [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)) returns an error in the completion handler.

## See Also

- [generating-the-signature-to-validate-view-through-ads](../com.apple.storekit/StoreKit/generating-the-signature-to-validate-view-through-ads.md)
- [SKAdImpression](../com.apple.storekit/StoreKit/SKAdImpression.md)
- [endImpression(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/endImpression(_:completionHandler:).md)

---


### updateconversionvalue(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updateConversionValue(_ conversionValue: Int)
```

## Parameters

- **conversionValue**: An unsigned 6-bit value (`>=0` and `<=63`). The app or the ad network determines the meaning of the value. The default value is `0`.

## 

Apps that ad networks advertise call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)) or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution()](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution()) when the app first launches, to register the attribution.

> **IMPORTANT:** Provide a valid conversion value within the range of `>=0` and `<=63` when calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)) to register the attribution. Invalid conversion values cause the method to fail, and the conversion to fail to register.

Apps may call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)) again within a rolling 24-hour period to update the conversion value. Calling this method serves two purposes:

- It registers the attribution by generating an install notification — the cryptographically signed data that confirms that a user installed and launched this app as a result of an ad.
- It enables the app to provide and update a conversion value.

Conversion values are a 6-bit value that the ad network or the app defines. The app decides when to update the value, which it can do any number of times before a rolling 24-hour timer expires. The 24-hour timer restarts each time the app calls this method with a valid conversion value greater than the previous value. When the timer expires, the conversion value is final and subsequent calls to [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)) have no effect.

The device sends the install notification postback to the ad network’s URL within 0-24 hours after the timer expires. The postback only contains the final conversion value if sending the data meets Apple’s privacy threshold. Only postbacks with an ad attribution can contain a conversion value; non-winning postbacks don’t include a conversion value. For more information, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

Ad networks must verify the postback after receiving it. See [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback) for more information.

## See Also

- [registerAppForAdNetworkAttribution()](../com.apple.storekit/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution().md)

---


### updatepostbackconversionvalue(_:coarsevalue:completionhandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updatePostbackConversionValue(_ fineValue: Int, coarseValue: SKAdNetwork.CoarseConversionValue, completionHandler completion: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updatePostbackConversionValue(_ fineValue: Int, coarseValue: SKAdNetwork.CoarseConversionValue) async throws
```

## Parameters

- **fineValue**: An unsigned 6-bit value `≥0` and `≤63`. The app or the ad network defines the meaning of the conversion value.
- **coarseValue**: An [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue) value. The app or the ad network defines the meaning of this value.
- **completion**: An optional completion handler you provide to catch and handle any errors this method encounters when you update a conversion value. Set this value to `nil` if you don’t provide a handler.

## 

Call this method when the user first launches an app to register the app installation, and optionally again, to update conversion values as the user engages with the app.

This method is identical to calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) with the `lockWindow` parameter set to `false`.

This method returns [doc://com.apple.storekit/documentation/StoreKit/SKANError-swift.struct/Code/invalidConversionValue](doc://com.apple.storekit/documentation/StoreKit/SKANError-swift.struct/Code/invalidConversionValue) if the `fineValue` is outside of the allowed range.

> **IMPORTANT:** The system ignores calls to this method if the `fineValue` is outside of the valid range. Valid conversion updates your app sends before or after an invalid conversion remain available.

## See Also

- [updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:).md)
- [CoarseConversionValue](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue.md)
- [updatePostbackConversionValue(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:).md)

---


### updatepostbackconversionvalue(_:coarsevalue:lockwindow:completionhandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updatePostbackConversionValue(_ fineValue: Int, coarseValue: SKAdNetwork.CoarseConversionValue, lockWindow: Bool, completionHandler completion: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updatePostbackConversionValue(_ fineValue: Int, coarseValue: SKAdNetwork.CoarseConversionValue, lockWindow: Bool) async throws
```

## Parameters

- **fineValue**: An unsigned 6-bit value `≥0` and `≤63`. The app or the ad network defines the meaning of the fine conversion value.
- **coarseValue**: An [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue) value of [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/low](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/low), [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/medium](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/medium), or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/high](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue/high). The app or the ad network defines the meaning of the coarse conversion value.
- **lockWindow**: A Boolean value that indicates whether to send the postback before the conversion window ends. Use `true` to tell the system to send the postback without waiting for the end of the conversion window. The default value is `false`.
- **completion**: An optional completion handler you provide to catch and handle any errors this method encounters when you update a conversion value. Set this value to `nil` if you don’t provide a handler.

## 

Call this method when the user first launches an app to register the app installation, and again to update conversion values as the user engages with the app. It’s up to your app to decide what the conversion values signify in your app, both the `fineValue` and the `coarseValue`.

This method supports ads signed with any verison of SKAdNetwork, and you can use it instead of calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)) and [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)). The system automatically determines the method’s behavior based on the ad’s version, as the following sections describe — the app doesn’t need to know the ad version. To take advantage of the multiple postbacks available starting in version 4, use this method or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)).

This method returns [doc://com.apple.storekit/documentation/StoreKit/SKANError-swift.struct/Code/invalidConversionValue](doc://com.apple.storekit/documentation/StoreKit/SKANError-swift.struct/Code/invalidConversionValue) if the `fineValue` is outside of the allowed range.

> **IMPORTANT:** The system ignores calls to this method if the `fineValue` is outside of the valid range. Valid conversion updates your app sends before or after an invalid conversion remain available.

### 

For ads that ad networks sign using version 4 or later, calling this method behaves as follows:

- Both the `fineValue` and `coarseValue` represent conversion values. The method ignores the `fineValue` after the first conversion window.
- Setting the `lockWindow` parameter to `true` indicates a final update for the conversion value for the current conversion window. The system ignores additional calls to update the conversion value until the end of the conversion window.
- Setting the `lockWindow` parameter to `false` continues updating the conversion value throughout the conversion window.

For information about the data you may receive in postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

### 

For ads that ad networks sign using version 3 or earlier, calling this method behaves as follows:

- The `fineValue` represents the conversion value.
- The method ignores the `coarseValue` and `lockWindow` parameters.
- There’s a single conversion period that ends after a rolling 24-hour timer expires. The 24-hour timer restarts each time the app calls this method with a valid conversion value greater than the previous value. When the timer expires, the conversion value is final and subsequent calls to this method have no effect.
- The device sends the postback 0–24 hours after the timer expires.
- The postback contains the final conversion value only if the postback data tier contains the value.

For more information about SKAdNetwork versions, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

## See Also

- [updatePostbackConversionValue(_:coarseValue:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:).md)
- [CoarseConversionValue](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue.md)
- [updatePostbackConversionValue(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:).md)

---


### updatepostbackconversionvalue(_:completionhandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updatePostbackConversionValue(_ conversionValue: Int, completionHandler completion: (((any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class func updatePostbackConversionValue(_ conversionValue: Int) async throws
```

## Parameters

- **conversionValue**: An unsigned 6-bit value `≥0` and `≤63`. The app or the ad network defines the meaning of the conversion value. For ad impressions signed with SKAdNetwork 3 or earlier, you need to increase the `conversionValue` each time you call this method. For ad impressions signed with SKAdNetwork 4 or later, you may use any valid `conversionValue` each time you call this method.
- **completion**: An optional completion handler you provide to catch and handle any errors this method encounters when you update a conversion value. Set this value to `nil` if you don’t provide a handler.

## 

Invalid conversion values cause the method to fail and return error [doc://com.apple.storekit/documentation/StoreKit/SKANError-swift.struct/Code/invalidConversionValue](doc://com.apple.storekit/documentation/StoreKit/SKANError-swift.struct/Code/invalidConversionValue).

> **NOTE:** Consider using [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) instead of this method for newer implementations.

Apps call this method to update conversion values as people engage with the app. It’s up to the app or ad network to define the conversion value’s meaning. Call this method immediately when the user first launches the app to confirm the app’s launch. Call this method again, as needed, to reflect the person’s engagement with the app.

The final conversion value appears in the postback if sending the data meets Apple’s privacy threshold. Only postbacks that win the ad attribution can contain a conversion value. Nonwinning postbacks don’t contain conversion values. For more information, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

The way this method behaves depends on the ad’s version, as described in the following sections. Ad networks determine an ad’s version when they sign the ad. For more information about signing ads, see [doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads](doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads).

### 

If the ad network signs the winning ad with version 3 or earlier, calling this method behaves as follows:

- Apps may call this method repeatedly before a rolling 24-hour timer expires.
- The 24-hour timer restarts each time the app calls this method with a valid `conversionValue` that’s greater than the previous value.
- When the timer expires, the conversion value is final and subsequent calls to [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)) have no effect.
- The device sends the postback to the ad network’s URL within 0 to 24 hours after the timer expires. The postback contains the final conversion value only if sending the data meets Apple’s privacy threshold.

### 

> **NOTE:** This method supports ads signed with version 4 and later, however, it doesn’t provide advanced features, such as multiple postbacks and coarse conversion values, available starting in version 4. To get those advanced features for ads signed with version 4 and later, use [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) instead of this method.

If the ad network signs the winning ad with version 4 or later, calling this method behaves as follows:

- Apps may call this method repeatedly within the first conversion window.
- Provide any `conversionValue` within the valid range; the `conversionValue` doesn’t need to increase with each call.
- This method is available only during the first conversion window. Use [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) to update conversion values in the subsequent conversion windows.
- When the first conversion window closes, the system sends the postback within 0 to 24 hours. The postback contains the final conversion value only if sending the data meets Apple’s privacy threshold.

## See Also

- [updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:).md)
- [updatePostbackConversionValue(_:coarseValue:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:).md)
- [CoarseConversionValue](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue.md)

---


## skarcadeservice


### arcadesubscriptionstatus(withnonce:resulthandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
class func arcadeSubscriptionStatus(withNonce nonce: UInt64, resultHandler: @escaping (Data?, UInt32, Data?, UInt32, (any Error)?) -> Void)
```

## See Also

- [registerArcadeAppWithRandom(fromLib:randomFromLibLength:resultHandler:)](../com.apple.storekit/StoreKit/SKArcadeService/registerArcadeAppWithRandom(fromLib:randomFromLibLength:resultHandler:).md)
- [repairArcadeApp()](../com.apple.storekit/StoreKit/SKArcadeService/repairArcadeApp().md)

---


### registerarcadeappwithrandom(fromlib:randomfromliblength:resulthandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
class func registerArcadeAppWithRandom(fromLib randomFromLib: Data, randomFromLibLength: UInt32, resultHandler: @escaping (Data?, UInt32, Data?, UInt32, (any Error)?) -> Void)
```

## See Also

- [arcadeSubscriptionStatus(withNonce:resultHandler:)](../com.apple.storekit/StoreKit/SKArcadeService/arcadeSubscriptionStatus(withNonce:resultHandler:).md)
- [repairArcadeApp()](../com.apple.storekit/StoreKit/SKArcadeService/repairArcadeApp().md)

---


### repairarcadeapp()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
class func repairArcadeApp()
```

## See Also

- [arcadeSubscriptionStatus(withNonce:resultHandler:)](../com.apple.storekit/StoreKit/SKArcadeService/arcadeSubscriptionStatus(withNonce:resultHandler:).md)
- [registerArcadeAppWithRandom(fromLib:randomFromLibLength:resultHandler:)](../com.apple.storekit/StoreKit/SKArcadeService/registerArcadeAppWithRandom(fromLib:randomFromLibLength:resultHandler:).md)

---


## skcloudserviceauthorizationstatus


### authorized

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case authorized
```

## See Also

- [notDetermined](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined.md)
- [denied](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/denied.md)
- [restricted](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/restricted.md)

---


### denied

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case denied
```

## See Also

- [notDetermined](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined.md)
- [restricted](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/restricted.md)
- [authorized](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/authorized.md)

---


### notdetermined

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case notDetermined
```

## See Also

- [denied](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/denied.md)
- [restricted](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/restricted.md)
- [authorized](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/authorized.md)

---


### restricted

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case restricted
```

## See Also

- [notDetermined](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined.md)
- [denied](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/denied.md)
- [authorized](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/authorized.md)

---


## skcloudservicecapability


### addtocloudmusiclibrary

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
static var addToCloudMusicLibrary: SKCloudServiceCapability { get }
```

## See Also

- [musicCatalogPlayback](../com.apple.storekit/StoreKit/SKCloudServiceCapability/musicCatalogPlayback.md)
- [musicCatalogSubscriptionEligible](../com.apple.storekit/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible.md)

---


### musiccatalogplayback

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
static var musicCatalogPlayback: SKCloudServiceCapability { get }
```

## See Also

- [musicCatalogSubscriptionEligible](../com.apple.storekit/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible.md)
- [addToCloudMusicLibrary](../com.apple.storekit/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary.md)

---


### musiccatalogsubscriptioneligible

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
static var musicCatalogSubscriptionEligible: SKCloudServiceCapability { get }
```

## See Also

- [musicCatalogPlayback](../com.apple.storekit/StoreKit/SKCloudServiceCapability/musicCatalogPlayback.md)
- [addToCloudMusicLibrary](../com.apple.storekit/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary.md)

---


### skcloudservicecapabilitynone

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
SKCloudServiceCapabilityNone
```

---


## skcloudservicesetupaction


### subscribe

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let subscribe: SKCloudServiceSetupAction
```

---


## skcloudservicesetupoptionskey


### action

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let action: SKCloudServiceSetupOptionsKey
```

## See Also

- [SKCloudServiceSetupAction](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction.md)
- [iTunesItemIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/iTunesItemIdentifier.md)
- [affiliateToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [messageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier.md)
- [SKCloudServiceSetupMessageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier.md)

---


### affiliatetoken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let affiliateToken: SKCloudServiceSetupOptionsKey
```

## See Also

- [action](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/action.md)
- [SKCloudServiceSetupAction](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction.md)
- [iTunesItemIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/iTunesItemIdentifier.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [messageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier.md)
- [SKCloudServiceSetupMessageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier.md)

---


### itunesitemidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let iTunesItemIdentifier: SKCloudServiceSetupOptionsKey
```

## 

The only iTunes Store items that are supported are song, video, playlist, and album.

## See Also

- [action](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/action.md)
- [SKCloudServiceSetupAction](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction.md)
- [affiliateToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [messageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier.md)
- [SKCloudServiceSetupMessageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier.md)

---


### messageidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
static let messageIdentifier: SKCloudServiceSetupOptionsKey
```

## 

If this key is missing, the setup view is configured as if it is using the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/join](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/join) key by default.

## See Also

- [action](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/action.md)
- [SKCloudServiceSetupAction](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction.md)
- [iTunesItemIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/iTunesItemIdentifier.md)
- [affiliateToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [SKCloudServiceSetupMessageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier.md)

---


## skcloudservicesetupviewcontroller


### load(options:completionhandler:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor func load(options: [SKCloudServiceSetupOptionsKey : Any] = [:], completionHandler: ((Bool, (any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor func load(options: [SKCloudServiceSetupOptionsKey : Any] = [:]) async throws -> Bool
```

## Parameters

- **options**: A key that identifies the type of setup the user needs to do. See [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey) for possible values.
- **completionHandler**: A block that is called when the setup view has loaded. The block takes the following parameters: `result` A Boolean value that indicates whether the view controller has loaded the view and can be presented. `error` An error value that indicates the reason for failure. Possible values are [doc://com.apple.storekit/documentation/StoreKit/SKError/Code/unknown](doc://com.apple.storekit/documentation/StoreKit/SKError/Code/unknown), [doc://com.apple.storekit/documentation/StoreKit/SKError/Code/cloudServicePermissionDenied](doc://com.apple.storekit/documentation/StoreKit/SKError/Code/cloudServicePermissionDenied), and [doc://com.apple.storekit/documentation/StoreKit/SKError/Code/cloudServiceNetworkConnectionFailed](doc://com.apple.storekit/documentation/StoreKit/SKError/Code/cloudServiceNetworkConnectionFailed).

## 

## See Also

- [offering-apple-music-subscription-in-your-app](../com.apple.storekit/StoreKit/offering-apple-music-subscription-in-your-app.md)
- [SKCloudServiceSetupOptionsKey](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey.md)
- [SKArcadeService](../com.apple.storekit/StoreKit/SKArcadeService.md)

---


## skcloudservicesetupviewcontrollerdelegate


### cloudservicesetupviewcontrollerdiddismiss(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
optional func cloudServiceSetupViewControllerDidDismiss(_ cloudServiceSetupViewController: SKCloudServiceSetupViewController)
```

## Parameters

- **cloudServiceSetupViewController**: The cloud service view controller that was dismissed.

---


## skdownloadstate


### active

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case active
```

## See Also

- [waiting](../com.apple.storekit/StoreKit/SKDownloadState/waiting.md)
- [paused](../com.apple.storekit/StoreKit/SKDownloadState/paused.md)
- [finished](../com.apple.storekit/StoreKit/SKDownloadState/finished.md)
- [failed](../com.apple.storekit/StoreKit/SKDownloadState/failed.md)
- [cancelled](../com.apple.storekit/StoreKit/SKDownloadState/cancelled.md)

---


### cancelled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case cancelled
```

## See Also

- [waiting](../com.apple.storekit/StoreKit/SKDownloadState/waiting.md)
- [active](../com.apple.storekit/StoreKit/SKDownloadState/active.md)
- [paused](../com.apple.storekit/StoreKit/SKDownloadState/paused.md)
- [finished](../com.apple.storekit/StoreKit/SKDownloadState/finished.md)
- [failed](../com.apple.storekit/StoreKit/SKDownloadState/failed.md)

---


### failed

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case failed
```

## See Also

- [waiting](../com.apple.storekit/StoreKit/SKDownloadState/waiting.md)
- [active](../com.apple.storekit/StoreKit/SKDownloadState/active.md)
- [paused](../com.apple.storekit/StoreKit/SKDownloadState/paused.md)
- [finished](../com.apple.storekit/StoreKit/SKDownloadState/finished.md)
- [cancelled](../com.apple.storekit/StoreKit/SKDownloadState/cancelled.md)

---


### finished

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case finished
```

## See Also

- [waiting](../com.apple.storekit/StoreKit/SKDownloadState/waiting.md)
- [active](../com.apple.storekit/StoreKit/SKDownloadState/active.md)
- [paused](../com.apple.storekit/StoreKit/SKDownloadState/paused.md)
- [failed](../com.apple.storekit/StoreKit/SKDownloadState/failed.md)
- [cancelled](../com.apple.storekit/StoreKit/SKDownloadState/cancelled.md)

---


### paused

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case paused
```

## See Also

- [waiting](../com.apple.storekit/StoreKit/SKDownloadState/waiting.md)
- [active](../com.apple.storekit/StoreKit/SKDownloadState/active.md)
- [finished](../com.apple.storekit/StoreKit/SKDownloadState/finished.md)
- [failed](../com.apple.storekit/StoreKit/SKDownloadState/failed.md)
- [cancelled](../com.apple.storekit/StoreKit/SKDownloadState/cancelled.md)

---


### waiting

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
case waiting
```

## See Also

- [active](../com.apple.storekit/StoreKit/SKDownloadState/active.md)
- [paused](../com.apple.storekit/StoreKit/SKDownloadState/paused.md)
- [finished](../com.apple.storekit/StoreKit/SKDownloadState/finished.md)
- [failed](../com.apple.storekit/StoreKit/SKDownloadState/failed.md)
- [cancelled](../com.apple.storekit/StoreKit/SKDownloadState/cancelled.md)

---


## skoverlaydelegate


### storeoverlaydidfailtoload(_:error:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
optional func storeOverlayDidFailToLoad(_ overlay: SKOverlay, error: any Error)
```

## Parameters

- **overlay**: An overlay object that failed to load.
- **error**: An indication of why the overlay failed to load.

## 

Common cases for a failure when loading an overlay are:

- Using invalid iTunes identifiers.
- Trying to present an overlay for media that’s not an app.
- Trying to present an overlay from an app extension or the simulator.

---


### storeoverlaydidfinishdismissal(_:transitioncontext:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
optional func storeOverlayDidFinishDismissal(_ overlay: SKOverlay, transitionContext: SKOverlay.TransitionContext)
```

## Parameters

- **overlay**: An app banner object that disappeared.
- **transitionContext**: The context you can use to animate changes to UI components when the overlay disappears.

## See Also

- [storeOverlayWillStartPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:).md)
- [storeOverlayDidFinishPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishPresentation(_:transitionContext:).md)
- [storeOverlayWillStartDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:).md)
- [TransitionContext](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext.md)

---


### storeoverlaydidfinishpresentation(_:transitioncontext:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
optional func storeOverlayDidFinishPresentation(_ overlay: SKOverlay, transitionContext: SKOverlay.TransitionContext)
```

## Parameters

- **overlay**: The overlay object that appears.
- **transitionContext**: A context you can use to animate changes to UI components after the overlay appears.

## See Also

- [storeOverlayWillStartPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:).md)
- [storeOverlayWillStartDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:).md)
- [storeOverlayDidFinishDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishDismissal(_:transitionContext:).md)
- [TransitionContext](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext.md)

---


### storeoverlaywillstartdismissal(_:transitioncontext:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
optional func storeOverlayWillStartDismissal(_ overlay: SKOverlay, transitionContext: SKOverlay.TransitionContext)
```

## Parameters

- **overlay**: An overlay object that’s about to disappear.
- **transitionContext**: The context you can use to animate changes to UI components when the overlay disappears.

## 

Use the `transitionContext` parameter to animate updates to the UI on the main thread. For example, make a [doc://com.apple.documentation/documentation/UIKit/UIImageView](doc://com.apple.documentation/documentation/UIKit/UIImageView) appear by animating the change of its opacity to 100%`,` as shown in the following code:

```swift
func storeOverlayWillStartDismissal(_ overlay: SKOverlay, transitionContext: SKOverlay.TransitionContext) {
    transitionContext.addAnimation { [self] in
        self.imageView.layer.opacity = 1
    }
}
```

## See Also

- [storeOverlayWillStartPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:).md)
- [storeOverlayDidFinishPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishPresentation(_:transitionContext:).md)
- [storeOverlayDidFinishDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishDismissal(_:transitionContext:).md)
- [TransitionContext](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext.md)

---


### storeoverlaywillstartpresentation(_:transitioncontext:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
optional func storeOverlayWillStartPresentation(_ overlay: SKOverlay, transitionContext: SKOverlay.TransitionContext)
```

## Parameters

- **overlay**: An overlay object that’s about to appear.
- **transitionContext**: A context you can use to animate changes to UI components as the overlay appears.

## 

Use the `transitionContext` parameter to animate updates to the UI on the main thread. For example, make a [doc://com.apple.documentation/documentation/UIKit/UIImageView](doc://com.apple.documentation/documentation/UIKit/UIImageView) disappear by animating the change of its opacity to 0% as shown in the following code:

```swift
func storeOverlayWillStartPresentation(_ overlay: SKOverlay, transitionContext: SKOverlay.TransitionContext) {
    transitionContext.addAnimation { [self] in
        self.imageView.layer.opacity = 0
    }
}
```

## See Also

- [storeOverlayDidFinishPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishPresentation(_:transitionContext:).md)
- [storeOverlayWillStartDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:).md)
- [storeOverlayDidFinishDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishDismissal(_:transitionContext:).md)
- [TransitionContext](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext.md)

---


## skpayment


### paymentwithproductidentifier:

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
+ (id) paymentWithProductIdentifier:(NSString *) identifier;
```

## Parameters

- **identifier**: A string that identifies the item to be purchased.

## 

A new payment object.

## 

The product identifier is a string previously agreed on between your application and the Apple App Store. The quantity property defaults to `1`.

To create a [doc://com.apple.storekit/documentation/StoreKit/SKPayment](doc://com.apple.storekit/documentation/StoreKit/SKPayment) object with a quantity greater than `1`, create a `SKMutablePayment` object, adjust its [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/quantity](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/quantity) property and then add it to the payment queue:

```objc
SKMutablePayment *myPayment = [SKMutablePayment paymentWithProductIdentifier: myIdentifier];
myPayment.quantity = 2;
[[SKPaymentQueue defaultQueue] addPayment:myPayment];
```

## See Also

- [init(product:)](../com.apple.storekit/StoreKit/SKPayment/init(product:).md)

---


## skpaymenttransaction


### downloads

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var downloads: [SKDownload] { get }
```

## 

The contents of this property are undefined except when [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is set to [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased). The [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects stored in this property must be used to download the transaction’s content before the transaction is finished. After the transaction is finished, the download objects are no longer queueable.

---


### original

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var original: SKPaymentTransaction? { get }
```

## 

The contents of this property are undefined except when [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is set to [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored). When a transaction is restored, the current transaction holds a new transaction identifier, receipt, and so on. Your application will read this property to retrieve the restored transaction.

## See Also

- [payment](../com.apple.storekit/StoreKit/SKPaymentTransaction/payment.md)
- [transactionIdentifier](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionIdentifier.md)
- [transactionDate](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionDate.md)
- [error](../com.apple.storekit/StoreKit/SKPaymentTransaction/error.md)
- [transactionReceipt](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionReceipt.md)

---


### payment

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var payment: SKPayment { get }
```

## 

Each payment transaction is created in response to a payment that your application added to the payment queue.

## See Also

- [transactionIdentifier](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionIdentifier.md)
- [transactionDate](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionDate.md)
- [original](../com.apple.storekit/StoreKit/SKPaymentTransaction/original.md)
- [error](../com.apple.storekit/StoreKit/SKPaymentTransaction/error.md)
- [transactionReceipt](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionReceipt.md)

---


### transactiondate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var transactionDate: Date? { get }
```

## 

The contents of this property are undefined except when [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is set to [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored).

## See Also

- [payment](../com.apple.storekit/StoreKit/SKPaymentTransaction/payment.md)
- [transactionIdentifier](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionIdentifier.md)
- [original](../com.apple.storekit/StoreKit/SKPaymentTransaction/original.md)
- [error](../com.apple.storekit/StoreKit/SKPaymentTransaction/error.md)
- [transactionReceipt](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionReceipt.md)

---


### transactionidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var transactionIdentifier: String? { get }
```

## 

The contents of this property are undefined except when [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is set to [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored). The [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionIdentifier) is a string that uniquely identifies an interaction between the user’s device and the App Store, such as a purchase or restore.

This value has the same format as the transaction’s [doc://com.apple.documentation/documentation/AppStoreReceipts/transaction_id](doc://com.apple.documentation/documentation/AppStoreReceipts/transaction_id) in the receipt; however, the values may not be the same.

## See Also

- [payment](../com.apple.storekit/StoreKit/SKPaymentTransaction/payment.md)
- [transactionDate](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionDate.md)
- [original](../com.apple.storekit/StoreKit/SKPaymentTransaction/original.md)
- [error](../com.apple.storekit/StoreKit/SKPaymentTransaction/error.md)
- [transactionReceipt](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionReceipt.md)

---


### transactionreceipt

## Declaration

**Platforms:** tvOS

```swift
var transactionReceipt: Data? { get }
```

## 

The contents of this property are undefined except when [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/transactionState) is set to [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased).

The receipt is a signed chunk of data that can be sent to the App Store to verify that the payment was successfully processed. This is most useful when designing a store that uses a server separate from the iPhone to verify that payment was processed. For more information on verifying receipts, see [https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Introduction.html#//apple_ref/doc/uid/TP40010573](https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Introduction.html#//apple_ref/doc/uid/TP40010573).

## See Also

- [payment](../com.apple.storekit/StoreKit/SKPaymentTransaction/payment.md)
- [transactionIdentifier](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionIdentifier.md)
- [transactionDate](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionDate.md)
- [original](../com.apple.storekit/StoreKit/SKPaymentTransaction/original.md)
- [error](../com.apple.storekit/StoreKit/SKPaymentTransaction/error.md)

---


### transactionstate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var transactionState: SKPaymentTransactionState { get }
```

## See Also

- [SKPaymentTransactionState](../com.apple.storekit/StoreKit/SKPaymentTransactionState.md)

---


## skpaymenttransactionstate


### deferred

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case deferred
```

## 

Update your UI to show the deferred state, and wait for another callback that indicates the final status.

## See Also

- [purchasing](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchasing.md)
- [purchased](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchased.md)
- [failed](../com.apple.storekit/StoreKit/SKPaymentTransactionState/failed.md)
- [restored](../com.apple.storekit/StoreKit/SKPaymentTransactionState/restored.md)

---


### purchasing

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case purchasing
```

## See Also

- [purchased](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchased.md)
- [failed](../com.apple.storekit/StoreKit/SKPaymentTransactionState/failed.md)
- [restored](../com.apple.storekit/StoreKit/SKPaymentTransactionState/restored.md)
- [deferred](../com.apple.storekit/StoreKit/SKPaymentTransactionState/deferred.md)

---


### restored

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case restored
```

## 

Read the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/original](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/original) property to obtain information about the original purchase.

## See Also

- [purchasing](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchasing.md)
- [purchased](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchased.md)
- [failed](../com.apple.storekit/StoreKit/SKPaymentTransactionState/failed.md)
- [deferred](../com.apple.storekit/StoreKit/SKPaymentTransactionState/deferred.md)

---


## skproduct


### periodunit


#### day

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case day
```

## See Also

- [month](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/month.md)
- [week](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/week.md)
- [year](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/year.md)

---


#### month

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case month
```

## See Also

- [day](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/day.md)
- [week](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/week.md)
- [year](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/year.md)

---


#### week

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case week
```

## See Also

- [day](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/day.md)
- [month](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/month.md)
- [year](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/year.md)

---


#### year

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case year
```

## See Also

- [day](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/day.md)
- [month](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/month.md)
- [week](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/week.md)

---


### contentlengths

## Declaration

**Platforms:** macOS

```swift
var contentLengths: [NSNumber] { get }
```

## See Also

- [localizedDescription](../com.apple.storekit/StoreKit/SKProduct/localizedDescription.md)
- [localizedTitle](../com.apple.storekit/StoreKit/SKProduct/localizedTitle.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKProduct/contentVersion.md)
- [isFamilyShareable](../com.apple.storekit/StoreKit/SKProduct/isFamilyShareable.md)

---


### discounts

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var discounts: [SKProductDiscount] { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts](doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts) array contains all of the introductory offers and promotional offers that you set up in App Store Connect for this subscription ([doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier)).  It’s up to the logic in your app to decide which offer to present to the user.

For more information about offers, see [doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app), and [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app).

## See Also

- [price](../com.apple.storekit/StoreKit/SKProduct/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProduct/priceLocale.md)
- [introductoryPrice](../com.apple.storekit/StoreKit/SKProduct/introductoryPrice.md)
- [SKProductDiscount](../com.apple.storekit/StoreKit/SKProductDiscount.md)

---


### downloadable

## Declaration

**Platforms:** macOS

```swift
var downloadable: Bool { get }
```

## 

You can associate a set of data files with the App Store Connect record you created for a product. The value of this property is [doc://com.apple.documentation/documentation/Swift/true](doc://com.apple.documentation/documentation/Swift/true) if at least one file has been associated with the product.

## See Also

- [isDownloadable](../com.apple.storekit/StoreKit/SKProduct/isDownloadable.md)
- [downloadContentLengths](../com.apple.storekit/StoreKit/SKProduct/downloadContentLengths.md)
- [downloadContentVersion](../com.apple.storekit/StoreKit/SKProduct/downloadContentVersion.md)

---


### downloadcontentlengths

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var downloadContentLengths: [NSNumber] { get }
```

## 

The array holds [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber) objects, each of which holds a `long long` value that is the size of one of the downloadable files (in bytes).

## See Also

- [isDownloadable](../com.apple.storekit/StoreKit/SKProduct/isDownloadable.md)
- [downloadContentVersion](../com.apple.storekit/StoreKit/SKProduct/downloadContentVersion.md)
- [downloadable](../com.apple.storekit/StoreKit/SKProduct/downloadable.md)

---


### downloadcontentversion

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var downloadContentVersion: String { get }
```

## 

The version string is formatted as a series of integers separated by periods.

## See Also

- [isDownloadable](../com.apple.storekit/StoreKit/SKProduct/isDownloadable.md)
- [downloadContentLengths](../com.apple.storekit/StoreKit/SKProduct/downloadContentLengths.md)
- [downloadable](../com.apple.storekit/StoreKit/SKProduct/downloadable.md)

---


### introductoryprice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var introductoryPrice: SKProductDiscount? { get }
```

## 

If you’ve set up introductory prices in App Store Connect, the introductory price property will be populated. This property is `nil` if the product has no introductory price.

Before displaying UI that offers the introductory price, you must first determine if the user is eligible to receive it. See [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app) for information on determining eligibility and displaying introductory prices.

## See Also

- [price](../com.apple.storekit/StoreKit/SKProduct/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProduct/priceLocale.md)
- [discounts](../com.apple.storekit/StoreKit/SKProduct/discounts.md)
- [SKProductDiscount](../com.apple.storekit/StoreKit/SKProductDiscount.md)

---


### isdownloadable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var isDownloadable: Bool { get }
```

## 

You can associate a set of data files with the App Store Connect record you created for a product. The value of this property is [doc://com.apple.documentation/documentation/Swift/true](doc://com.apple.documentation/documentation/Swift/true) if at least one file has been associated with the product.

## See Also

- [downloadContentLengths](../com.apple.storekit/StoreKit/SKProduct/downloadContentLengths.md)
- [downloadContentVersion](../com.apple.storekit/StoreKit/SKProduct/downloadContentVersion.md)
- [downloadable](../com.apple.storekit/StoreKit/SKProduct/downloadable.md)

---


### isfamilyshareable

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var isFamilyShareable: Bool { get }
```

## 

Check the value of [doc://com.apple.storekit/documentation/StoreKit/SKProduct/isFamilyShareable](doc://com.apple.storekit/documentation/StoreKit/SKProduct/isFamilyShareable) to learn whether an in-app purchase is sharable with the family group.

```swift
// Determine whether an in-app purchase supports Family Sharing.
let myProduct: SKProduct = getProductWithId(id: "com.example.product_identifier")
if myProduct.isFamilyShareable {
    print("Product can be shared with family group.")
}
```

When displaying in-app purchases in your app, indicate whether the product includes Family Sharing to help customers make a selection that best fits their needs.

Configure your in-app purchases to allow Family Sharing in App Store Connect. For more information about setting up Family Sharing, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/turn-on-family-sharing-for-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/turn-on-family-sharing-for-in-app-purchases).

## See Also

- [supporting-family-sharing-in-your-app](../com.apple.storekit/StoreKit/supporting-family-sharing-in-your-app.md)
- [paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:).md)

---


### localizedtitle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var localizedTitle: String { get }
```

## 

The title’s language is determined by the storefront that the user’s device is connected to, not the preferred language set on the device.

## See Also

- [SKStorefront](../com.apple.storekit/StoreKit/SKStorefront.md)
- [localizedDescription](../com.apple.storekit/StoreKit/SKProduct/localizedDescription.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKProduct/contentVersion.md)
- [isFamilyShareable](../com.apple.storekit/StoreKit/SKProduct/isFamilyShareable.md)
- [contentLengths](../com.apple.storekit/StoreKit/SKProduct/contentLengths.md)

---


### periodunit

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum PeriodUnit
```

## 

The period unit represents the duration of an interval. Period units are used with the number of units to determine one period in [doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod](doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod).

## Topics

### Period Units

- [day](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/day.md)
- [month](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/month.md)
- [week](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/week.md)
- [year](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/year.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit/init(rawValue:).md)

## See Also

- [subscriptionGroupIdentifier](../com.apple.storekit/StoreKit/SKProduct/subscriptionGroupIdentifier.md)
- [subscriptionPeriod](../com.apple.storekit/StoreKit/SKProduct/subscriptionPeriod.md)
- [SKProductSubscriptionPeriod](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod.md)

---


### subscriptiongroupidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var subscriptionGroupIdentifier: String? { get }
```

## 

Auto-renewable subscriptions always belong to a subscription group. You create the subscription group identifiers in App Store Connect before you create and add an auto-renewable subscription. For more information about subscription groups, see [https://help.apple.com/app-store-connect/#/dev75708c031](https://help.apple.com/app-store-connect/#/dev75708c031).

This property is `nil` if the [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) isn’t an auto-renewable subscription.

## See Also

- [subscriptionPeriod](../com.apple.storekit/StoreKit/SKProduct/subscriptionPeriod.md)
- [SKProductSubscriptionPeriod](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod.md)
- [PeriodUnit](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit.md)

---


## skproductstorepromotionvisibility


### default

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
case `default`
```

## See Also

- [hide](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/hide.md)
- [show](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/show.md)

---


### hide

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
case hide
```

## See Also

- [default](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/default.md)
- [show](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/show.md)

---


### show

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
case show
```

## See Also

- [default](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/default.md)
- [hide](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/hide.md)

---


## skreceiptrefreshrequest


### init(receiptproperties:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
init(receiptProperties properties: [String : Any]?)
```

## Parameters

- **properties**: In the test environment, the properties that the new receipt is to have. For keys, see Receipt Properties and Keys. In the production environment, set this parameter to `nil`.

## 

The initialized request.

## 

In the sandbox environment, you can initialize a receipt with any combination of properties to test the state transitions related to Volume Purchase Plan receipts. Set the `properties` when you call this initializer.

---


### receiptproperties

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var receiptProperties: [String : Any]? { get }
```

## 

Receipt properties include [doc://com.apple.storekit/documentation/StoreKit/SKReceiptPropertyIsExpired](doc://com.apple.storekit/documentation/StoreKit/SKReceiptPropertyIsExpired), [doc://com.apple.storekit/documentation/StoreKit/SKReceiptPropertyIsRevoked](doc://com.apple.storekit/documentation/StoreKit/SKReceiptPropertyIsRevoked), and [doc://com.apple.storekit/documentation/StoreKit/SKReceiptPropertyIsVolumePurchase](doc://com.apple.storekit/documentation/StoreKit/SKReceiptPropertyIsVolumePurchase).

## See Also

- [SKReceiptPropertyIsExpired](../com.apple.storekit/StoreKit/SKReceiptPropertyIsExpired.md)
- [SKReceiptPropertyIsRevoked](../com.apple.storekit/StoreKit/SKReceiptPropertyIsRevoked.md)
- [SKReceiptPropertyIsVolumePurchase](../com.apple.storekit/StoreKit/SKReceiptPropertyIsVolumePurchase.md)

---


## skstoreproductviewcontroller


### loadproduct(parameters:impression:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor @preconcurrency func loadProduct(parameters: [String : Any], impression: AppImpression) async throws
```

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [loadProduct(withParameters:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:).md)
- [loadProduct(withParameters:impression:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:impression:completionBlock:).md)
- [loadProduct(parameters:impression:reengagementURL:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:reengagementURL:).md)
- [product-dictionary-keys](../com.apple.storekit/StoreKit/product-dictionary-keys.md)

---


### loadproduct(parameters:impression:reengagementurl:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor @preconcurrency func loadProduct(parameters: [String : Any], impression: AppImpression, reengagementURL: URL) async throws
```

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [loadProduct(withParameters:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:).md)
- [loadProduct(withParameters:impression:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:impression:completionBlock:).md)
- [loadProduct(parameters:impression:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:).md)
- [product-dictionary-keys](../com.apple.storekit/StoreKit/product-dictionary-keys.md)

---


### loadproduct(withparameters:completionblock:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
@MainActor func loadProduct(withParameters parameters: [String : Any], completionBlock block: ((Bool, (any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
@MainActor func loadProduct(withParameters parameters: [String : Any]) async throws -> Bool
```

## Parameters

- **parameters**: A dictionary describing the content you want the view controller to display. See [doc://com.apple.storekit/documentation/StoreKit/product-dictionary-keys](doc://com.apple.storekit/documentation/StoreKit/product-dictionary-keys) for keys that describe the product. See [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) for keys that describe an impression in an advertising campaign.
- **block**: A block to be called when the product information has been loaded from the App Store. The completion block is called on the main thread and receives the following parameters:

## 

For a seamless user experience, load the product information before presenting the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController) view controller. However, if you load the product information while presenting the view controller, once loaded, the product data replaces the contents of the view controller.

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [loadProduct(withParameters:impression:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:impression:completionBlock:).md)
- [loadProduct(parameters:impression:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:).md)
- [loadProduct(parameters:impression:reengagementURL:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:reengagementURL:).md)
- [product-dictionary-keys](../com.apple.storekit/StoreKit/product-dictionary-keys.md)

---


### loadproduct(withparameters:impression:completionblock:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor func loadProduct(withParameters parameters: [String : Any], impression: SKAdImpression, completionBlock block: ((Bool, (any Error)?) -> Void)? = nil)
```

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor func loadProduct(withParameters parameters: [String : Any], impression: SKAdImpression) async throws -> Bool
```

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [loadProduct(withParameters:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:).md)
- [loadProduct(parameters:impression:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:).md)
- [loadProduct(parameters:impression:reengagementURL:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:reengagementURL:).md)
- [product-dictionary-keys](../com.apple.storekit/StoreKit/product-dictionary-keys.md)

---


## skstoreproductviewcontrollerdelegate


### productviewcontrollerdidfinish(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
optional func productViewControllerDidFinish(_ viewController: SKStoreProductViewController)
```

## Parameters

- **viewController**: The store view controller whose interface was dismissed by the user.

## 

Your delegate should call the [doc://com.apple.documentation/documentation/UIKit/UIViewController/dismissModalViewControllerAnimated:](doc://com.apple.documentation/documentation/UIKit/UIViewController/dismissModalViewControllerAnimated:) method on the view controller that originally presented the store screen. If your app paused any other activities before presenting the store, it can restart those services in this method.

## See Also

- [TP40008267](../https://developer.apple.com/library/archive/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267.md)

---


## skstorereviewcontroller


### requestreview()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
class func requestReview()
```

## 

Although you normally call this method when it makes sense in the user experience flow of your app, App Store policy governs the actual display of a rating and review request view. Because this method may not present an alert, it isn’t appropriate to call [doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview()](doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview()) or [doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview(in:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview(in:)) in response to a button tap or other user action.

> **NOTE:** When you call this method while your app is in development mode, a rating and review request view is always displayed so you can test the user interface and experience. However, this method has no effect when you call it in an app that you distribute using TestFlight.

When you call this method in your shipping app and the system displays a rating and review request view, the system handles the entire process for you. In addition, you can continue to include a persistent link in the settings or configuration screens of your app that links to your App Store product page. To automatically open a page on which users can write a review in the App Store, append the query parameter `action=write-review` to your product URL.

## See Also

- [requestReview(in:)](../com.apple.storekit/StoreKit/SKStoreReviewController/requestReview(in:).md)

---


### requestreview(in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor class func requestReview(in windowScene: UIWindowScene)
```

## Parameters

- **windowScene**: The window scene that StoreKit uses to present the rating and review request interface.

## 

When you call this method in your shipping app and the system displays a rating and review request view, the system handles the entire process for you. Although you normally call this method when it makes sense in the user experience flow of your app, App Store policy governs the actual display of a rating and review request view. When your app calls this API, StoreKit uses the following criteria::

- If the person hasn’t rated or reviewed your app on this device, StoreKit displays the ratings and review request a maximum of three times within a 365-day period.
- If the person has rated or reviewed your app on this device, StoreKit displays the ratings and review request if the app version is new, and if more than 365 days have passed since the person’s previous review.

> **NOTE:** Because this method may not present an alert, don’t call [doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview()](doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview()) or [doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview(in:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview(in:)) in response to a button tap or other user action.

It’s up to your app to decide on the best timing for requesting reviews. For design guidance, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews](https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews).

### 

When your app calls this method while it’s in development mode, StoreKit always displays the rating and review request view, so you can test the user interface and experience. However, this method has no effect in apps that you distribute for beta testing using TestFlight.

### 

Your customers can review your app at any time on the App Store. To make it easier for people to leave reviews, you may include a persistent link to your App Store product page in your app’s settings or configuration screens. Append the query parameter `action=write-review` to your product page URL to automatically open the App Store page where users can write a review.

## See Also

- [requestReview()](../com.apple.storekit/StoreKit/SKStoreReviewController/requestReview().md)

---


## storebuttonkind


### cancellation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
static var cancellation: StoreButtonKind { get }
```

## See Also

- [restorePurchases](../com.apple.storekit/StoreKit/StoreButtonKind/restorePurchases.md)

---


### policies

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var policies: StoreButtonKind { get }
```

## See Also

- [signIn](../com.apple.storekit/StoreKit/StoreButtonKind/signIn.md)
- [redeemCode](../com.apple.storekit/StoreKit/StoreButtonKind/redeemCode.md)

---


### redeemcode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
static var redeemCode: StoreButtonKind { get }
```

## See Also

- [signIn](../com.apple.storekit/StoreKit/StoreButtonKind/signIn.md)
- [policies](../com.apple.storekit/StoreKit/StoreButtonKind/policies.md)

---


### restorepurchases

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var restorePurchases: StoreButtonKind { get }
```

## See Also

- [cancellation](../com.apple.storekit/StoreKit/StoreButtonKind/cancellation.md)

---


### signin

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var signIn: StoreButtonKind { get }
```

## See Also

- [redeemCode](../com.apple.storekit/StoreKit/StoreButtonKind/redeemCode.md)
- [policies](../com.apple.storekit/StoreKit/StoreButtonKind/policies.md)

---


## storecontent


### body-swift.associatedtype

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
associatedtype Body : StoreContent
```

## See Also

- [body-swift.property](../com.apple.storekit/StoreKit/StoreContent/body-swift.property.md)

---


### body-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@StoreContentBuilder @MainActor @preconcurrency var body: Self.Body { get }
```

## See Also

- [Body-swift.associatedtype](../com.apple.storekit/StoreKit/StoreContent/Body-swift.associatedtype.md)

---


### productdescription(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency func productDescription(_ visibility: Visibility) -> some StoreContent

```

## See Also

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)
- [subscriptionStoreButtonLabel(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreButtonLabel(_:).md)
- [storeButton(_:for:)](../com.apple.storekit/StoreKit/StoreContent/storeButton(_:for:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlStyle(_:placement:).md)

---


### storebutton(_:for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated func storeButton(_ visibility: Visibility, for buttonKinds: StoreButtonKind...) -> some StoreContent

```

## See Also

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)
- [subscriptionStoreButtonLabel(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreButtonLabel(_:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlStyle(_:placement:).md)
- [productDescription(_:)](../com.apple.storekit/StoreKit/StoreContent/productDescription(_:).md)

---


### subscriptionstorebuttonlabel(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
nonisolated func subscriptionStoreButtonLabel(_ label: SubscriptionStoreButtonLabel) -> some StoreContent

```

## See Also

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)
- [storeButton(_:for:)](../com.apple.storekit/StoreKit/StoreContent/storeButton(_:for:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlStyle(_:placement:).md)
- [productDescription(_:)](../com.apple.storekit/StoreKit/StoreContent/productDescription(_:).md)

---


### subscriptionstorecontrolbackground(_:)-10hv8

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
nonisolated func subscriptionStoreControlBackground(_ backgroundStyle: SubscriptionStoreControlBackground) -> some StoreContent

```

## See Also

- [subscriptionStoreControlBackground(_:)-3xzai](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-3xzai.md)
- [subscriptionStorePickerItemBackground(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:).md)
- [subscriptionStorePickerItemBackground(_:in:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:in:).md)

---


### subscriptionstorecontrolbackground(_:)-3xzai

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
nonisolated func subscriptionStoreControlBackground(_ backgroundStyle: some ShapeStyle) -> some StoreContent

```

## See Also

- [subscriptionStoreControlBackground(_:)-10hv8](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-10hv8.md)
- [subscriptionStorePickerItemBackground(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:).md)
- [subscriptionStorePickerItemBackground(_:in:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:in:).md)

---


### subscriptionstorecontrolstyle(_:placement:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated func subscriptionStoreControlStyle<S>(_ style: S, placement: S.Placement = .automatic) -> some StoreContent where S : SubscriptionStoreControlStyle

```

## See Also

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)
- [subscriptionStoreButtonLabel(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreButtonLabel(_:).md)
- [storeButton(_:for:)](../com.apple.storekit/StoreKit/StoreContent/storeButton(_:for:).md)
- [productDescription(_:)](../com.apple.storekit/StoreKit/StoreContent/productDescription(_:).md)

---


### subscriptionstoreoptiongroupstyle(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency func subscriptionStoreOptionGroupStyle(_ style: some SubscriptionOptionGroupStyle) -> some StoreContent

```

## See Also

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreOptionGroupStyle(_:).md)
- [SubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle.md)

---


### subscriptionstorepickeritembackground(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
nonisolated func subscriptionStorePickerItemBackground(_ backgroundStyle: some ShapeStyle) -> some StoreContent

```

## See Also

- [subscriptionStoreControlBackground(_:)-10hv8](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-10hv8.md)
- [subscriptionStoreControlBackground(_:)-3xzai](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-3xzai.md)
- [subscriptionStorePickerItemBackground(_:in:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:in:).md)

---


### subscriptionstorepickeritembackground(_:in:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
nonisolated func subscriptionStorePickerItemBackground(_ backgroundStyle: some ShapeStyle, in shape: some Shape) -> some StoreContent

```

## See Also

- [subscriptionStoreControlBackground(_:)-10hv8](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-10hv8.md)
- [subscriptionStoreControlBackground(_:)-3xzai](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-3xzai.md)
- [subscriptionStorePickerItemBackground(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:).md)

---


## storecontentbuilder


### buildblock(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func buildBlock<each Content>(_ content: repeat each Content) -> TupleStoreContent<repeat each Content> where repeat each Content : StoreContent
```

## See Also

- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

---


### buildeither(first:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func buildEither<TrueContent, FalseContent>(first: TrueContent) -> _ConditionalContent<TrueContent, FalseContent> where TrueContent : StoreContent, FalseContent : StoreContent
```

## See Also

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

---


### buildeither(second:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func buildEither<TrueContent, FalseContent>(second: FalseContent) -> _ConditionalContent<TrueContent, FalseContent> where TrueContent : StoreContent, FalseContent : StoreContent
```

## See Also

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

---


### buildexpression(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func buildExpression<Content>(_ content: Content) -> some StoreContent where Content : StoreContent

```

## See Also

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

---


### buildif(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func buildIf<Content>(_ section: Content?) -> Content? where Content : StoreContent
```

## See Also

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

---


### buildlimitedavailability(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func buildLimitedAvailability(_ content: any StoreContent) -> some StoreContent

```

## See Also

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

---


## subscriptionofferview


### init(groupid:visiblerelationship:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
nonisolated init(groupID: String, visibleRelationship: Product.SubscriptionRelationship) where Icon == EmptyView, PlaceholderIcon == EmptyView
```

## See Also

- [init(_:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:).md)
- [init(groupID:visibleRelationship:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:).md)
- [init(groupID:visibleRelationship:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:placeholderIcon:).md)
- [init(groupID:visibleRelationship:useAppIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:useAppIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:icon:placeholderIcon:).md)
- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)

---


### init(groupid:visiblerelationship:icon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
nonisolated init(groupID: String, visibleRelationship: Product.SubscriptionRelationship, @ViewBuilder icon: () -> Icon) where PlaceholderIcon == AutomaticProductPlaceholderIcon
```

## See Also

- [init(_:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:).md)
- [init(groupID:visibleRelationship:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:).md)
- [init(groupID:visibleRelationship:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:placeholderIcon:).md)
- [init(groupID:visibleRelationship:useAppIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:useAppIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:icon:placeholderIcon:).md)
- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)

---


### init(groupid:visiblerelationship:icon:placeholdericon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
nonisolated init(groupID: String, visibleRelationship: Product.SubscriptionRelationship, @ViewBuilder icon: () -> Icon, @ViewBuilder placeholderIcon: () -> PlaceholderIcon)
```

## See Also

- [init(_:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:).md)
- [init(groupID:visibleRelationship:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:).md)
- [init(groupID:visibleRelationship:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:).md)
- [init(groupID:visibleRelationship:useAppIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:useAppIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:icon:placeholderIcon:).md)
- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)

---


### init(groupid:visiblerelationship:useappicon:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
nonisolated init(groupID: String, visibleRelationship: Product.SubscriptionRelationship, useAppIcon: Bool) where Icon == EmptyView, PlaceholderIcon == EmptyView
```

## See Also

- [init(_:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:).md)
- [init(groupID:visibleRelationship:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:).md)
- [init(groupID:visibleRelationship:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:).md)
- [init(groupID:visibleRelationship:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:placeholderIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:icon:placeholderIcon:).md)
- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)

---


## subscriptionofferviewstyleconfiguration


### displaydetails()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func displayDetails()
```

## See Also

- [subscribe()](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscribe().md)

---


### subscriptiongroupdisplayname

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var subscriptionGroupDisplayName: String { get }
```

## See Also

- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/activeOffer.md)
- [icon-swift.property](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/icon-swift.property.md)
- [state](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/state.md)
- [subscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionStatus.md)
- [subscriptions](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptions.md)
- [visibleSubscription](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/visibleSubscription.md)

---


### subscriptions

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var subscriptions: [Product]? { get }
```

## See Also

- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/activeOffer.md)
- [icon-swift.property](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/icon-swift.property.md)
- [state](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/state.md)
- [subscriptionGroupDisplayName](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionGroupDisplayName.md)
- [subscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionStatus.md)
- [visibleSubscription](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/visibleSubscription.md)

---


### visiblesubscription

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
var visibleSubscription: Product?
```

## See Also

- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/activeOffer.md)
- [icon-swift.property](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/icon-swift.property.md)
- [state](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/state.md)
- [subscriptionGroupDisplayName](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionGroupDisplayName.md)
- [subscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionStatus.md)
- [subscriptions](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptions.md)

---


## subscriptionoptiongroupset


### init(idtype:groupedby:label:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(idType: GroupID.Type = GroupID.self, groupedBy transform: @escaping (Product) -> GroupID, @ViewBuilder label: @escaping (GroupID) -> Label) where MarketingContent == AutomaticSubscriptionStoreMarketingContent
```

## See Also

- [init(idType:groupedBy:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet/init(idType:groupedBy:label:marketingContent:).md)

---


### init(idtype:groupedby:label:marketingcontent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(idType: GroupID.Type = GroupID.self, groupedBy transform: @escaping (Product) -> GroupID, @ViewBuilder label: @escaping (GroupID) -> Label, @ViewBuilder marketingContent: @escaping (GroupID) -> MarketingContent)
```

## See Also

- [init(idType:groupedBy:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet/init(idType:groupedBy:label:).md)

---


## subscriptionoptionsection


### init(_:isincluded:footer:)-17lo3

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ title: LocalizedStringKey, isIncluded: @escaping (Product) -> Bool, @ViewBuilder footer: () -> Footer = EmptyView.init)
```

## See Also

- [init(_:isIncluded:footer:)-36k79](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(_:isIncluded:footer:)-36k79.md)
- [init(isIncluded:header:footer:)](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(isIncluded:header:footer:).md)

---


### init(_:isincluded:footer:)-36k79

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ title: some StringProtocol, isIncluded: @escaping (Product) -> Bool, @ViewBuilder footer: () -> Footer = EmptyView.init)
```

## See Also

- [init(_:isIncluded:footer:)-17lo3](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(_:isIncluded:footer:)-17lo3.md)
- [init(isIncluded:header:footer:)](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(isIncluded:header:footer:).md)

---


### init(isincluded:header:footer:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(isIncluded: @escaping (Product) -> Bool, @ViewBuilder header: () -> Header = EmptyView.init, @ViewBuilder footer: () -> Footer = EmptyView.init)
```

## See Also

- [init(_:isIncluded:footer:)-17lo3](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(_:isIncluded:footer:)-17lo3.md)
- [init(_:isIncluded:footer:)-36k79](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(_:isIncluded:footer:)-36k79.md)

---


## subscriptionperiodgroupset


### init(marketingcontent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@ViewBuilder marketingContent: @escaping (Product.SubscriptionPeriod?) -> MarketingContent) where Label == AutomaticSubscriptionOptionGroupLabel
```

## See Also

- [init()](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init().md)
- [init(marketingContent:label:)](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init(marketingContent:label:).md)

---


### init(marketingcontent:label:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(@ViewBuilder marketingContent: @escaping (Product.SubscriptionPeriod?) -> MarketingContent, @ViewBuilder label: @escaping (Product.SubscriptionPeriod?) -> Label)
```

## See Also

- [init()](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init().md)
- [init(marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init(marketingContent:).md)

---


## subscriptionstorecontrolstyleconfiguration


### option


#### subscribe()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func subscribe()
```

## 

Call the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) method within your custom style when the customer chooses to make a purchase.

> **IMPORTANT:** Don’t call purchase methods, such as [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-8eai6](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-8eai6), on the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscription](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscription) property from your custom style.

---


#### subscript(dynamicmember:)-8sl2m

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
subscript<T>(dynamicMember keyPath: KeyPath<Product.SubscriptionInfo, T?>) -> T? { get }
```

## 

You don’t use this subscript directly. Instead, access the properties of a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) value. For an example of using a dynamic member lookup, see [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option).

## See Also

- [subscript(dynamicMember:)-wjww](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-wjww.md)
- [subscript(dynamicMember:)-9g2sm](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-9g2sm.md)

---


#### subscript(dynamicmember:)-9g2sm

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
subscript<T>(dynamicMember keyPath: KeyPath<Product, T>) -> T { get }
```

## 

You don’t use this subscript directly. Instead, access the properties of a [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) instance directly on a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) value. For an example of using a dynamic member lookup, see [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option).

## See Also

- [subscript(dynamicMember:)-8sl2m](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-8sl2m.md)
- [subscript(dynamicMember:)-wjww](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-wjww.md)

---


#### subscript(dynamicmember:)-wjww

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
subscript<T>(dynamicMember keyPath: KeyPath<Product.SubscriptionInfo, T>) -> T? { get }
```

## 

You don’t use this subscript directly. Instead, access the properties of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) value. For an example of using a dynamic member lookup, see [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option).

## See Also

- [subscript(dynamicMember:)-8sl2m](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-8sl2m.md)
- [subscript(dynamicMember:)-9g2sm](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-9g2sm.md)

---


### pickeroption


#### activeoffer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
var activeOffer: Product.SubscriptionOffer? { get }
```

## See Also

- [subscription](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscription.md)
- [isSelected](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected.md)
- [icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/icon.md)
- [id](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/id.md)

---


#### identifiable-implementations

## Topics

### Instance Properties

- [id](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/id.md)

---


#### isselected

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
let isSelected: Bool
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected) property to display a selection indicator, such as a checkmark, in its correct state. The following code example shows a checkmark when [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected) is true:

```swift
SubscriptionPickerOption(option) { pickerOption in 
HStack {
    Text(pickerOption.displayName)
    Spacer()
    Image(systemName: "checkmark")
        .opacity(pickerOption.isSelected ? 1 : 0)
    }
}
```

The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker) automatically updates the picker’s selection state as customers interact with your picker. However, the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker) doesn’t display selection indicators. Your app needs to display selection indicators in the picker option label.

Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) value, which represents the properties of a subscription picker option’s label, to display the selection indicator.

## See Also

- [subscription](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscription.md)
- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/activeOffer.md)
- [icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/icon.md)
- [id](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/id.md)

---


#### subscript(dynamicmember:)-2ahxy

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
subscript<T>(dynamicMember keyPath: KeyPath<Product.SubscriptionInfo, T?>) -> T? { get }
```

## 

You don’t use this subscript directly. Instead, access the properties of a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) value.

## See Also

- [subscript(dynamicMember:)-4f3i1](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-4f3i1.md)
- [subscript(dynamicMember:)-8bsxh](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-8bsxh.md)

---


#### subscript(dynamicmember:)-4f3i1

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
subscript<T>(dynamicMember keyPath: KeyPath<Product.SubscriptionInfo, T>) -> T? { get }
```

## 

You don’t use this subscript directly. Instead, access the properties of a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) value.

## See Also

- [subscript(dynamicMember:)-2ahxy](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-2ahxy.md)
- [subscript(dynamicMember:)-8bsxh](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-8bsxh.md)

---


#### subscript(dynamicmember:)-8bsxh

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
subscript<T>(dynamicMember keyPath: KeyPath<Product, T>) -> T { get }
```

## 

You don’t use this subscript directly. Instead, access the properties of a [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) instance directly on a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) value.

## See Also

- [subscript(dynamicMember:)-2ahxy](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-2ahxy.md)
- [subscript(dynamicMember:)-4f3i1](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-4f3i1.md)

---


#### subscription

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
var subscription: Product { get }
```

## 

[doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) is a dynamic member lookup type, so you don’t need to use this property directly to access the properties of the [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) value. Instead, access any properties of [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) or [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on the `PickerOption` value.

> **IMPORTANT:** Don’t use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y) or related purchase methods on this property to initiate a purchase. Use a picker option only for selecting a subscription option, which requires additional confirmation before initiating a purchase.

## See Also

- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/activeOffer.md)
- [isSelected](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected.md)
- [icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/icon.md)
- [id](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/id.md)

---


### section


#### footer-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var footer: SubscriptionStoreControlStyleConfiguration.Section.Footer?
```

## See Also

- [header-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property.md)
- [Header-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Header-swift.struct.md)
- [Footer-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Footer-swift.struct.md)

---


#### footer-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct Footer
```

## See Also

- [header-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property.md)
- [footer-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property.md)
- [Header-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Header-swift.struct.md)

---


#### header-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var header: SubscriptionStoreControlStyleConfiguration.Section.Header?
```

## See Also

- [footer-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property.md)
- [Header-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Header-swift.struct.md)
- [Footer-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Footer-swift.struct.md)

---


#### header-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct Header
```

## See Also

- [header-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property.md)
- [footer-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property.md)
- [Footer-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Footer-swift.struct.md)

---


#### id

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct ID
```

---


### alloptions

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var allOptions: [Product] { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property is an array that contains all the subscription options in a subscription group. Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property to access the subscription options that the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) and [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) properties may not contain.

For example, use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property if your control style displays comparisons between available subscription options. A [doc://com.apple.storekit/documentation/StoreKit/SubscriptionPeriodGroupSet](doc://com.apple.storekit/documentation/StoreKit/SubscriptionPeriodGroupSet) can compare the value of a yearly renewing subscription to a monthly subscription. Because each instance of your control style displays only subscriptions with matching renewal periods, you can’t compute such a comparison using the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) property. The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) value is always a superset of the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) property.

> **NOTE:** Don’t use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property to determine the subscription options your control style view displays. Instead, only display the subscription options that the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) properties contain.

It’s possible for a subscription store control to display only a subset of the options available within a subscription group. For example, if you use a store content builder to declare the content of a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView), the store may create multiple instances of your control with different configuration values. These instances may each display a different subset of the subscripton options.

## See Also

- [groupDisplayName](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/groupDisplayName.md)
- [autoRenewPreference](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference.md)

---


### autorenewpreference

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var autoRenewPreference: Product? { get }
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) property to identify the subscription that renews in the next billing cycle, if there is one. The property is `nil` if the customer doesn’t have an auto-renewable subscription that renews in the next billing period. This indicates that the customer turned off the auto-renew preference, or that they don’t have a current subscription.

Display the subscription in the auto-renew preference only if it appears in the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) arrays. However, disable its [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) control so the customer doesn’t try to subscribe to it again, to prevent a system dialog that explains that the customer is already subscribed. The following code example shows how to check for the auto-renew preference and disable the subscribe functionality:

```swift
ForEach(configuration.options) { option in 
    Button(option.displayName, action: option.subscribe)
        .disabled(option.id == configuration.autoRenewPreference?.id)
}
```

> **IMPORTANT:** Don’t use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) property to determine whether to grant access to a service. Always check the full transaction information before granting access to a paid service.

## See Also

- [groupDisplayName](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/groupDisplayName.md)
- [allOptions](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions.md)

---


### descriptionvisibility

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var descriptionVisibility: Visibility { get }
```

## 

Use this property if you choose to support configuring the description visibility in your custom style. It reflects the value that the ancestor view sets with the [doc://com.apple.documentation/documentation/SwiftUI/View/productDescription(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/productDescription(_:)) view modifier.

---


### groupdisplayname

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var groupDisplayName: String { get }
```

## 

This property is the same as accessing [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupDisplayName](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/groupDisplayName) on a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) value. Because all options within a subscription store view belong to the same subscription group, using the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/groupDisplayName](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/groupDisplayName) property is more convenient than getting the group display name from an arbitrary subscription option.

## See Also

- [autoRenewPreference](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference.md)
- [allOptions](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions.md)

---


### icon

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct Icon
```

## See Also

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/options.md)
- [sections](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/sections.md)
- [Option](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option.md)
- [PickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption.md)
- [Section](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section.md)

---


### option

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@dynamicMemberLookup struct Option
```

## 

You use `SubscriptionStoreControlStyleConfiguration.Option` very similarly to [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) values, with some important differences:

- The `offer` property indicates the offer that applies to the purchase. Display the terms of the `offer`, and ignore offer properties on [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo), such as [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/introductoryOffer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/introductoryOffer).
- If the `offer` is `nil`, no offer applies to the purchase.
- Call the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) method when a customer activates a control to subscribe to a subscription option, instead of methods on [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product), such as [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-6dj6y).
- Access the decorative icon using the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/icon](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/icon) property.

`SubscriptionStoreControlStyleConfiguration.Option` is a dynamic member lookup type, so you don’t need to use [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscription](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscription) directly to access the properties of the `Product` value. Instead, access the properties of `Product` or [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on the `Option` value. In the example below, the [doc://com.apple.storekit/documentation/StoreKit/Product/displayName](doc://com.apple.storekit/documentation/StoreKit/Product/displayName) property is available on `Option` to use as the button label:

```swift
struct DisplayNameButtonsControlStyle: SubscriptionStoreControlStyle {

    func makeBody(configuration: Configuration) -> some View {
        ForEach(configuration.options) { option in
            Button(option.displayName, action: option.subscribe)
        }
    }
}
```

## Topics

### Getting the subscription product and offer

- [subscription](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscription.md)
- [id](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/id.md)
- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/activeOffer.md)

### Getting the icon

- [icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/icon.md)

### Purchasing a subscription option

- [subscribe()](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe().md)

### Looking up dynamic members

- [subscript(dynamicMember:)-8sl2m](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-8sl2m.md)
- [subscript(dynamicMember:)-wjww](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-wjww.md)
- [subscript(dynamicMember:)-9g2sm](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscript(dynamicMember:)-9g2sm.md)

### Default Implementations

- [Identifiable-Implementations](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/Identifiable-Implementations.md)

## See Also

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/options.md)
- [sections](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/sections.md)
- [PickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption.md)
- [Section](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section.md)
- [Icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Icon.md)

---


### options

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var options: [SubscriptionStoreControlStyleConfiguration.Option] { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) property is an array that contains the main content of your subscription store control style, including the auto-renewable subscription products. Use the properties of each [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) value to declare your control style. Provide a control that enables the customer to subscribe to each option in the array. Call the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) method when the customer activates a control to subscribe.

Display only the subscription options that appear in the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) array. Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property to access information about all the options, for example, to compute comparisons between subscription options.

To hide and sort subscription options, use the initializer of the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView). The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) array maintains the sort order, and includes only the options you provide to the subscription store view’s initializer. For example, the following code initializes the subscription store to contain only the subscription options that upgrade the customer’s current subscription:

```swift
SubscriptionStoreView(groupID: "SAMPLE", visibleRelationships: .upgrade)
```

If you configure a subscription store view to show the current auto-renewal preference, the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) array contains the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) subscription product. There’s no need to specifically display the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) product in that case.

> **NOTE:** A subscription store control style needs only one of the properties, [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections). Use [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) if your style doesn’t support sections.

If you declare a subscription store view using [doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection](doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection) instances, this property flattens the section structure and ignores any header or footer views.

## See Also

- [sections](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/sections.md)
- [Option](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option.md)
- [PickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption.md)
- [Section](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section.md)
- [Icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Icon.md)

---


### pickeroption

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@dynamicMemberLookup struct PickerOption
```

## 

You use `SubscriptionStoreControlStyleConfiguration.PickerOption` very similarly to [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option). The key differences are:

- The picker option represents a subscription option within the scope of an element of a picker control, where you can merchandise a standard option using any kind of control.
- Instead of getting an option from a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration), you get a picker option when you create a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker).
- Instead of providing a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option/subscribe()) method, the picker option provides an [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected) property to get the selection state.

The key difference is a `SubscriptionStoreControlStyleConfiguration.Option` provides a method to subscribe, and a `SubscriptionStoreControlStyleConfiguration.PickerOption` indicates the current selection state within a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePicker).

[doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption) is a dynamic member lookup type, so you don’t need to use [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscription](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscription) directly to access the properties of the `Product` value. Instead, access any properties of `Product` or [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo) directly on the `PickerOption` value.

## Topics

### Getting properties of the subscription picker option

- [subscription](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscription.md)
- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/activeOffer.md)
- [isSelected](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/isSelected.md)
- [icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/icon.md)
- [id](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/id.md)

### Dynamic member lookup support

- [subscript(dynamicMember:)-2ahxy](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-2ahxy.md)
- [subscript(dynamicMember:)-4f3i1](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-4f3i1.md)
- [subscript(dynamicMember:)-8bsxh](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/subscript(dynamicMember:)-8bsxh.md)

### Default Implementations

- [Identifiable-Implementations](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption/Identifiable-Implementations.md)

## See Also

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/options.md)
- [sections](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/sections.md)
- [Option](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option.md)
- [Section](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section.md)
- [Icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Icon.md)

---


### section

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Section
```

## 

Each value represents an instance of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection](doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection) when the system creates a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView).

Even if a subscription store instance doesn’t declare sections using [doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection](doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection), the instance always has at least one implicit section that contains the options within the group. Implicit sections have `nil` for the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property) and [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property) accessory views.

## Topics

### Getting a section’s content

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/options.md)

### Getting accessory views

- [header-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property.md)
- [footer-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property.md)
- [Header-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Header-swift.struct.md)
- [Footer-swift.struct](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/Footer-swift.struct.md)

### Identifying a section

- [ID](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/ID.md)

## See Also

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/options.md)
- [sections](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/sections.md)
- [Option](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option.md)
- [PickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption.md)
- [Icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Icon.md)

---


### sections

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var sections: [SubscriptionStoreControlStyleConfiguration.Section] { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) property represents the main content of your subscription store control style, including the auto-renewable subscription products.

Each [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section) element contains an array of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) values named [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/options). Use this structure to modify the appearance of a control depending on the section it belongs to.

The elements of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) represent [doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection](doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection) instances. A minimal store has one implicit section, with the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) property containing a single element. The single element’s [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/header-swift.property) and [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/footer-swift.property) properties are both `nil`, and its [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Section/options) property is identical to the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) property on [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration).

> **NOTE:** Typically, a style needs only one of the properties: [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections). Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) property if your style supports sections.

Use the initializer of the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView) to determine the contents of the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) array.

Display only the subscription options that appear in the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) array. Use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property to access information about all the options, for example, to compute comparisons between subscription options. The view your style creates needs to provide a control that enables the customer to subscribe to each option in the array.

If you configure a subscription store view to show the current auto-renewal preference, the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) array contains the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) subscription product. There’s no need to specifically display the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) product in that case.

## See Also

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/options.md)
- [Option](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option.md)
- [PickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption.md)
- [Section](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section.md)
- [Icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Icon.md)

---


## subscriptionstorepickeroption


### init(_:)-3iu97

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ option: SubscriptionStoreControlStyleConfiguration.PickerOption) where Label == AutomaticSubscriptionStorePickerOptionLabel
```

## See Also

- [init(_:)-4cb3l](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:)-4cb3l.md)
- [init(_:label:)](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:label:).md)

---


### init(_:)-4cb3l

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ option: SubscriptionStoreControlStyleConfiguration.Option) where Label == AutomaticSubscriptionStorePickerOptionLabel
```

## See Also

- [init(_:)-3iu97](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:)-3iu97.md)
- [init(_:label:)](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:label:).md)

---


### init(_:label:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency init(_ option: SubscriptionStoreControlStyleConfiguration.Option, @ViewBuilder label: @escaping (SubscriptionStoreControlStyleConfiguration.PickerOption) -> Label)
```

## See Also

- [init(_:)-4cb3l](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:)-4cb3l.md)
- [init(_:)-3iu97](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:)-3iu97.md)

---


## subscriptionstorepolicykind


### privacypolicy

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var privacyPolicy: SubscriptionStorePolicyKind { get }
```

## See Also

- [termsOfService](../com.apple.storekit/StoreKit/SubscriptionStorePolicyKind/termsOfService.md)

---


### termsofservice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var termsOfService: SubscriptionStorePolicyKind { get }
```

## See Also

- [privacyPolicy](../com.apple.storekit/StoreKit/SubscriptionStorePolicyKind/privacyPolicy.md)

---


## subscriptionstoreview


### init(groupid:visiblerelationships:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(groupID: String, visibleRelationships: Product.SubscriptionRelationship = .all) where Content == AutomaticSubscriptionStoreMarketingContent
```

## Parameters

- **groupID**: The subscription group identifier to load from the App Store.
- **visibleRelationships**: The kinds of subscription option relationships the view makes visible when someone is already subscribed to the subscription.

## See Also

- [init(productIDs:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:).md)
- [init(subscriptions:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:).md)

---


### init(groupid:visiblerelationships:content:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init<C>(groupID: String, visibleRelationships: Product.SubscriptionRelationship = .all, @StoreContentBuilder content: () -> C) where Content == SubscriptionStoreContentView<C>, C : StoreContent
```

## See Also

- [init(productIDs:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:content:).md)
- [init(subscriptions:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:content:).md)

---


### init(groupid:visiblerelationships:marketingcontent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(groupID: String, visibleRelationships: Product.SubscriptionRelationship = .all, @ViewBuilder marketingContent: () -> Content)
```

## Parameters

- **groupID**: The subscription group identifier to load from the App Store.
- **visibleRelationships**: The kinds of subscription option relationships the view makes visible when someone is already subscribed to the subscription.
- **marketingContent**: The view that contains marketing content to display above the store controls.

## See Also

- [init(productIDs:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:marketingContent:).md)
- [init(subscriptions:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:marketingContent:).md)

---


### init(productids:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(productIDs: some Collection<String>) where Content == AutomaticSubscriptionStoreMarketingContent
```

## Parameters

- **productIDs**: The product identifiers to load from the App Store.

## See Also

- [init(groupID:visibleRelationships:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:).md)
- [init(subscriptions:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:).md)

---


### init(productids:content:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init<C>(productIDs: some Collection<String>, @StoreContentBuilder content: () -> C) where Content == SubscriptionStoreContentView<C>, C : StoreContent
```

## See Also

- [init(groupID:visibleRelationships:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:content:).md)
- [init(subscriptions:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:content:).md)

---


### init(productids:marketingcontent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(productIDs: some Collection<String>, @ViewBuilder marketingContent: () -> Content)
```

## Parameters

- **productIDs**: The product identifiers to load from the App Store.
- **marketingContent**: The view that contains marketing content to display above the store controls.

## See Also

- [init(groupID:visibleRelationships:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:marketingContent:).md)
- [init(subscriptions:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:marketingContent:).md)

---


### init(subscriptions:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(subscriptions: some Collection<Product>) where Content == AutomaticSubscriptionStoreMarketingContent
```

## Parameters

- **subscriptions**: A collection of auto-renewable subscription [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) instances to merchandise. The auto-renewable subscriptions need to belong to the same subscription group.

## See Also

- [init(groupID:visibleRelationships:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:).md)
- [init(productIDs:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:).md)

---


### init(subscriptions:content:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init<C>(subscriptions: some Collection<Product>, @StoreContentBuilder content: () -> C) where Content == SubscriptionStoreContentView<C>, C : StoreContent
```

## See Also

- [init(groupID:visibleRelationships:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:content:).md)
- [init(productIDs:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:content:).md)

---


### init(subscriptions:marketingcontent:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
nonisolated init(subscriptions: some Collection<Product>, @ViewBuilder marketingContent: () -> Content)
```

## Parameters

- **subscriptions**: A collection of auto-renewable subscription [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) instances to merchandise. The auto-renewable subscriptions need to belong to the same subscription group.
- **marketingContent**: A view that contains marketing content to display above the store controls.

## See Also

- [init(groupID:visibleRelationships:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:marketingContent:).md)
- [init(productIDs:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:marketingContent:).md)

---


## transaction


### advancedcommerceinfo-swift.struct


#### item


##### details-swift.struct


###### sku

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let sku: String
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/displayName.md)
- [offer](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/offer.md)
- [price](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/price.md)

---


##### details-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let details: Transaction.AdvancedCommerceInfo.Item.Details
```

## See Also

- [refunds](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/refunds.md)
- [revocationDate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/revocationDate.md)

---


##### details-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Details
```

## Topics

### Instance Properties

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/displayName.md)
- [offer](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/offer.md)
- [price](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/price.md)
- [sku](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct/sku.md)

---


##### refunds

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let refunds: [Transaction.AdvancedCommerceInfo.Refund]?
```

## See Also

- [details-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/details-swift.property.md)
- [revocationDate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/revocationDate.md)

---


#### offer


##### reason-swift.struct


###### acquisition

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let acquisition: Transaction.AdvancedCommerceInfo.Offer.Reason
```

## See Also

- [retention](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct/retention.md)
- [winBack](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct/winBack.md)

---


###### retention

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let retention: Transaction.AdvancedCommerceInfo.Offer.Reason
```

## See Also

- [acquisition](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct/acquisition.md)
- [winBack](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct/winBack.md)

---


###### winback

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let winBack: Transaction.AdvancedCommerceInfo.Offer.Reason
```

## See Also

- [acquisition](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct/acquisition.md)
- [retention](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct/retention.md)

---


##### periodcount

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let periodCount: Int
```

## See Also

- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/period.md)
- [price](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/price.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/reason-swift.property.md)

---


#### refund


##### reason-swift.struct


###### legal

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let legal: Transaction.AdvancedCommerceInfo.Refund.Reason
```

## See Also

- [modifyItems](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/modifyItems.md)
- [other](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/other.md)
- [unfulfilled](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unfulfilled.md)
- [unintended](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unintended.md)
- [unsatisfied](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unsatisfied.md)

---


###### modifyitems

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let modifyItems: Transaction.AdvancedCommerceInfo.Refund.Reason
```

## See Also

- [legal](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/legal.md)
- [other](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/other.md)
- [unfulfilled](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unfulfilled.md)
- [unintended](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unintended.md)
- [unsatisfied](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unsatisfied.md)

---


###### other

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let other: Transaction.AdvancedCommerceInfo.Refund.Reason
```

## See Also

- [legal](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/legal.md)
- [modifyItems](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/modifyItems.md)
- [unfulfilled](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unfulfilled.md)
- [unintended](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unintended.md)
- [unsatisfied](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unsatisfied.md)

---


###### unfulfilled

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let unfulfilled: Transaction.AdvancedCommerceInfo.Refund.Reason
```

## See Also

- [legal](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/legal.md)
- [modifyItems](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/modifyItems.md)
- [other](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/other.md)
- [unintended](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unintended.md)
- [unsatisfied](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unsatisfied.md)

---


###### unintended

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let unintended: Transaction.AdvancedCommerceInfo.Refund.Reason
```

## See Also

- [legal](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/legal.md)
- [modifyItems](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/modifyItems.md)
- [other](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/other.md)
- [unfulfilled](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unfulfilled.md)
- [unsatisfied](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unsatisfied.md)

---


###### unsatisfied

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let unsatisfied: Transaction.AdvancedCommerceInfo.Refund.Reason
```

## See Also

- [legal](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/legal.md)
- [modifyItems](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/modifyItems.md)
- [other](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/other.md)
- [unfulfilled](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unfulfilled.md)
- [unintended](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct/unintended.md)

---


##### refundtype


###### custom

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let custom: Transaction.AdvancedCommerceInfo.Refund.RefundType
```

## See Also

- [full](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/full.md)
- [proRated](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/proRated.md)

---


###### full

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let full: Transaction.AdvancedCommerceInfo.Refund.RefundType
```

## See Also

- [custom](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/custom.md)
- [proRated](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/proRated.md)

---


###### prorated

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let proRated: Transaction.AdvancedCommerceInfo.Refund.RefundType
```

## See Also

- [custom](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/custom.md)
- [full](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/full.md)

---


##### amount

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let amount: Decimal
```

## See Also

- [date](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/date.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/reason-swift.property.md)
- [type](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/type.md)

---


##### date

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let date: Date
```

## See Also

- [amount](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/amount.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/reason-swift.property.md)
- [type](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/type.md)

---


##### refundtype

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct RefundType
```

## Topics

### Type Properties

- [custom](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/custom.md)
- [full](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/full.md)
- [proRated](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType/proRated.md)

## See Also

- [Reason-swift.struct](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct.md)

---


##### type

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let type: Transaction.AdvancedCommerceInfo.Refund.RefundType
```

## See Also

- [amount](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/amount.md)
- [date](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/date.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/reason-swift.property.md)

---


#### description

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let description: String?
```

## See Also

- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### displayname

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let displayName: String?
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### estimatedtax

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let estimatedTax: Decimal
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### item

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Item
```

## Topics

### Structures

- [Details-swift.struct](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/Details-swift.struct.md)

### Instance Properties

- [details-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/details-swift.property.md)
- [refunds](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/refunds.md)
- [revocationDate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item/revocationDate.md)

## See Also

- [Offer](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer.md)
- [Refund](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund.md)

---


#### items

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let items: [Transaction.AdvancedCommerceInfo.Item]
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### offer

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Offer
```

## Topics

### Structures

- [Reason-swift.struct](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/Reason-swift.struct.md)

### Instance Properties

- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/period.md)
- [periodCount](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/periodCount.md)
- [price](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/price.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer/reason-swift.property.md)

## See Also

- [Item](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item.md)
- [Refund](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund.md)

---


#### period

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let period: SubscriptionPeriod?
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### refund

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Refund
```

## Topics

### Structures

- [Reason-swift.struct](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/Reason-swift.struct.md)
- [RefundType](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/RefundType.md)

### Instance Properties

- [amount](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/amount.md)
- [date](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/date.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/reason-swift.property.md)
- [type](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund/type.md)

## See Also

- [Item](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item.md)
- [Offer](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer.md)

---


#### requestreferenceid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let requestReferenceID: String
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### taxcode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let taxCode: String
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### taxexclusiveprice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let taxExclusivePrice: Decimal
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

---


#### taxrate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let taxRate: Decimal
```

## See Also

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)

---


### offer-swift.struct


#### paymentmode-swift.struct


##### onetime

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 26.0, macOS 26.0, tvOS 26.0, watchOS 26.0, visionOS 26.0)
static var oneTime: Transaction.Offer.PaymentMode { get }
```

## See Also

- [freeTrial](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/freeTrial.md)
- [payAsYouGo](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/payAsYouGo.md)
- [payUpFront](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/payUpFront.md)

---


#### paymentmode-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct PaymentMode
```

## 

If your app supports offers and the customer redeems an offer, the transaction contains the information in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property) parameter. The payment modes include the subscription payment modes as in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer/PaymentMode-swift.struct](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer/PaymentMode-swift.struct) structure, and the [doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/oneTime](doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/oneTime) mode that applies to consumables, non-consumables, and non-renewing subscriptions.

The following images describe payment modes for auto-renewable subscriptions.







For more information about payment modes, see [https://developer.apple.com/help/app-store-connect/reference/in-app-purchase-and-subscriptions-pricing-and-availability](https://developer.apple.com/help/app-store-connect/reference/in-app-purchase-and-subscriptions-pricing-and-availability).

## Topics

### Getting payment modes

- [freeTrial](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/freeTrial.md)
- [payAsYouGo](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/payAsYouGo.md)
- [payUpFront](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/payUpFront.md)
- [oneTime](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct/oneTime.md)

## See Also

- [id](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/id.md)
- [type](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/type.md)
- [OfferType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/paymentMode-swift.property.md)
- [period](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/period.md)

---


### offertype-swift.struct


#### promotional

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let promotional: Transaction.OfferType
```

## 

For more information about promotional offers, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions).

The raw value of the [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/promotional](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/promotional) offer type is `2`.

## See Also

- [introductory](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/introductory.md)
- [code](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/code.md)
- [winBack](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/winBack.md)

---


### ownershiptype-swift.struct


#### familyshared

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let familyShared: Transaction.OwnershipType
```

## 

For more information about Family Sharing, see [https://help.apple.com/app-store-connect/#/dev45b03fab9](https://help.apple.com/app-store-connect/#/dev45b03fab9).

## See Also

- [purchased](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct/purchased.md)

---


#### purchased

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let purchased: Transaction.OwnershipType
```

## See Also

- [familyShared](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct/familyShared.md)

---


### reason-swift.struct


#### purchase

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let purchase: Transaction.Reason
```

## 

The customer initiated the purchase, which may be for any in-app purchase type: consumable, non-consumable, non-renewing subscription, or auto-renewable subscription.

## See Also

- [renewal](../com.apple.storekit/StoreKit/Transaction/Reason-swift.struct/renewal.md)

---


#### renewal

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let renewal: Transaction.Reason
```

## See Also

- [purchase](../com.apple.storekit/StoreKit/Transaction/Reason-swift.struct/purchase.md)

---


### refundrequesterror


#### duplicaterequest

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case duplicateRequest
```

## 

StoreKit returns this error if the App Store has previously received a refund request for this transaction and the refund decision is still pending, has been previously denied, or has been previously approved.

Consider checking the transaction’s [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate) or [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property) before calling [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph) to identify whether the App Store has already refunded the transaction.

## See Also

- [failed](../com.apple.storekit/StoreKit/Transaction/RefundRequestError/failed.md)

---


### refundrequeststatus


#### success

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case success
```

## See Also

- [userCancelled](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus/userCancelled.md)

---


### revocationreason-swift.struct


#### developerissue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static let developerIssue: Transaction.RevocationReason
```

## See Also

- [other](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct/other.md)

---


### advancedcommerceinfo-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let advancedCommerceInfo: Transaction.AdvancedCommerceInfo?
```

## See Also

- [AdvancedCommerceInfo-swift.struct](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct.md)

---


### advancedcommerceinfo-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct AdvancedCommerceInfo
```

## Topics

### Structures

- [Item](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Item.md)
- [Offer](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Offer.md)
- [Refund](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/Refund.md)

### Instance Properties

- [description](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/description.md)
- [displayName](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/displayName.md)
- [estimatedTax](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/estimatedTax.md)
- [items](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/items.md)
- [period](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/period.md)
- [requestReferenceID](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/requestReferenceID.md)
- [taxCode](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxCode.md)
- [taxExclusivePrice](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxExclusivePrice.md)
- [taxRate](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct/taxRate.md)

## See Also

- [advancedCommerceInfo-swift.property](../com.apple.storekit/StoreKit/Transaction/advancedCommerceInfo-swift.property.md)

---


### all(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func all(for productID: String) -> Transaction.Transactions
```

## Parameters

- **productID**: Identifies the product to filter the transaction cache against.

## 

A sequence containing all transactions for the given product.

---


### all

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var all: Transaction.Transactions { get }
```

## 

This sequence returns the customer’s transaction history current to the moment you access it. The sequence emits a finite number of transactions. If the App Store processes additional transactions for the customer while you’re accessing this sequence, they appear in the transaction listener [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).

The transaction history includes the following in-app purchases:

- Unfinished consumables
- Finished consumables that are refunded or revoked
- Non-consumables
- Auto-renewable subscriptions, including all renewals
- Auto-renewable subscriptions and non-consumables that the customer gets through Family Sharing

By default, when the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory) property list key is `false`, the transaction information excludes finished consumables (unless refunded or revoked).

To get all possible transactions, including all finished consumables, set the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory) property list key to `true`.

## See Also

- [Transaction](../com.apple.storekit/StoreKit/Transaction.md)
- [updates](../com.apple.storekit/StoreKit/Transaction/updates.md)
- [currentEntitlements](../com.apple.storekit/StoreKit/Transaction/currentEntitlements.md)

---


### appaccounttoken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let appAccountToken: UUID?
```

## 

You create an [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/appAccountToken(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/appAccountToken(_:)) and send it to the App Store when a customer initiates an in-app purchase. The App Store returns the same value in [doc://com.apple.storekit/documentation/StoreKit/Transaction/appAccountToken](doc://com.apple.storekit/documentation/StoreKit/Transaction/appAccountToken) in the transaction information after the customer completes the purchase.

---


### appbundleid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let appBundleID: String
```

## See Also

- [productID](../com.apple.storekit/StoreKit/Transaction/productID.md)
- [productType](../com.apple.storekit/StoreKit/Transaction/productType.md)
- [subscriptionGroupID](../com.apple.storekit/StoreKit/Transaction/subscriptionGroupID.md)

---


### beginrefundrequest(for:in:)-65tph

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor static func beginRefundRequest(for transactionID: UInt64, in scene: UIWindowScene) async throws -> Transaction.RefundRequestStatus
```

## Parameters

- **transactionID**: The identifier of the transaction the user is requesting a refund for.
- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that the system displays the sheet on.

## 

[doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus](doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus)

## 

Call this function from account settings or a help menu to enable customers to request a refund for an in-app purchase within your app. When you call this function, the system displays a refund sheet with the customer’s purchase details and a list of reason codes for the customer to choose from. For design guidance, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases).

When a customer requests a refund for consumable in-app purchases through your app, the App Stores sends a `CONSUMPTION_REQUEST` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) to your server. If the customer provided consent, respond by sending consumption data to the App Store using the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information](doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information) endpoint. If not, don’t respond to the `CONSUMPTION_REQUEST` notification.

The App Store takes up to 48 hours to either approve or deny a refund.

For information about setting up your server to receive notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications).

> **NOTE:** If your app uses SwiftUI, use [doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)](doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)) instead. For example usage, see [doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app](doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app).

### 

The sandbox environment and StoreKit Testing in Xcode both support testing refund requests. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests](doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests).

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-9k0pj](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj.md)
- [beginRefundRequest(in:)-63bvd](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-63bvd.md)
- [beginRefundRequest(for:in:)-9mscy](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy.md)
- [RefundRequestError](../com.apple.storekit/StoreKit/Transaction/RefundRequestError.md)
- [RefundRequestStatus](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus.md)

---


### beginrefundrequest(for:in:)-9mscy

## Declaration

**Platforms:** macOS

```swift
static func beginRefundRequest(for transactionID: UInt64, in controller: NSViewController) async throws -> Transaction.RefundRequestStatus
```

## Parameters

- **transactionID**: The identifier of the transaction the user is requesting a refund for.
- **controller**: The [doc://com.apple.documentation/documentation/AppKit/NSViewController](doc://com.apple.documentation/documentation/AppKit/NSViewController) that the system displays the sheet on.

## 

[doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus](doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus)

## 

Call this function from account settings or a help menu to enable customers to request a refund for an in-app purchase within your app. When you call this function, the system displays a refund sheet with the customer’s purchase details and a list of reason codes for the customer to choose from. For design guidance, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases).

When a customer requests a refund for consumable in-app purchases through your app, the App Stores sends a `CONSUMPTION_REQUEST` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) to your server. If the customer provided consent, respond by sending consumption data to the App Store using the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information](doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information) endpoint. If not, don’t respond to the `CONSUMPTION_REQUEST` notification.

The App Store takes up to 48 hours to either approve or deny a refund.

For information about setting up your server to receive notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications).

> **NOTE:** If your app uses SwiftUI, use [doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)](doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)) instead. For example usage, see [doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app](doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app).

### 

The sandbox environment and StoreKit Testing in Xcode both support testing refund requests. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests](doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests).

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-9k0pj](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj.md)
- [beginRefundRequest(in:)-63bvd](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-63bvd.md)
- [beginRefundRequest(for:in:)-65tph](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph.md)
- [RefundRequestError](../com.apple.storekit/StoreKit/Transaction/RefundRequestError.md)
- [RefundRequestStatus](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus.md)

---


### beginrefundrequest(in:)-63bvd

## Declaration

**Platforms:** macOS

```swift
func beginRefundRequest(in controller: NSViewController) async throws -> Transaction.RefundRequestStatus
```

## Parameters

- **controller**: The [doc://com.apple.documentation/documentation/AppKit/NSViewController](doc://com.apple.documentation/documentation/AppKit/NSViewController) that the system displays the sheet on.

## 

[doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus](doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus)

## 

Call this function from account settings or a help menu to enable customers to request a refund for an in-app purchase within your app. When you call this function, the system displays a refund sheet with the customer’s purchase details and a list of reason codes for the customer to choose from. For design guidance, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases).

When a customer requests a refund for consumable in-app purchases through your app, the App Stores sends a `CONSUMPTION_REQUEST` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) to your server. If the customer provided consent, respond by sending consumption data to the App Store using the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information](doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information) endpoint. If not, don’t respond to the `CONSUMPTION_REQUEST` notification.

The App Store takes up to 48 hours to either approve or deny a refund.

For information about setting up your server to receive notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications).

> **NOTE:** If your app uses SwiftUI, use [doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)](doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)) instead. For example usage, see [doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app](doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app).

### 

The sandbox environment and StoreKit Testing in Xcode both support testing refund requests. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests](doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests).

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-9k0pj](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj.md)
- [beginRefundRequest(for:in:)-65tph](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph.md)
- [beginRefundRequest(for:in:)-9mscy](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy.md)
- [RefundRequestError](../com.apple.storekit/StoreKit/Transaction/RefundRequestError.md)
- [RefundRequestStatus](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus.md)

---


### beginrefundrequest(in:)-9k0pj

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
func beginRefundRequest(in scene: UIWindowScene) async throws -> Transaction.RefundRequestStatus
```

## Parameters

- **scene**: The [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) that the system displays the sheet on.

## 

[doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus](doc://com.apple.storekit/documentation/StoreKit/Transaction/RefundRequestStatus)

## 

Call this function from account settings or a help menu to enable customers to request a refund for an in-app purchase within your app. When you call this function, the system displays a refund sheet with the customer’s purchase details and a list of reason codes for the customer to choose from. For design guidance, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/#providing-help-with-in-app-purchases).

When a customer requests a refund for consumable in-app purchases through your app, the App Stores sends a `CONSUMPTION_REQUEST` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) to your server. If the customer provided consent, respond by sending consumption data to the App Store using the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information](doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information) endpoint. If not, don’t respond to the `CONSUMPTION_REQUEST` notification.

The App Store takes up to 48 hours to either approve or deny a refund.

For information about setting up your server to receive notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications).

> **NOTE:** If your app uses SwiftUI, use [doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)](doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)) instead. For example usage, see [doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app](doc://com.apple.documentation/documentation/SwiftUI/food-truck-building-a-swiftui-multiplatform-app).

### 

The sandbox environment and StoreKit Testing in Xcode both support testing refund requests. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests](doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests).

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-63bvd](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-63bvd.md)
- [beginRefundRequest(for:in:)-65tph](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph.md)
- [beginRefundRequest(for:in:)-9mscy](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy.md)
- [RefundRequestError](../com.apple.storekit/StoreKit/Transaction/RefundRequestError.md)
- [RefundRequestStatus](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus.md)

---


### currency

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 17.2, macOS 14.2, tvOS 17.2, watchOS 10.2, visionOS 1.1)
var currency: Locale.Currency? { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/Transaction/currency](doc://com.apple.storekit/documentation/StoreKit/Transaction/currency) property represents the currency of the product’s [doc://com.apple.storekit/documentation/StoreKit/Transaction/price](doc://com.apple.storekit/documentation/StoreKit/Transaction/price) that the system records at the time of purchase.

> **IMPORTANT:** For financial and accounting purposes, use the App Store Connect reporting tools. For more information, see [https://developer.apple.com/help/app-store-connect/getting-paid/download-financial-reports](https://developer.apple.com/help/app-store-connect/getting-paid/download-financial-reports) and [https://developer.apple.com/help/app-store-connect/measure-app-performance/overview-of-reporting-tools](https://developer.apple.com/help/app-store-connect/measure-app-performance/overview-of-reporting-tools).

Don’t use [doc://com.apple.storekit/documentation/StoreKit/Transaction/currency](doc://com.apple.storekit/documentation/StoreKit/Transaction/currency) to infer the storefront. Use the [doc://com.apple.storekit/documentation/StoreKit/Transaction/storefront](doc://com.apple.storekit/documentation/StoreKit/Transaction/storefront) value in the transaction instead.

To access the transaction’s currency on systems earlier than iOS 16, iPadOS 16, macOS 13, tvOS 16, and watchOS 9, use [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currencyCode](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currencyCode).

## See Also

- [price](../com.apple.storekit/StoreKit/Transaction/price.md)

---


### currencycode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0)
var currencyCode: String? { get }
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/Transaction/currencyCode](doc://com.apple.storekit/documentation/StoreKit/Transaction/currencyCode) property contains an ISO 4217 alpha-3 string that represents the currency of the price of the product. Use [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currencyCode](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currencyCode) to access the currency of the price on systems earlier than iOS 16, iPadOS 16, macOS 13, tvOS 16, and watchOS 9. Otherwise, use [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currency](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/currency).

> **IMPORTANT:** For financial and accounting purposes, use the App Store Connect reporting tools. For more information, see [https://developer.apple.com/help/app-store-connect/getting-paid/download-financial-reports](https://developer.apple.com/help/app-store-connect/getting-paid/download-financial-reports) and [https://developer.apple.com/help/app-store-connect/measure-app-performance/overview-of-reporting-tools](https://developer.apple.com/help/app-store-connect/measure-app-performance/overview-of-reporting-tools).

Don’t use [doc://com.apple.storekit/documentation/StoreKit/Transaction/currencyCode](doc://com.apple.storekit/documentation/StoreKit/Transaction/currencyCode) to infer the storefront. Use the [doc://com.apple.storekit/documentation/StoreKit/Transaction/storefront](doc://com.apple.storekit/documentation/StoreKit/Transaction/storefront) value in the transaction instead.

For more information on how you set prices, see [https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/set-a-price-for-an-in-app-purchase](https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/set-a-price-for-an-in-app-purchase).

## See Also

- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

---


### currententitlement(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func currentEntitlement(for productID: String) async -> VerificationResult<Transaction>?
```

## Parameters

- **productID**: In-App Purchase product identifier.

## 

A [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult) or `nil` if the customer has no current In-App Purchases.

## See Also

- [currentEntitlements(for:)](../com.apple.storekit/StoreKit/Transaction/currentEntitlements(for:).md)
- [offerPeriodStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPeriodStringRepresentation.md)

---


### currententitlements(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func currentEntitlements(for productID: String) -> Transaction.Transactions
```

## Parameters

- **productID**: Identifies the product to check entitlements for.

## 

A sequence containing all transactions that entitle the user to the product.

## 

If a generic SKU is provided, the returned sequence will yield all transactions that entitle the user to Advanced Commerce Items purchased using the generic product’s ID.

If an ID for a regular IAP is provided, the returned sequence will contain no more than one transaction.

## See Also

- [currentEntitlement(for:)](../com.apple.storekit/StoreKit/Transaction/currentEntitlement(for:).md)
- [offerPeriodStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPeriodStringRepresentation.md)

---


### currententitlements

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var currentEntitlements: Transaction.Transactions { get }
```

## 

The current entitlements sequence emits the latest transaction for each product the customer has an entitlement to, specifically:

- A transaction for each non-consumable In-App Purchase
- The latest transaction for each auto-renewable subscription that has a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState) state of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/subscribed) or [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState/inGracePeriod)
- The latest transaction for each non-renewing subscription, including finished ones

Products that the App Store has refunded or revoked don’t appear in the current entitlements. Consumable In-App Purchases also don’t appear in the current entitlements. To get transactions for unfinished consumables, use the [doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished](doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished) or [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all) sequences in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

The following example illustrates iterating through the current entitlements:

```swift
func refreshPurchasedProducts() async {
    // Iterate through the user's purchased products.
    for await verificationResult in Transaction.currentEntitlements {
        switch verificationResult {
        case .verified(let transaction):
            // Check the type of product for the transaction
            // and provide access to the content as appropriate.
            ...
        case .unverified(let unverifiedTransaction, let verificationError):
            // Handle unverified transactions based on your
            // business model.
            ...
        }
    }
}
```

## See Also

- [Transaction](../com.apple.storekit/StoreKit/Transaction.md)
- [updates](../com.apple.storekit/StoreKit/Transaction/updates.md)
- [all](../com.apple.storekit/StoreKit/Transaction/all.md)

---


### environmentstringrepresentation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
@backDeployed(before: iOS 16.0, macOS 13.0, tvOS 16.0, watchOS 9.0, macCatalyst 16.0)
var environmentStringRepresentation: String { get }
```

## See Also

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

---


### expirationdate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let expirationDate: Date?
```

## See Also

- [purchaseDate](../com.apple.storekit/StoreKit/Transaction/purchaseDate.md)

---


### finish()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func finish() async
```

## 

Call [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()) to complete a transaction after you deliver the purchased content or enable the purchased service. For on-demand resources, don’t finish the transaction until the app completes downloading the resource or you’ve otherwise delivered the resource.

## See Also

- [unfinished](../com.apple.storekit/StoreKit/Transaction/unfinished.md)

---


### isupgraded

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let isUpgraded: Bool
```

## 

If [doc://com.apple.storekit/documentation/StoreKit/Transaction/isUpgraded](doc://com.apple.storekit/documentation/StoreKit/Transaction/isUpgraded) is `true`, the user has upgraded the subscription represented by this transaction to another subscription. This value appears in the transaction only when the value is `true`. To determine the service that the customer is entitled to, look for another transaction that has a subscription with a higher level of service.

## See Also

- [ownershipType-swift.property](../com.apple.storekit/StoreKit/Transaction/ownershipType-swift.property.md)
- [OwnershipType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct.md)
- [purchasedQuantity](../com.apple.storekit/StoreKit/Transaction/purchasedQuantity.md)

---


### latest(for:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static func latest(for productID: String) async -> VerificationResult<Transaction>?
```

## Parameters

- **productID**: The product identifier that the method uses to look up the most recent transaction.

## 

A [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult) with a single [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction), or `nil` if the customer hasn’t purchased the product.

## 

Call this method for any type of In-App Purchase. The following code example illustrates requesting the most recent transaction to determine whether the customer purchased the product indicated by the string `productIdentifier`:

```swift
guard let verificationResult = await Transaction.latest(for: productIdentifier) else {    
    // The customer hasn't purchased this product.
    return
}

switch verificationResult {
case .verified(let transaction):
    // Check the transaction and give the customer access to purchased 
    // content as appropriate.
    ...
case .unverified(let transaction, let verificationError):
    // Handle unverified transactions based 
    // on your business model.
    ...
}
```

By default, when the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory) property list key is `false`, this method excludes finished consumable in-app purchases unless they are refunded or revoked.

If you set the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory) property list key to `true`, this method returns all transactions, including consumable In-App Purchases that your app marked as finished ([doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish())).

## See Also

- [all](../com.apple.storekit/StoreKit/Transaction/all.md)
- [unfinished](../com.apple.storekit/StoreKit/Transaction/unfinished.md)
- [SKIncludeConsumableInAppPurchaseHistory](../com.apple.BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory.md)

---


### offer-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let offer: Transaction.Offer?
```

## 

This value is `nil` if the transaction doesn’t include an offer.

You set up offers for auto-renewable subscriptions and other In-App Purchase product types in App Store Connect. If a customer redeems an offer, this property contains the offer details, including its [doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/type](doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/type), [doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/paymentMode-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/paymentMode-swift.property), and [doc://com.apple.storekit/documentation/StoreKit/Transaction/id](doc://com.apple.storekit/documentation/StoreKit/Transaction/id). For more information, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct](doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct).

## See Also

- [Offer-swift.struct](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct.md)

---


### offer-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Offer
```

## 

You set up offers for auto-renewable subscriptions and other In-App Purchase types in App Store Connect. If a customer redeems an offer, it appears in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property) property of the transaction. For auto-renewable subscriptions, if the offer applies to one or more renewal periods, it also appears in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer) property of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo).

For more information on configuring the various offers in App Store Connect, see:

- [https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/create-offer-codes-for-in-app-purchases](https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/create-offer-codes-for-in-app-purchases)
- [https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers](https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers).
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-offer-codes/](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-offer-codes/)
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-introductory-offers-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-introductory-offers-for-auto-renewable-subscriptions)
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-promotional-offers-for-auto-renewable-subscriptions)
- [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers)

## Topics

### Getting offer details

- [id](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/id.md)
- [type](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/type.md)
- [OfferType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/paymentMode-swift.property.md)
- [PaymentMode-swift.struct](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/PaymentMode-swift.struct.md)
- [period](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct/period.md)

## See Also

- [offer](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/offer.md)
- [eligibleWinBackOfferIDs](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs.md)

---


### offerid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var offerID: String? { get }
```

## 

This value is `nil` if there isn’t an offer, or if the offer type is [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/introductory](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/introductory).

If the offer type is [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/promotional](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/promotional), this value contains the promotional offer identifier you set up in App Store Connect. For more information about promotional offers, see [https://help.apple.com/app-store-connect/#/dev16dfca448](https://help.apple.com/app-store-connect/#/dev16dfca448).

If the offer type is [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/code](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/code), this value contains the reference name of the offer code you set up in App Store Connect. For more information about offer codes, see [https://help.apple.com/app-store-connect/#/dev6a098e4b1](https://help.apple.com/app-store-connect/#/dev6a098e4b1).

## See Also

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

---


### offerpaymentmodestringrepresentation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 17.2, macOS 14.2, tvOS 17.2, watchOS 10.2)
var offerPaymentModeStringRepresentation: String? { get }
```

## See Also

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

---


### offerperiodstringrepresentation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@backDeployed(before: iOS 18.4, macOS 15.4, tvOS 18.4, watchOS 11.4, visionOS 2.4)
var offerPeriodStringRepresentation: String? { get }
```

## 

This value is present only for subscriptions that include an offer.

> **IMPORTANT:** In rare cases, the property might return a sentinel `nil` value. One possible reason is using StoreKit Testing in Xcode; try testing on a device with a newer OS. Another reason might be a critical server error.

## See Also

- [currentEntitlement(for:)](../com.apple.storekit/StoreKit/Transaction/currentEntitlement(for:).md)
- [currentEntitlements(for:)](../com.apple.storekit/StoreKit/Transaction/currentEntitlements(for:).md)

---


### offertype-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var offerType: Transaction.OfferType? { get }
```

## 

If this value is `nil`, there’s no offer applied.

## See Also

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

---


### offertype-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct OfferType
```

## 

You don’t create offer types in [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct). The static values indicate the offer types that the system reports for a transaction.

## Topics

### Getting offer types

- [introductory](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/introductory.md)
- [promotional](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/promotional.md)
- [code](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/code.md)
- [winBack](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/winBack.md)

### Getting a localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct/localizedDescription.md)

---


### originalid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let originalID: UInt64
```

## 

The original transaction identifier, [doc://com.apple.storekit/documentation/StoreKit/Transaction/originalID](doc://com.apple.storekit/documentation/StoreKit/Transaction/originalID), is identical to [doc://com.apple.storekit/documentation/StoreKit/Transaction/id](doc://com.apple.storekit/documentation/StoreKit/Transaction/id) except when the user restores a purchase or renews a transaction. You can use this value to:

- Identify one or more renewals for the same subscription.
- Differentiate a purchase transaction from a restore or a renewal transaction. For restore and renewal transactions, the original transaction identifier, [doc://com.apple.storekit/documentation/StoreKit/Transaction/originalID](doc://com.apple.storekit/documentation/StoreKit/Transaction/originalID), and transaction identifier, [doc://com.apple.storekit/documentation/StoreKit/Transaction/id](doc://com.apple.storekit/documentation/StoreKit/Transaction/id), differ.
- Match a transaction in the app with a transaction you receive on your server in an [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications) event.

## See Also

- [originalPurchaseDate](../com.apple.storekit/StoreKit/Transaction/originalPurchaseDate.md)

---


### ownershiptype-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let ownershipType: Transaction.OwnershipType
```

## See Also

- [isUpgraded](../com.apple.storekit/StoreKit/Transaction/isUpgraded.md)
- [OwnershipType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct.md)
- [purchasedQuantity](../com.apple.storekit/StoreKit/Transaction/purchasedQuantity.md)

---


### ownershiptype-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct OwnershipType
```

## Topics

### Getting ownership types

- [familyShared](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct/familyShared.md)
- [purchased](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct/purchased.md)

### Getting a localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct/localizedDescription.md)

## See Also

- [isUpgraded](../com.apple.storekit/StoreKit/Transaction/isUpgraded.md)
- [ownershipType-swift.property](../com.apple.storekit/StoreKit/Transaction/ownershipType-swift.property.md)
- [purchasedQuantity](../com.apple.storekit/StoreKit/Transaction/purchasedQuantity.md)

---


### productid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let productID: String
```

## 

You create product identifiers for in-app purchases in App Store Connect.

## See Also

- [appBundleID](../com.apple.storekit/StoreKit/Transaction/appBundleID.md)
- [productType](../com.apple.storekit/StoreKit/Transaction/productType.md)
- [subscriptionGroupID](../com.apple.storekit/StoreKit/Transaction/subscriptionGroupID.md)

---


### producttype

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let productType: Product.ProductType
```

## See Also

- [appBundleID](../com.apple.storekit/StoreKit/Transaction/appBundleID.md)
- [productID](../com.apple.storekit/StoreKit/Transaction/productID.md)
- [subscriptionGroupID](../com.apple.storekit/StoreKit/Transaction/subscriptionGroupID.md)

---


### purchasedate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let purchaseDate: Date
```

## See Also

- [expirationDate](../com.apple.storekit/StoreKit/Transaction/expirationDate.md)

---


### purchasedquantity

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let purchasedQuantity: Int
```

## See Also

- [isUpgraded](../com.apple.storekit/StoreKit/Transaction/isUpgraded.md)
- [ownershipType-swift.property](../com.apple.storekit/StoreKit/Transaction/ownershipType-swift.property.md)
- [OwnershipType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct.md)

---


### reasonstringrepresentation

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
@backDeployed(before: iOS 17.0, macOS 14.0, tvOS 17.0, watchOS 10.0, macCatalyst 17.0)
var reasonStringRepresentation: String { get }
```

## 

For more information, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/reason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/reason-swift.property).

## See Also

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

---


### refundrequesterror

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum RefundRequestError
```

## 

The following methods throw refund request errors: [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj), [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph), [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-63bvd](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-63bvd), and [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy).

## Topics

### Error Enumeration

- [duplicateRequest](../com.apple.storekit/StoreKit/Transaction/RefundRequestError/duplicateRequest.md)
- [failed](../com.apple.storekit/StoreKit/Transaction/RefundRequestError/failed.md)

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-9k0pj](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj.md)
- [beginRefundRequest(in:)-63bvd](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-63bvd.md)
- [beginRefundRequest(for:in:)-65tph](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph.md)
- [beginRefundRequest(for:in:)-9mscy](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy.md)
- [RefundRequestStatus](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus.md)

---


### refundrequeststatus

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum RefundRequestStatus
```

## 

The following methods throw the refund request status: [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj),  [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph), [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-63bvd](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-63bvd), and [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy).

The refund request status reflects the status of the request, not the status of the refund itself.

## Topics

### Getting Refund Request Status

- [userCancelled](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus/userCancelled.md)
- [success](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus/success.md)

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-9k0pj](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj.md)
- [beginRefundRequest(in:)-63bvd](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-63bvd.md)
- [beginRefundRequest(for:in:)-65tph](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph.md)
- [beginRefundRequest(for:in:)-9mscy](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy.md)
- [RefundRequestError](../com.apple.storekit/StoreKit/Transaction/RefundRequestError.md)

---


### revocationdate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let revocationDate: Date?
```

## See Also

- [revocationReason-swift.property](../com.apple.storekit/StoreKit/Transaction/revocationReason-swift.property.md)
- [RevocationReason-swift.struct](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct.md)

---


### revocationreason-swift.property

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let revocationReason: Transaction.RevocationReason?
```

## See Also

- [revocationDate](../com.apple.storekit/StoreKit/Transaction/revocationDate.md)
- [RevocationReason-swift.struct](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct.md)

---


### revocationreason-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct RevocationReason
```

## Topics

### Revocation reasons

- [developerIssue](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct/developerIssue.md)
- [other](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct/other.md)

### Getting a localized description

- [localizedDescription](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct/localizedDescription.md)

## See Also

- [revocationDate](../com.apple.storekit/StoreKit/Transaction/revocationDate.md)
- [revocationReason-swift.property](../com.apple.storekit/StoreKit/Transaction/revocationReason-swift.property.md)

---


### storefrontcountrycode

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
@backDeployed(before: iOS 17.0, macOS 14.0, tvOS 17.0, watchOS 10.0, macCatalyst 17.0)
var storefrontCountryCode: String { get }
```

## 

This property uses the ISO 3166-1 alpha-3 country code representation.

## See Also

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)

---


### subscriptiongroupid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let subscriptionGroupID: String?
```

## See Also

- [appBundleID](../com.apple.storekit/StoreKit/Transaction/appBundleID.md)
- [productID](../com.apple.storekit/StoreKit/Transaction/productID.md)
- [productType](../com.apple.storekit/StoreKit/Transaction/productType.md)

---


### transactions

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Transactions
```

## 

You don’t create a [doc://com.apple.storekit/documentation/StoreKit/Transaction/Transactions](doc://com.apple.storekit/documentation/StoreKit/Transaction/Transactions) sequence directly. Use methods such as [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all), [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates), or [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) to get transactions.

## See Also

- [updates](../com.apple.storekit/StoreKit/Transaction/updates.md)

---


### unfinished

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var unfinished: Transaction.Transactions { get }
```

## 

A transaction is unfinished until you call [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()). Use the [doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished](doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished) sequence to find the transactions your app needs to process to deliver purchased content or enable service.

## See Also

- [latest(for:)](../com.apple.storekit/StoreKit/Transaction/latest(for:).md)
- [all](../com.apple.storekit/StoreKit/Transaction/all.md)
- [SKIncludeConsumableInAppPurchaseHistory](../com.apple.BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory.md)

---


### updates

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
static var updates: Transaction.Transactions { get }
```

## 

Use [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) to receive new transactions while the app is running. This sequence receives transactions that occur outside of the app, such as Ask to Buy transactions, offer code redemptions, and purchases that customers make in the App Store. It also emits transactions that customers complete in your app on another device.

Note that after a successful in-app purchase on the same device, StoreKit returns the transaction through [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/success(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/success(_:)).

> **IMPORTANT:** Create a [doc://com.apple.documentation/documentation/Swift/Task](doc://com.apple.documentation/documentation/Swift/Task) to iterate through the transactions from the listener as soon as your app launches. If your app has unfinished transactions, the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) listener receives them once, immediately after the app launches. Without the [doc://com.apple.documentation/documentation/Swift/Task](doc://com.apple.documentation/documentation/Swift/Task) to listen for these transactions, your app may miss them.

The following example shows a class that creates a [doc://com.apple.documentation/documentation/Swift/Task](doc://com.apple.documentation/documentation/Swift/Task) when it initializes. The task retrieves and processes any unfinished transactions.

```swift
final class TransactionObserver {
    
    var updates: Task<Void, Never>? = nil
    
    init() {
        updates = newTransactionListenerTask()
    }

    deinit {
        // Cancel the update handling task when you deinitialize the class.
        updates?.cancel()
    }
    
    private func newTransactionListenerTask() -> Task<Void, Never> {
        Task(priority: .background) {
            for await verificationResult in Transaction.updates {
                self.handle(updatedTransaction: verificationResult)
            }
        }
    }
    
    private func handle(updatedTransaction verificationResult: VerificationResult<Transaction>) {
        guard case .verified(let transaction) = verificationResult else {
            // Ignore unverified transactions.
            return
        }

        if let revocationDate = transaction.revocationDate {
            // Remove access to the product identified by transaction.productID.
            // Transaction.revocationReason provides details about
            // the revoked transaction.
            <#...#>
        } else if let expirationDate = transaction.expirationDate,
            expirationDate < Date() {
            // Do nothing, this subscription is expired.
            return
        } else if transaction.isUpgraded {
            // Do nothing, there is an active transaction
            // for a higher level of service.
            return
        } else {
            // Provide access to the product identified by
            // transaction.productID.
            <#...#>
        }
    }
    
}
```

The [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) listener receives unfinished transactions just once at app launch, but you can use the [doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished](doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished) listener to get your app’s unfinished transactions at any time. For information on finishing transactions, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()).

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [Transaction](../com.apple.storekit/StoreKit/Transaction.md)
- [all](../com.apple.storekit/StoreKit/Transaction/all.md)
- [currentEntitlements](../com.apple.storekit/StoreKit/Transaction/currentEntitlements.md)

---


### weborderlineitemid

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let webOrderLineItemID: String?
```

## See Also

- [id](../com.apple.storekit/StoreKit/Transaction/id.md)

---


## verificationresult


### verificationerror


#### invalidcertificatechain

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case invalidCertificateChain
```

## 

This error may occur if one or more certificates in the certiificate chain are expired or from an untrusted source.

## See Also

- [invalidDeviceVerification](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidDeviceVerification.md)
- [invalidEncoding](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidEncoding.md)
- [invalidSignature](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidSignature.md)
- [missingRequiredProperties](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/missingRequiredProperties.md)
- [revokedCertificate](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/revokedCertificate.md)

---


#### invaliddeviceverification

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case invalidDeviceVerification
```

## See Also

- [invalidCertificateChain](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidCertificateChain.md)
- [invalidEncoding](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidEncoding.md)
- [invalidSignature](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidSignature.md)
- [missingRequiredProperties](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/missingRequiredProperties.md)
- [revokedCertificate](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/revokedCertificate.md)

---


#### invalidencoding

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case invalidEncoding
```

## See Also

- [invalidCertificateChain](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidCertificateChain.md)
- [invalidDeviceVerification](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidDeviceVerification.md)
- [invalidSignature](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidSignature.md)
- [missingRequiredProperties](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/missingRequiredProperties.md)
- [revokedCertificate](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/revokedCertificate.md)

---


#### missingrequiredproperties

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case missingRequiredProperties
```

## See Also

- [invalidCertificateChain](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidCertificateChain.md)
- [invalidDeviceVerification](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidDeviceVerification.md)
- [invalidEncoding](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidEncoding.md)
- [invalidSignature](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidSignature.md)
- [revokedCertificate](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/revokedCertificate.md)

---


#### revokedcertificate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case revokedCertificate
```

## 

In some cases, this error may resolve if you try again later.

## See Also

- [invalidCertificateChain](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidCertificateChain.md)
- [invalidDeviceVerification](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidDeviceVerification.md)
- [invalidEncoding](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidEncoding.md)
- [invalidSignature](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidSignature.md)
- [missingRequiredProperties](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/missingRequiredProperties.md)

---


### deviceverification-5hvi9

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var deviceVerification: Data { get }
```

## 

For more information about using the device verification value, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification).

This value is identical to the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerification) value in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo).

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### deviceverification-69lvx

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var deviceVerification: Data { get }
```

## 

For more information about using the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-69lvx](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-69lvx) value, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification).

This value is identical to the [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification) value in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### deviceverification-6c8xu

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var deviceVerification: Data { get }
```

## 

For more information about using the device verification value, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification).

This value is identical to the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerification) value in [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### deviceverificationnonce-6082b

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var deviceVerificationNonce: UUID { get }
```

## 

Use the lowercased nonce when computing the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-6c8xu](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-6c8xu) value.

This value is identical to the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerificationNonce](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/deviceVerificationNonce) value in [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### deviceverificationnonce-6mzfc

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var deviceVerificationNonce: UUID { get }
```

## 

Use the lowercased nonce when computing the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-5hvi9](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-5hvi9) value.

This value is identical to the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerificationNonce](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/deviceVerificationNonce) value in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo).

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### deviceverificationnonce-9dfrn

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var deviceVerificationNonce: UUID { get }
```

## 

Use the lowercased nonce when computing the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-69lvx](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/deviceVerification-69lvx) value.

This value is identical to the [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerificationNonce](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerificationNonce) value in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### headerdata-3be0o

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var headerData: Data { get }
```

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### headerdata-3drrl

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var headerData: Data { get }
```

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### headerdata-9egfp

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var headerData: Data { get }
```

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### jwsrepresentation-178oj

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var jwsRepresentation: String { get }
```

## 

Use this JSON Web Signature (JWS) value to perform your own JWS verification on your server or on the device.

The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) is the same as the [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfo](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfo) that the App Store Server API returns, and the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSRenewalInfo](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSRenewalInfo) that you receive from App Store Server Notifications. The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo)’s decoded payload contains two additional fields: `deviceVerification` and `deviceVerificationNonce`. Use these fields on the device to verify that the JWS information belongs to the device. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID).

To verify the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj) on your server, consider using the App Store Server Library function `verifyAndDecodeRenewalInfo`, available in each language the library supports. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

> **IMPORTANT:** The decoded payloads of the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) and [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfo](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfo) strings contain [doc://com.apple.documentation/documentation/AppStoreServerAPI/renewalPrice](doc://com.apple.documentation/documentation/AppStoreServerAPI/renewalPrice) fields that are specified in *milliunits* of the currency; StoreKit represents the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalPrice](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalPrice) in *units* of currency. Take care not to confuse these two representations when working with both APIs.

## See Also

- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### jwsrepresentation-21vgo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var jwsRepresentation: String { get }
```

## 

Use this JSON Web Signature (JWS) value to perform your own JWS verification on your server or on the device.

The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) is the same as the [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction) that the App Store Server API returns and the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransaction) that you receive from App Store Server Notifications. The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo)’s decoded payload contains two additional fields: `deviceVerification` and `deviceVerificationNonce`. Use these fields on the device to verify that the JWS information belongs to the device. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID).

To verify the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) on your server, consider using the App Store Server Library function `verifyAndDecodeTransaction`, available in each language the library supports. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

> **IMPORTANT:** The decoded payloads of the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) and [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction) strings contain [doc://com.apple.documentation/documentation/AppStoreServerAPI/price](doc://com.apple.documentation/documentation/AppStoreServerAPI/price) fields that are specified in *milliunits* of the currency;  StoreKit represents the `price`  in *units* of currency. Take care not to confuse these two representations when working with both APIs.

## See Also

- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### jwsrepresentation-6ma59

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var jwsRepresentation: String { get }
```

## 

Use this JSON Web Signature (JWS) value to perform your own JWS verification on your server or on the device.

To verify the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59) on your server, consider using the App Store Server Library function `verifyAndDecodeAppTransaction`, available in each language the library supports. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59)’s decoded payload contains the fields `deviceVerification` and `deviceVerificationNonce`. Use these fields on the device to verify that the JWS information belongs to the device. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID).

## See Also

- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### payloaddata-97acz

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var payloadData: Data { get }
```

## 

This value is the same as the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/jsonRepresentation](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/jsonRepresentation) in [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### payloaddata-abfv

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var payloadData: Data { get }
```

## 

This value is the same as the [doc://com.apple.storekit/documentation/StoreKit/Transaction/jsonRepresentation](doc://com.apple.storekit/documentation/StoreKit/Transaction/jsonRepresentation) in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo).

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### payloaddata-uyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var payloadData: Data { get }
```

## 

This value is the same as the [doc://com.apple.storekit/documentation/StoreKit/Transaction/jsonRepresentation](doc://com.apple.storekit/documentation/StoreKit/Transaction/jsonRepresentation) in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### payloadvalue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var payloadValue: SignedType { get throws }
```

## 

This property represents the value of a payload in a JSON Web Signature (JWS) value that passed StoreKit verification.

This property throws an error if the JWS value containing the payload doesn’t pass StoreKit’s verification and is therefore *unverified*. To access the payload of an unverified JWS value, get the associated value of the verification result, or use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unsafePayloadValue](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unsafePayloadValue) property.

## See Also

- [verified(_:)](../com.apple.storekit/StoreKit/VerificationResult/verified(_:).md)
- [unverified(_:_:)](../com.apple.storekit/StoreKit/VerificationResult/unverified(_:_:).md)
- [unsafePayloadValue](../com.apple.storekit/StoreKit/VerificationResult/unsafePayloadValue.md)
- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

---


### signature-6d5ue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signature: P256.Signing.ECDSASignature { get }
```

## 

Use this [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signature-95r7x](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signature-95r7x) with [doc://com.apple.documentation/documentation/CryptoKit](doc://com.apple.documentation/documentation/CryptoKit) if you verify the signature on the device.

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)

---


### signature-7t1ne

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signature: P256.Signing.ECDSASignature { get }
```

## 

Use this [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signature-7t1ne](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signature-7t1ne) with [doc://com.apple.documentation/documentation/CryptoKit](doc://com.apple.documentation/documentation/CryptoKit) if you verify the signature on the device.

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)

---


### signature-95r7x

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signature: P256.Signing.ECDSASignature { get }
```

## 

Use this [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signature-95r7x](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signature-95r7x) with [doc://com.apple.documentation/documentation/CryptoKit](doc://com.apple.documentation/documentation/CryptoKit) if you verify the signature on the device.

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)

---


### signaturedata-4pvv0

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signatureData: Data { get }
```

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### signaturedata-4pyv8

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signatureData: Data { get }
```

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### signaturedata-9uw8c

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signatureData: Data { get }
```

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### signeddata-1t80n

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signedData: Data { get }
```

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### signeddata-56usp

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signedData: Data { get }
```

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### signeddata-99fyo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signedData: Data { get }
```

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### signeddate-24zch

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signedDate: Date { get }
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signedDate-24zch](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signedDate-24zch) to verify whether the certificate used to sign the transaction was valid when the App Store signed the transaction.

## See Also

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

---


### signeddate-3tvo5

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signedDate: Date { get }
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signedDate-8x9bg](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signedDate-8x9bg) to verify whether the certificate used to sign the transaction was valid when the App Store signed the transaction.

## See Also

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

---


### signeddate-8x9bg

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var signedDate: Date { get }
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signedDate-8x9bg](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signedDate-8x9bg) to verify whether the certificate used to sign the transaction was valid when the App Store signed the transaction.

## See Also

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

---


### unsafepayloadvalue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
var unsafePayloadValue: SignedType { get }
```

## 

This property represents the value of a payload in a JSON Web Signature (JWS) value that’s not confirmed to have passed StoreKit verification.

Use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unsafePayloadValue](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unsafePayloadValue) for debugging purposes or other situations where the integrity of the data is unimportant. This property ignores any verification errors. To get a payload that passed verification, or to check for verification errors, use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/payloadValue](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/payloadValue) property instead.

> **IMPORTANT:** Don’t trust the integrity of the values you receive from the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unsafePayloadValue](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unsafePayloadValue) property. This property contains data regardless of the verification result, and contains data even if StoreKit’s verification fails.

To determine if the JWS value fails verification, perform a verification on the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj) property for subscription renewal information, the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) property for transactions, or the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59) property for app transactions.

## See Also

- [verified(_:)](../com.apple.storekit/StoreKit/VerificationResult/verified(_:).md)
- [unverified(_:_:)](../com.apple.storekit/StoreKit/VerificationResult/unverified(_:_:).md)
- [payloadValue](../com.apple.storekit/StoreKit/VerificationResult/payloadValue.md)
- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

---


### unverified(_:_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case unverified(SignedType, VerificationResult<SignedType>.VerificationError)
```

## 

The first associated value in this case is the App Store-signed value. The second associated value provides the reason why the verification failed.

## See Also

- [verified(_:)](../com.apple.storekit/StoreKit/VerificationResult/verified(_:).md)
- [payloadValue](../com.apple.storekit/StoreKit/VerificationResult/payloadValue.md)
- [unsafePayloadValue](../com.apple.storekit/StoreKit/VerificationResult/unsafePayloadValue.md)
- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

---


### verificationerror

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum VerificationError
```

## Topics

### Error Codes

- [invalidCertificateChain](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidCertificateChain.md)
- [invalidDeviceVerification](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidDeviceVerification.md)
- [invalidEncoding](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidEncoding.md)
- [invalidSignature](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/invalidSignature.md)
- [missingRequiredProperties](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/missingRequiredProperties.md)
- [revokedCertificate](../com.apple.storekit/StoreKit/VerificationResult/VerificationError/revokedCertificate.md)

## See Also

- [VerificationResult](../com.apple.storekit/StoreKit/VerificationResult.md)

---


### verified(_:)

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
case verified(SignedType)
```

## 

The associated value in this case is the App Store-signed value.

## See Also

- [unverified(_:_:)](../com.apple.storekit/StoreKit/VerificationResult/unverified(_:_:).md)
- [payloadValue](../com.apple.storekit/StoreKit/VerificationResult/payloadValue.md)
- [unsafePayloadValue](../com.apple.storekit/StoreKit/VerificationResult/unsafePayloadValue.md)
- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

---


## AppStoreMerchandisingKind

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
struct AppStoreMerchandisingKind
```

## Topics

### Type methods

- [subscriptionBundle(_:)](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind/subscriptionBundle(_:).md)

### Enumerations

- [PresentationResult](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind/PresentationResult.md)

---


## AppTransaction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct AppTransaction
```

## 

> **NOTE:** Session 10007:  [https://developer.apple.com/videos/play/wwdc2022/10007/](https://developer.apple.com/videos/play/wwdc2022/10007/)

## Topics

### Getting the signed app transaction

- [shared](../com.apple.storekit/StoreKit/AppTransaction/shared.md)

### Getting the app transaction identifier

- [appTransactionID](../com.apple.storekit/StoreKit/AppTransaction/appTransactionID.md)

### Getting the environment

- [environment](../com.apple.storekit/StoreKit/AppTransaction/environment.md)
- [Environment](../com.apple.storekit/StoreKit/AppStore/Environment.md)

### Getting app and version information

- [bundleID](../com.apple.storekit/StoreKit/AppTransaction/bundleID.md)
- [appVersion](../com.apple.storekit/StoreKit/AppTransaction/appVersion.md)
- [originalAppVersion](../com.apple.storekit/StoreKit/AppTransaction/originalAppVersion.md)
- [appID](../com.apple.storekit/StoreKit/AppTransaction/appID.md)
- [appVersionID](../com.apple.storekit/StoreKit/AppTransaction/appVersionID.md)

### Getting the original platform

- [originalPlatform](../com.apple.storekit/StoreKit/AppTransaction/originalPlatform.md)
- [Platform](../com.apple.storekit/StoreKit/AppStore/Platform.md)

### Getting purchase dates

- [originalPurchaseDate](../com.apple.storekit/StoreKit/AppTransaction/originalPurchaseDate.md)
- [preorderDate](../com.apple.storekit/StoreKit/AppTransaction/preorderDate.md)

### Verifying the app transaction

- [deviceVerification](../com.apple.storekit/StoreKit/AppTransaction/deviceVerification.md)
- [deviceVerificationNonce](../com.apple.storekit/StoreKit/AppTransaction/deviceVerificationNonce.md)
- [signedDate](../com.apple.storekit/StoreKit/AppTransaction/signedDate.md)

### Getting app transaction information in JSON format

- [jsonRepresentation](../com.apple.storekit/StoreKit/AppTransaction/jsonRepresentation.md)

### Getting app transaction from the server

- [refresh()](../com.apple.storekit/StoreKit/AppTransaction/refresh().md)

### Deprecated

- [originalPlatformStringRepresentation](../com.apple.storekit/StoreKit/AppTransaction/originalPlatformStringRepresentation.md)

## See Also

- [supporting-business-model-changes-by-using-the-app-transaction](../com.apple.storekit/StoreKit/supporting-business-model-changes-by-using-the-app-transaction.md)

---


## AutomaticSubscriptionOptionGroupLabel

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct AutomaticSubscriptionOptionGroupLabel
```

---


## AutomaticSubscriptionOptionGroupStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct AutomaticSubscriptionOptionGroupStyle
```

## Topics

### Getting the automatic style

- [automatic](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/automatic.md)
- [init()](../com.apple.storekit/StoreKit/AutomaticSubscriptionOptionGroupStyle/init().md)

## See Also

- [LinksSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/LinksSubscriptionOptionGroupStyle.md)
- [TabsSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/TabsSubscriptionOptionGroupStyle.md)
- [SubscriptionOptionGroupStyleOutput](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyleOutput.md)

---


## AutomaticSubscriptionStoreControlPlacement

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct AutomaticSubscriptionStoreControlPlacement
```

## 

You typically don’t use this type directly, except when you implement a custom control style. By default, a custom control style supports all placements. For more information, see the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlPlacement](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlPlacement) protocol.

## Topics

### Getting automatic placements

- [automatic](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/automatic.md)
- [bottomBar](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/buttonsInBottomBar.md)
- [scrollView](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/scrollView.md)
- [bottom](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/bottom.md)
- [leading](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/leading.md)
- [trailing](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement/trailing.md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [ProminentPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ProminentPickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)
- [PagedProminentPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedProminentPickerSubscriptionStoreControlStyle.md)

---


## ButtonsSubscriptionStoreControlStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct ButtonsSubscriptionStoreControlStyle
```

## Topics

### Getting the button subscription store style

- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle/init().md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)

---


## CompactPickerSubscriptionStoreControlStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor @preconcurrency struct CompactPickerSubscriptionStoreControlStyle
```

## 

This style lays out the picker options in a horizontal stack, and it can scroll horizontally if the contents are wider than the container. This style is recommended when you expect your store to display two or three subscription options.

## Topics

### Getting the compact picker control style

- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/init().md)

### Placing the controls

- [Placement](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle/Placement.md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)

---


## CompactProductViewStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
@MainActor @preconcurrency struct CompactProductViewStyle
```

## Topics

### Getting the compact product view style

- [compact](../com.apple.storekit/StoreKit/ProductViewStyle/compact.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/CompactProductViewStyle/init().md)

## See Also

- [AutomaticProductViewStyle](../com.apple.storekit/StoreKit/AutomaticProductViewStyle.md)
- [RegularProductViewStyle](../com.apple.storekit/StoreKit/RegularProductViewStyle.md)
- [LargeProductViewStyle](../com.apple.storekit/StoreKit/LargeProductViewStyle.md)

---


## DisplayMessageAction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor struct DisplayMessageAction
```

## 

A StoreKit message represents a sheet that appears over your app to display important information from the App Store to the customer. Messages have a reason, indicated by the [doc://com.apple.storekit/documentation/StoreKit/Message/reason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Message/reason-swift.property) value. StoreKit retrieves any messages from the App Store each time your app launches, and presents them by default. Your app can optionally delay or suppress App Store messages by listening for the messages and determining the appropriate time to ask the system to display them.

To use this API, read the [doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/displayStoreKitMessage](doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/displayStoreKitMessage) environment value to get an instance of the structure for a given [doc://com.apple.documentation/documentation/SwiftUI/Environment](doc://com.apple.documentation/documentation/SwiftUI/Environment). Call the instance to ask StoreKit to display the App Store message. StoreKit displays a message only if it’s still pending. It doesn’t display expired messages. You call the instance directly because it defines a [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction/callAsFunction(_:)](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction/callAsFunction(_:)) method that Swift calls when you call the instance.

> **NOTE:** If your app uses [doc://com.apple.documentation/documentation/UIKit/UIWindowScene](doc://com.apple.documentation/documentation/UIKit/UIWindowScene) and not SwiftUI views, use [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)) instead.

The following code example listens for App Store messages and decides whether to defer them by saving them to an array, display them immediately, or suppress them. A private function that the app calls according to its logic asks the system to display all the deferred messages.

```swift
import SwiftUI
import StoreKit

struct MessageExampleView: View {
    @Environment(\.displayStoreKitMessage) private var displayStoreMessage
    @State private var deferredMessages = [Message]()
    
    enum MessageBehavior {
        // Display the message at a later time.
        case displayLater
        // Display the message immediately.
        case displayNow
        // Do not display the message.
        case ignore
    }

    var body: some View {
        Text("Hello World")
        .task {
            for await message in StoreKit.Message.messages {
                let behavior = processMessage(message)
                switch behavior {
                    case .displayNow:
                        try? displayStoreMessage(message)
                    case .displayLater:
                        // Save the message to display it later.
                        deferredMessages.append(message)
                    case .ignore:
                        // Suppresses the message.
                        break
                }
            }
        }
    }
        
    private func processMessage(_ message: Message) -> MessageBehavior { 
        var messageBehavior: MessageBehavior

        // Add your logic here to determine how your app should handle the message.

        return messageBehavior
    }
    
    // Call this function when the app is ready to display deferred messages.
    @MainActor private func displayDeferredMessages() {
        for message in deferredMessages {
            try? displayStoreMessage(message)
        }
        deferredMessages.removeAll()
    }
}
```

## Topics

### Displaying the message

- [callAsFunction(_:)](../com.apple.storekit/StoreKit/DisplayMessageAction/callAsFunction(_:).md)

## See Also

- [Message](../com.apple.storekit/StoreKit/Message.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)

---


## ExternalLinkAccount

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
enum ExternalLinkAccount
```

## 

This functionality is only available to apps with the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-link.account](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-link.account) entitlement. For more information, see [https://developer.apple.com/support/reader-apps/](https://developer.apple.com/support/reader-apps/).

## Topics

### Linking to external accounts

- [canOpen](../com.apple.storekit/StoreKit/ExternalLinkAccount/canOpen.md)
- [open()](../com.apple.storekit/StoreKit/ExternalLinkAccount/open().md)

## See Also

- [com.apple.developer.storekit.external-link.account](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-link.account.md)
- [SKExternalLinkAccount](../com.apple.BundleResources/Information-Property-List/SKExternalLinkAccount.md)

---


## ExternalPurchaseCustomLink

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum ExternalPurchaseCustomLink
```

## 

This functionality is only available to apps with the any of the following entitlements:

- [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions)
- [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link)
- doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link-streaming.allowed-regions
- [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming)

For more information, see:

- [https://developer.apple.com/support/communication-and-promotion-of-offers-on-the-app-store-in-the-eu/](https://developer.apple.com/support/communication-and-promotion-of-offers-on-the-app-store-in-the-eu/)
- [https://developer.apple.com/support/music-streaming-services-entitlement-eea/](https://developer.apple.com/support/music-streaming-services-entitlement-eea/)

### 

If your account receives the StoreKit External Purchase Link (EU) entitlement or the StoreKit External Custom Purchase Link Regions entitlement, your app can communicate and promote offers for digital goods or services available for purchase or download, in a distribution channel of your choice. Implement the following:

- Depending on the entitlement you receive, configure the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions) entitlement for your app, or configure the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) entitlement and the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) property list key, including the country code for each permitted region where your app communicates and promotes offers.
- Check the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) property of the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API to determine whether the API is available at runtime.
- At launch and before every potential transaction, call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) function to request the external purchase tokens, using the token types `ACQUISITION` and `SERVICES`. Associate these tokens with a customer account on your server.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)) function after a deliberate customer interaction, such as tapping a button, and before communicating and promoting offers.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

For information about testing in the sandbox environment, see [doc://com.apple.storekit/documentation/StoreKit/testing-transactions-that-use-custom-link-tokens](doc://com.apple.storekit/documentation/StoreKit/testing-transactions-that-use-custom-link-tokens).

### 

If your account receives the Music Streaming Services (EEA) entitlement or the StoreKit External Purchase Link Regions For Music Streaming entitlement, your music-streaming app can use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API to communicate and promote offers for music streaming services. Custom links can be to a distribution channel of your choice. Implement the following:

- Depending on the entitlement you receive, configure the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link-streaming.allowed-regions entitlement for your app, or configure the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming) entitlement and the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions) property list key, including the country code for each permitted region where your app communicates and promotes offers for music streaming.
- Check the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) property of the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API to determine whether external purchase is available at runtime.
- At launch and before every potential transaction, call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) function to request the external purchase tokens, using the token types `ACQUISITION` and `SERVICES`. Associate these tokens with a customer account on your server.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)) function after a deliberate customer interaction, such as tapping a button, and before communicating and promoting offers.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

### 

When your app launches, check whether its eligible to use the `ExternalPurchaseCustomLink` API. For more information, see [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) and [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments).

If your app is eligible, request both the `ACQUISITION` and `SERVICES` external purchase tokens. Associate and store these tokens with a customer account on your server. Use the tokens to report transactions to Apple.

The following example code shows how to check for eligibility and request custom link tokens:

```swift
// Ensure the app is eligible to use the external purchase custom link API.
guard await ExternalPurchaseCustomLink.isEligible else { return }

// Declare the tokens and the token types.
var tokens: [String : String] = [:]
let tokenTypes = ["ACQUISITION", "SERVICES"]

// Request the tokens.
for tokenType in tokenTypes {
    do {
        let token = try await ExternalPurchaseCustomLink.token(for: tokenType)
        if let token {
            tokens[tokenType] = token.value
        }
    }
    catch {
        // Failed to get a token of type `tokenType`.
        // Add your code to handle errors.
    }
}

// Add your code to manage the tokens, for example to associate them
// with a customer account on your server.
```

### 

The following SwiftUI code example shows how to check for eligibility, and then show the disclosure notice to determine whether to continue to promoting offers:

```swift
struct MyView: View {

    func openStore() async {
        guard await ExternalPurchaseCustomLink.isEligible else {
            return
        }
        // Show the disclosure notice.
        do {
            let result = try await ExternalPurchaseCustomLink.showNotice(type: .withinApp)
            guard case .continued = result else {
                // Customer chooses not to continue. Don't display external purchases.
                return
            }
            // Customer chooses to continue. 
            // Proceed with the custom link out and offer external purchases...
        }
        catch {
            // Add error handling here... 
        }
    }

    var body: some View {
        Button("Open store") {
            Task { await openStore() }
        }
    }
}
```

## Topics

### Checking eligibility

- [isEligible](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/isEligible.md)

### Getting external purchase tokens

- [token(for:)](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/token(for:).md)
- [Token](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/Token.md)
- [receiving-and-decoding-external-purchase-tokens](../com.apple.storekit/StoreKit/receiving-and-decoding-external-purchase-tokens.md)

### Displaying the disclosure sheet

- [showNotice(type:)](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/showNotice(type:).md)
- [NoticeType](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeType.md)
- [NoticeResult](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/NoticeResult.md)

### Testing external purchase transactions

- [testing-transactions-that-use-custom-link-tokens](../com.apple.storekit/StoreKit/testing-transactions-that-use-custom-link-tokens.md)

## See Also

- [Token](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/Token.md)
- [com.apple.developer.storekit.custom-purchase-link.allowed-regions](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions.md)
- [com.apple.developer.storekit.external-purchase-link](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link.md)
- [SKExternalPurchaseCustomLinkRegions](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions.md)
- [testing-transactions-that-use-custom-link-tokens](../com.apple.storekit/StoreKit/testing-transactions-that-use-custom-link-tokens.md)

---


## ExternalPurchaseLink

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum ExternalPurchaseLink
```

## 

This functionality is only available to apps with the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link.allowed-regions entitlement or the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) entitlement.

For more information, see:

- [https://developer.apple.com/support/communication-and-promotion-of-offers-on-the-app-store-in-the-eu/](https://developer.apple.com/support/communication-and-promotion-of-offers-on-the-app-store-in-the-eu/)
- [https://developer.apple.com/support/storekit-external-entitlement/](https://developer.apple.com/support/storekit-external-entitlement/)
- [https://developer.apple.com/contact/request/storekit-external-entitlement-ru/](https://developer.apple.com/contact/request/storekit-external-entitlement-ru/)
- [https://developer.apple.com/support/music-streaming-services-entitlement-eea/](https://developer.apple.com/support/music-streaming-services-entitlement-eea/)

> **NOTE:** You must check [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) before calling the External Purchase APIs. If [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) is `false`, don’t call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink) or [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase) APIs.

## Topics

### Getting multiple external purchase links

- [SKExternalPurchaseMultiLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseMultiLink.md)
- [eligibleURLs](../com.apple.storekit/StoreKit/ExternalPurchaseLink/eligibleURLs.md)
- [open(url:)](../com.apple.storekit/StoreKit/ExternalPurchaseLink/open(url:).md)

### Getting a single external purchase link

- [SKExternalPurchaseLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseLink.md)
- [canOpen](../com.apple.storekit/StoreKit/ExternalPurchaseLink/canOpen.md)
- [open()](../com.apple.storekit/StoreKit/ExternalPurchaseLink/open().md)

## See Also

- [com.apple.developer.storekit.external-purchase-link](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link.md)
- [SKExternalPurchaseMultiLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseMultiLink.md)
- [SKExternalPurchaseLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseLink.md)

---


## IdentifiedStoreContent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct IdentifiedStoreContent<IdentifiedView> where IdentifiedView : View
```

---


## InvalidRequestError

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct InvalidRequestError
```

## Topics

### Instance Properties

- [code](../com.apple.storekit/StoreKit/InvalidRequestError/code.md)
- [message](../com.apple.storekit/StoreKit/InvalidRequestError/message.md)

---


## LargeProductViewStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor @preconcurrency struct LargeProductViewStyle
```

## Topics

### Getting the large product view style

- [large](../com.apple.storekit/StoreKit/ProductViewStyle/large.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/LargeProductViewStyle/init().md)

## See Also

- [AutomaticProductViewStyle](../com.apple.storekit/StoreKit/AutomaticProductViewStyle.md)
- [CompactProductViewStyle](../com.apple.storekit/StoreKit/CompactProductViewStyle.md)
- [RegularProductViewStyle](../com.apple.storekit/StoreKit/RegularProductViewStyle.md)

---


## PagedPickerSubscriptionStoreControlStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct PagedPickerSubscriptionStoreControlStyle
```

## Topics

### Getting the paged picker control style

- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle/init().md)

### Placing the controls

- [Placement](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle/Placement.md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)

---


## PaymentMethodBinding

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct PaymentMethodBinding
```

## 

This functionality is available only to eligible apps with server entitlements. The initializer [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/init(id:)](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/init(id:)) throws an error if your app doesn’t have the appropriate entitlement to use this API, or if the user isn’t eligible.

> **IMPORTANT:** The [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/init(id:)](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/init(id:)) and [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/bind()](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/bind()) methods may display a system prompt that asks users to authenticate with their Apple Account. Call these methods only after an explicit user action, like tapping or clicking a button.

Initialize this structure using the in-app binding identifier that your server receives from the Apple server when your server initiates payment method binding. Call the [doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/bind()](doc://com.apple.storekit/documentation/StoreKit/PaymentMethodBinding/bind()) method to prompt users to confirm adding the payment method and making it their primary payment method.

## Topics

### Determining eligiblity

- [init(id:)](../com.apple.storekit/StoreKit/PaymentMethodBinding/init(id:).md)

### Creating and identifying bindings

- [id](../com.apple.storekit/StoreKit/PaymentMethodBinding/id.md)

### Binding payment methods

- [bind()](../com.apple.storekit/StoreKit/PaymentMethodBinding/bind().md)

### Reading errors

- [PaymentMethodBindingError](../com.apple.storekit/StoreKit/PaymentMethodBinding/PaymentMethodBindingError.md)

---


## PickerSubscriptionStoreControlStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct PickerSubscriptionStoreControlStyle
```

## Topics

### Getting the picker control style

- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)

### Placing the controls

- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle/init().md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)

---


## ProductViewStyleConfiguration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct ProductViewStyleConfiguration
```

## 

Use the `ProductViewStyleConfiguration` to create a custom [doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle).

## Topics

### Getting a product’s information

- [product](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/product.md)
- [state](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/state.md)
- [hasCurrentEntitlement](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/hasCurrentEntitlement.md)

### Getting a product view’s icon

- [icon-swift.property](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/icon-swift.property.md)
- [Icon-swift.struct](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/Icon-swift.struct.md)

### Getting a product’s description visibility

- [descriptionVisibility](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/descriptionVisibility.md)

### Initiating a purchase

- [purchase()](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration/purchase().md)

## See Also

- [productViewStyle(_:)](../com.apple.SwiftUI/View/productViewStyle(_:).md)
- [productIconBorder()](../com.apple.SwiftUI/View/productIconBorder().md)
- [ProductViewStyle](../com.apple.storekit/StoreKit/ProductViewStyle.md)

---


## ProminentPickerSubscriptionStoreControlStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
@MainActor @preconcurrency struct ProminentPickerSubscriptionStoreControlStyle
```

## Topics

### Getting the prominent picker control style

- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/ProminentPickerSubscriptionStoreControlStyle/init().md)

### Placing the controls

- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)
- [PagedProminentPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedProminentPickerSubscriptionStoreControlStyle.md)
- [AutomaticSubscriptionStoreControlPlacement](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement.md)

---


## PurchaseAction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct PurchaseAction
```

## 

StoreKit provides several APIs you can use to enable customers to initiate a purchase. Choose the API that suits your app’s implementation, specifically:

- Use `PurchaseAction` for apps that use [doc://com.apple.documentation/documentation/SwiftUI](doc://com.apple.documentation/documentation/SwiftUI), including multi-scene apps for visionOS.
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-3bivf](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-3bivf) for apps that use [doc://com.apple.documentation/documentation/UIKit](doc://com.apple.documentation/documentation/UIKit).
- Use [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) if your app runs on watchOS or macOS.

> **IMPORTANT:** If you use StoreKit views such as [doc://com.apple.storekit/documentation/StoreKit/ProductView](doc://com.apple.storekit/documentation/StoreKit/ProductView), [doc://com.apple.storekit/documentation/StoreKit/StoreView](doc://com.apple.storekit/documentation/StoreKit/StoreView), or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView) you don’t need to call any other API to initiate a purchase. StoreKit manages the purchase action automatically, including presenting the purchase confirmation UI. For more information, see [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views).

### 

Use `PurchaseAction` instead of [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) for SwiftUI implementations, including multi-scene apps for visionOS. Call the instance to start an in-app purchase.

To use this API, read the `PurchaseAction` environment value to get an instance of the structure for a given [doc://com.apple.documentation/documentation/SwiftUI/Environment](doc://com.apple.documentation/documentation/SwiftUI/Environment). You call the instance directly because it defines a [doc://com.apple.storekit/documentation/StoreKit/PurchaseAction/callAsFunction(_:options:)](doc://com.apple.storekit/documentation/StoreKit/PurchaseAction/callAsFunction(_:options:)) method that Swift calls when you call the instance.

When you initiate an in-app purchase, the system presents UI for the customer to confirm the purchase details. The purchase action you get from the environment automatically includes the UI context. It presents the confirmation UI in proximity to the scene in which the view displays.

The following code shows an example of starting an in-app purchase when a person taps a button:

```swift
struct PurchaseExample: View {
    @Environment(\.purchase) private var purchase: PurchaseAction
    let product: Product
    let purchaseOptions: [Product.PurchaseOption]

    var body: some View {
        Button {
            Task {
                let purchaseResult = try? await purchase(product, options: purchaseOptions)
                 // Process the purchase result.
            }
        } label: {
            Text(product.displayName)
        }
    }
}
```

Note that the second line in the code example can omit the type name, as follows, because the compiler can infer the type:

```swift
@Environment(\.purchase) private var purchase
```

## Topics

### Calling the action

- [callAsFunction(_:options:)](../com.apple.storekit/StoreKit/PurchaseAction/callAsFunction(_:options:).md)

### Instance Methods

- [callAsFunction(_:compactJWS:options:)](../com.apple.storekit/StoreKit/PurchaseAction/callAsFunction(_:compactJWS:options:).md)

## See Also

- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)

---


## PurchaseIntent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
struct PurchaseIntent
```

## 

Using `PurchaseIntent` is required in the following cases:

- If you promote in-app purchases on the App Store
- If you turn off the Streamlined Purchasing setting in App Store Connect and use win-back offers or contingent pricing

You set up these offers and settings in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases), [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers), and [https://developer.apple.com/help/app-store-connect/manage-subscriptions/manage-streamlined-purchasing](https://developer.apple.com/help/app-store-connect/manage-subscriptions/manage-streamlined-purchasing).

> **IMPORTANT:** To enable promoted in-app purchases, your app must use either [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) (starting in iOS 16.4) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)) (starting in iOS 11). Don’t use both at the same time. If necessary, use conditional compilation to identify the OS version the app is running in. For more information, see [doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version](doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version).

When a customer selects a promoted product on the App Store or a win-back offer outside of your app, it initiates a purchase that they complete in your app. If they don’t have your app installed, the system prompts them to download it. After the app downloads, the transaction continues in the app, which receives a purchase intent from the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents) sequence.

The purchase intent identifies the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product) the customer selected. To enable customers to complete the purchase, call [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) on this product instance. The following example code receives the purchase intent, and calls a method to complete the purchase workflow:

```swift
func purchaseProduct(_ product: Product) async {
    // Complete the purchase workflow.
    do {
        try await product.purchase()
    }
    catch {
        // Add your error handling here.
    }
    // Add your remaining purchase workflow here.
}

for await purchaseIntent in PurchaseIntent.intents {
    // Complete the purchase workflow.
    await purchaseProduct(purchaseIntent.product)
}

```

For more information, see [doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app) and [doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app).

In Mac apps built with Mac Catalyst, this instance doesn’t emit purchase intents for promoted in-app purchases because the Mac App Store doesn’t support this feature.

> **NOTE:** `PurchaseIntent` and promoted in-app purchases aren’t available to compatible iPad or iPhone apps running in visionOS.

## Topics

### Identifying the product

- [id](../com.apple.storekit/StoreKit/PurchaseIntent/id.md)
- [product](../com.apple.storekit/StoreKit/PurchaseIntent/product.md)

### Getting purchase intents

- [intents](../com.apple.storekit/StoreKit/PurchaseIntent/intents.md)
- [PurchaseIntents](../com.apple.storekit/StoreKit/PurchaseIntent/PurchaseIntents.md)

### Identifying the offer

- [offer](../com.apple.storekit/StoreKit/PurchaseIntent/offer.md)

## See Also

- [supporting-promoted-in-app-purchases-in-your-app](../com.apple.storekit/StoreKit/supporting-promoted-in-app-purchases-in-your-app.md)
- [PromotionInfo](../com.apple.storekit/StoreKit/Product/PromotionInfo.md)
- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)

---


## RegularProductViewStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct RegularProductViewStyle
```

## Topics

### Getting the regular product view style

- [regular](../com.apple.storekit/StoreKit/ProductViewStyle/regular.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/RegularProductViewStyle/init().md)

## See Also

- [AutomaticProductViewStyle](../com.apple.storekit/StoreKit/AutomaticProductViewStyle.md)
- [CompactProductViewStyle](../com.apple.storekit/StoreKit/CompactProductViewStyle.md)
- [LargeProductViewStyle](../com.apple.storekit/StoreKit/LargeProductViewStyle.md)

---


## RequestReviewAction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor struct RequestReviewAction
```

## 

Read the [doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/requestReview](doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/requestReview) environment value to get an instance of this structure for a given [doc://com.apple.documentation/documentation/SwiftUI/Environment](doc://com.apple.documentation/documentation/SwiftUI/Environment). Call the instance to tell StoreKit to ask the user to rate or review your app, if appropriate. You call the instance directly because it defines a [doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction/callAsFunction()](doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction/callAsFunction()) method that Swift calls when you call the instance.

When you call this API in your shipping app and the system displays a rating and review request view, the system handles the entire process for you. Although you normally call this method when it makes sense in the user experience flow of your app, App Store policy governs the actual display of a rating and review request view. When your app calls this API, StoreKit uses the following criteria:

- If the person hasn’t rated or reviewed your app on this device, StoreKit displays the ratings and review request a maximum of three times within a 365-day period.
- If the person has rated or reviewed your app on this device, StoreKit displays the ratings and review request if the app version is new, and if more than 365 days have passed since the person’s previous review.

> **NOTE:** Because this API may not present an alert, don’t call it in response to a button tap or other user action.

It’s up to your app to decide on the best timing for requesting reviews. For design guidance, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews](https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews).

### 

When your app calls this method while it’s in development mode, StoreKit always displays the rating and review request view, so you can test the user interface and experience. However, this method has no effect in apps that you distribute for beta testing using TestFlight.

### 

People can review your app at any time on the App Store. To make it easier for people to leave reviews, you may include a persistent link to your App Store product page in your app’s settings or configuration screens. Append the query parameter `action=write-review` to your product page URL to automatically open the App Store page where users can write a review.

## Topics

### Call as function

- [callAsFunction()](../com.apple.storekit/StoreKit/RequestReviewAction/callAsFunction().md)

### Environment value

- [requestReview](../com.apple.SwiftUI/EnvironmentValues/requestReview.md)

## See Also

- [requesting-app-store-reviews](../com.apple.storekit/StoreKit/requesting-app-store-reviews.md)
- [SKStoreReviewController](../com.apple.storekit/StoreKit/SKStoreReviewController.md)

---


## SKANError-swift.struct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct SKANError
```

## Topics

### Getting Error Codes

- [adNetworkIdMissing](../com.apple.storekit/StoreKit/SKANError-swift.struct/adNetworkIdMissing.md)
- [impressionMissingRequiredValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionMissingRequiredValue.md)
- [impressionNotFound](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionNotFound.md)
- [impressionTooShort](../com.apple.storekit/StoreKit/SKANError-swift.struct/impressionTooShort.md)
- [invalidAdvertisedAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidAdvertisedAppId.md)
- [invalidCampaignId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidCampaignId.md)
- [invalidConversionValue](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidConversionValue.md)
- [invalidSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidSourceAppId.md)
- [invalidVersion](../com.apple.storekit/StoreKit/SKANError-swift.struct/invalidVersion.md)
- [mismatchedSourceAppId](../com.apple.storekit/StoreKit/SKANError-swift.struct/mismatchedSourceAppId.md)
- [unknown](../com.apple.storekit/StoreKit/SKANError-swift.struct/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/SKANError-swift.struct/unsupported.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

### Type Properties

- [errorDomain](../com.apple.storekit/StoreKit/SKANError-swift.struct/errorDomain.md)

## See Also

- [SKANErrorDomain](../com.apple.storekit/StoreKit/SKANErrorDomain.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


## SKANErrorDomain

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
let SKANErrorDomain: String
```

## See Also

- [SKANError-swift.struct](../com.apple.storekit/StoreKit/SKANError-swift.struct.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


## SKAdImpression

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class SKAdImpression
```

## 

Create a `SKAdImpression` instance when you’re preparing to present a view-through ad. In the instance, you set:

- Values known to you, including your ad network ID, the App Store IDs of the source app and the advertised app, and the version.
- A value you determine – the campaign ID.
- Values you generate, including the timestamp, a nonce (ad-impression identifier), and the cryptographic signature.

For information about generating the cryptographic signature, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads).

Use your `SKAdImpression` instance when you call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)) to begin presenting your view-through ad. Use the same instance when you call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) to end the ad presentation.

## Topics

### Providing a signature

- [signature](../com.apple.storekit/StoreKit/SKAdImpression/signature.md)

### Creating a signature

- [init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:)](../com.apple.storekit/StoreKit/SKAdImpression/init(sourceAppStoreItemIdentifier:advertisedAppStoreItemIdentifier:adNetworkIdentifier:adCampaignIdentifier:adImpressionIdentifier:timestamp:signature:version:).md)
- [version](../com.apple.storekit/StoreKit/SKAdImpression/version.md)
- [adNetworkIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adNetworkIdentifier.md)
- [sourceIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceIdentifier.md)
- [adCampaignIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adCampaignIdentifier.md)
- [advertisedAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier.md)
- [adImpressionIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/adImpressionIdentifier.md)
- [sourceAppStoreItemIdentifier](../com.apple.storekit/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier.md)
- [timestamp](../com.apple.storekit/StoreKit/SKAdImpression/timestamp.md)

### Describing ads

- [adType](../com.apple.storekit/StoreKit/SKAdImpression/adType.md)
- [adDescription](../com.apple.storekit/StoreKit/SKAdImpression/adDescription.md)
- [adPurchaserName](../com.apple.storekit/StoreKit/SKAdImpression/adPurchaserName.md)

## See Also

- [adattributionkit-skadnetwork-interoperability](../com.apple.AdAttributionKit/adattributionkit-skadnetwork-interoperability.md)
- [SKAdNetwork](../com.apple.storekit/StoreKit/SKAdNetwork.md)

---


## SKCloudServiceCapability

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
struct SKCloudServiceCapability
```

## Topics

### Initializing

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKCloudServiceCapability/init(rawValue:).md)

### Identifying Cloud Service Capabilities

- [musicCatalogPlayback](../com.apple.storekit/StoreKit/SKCloudServiceCapability/musicCatalogPlayback.md)
- [musicCatalogSubscriptionEligible](../com.apple.storekit/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible.md)
- [addToCloudMusicLibrary](../com.apple.storekit/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary.md)

## See Also

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

---


## SKCloudServiceSetupAction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
struct SKCloudServiceSetupAction
```

## Topics

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction/init(rawValue:).md)

### Type Properties

- [subscribe](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction/subscribe.md)

## See Also

- [action](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/action.md)
- [iTunesItemIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/iTunesItemIdentifier.md)
- [affiliateToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [messageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier.md)
- [SKCloudServiceSetupMessageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier.md)

---


## SKCloudServiceSetupViewController

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
@MainActor class SKCloudServiceSetupViewController
```

## 

Use the view that this view controller presents to allow customers to set up cloud services that are associated with their iTunes Store account, like an Apple Music subscription.

To enable the Apple Music subscriber setup flow in particular, you first request the current set of capabilities from [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController). Then, present the setup view controller only when the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible) capability is enabled and the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback) capability is disabled.

For information about other capabilities that you can enable by using this view controller, see [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability).

## Topics

### Setting a delegate

- [delegate](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController/delegate.md)
- [SKCloudServiceSetupViewControllerDelegate](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewControllerDelegate.md)

### Loading the setup view

- [offering-apple-music-subscription-in-your-app](../com.apple.storekit/StoreKit/offering-apple-music-subscription-in-your-app.md)
- [SKCloudServiceSetupOptionsKey](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey.md)
- [load(options:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:).md)
- [SKArcadeService](../com.apple.storekit/StoreKit/SKArcadeService.md)

## See Also

- [SKCloudServiceController](../com.apple.storekit/StoreKit/SKCloudServiceController.md)

---


## SKDownloadState

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
@frozen enum SKDownloadState
```

## Topics

### Constants

- [waiting](../com.apple.storekit/StoreKit/SKDownloadState/waiting.md)
- [active](../com.apple.storekit/StoreKit/SKDownloadState/active.md)
- [paused](../com.apple.storekit/StoreKit/SKDownloadState/paused.md)
- [finished](../com.apple.storekit/StoreKit/SKDownloadState/finished.md)
- [failed](../com.apple.storekit/StoreKit/SKDownloadState/failed.md)
- [cancelled](../com.apple.storekit/StoreKit/SKDownloadState/cancelled.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKDownloadState/init(rawValue:).md)

## See Also

- [state](../com.apple.storekit/StoreKit/SKDownload/state.md)
- [progress](../com.apple.storekit/StoreKit/SKDownload/progress.md)
- [timeRemaining](../com.apple.storekit/StoreKit/SKDownload/timeRemaining.md)
- [SKDownloadTimeRemainingUnknown](../com.apple.storekit/StoreKit/SKDownloadTimeRemainingUnknown.md)
- [downloadState](../com.apple.storekit/StoreKit/SKDownload/downloadState.md)

---


## SKDownloadTimeRemainingUnknown

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
var SKDownloadTimeRemainingUnknown: TimeInterval
```

## See Also

- [state](../com.apple.storekit/StoreKit/SKDownload/state.md)
- [progress](../com.apple.storekit/StoreKit/SKDownload/progress.md)
- [timeRemaining](../com.apple.storekit/StoreKit/SKDownload/timeRemaining.md)
- [SKDownloadState](../com.apple.storekit/StoreKit/SKDownloadState.md)
- [downloadState](../com.apple.storekit/StoreKit/SKDownload/downloadState.md)

---


## SKError

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SKError
```

## Topics

### Error codes

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [unknown](../com.apple.storekit/StoreKit/SKError/unknown.md)
- [clientInvalid](../com.apple.storekit/StoreKit/SKError/clientInvalid.md)
- [paymentCancelled](../com.apple.storekit/StoreKit/SKError/paymentCancelled.md)
- [paymentInvalid](../com.apple.storekit/StoreKit/SKError/paymentInvalid.md)
- [paymentNotAllowed](../com.apple.storekit/StoreKit/SKError/paymentNotAllowed.md)
- [storeProductNotAvailable](../com.apple.storekit/StoreKit/SKError/storeProductNotAvailable.md)
- [cloudServicePermissionDenied](../com.apple.storekit/StoreKit/SKError/cloudServicePermissionDenied.md)
- [cloudServiceNetworkConnectionFailed](../com.apple.storekit/StoreKit/SKError/cloudServiceNetworkConnectionFailed.md)
- [cloudServiceRevoked](../com.apple.storekit/StoreKit/SKError/cloudServiceRevoked.md)
- [privacyAcknowledgementRequired](../com.apple.storekit/StoreKit/SKError/privacyAcknowledgementRequired.md)
- [unauthorizedRequestData](../com.apple.storekit/StoreKit/SKError/unauthorizedRequestData.md)
- [invalidOfferIdentifier](../com.apple.storekit/StoreKit/SKError/invalidOfferIdentifier.md)
- [invalidOfferPrice](../com.apple.storekit/StoreKit/SKError/invalidOfferPrice.md)
- [invalidSignature](../com.apple.storekit/StoreKit/SKError/invalidSignature.md)
- [missingOfferParams](../com.apple.storekit/StoreKit/SKError/missingOfferParams.md)
- [ineligibleForOffer](../com.apple.storekit/StoreKit/SKError/ineligibleForOffer.md)
- [overlayCancelled](../com.apple.storekit/StoreKit/SKError/overlayCancelled.md)
- [overlayInvalidConfiguration](../com.apple.storekit/StoreKit/SKError/overlayInvalidConfiguration.md)
- [overlayPresentedInBackgroundScene](../com.apple.storekit/StoreKit/SKError/overlayPresentedInBackgroundScene.md)
- [overlayTimeout](../com.apple.storekit/StoreKit/SKError/overlayTimeout.md)
- [unsupportedPlatform](../com.apple.storekit/StoreKit/SKError/unsupportedPlatform.md)

### Error domain

- [SKErrorDomain](../com.apple.storekit/StoreKit/SKErrorDomain.md)

### Type Properties

- [errorDomain](../com.apple.storekit/StoreKit/SKError/errorDomain.md)

## See Also

- [handling-errors](../com.apple.storekit/StoreKit/handling-errors.md)
- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [SKErrorDomain](../com.apple.storekit/StoreKit/SKErrorDomain.md)

---


## SKPayment

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKPayment
```

## 

A payment object identifies a product and the quantity of those items the user would like to purchase.

## Topics

### Creating Payments

- [init(product:)](../com.apple.storekit/StoreKit/SKPayment/init(product:).md)

### Getting Payment Details

- [productIdentifier](../com.apple.storekit/StoreKit/SKPayment/productIdentifier.md)
- [quantity](../com.apple.storekit/StoreKit/SKPayment/quantity.md)
- [requestData](../com.apple.storekit/StoreKit/SKPayment/requestData.md)
- [applicationUsername](../com.apple.storekit/StoreKit/SKPayment/applicationUsername.md)

### Simulating Purchases for Testing

- [simulatesAskToBuyInSandbox](../com.apple.storekit/StoreKit/SKPayment/simulatesAskToBuyInSandbox.md)

### Getting Discount Details

- [paymentDiscount](../com.apple.storekit/StoreKit/SKPayment/paymentDiscount.md)
- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

## See Also

- [requesting-a-payment-from-the-app-store](../com.apple.storekit/StoreKit/requesting-a-payment-from-the-app-store.md)
- [processing-a-transaction](../com.apple.storekit/StoreKit/processing-a-transaction.md)
- [SKMutablePayment](../com.apple.storekit/StoreKit/SKMutablePayment.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)

---


## SKPaymentDiscount

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKPaymentDiscount
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount) contains the details of a promotional offer discount that you want to apply to a [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment).

Include the signature that you generated in this object. For guidance, see [doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers](doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers). The App Store uses this signature and the parameters to validate the promotional offer. Keep in mind that the signature must correspond to the parameters in the payment for a transaction to be successful.

## Topics

### Initializing a Payment Discount

- [init(identifier:keyIdentifier:nonce:signature:timestamp:)](../com.apple.storekit/StoreKit/SKPaymentDiscount/init(identifier:keyIdentifier:nonce:signature:timestamp:).md)

### Identifying the Discount

- [identifier](../com.apple.storekit/StoreKit/SKPaymentDiscount/identifier.md)
- [keyIdentifier](../com.apple.storekit/StoreKit/SKPaymentDiscount/keyIdentifier.md)

### Validating the Discount

- [nonce](../com.apple.storekit/StoreKit/SKPaymentDiscount/nonce.md)
- [signature](../com.apple.storekit/StoreKit/SKPaymentDiscount/signature.md)
- [timestamp](../com.apple.storekit/StoreKit/SKPaymentDiscount/timestamp.md)

## See Also

- [paymentDiscount](../com.apple.storekit/StoreKit/SKPayment/paymentDiscount.md)

---


## SKPaymentQueue

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKPaymentQueue
```

## 

The payment queue communicates with the App Store and presents a user interface so that the user can authorize payment. The contents of the queue are persistent between launches of your app.

To process a payment, first add at least one observer object ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver)) to the queue (see [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-5ciz2](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-5ciz2)). Then, add a payment object ([doc://com.apple.storekit/documentation/StoreKit/SKPayment](doc://com.apple.storekit/documentation/StoreKit/SKPayment)) for the item the user wants to purchase. Each time you add a payment object, the queue creates a transaction object ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction)) to process that payment and enqueues it to be processed. After payment is fulfilled, the queue updates the transaction object and then calls any observer objects to provide them the updated transaction. Your observer should process the transaction and then remove it from the queue.

The exact mechanism you use to process a processed transaction depends on the design of your app and the product being purchased. Here are a few common examples:

- If the product is a feature already built into your app, your app enables the feature to process the transaction.
- If the product includes downloadable content provided by the App Store, your app retrieves the [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects from the transaction and ask the payment queue to download them. You provide the actual content files to be served by the App Store to App Store Connect when you create the product information.
- If the product represents downloadable content provided by your own server, your app might open a network connection to your server and download the content from there.

For more information on designing the payment processing portion of your app, see [https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267](https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html#//apple_ref/doc/uid/TP40008267).

## Topics

### Determining Whether the User Can Make Payments

- [canMakePayments()](../com.apple.storekit/StoreKit/SKPaymentQueue/canMakePayments().md)

### Determining Store Content

- [storefront](../com.apple.storekit/StoreKit/SKPaymentQueue/storefront.md)

### Getting the Queue

- [default()](../com.apple.storekit/StoreKit/SKPaymentQueue/default().md)

### Adding, Getting, and Removing Observers

- [add(_:)-5ciz2](../com.apple.storekit/StoreKit/SKPaymentQueue/add(_:)-5ciz2.md)
- [transactionObservers](../com.apple.storekit/StoreKit/SKPaymentQueue/transactionObservers.md)
- [remove(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/remove(_:).md)

### Managing Transactions

- [delegate](../com.apple.storekit/StoreKit/SKPaymentQueue/delegate.md)
- [transactions](../com.apple.storekit/StoreKit/SKPaymentQueue/transactions.md)
- [add(_:)-4vct1](../com.apple.storekit/StoreKit/SKPaymentQueue/add(_:)-4vct1.md)
- [finishTransaction(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/finishTransaction(_:).md)

### Restoring Purchases

- [restoreCompletedTransactions()](../com.apple.storekit/StoreKit/SKPaymentQueue/restoreCompletedTransactions().md)
- [restoreCompletedTransactions(withApplicationUsername:)](../com.apple.storekit/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:).md)

### Showing Price Consent

- [showPriceConsentIfNeeded()](../com.apple.storekit/StoreKit/SKPaymentQueue/showPriceConsentIfNeeded().md)

### Redeeming Codes

- [presentCodeRedemptionSheet()](../com.apple.storekit/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet().md)

### Downloading Content

- [start(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/start(_:).md)
- [cancel(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/cancel(_:).md)
- [pause(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/pause(_:).md)
- [resume(_:)](../com.apple.storekit/StoreKit/SKPaymentQueue/resume(_:).md)

## See Also

- [setting-up-the-transaction-observer-for-the-payment-queue](../com.apple.storekit/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue.md)
- [offering-completing-and-restoring-in-app-purchases](../com.apple.storekit/StoreKit/offering-completing-and-restoring-in-app-purchases.md)
- [SKPaymentTransactionObserver](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver.md)
- [SKPaymentQueueDelegate](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)

---


## SKPaymentQueueDelegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
protocol SKPaymentQueueDelegate : NSObjectProtocol
```

## 

This protocol includes a method that lets your app determine whether to continue a transaction if the customer’s App Store storefront changes.

## Topics

### Continuing transactions

- [paymentQueue(_:shouldContinue:in:)](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate/paymentQueue(_:shouldContinue:in:).md)

### Showing price consent

- [paymentQueueShouldShowPriceConsent(_:)](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:).md)

## See Also

- [setting-up-the-transaction-observer-for-the-payment-queue](../com.apple.storekit/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue.md)
- [offering-completing-and-restoring-in-app-purchases](../com.apple.storekit/StoreKit/offering-completing-and-restoring-in-app-purchases.md)
- [SKPaymentQueue](../com.apple.storekit/StoreKit/SKPaymentQueue.md)
- [SKPaymentTransactionObserver](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)

---


## SKPaymentTransactionObserver

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
protocol SKPaymentTransactionObserver : NSObjectProtocol
```

## 

Observers of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue) objects implement the methods of this protocol.

The system calls an observer when the queue updates or removes transactions. An observer needs to process all successful transactions, unlock the functionality the user purchases, and then finish the transaction by calling the payment queue’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) method.

## Topics

### Handling transactions

- [paymentQueue(_:updatedTransactions:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:).md)
- [paymentQueue(_:removedTransactions:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:removedTransactions:).md)

### Restoring transactions

- [paymentQueue(_:restoreCompletedTransactionsFailedWithError:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:restoreCompletedTransactionsFailedWithError:).md)
- [paymentQueueRestoreCompletedTransactionsFinished(_:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:).md)

### Handling promoted in-app purchases

- [promoting-in-app-purchases](../com.apple.storekit/StoreKit/promoting-in-app-purchases.md)
- [paymentQueue(_:shouldAddStorePayment:for:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:).md)

### Revoking entitlements

- [paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:).md)

### Changing the storefront

- [paymentQueueDidChangeStorefront(_:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueueDidChangeStorefront(_:).md)

### Handling download actions

- [paymentQueue(_:updatedDownloads:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedDownloads:).md)

## See Also

- [setting-up-the-transaction-observer-for-the-payment-queue](../com.apple.storekit/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue.md)
- [offering-completing-and-restoring-in-app-purchases](../com.apple.storekit/StoreKit/offering-completing-and-restoring-in-app-purchases.md)
- [SKPaymentQueue](../com.apple.storekit/StoreKit/SKPaymentQueue.md)
- [SKPaymentQueueDelegate](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)

---


## SKProductDiscount

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKProductDiscount
```

## 

You set up introductory and promotional offers in App Store Connect. [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount) contains the offer information as retrieved from the App Store.

For more information about setting up offers, see [https://help.apple.com/app-store-connect/#/deve1d49254f](https://help.apple.com/app-store-connect/#/deve1d49254f) and [https://help.apple.com/app-store-connect/#/dev16dfca448](https://help.apple.com/app-store-connect/#/dev16dfca448).

## Topics

### Identifying the Discount

- [identifier](../com.apple.storekit/StoreKit/SKProductDiscount/identifier.md)
- [type-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/type-swift.property.md)
- [Type-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/Type-swift.enum.md)

### Getting Price and Payment Mode

- [price](../com.apple.storekit/StoreKit/SKProductDiscount/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProductDiscount/priceLocale.md)
- [paymentMode-swift.property](../com.apple.storekit/StoreKit/SKProductDiscount/paymentMode-swift.property.md)
- [PaymentMode-swift.enum](../com.apple.storekit/StoreKit/SKProductDiscount/PaymentMode-swift.enum.md)

### Getting the Discount Duration

- [numberOfPeriods](../com.apple.storekit/StoreKit/SKProductDiscount/numberOfPeriods.md)
- [subscriptionPeriod](../com.apple.storekit/StoreKit/SKProductDiscount/subscriptionPeriod.md)

## See Also

- [price](../com.apple.storekit/StoreKit/SKProduct/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProduct/priceLocale.md)
- [introductoryPrice](../com.apple.storekit/StoreKit/SKProduct/introductoryPrice.md)
- [discounts](../com.apple.storekit/StoreKit/SKProduct/discounts.md)

---


## SKProductStorePromotionController

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
class SKProductStorePromotionController
```

## 

For information about promoting In-App Purchases, see [doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases).

> **NOTE:** [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController) and promoted In-App Purchases aren’t available to compatible iPad and iPhone apps running in visionOS.

## Topics

### Managing promoted product order

- [fetchStorePromotionOrder(completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/fetchStorePromotionOrder(completionHandler:).md)
- [update(storePromotionOrder:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:).md)

### Managing promoted product visibility

- [fetchStorePromotionVisibility(for:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:).md)
- [update(storePromotionVisibility:for:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/update(storePromotionVisibility:for:completionHandler:).md)
- [SKProductStorePromotionVisibility](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility.md)

### Getting the controller

- [default()](../com.apple.storekit/StoreKit/SKProductStorePromotionController/default().md)

## See Also

- [promoting-in-app-purchases](../com.apple.storekit/StoreKit/promoting-in-app-purchases.md)
- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)

---


## SKProductStorePromotionVisibility

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
@frozen enum SKProductStorePromotionVisibility
```

## Topics

### Enumeration cases

- [default](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/default.md)
- [hide](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/hide.md)
- [show](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/show.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKProductStorePromotionVisibility/init(rawValue:).md)

## See Also

- [fetchStorePromotionVisibility(for:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:).md)
- [update(storePromotionVisibility:for:completionHandler:)](../com.apple.storekit/StoreKit/SKProductStorePromotionController/update(storePromotionVisibility:for:completionHandler:).md)

---


## SKProductsRequestDelegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
protocol SKProductsRequestDelegate : SKRequestDelegate
```

## 

The [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequestDelegate](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequestDelegate) protocol declares methods that are implemented by the delegate of an [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) object. The delegate receives the product information that the product request referred to. Your app uses this information when presenting products to users in its in-app store.

> **WARNING:** Responses received by the `SKProductsRequestDelegate` may not be returned on a specific thread. If you make assumptions about which queue will handle delegate responses, you may encounter unintended performance and compatibility issues in the future.

## Topics

### Receiving the Response

- [productsRequest(_:didReceive:)](../com.apple.storekit/StoreKit/SKProductsRequestDelegate/productsRequest(_:didReceive:).md)

## See Also

- [delegate](../com.apple.storekit/StoreKit/SKProductsRequest/delegate.md)

---


## SKProductsResponse

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKProductsResponse
```

## Topics

### Response Information

- [products](../com.apple.storekit/StoreKit/SKProductsResponse/products.md)
- [invalidProductIdentifiers](../com.apple.storekit/StoreKit/SKProductsResponse/invalidProductIdentifiers.md)

## See Also

- [loading-in-app-product-identifiers](../com.apple.storekit/StoreKit/loading-in-app-product-identifiers.md)
- [fetching-product-information-from-the-app-store](../com.apple.storekit/StoreKit/fetching-product-information-from-the-app-store.md)
- [SKProductsRequest](../com.apple.storekit/StoreKit/SKProductsRequest.md)
- [SKProduct](../com.apple.storekit/StoreKit/SKProduct.md)

---


## SKReceiptPropertyIsRevoked

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let SKReceiptPropertyIsRevoked: String
```

## 

This key’s value is an instance of [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber) that the system interprets as a Boolean value that indicates whether the receipt is in a revoked state.

## See Also

- [receiptProperties](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest/receiptProperties.md)
- [SKReceiptPropertyIsExpired](../com.apple.storekit/StoreKit/SKReceiptPropertyIsExpired.md)
- [SKReceiptPropertyIsVolumePurchase](../com.apple.storekit/StoreKit/SKReceiptPropertyIsVolumePurchase.md)

---


## SKReceiptPropertyIsVolumePurchase

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let SKReceiptPropertyIsVolumePurchase: String
```

## 

This key’s value is an instance of [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber) that the system interprets as a Boolean value that indicates whether the receipt is a Volume Purchase Plan receipt.

## See Also

- [receiptProperties](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest/receiptProperties.md)
- [SKReceiptPropertyIsExpired](../com.apple.storekit/StoreKit/SKReceiptPropertyIsExpired.md)
- [SKReceiptPropertyIsRevoked](../com.apple.storekit/StoreKit/SKReceiptPropertyIsRevoked.md)

---


## SKRequest

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKRequest
```

## 

To make a request, initialize a subclass of [doc://com.apple.storekit/documentation/StoreKit/SKRequest](doc://com.apple.storekit/documentation/StoreKit/SKRequest)—such as [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) or [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest)—set the [doc://com.apple.storekit/documentation/StoreKit/SKRequest/delegate](doc://com.apple.storekit/documentation/StoreKit/SKRequest/delegate) property, and call the [doc://com.apple.storekit/documentation/StoreKit/SKRequest/start()](doc://com.apple.storekit/documentation/StoreKit/SKRequest/start()) method.

## Topics

### Controlling the Request

- [start()](../com.apple.storekit/StoreKit/SKRequest/start().md)
- [cancel()](../com.apple.storekit/StoreKit/SKRequest/cancel().md)

### Accessing the Delegate

- [delegate](../com.apple.storekit/StoreKit/SKRequest/delegate.md)
- [SKRequestDelegate](../com.apple.storekit/StoreKit/SKRequestDelegate.md)

## See Also

- [setting-up-the-transaction-observer-for-the-payment-queue](../com.apple.storekit/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue.md)
- [offering-completing-and-restoring-in-app-purchases](../com.apple.storekit/StoreKit/offering-completing-and-restoring-in-app-purchases.md)
- [SKPaymentQueue](../com.apple.storekit/StoreKit/SKPaymentQueue.md)
- [SKPaymentTransactionObserver](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver.md)
- [SKPaymentQueueDelegate](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate.md)

---


## SKRequestDelegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
protocol SKRequestDelegate : NSObjectProtocol
```

## Topics

### Completing Requests

- [requestDidFinish(_:)](../com.apple.storekit/StoreKit/SKRequestDelegate/requestDidFinish(_:).md)

### Handling Errors

- [request(_:didFailWithError:)](../com.apple.storekit/StoreKit/SKRequestDelegate/request(_:didFailWithError:).md)

## See Also

- [delegate](../com.apple.storekit/StoreKit/SKRequest/delegate.md)

---


## SKStoreProductParameterAdNetworkCampaignIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkCampaignIdentifier: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber). Ad networks determine their own campaign identifiers, which must be an integer `>=1` and `<=100`.

Use [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier) instead of this value to generate version 4 and later signatures.

## See Also

- [SKStoreProductParameterAdNetworkIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkIdentifier.md)
- [SKStoreProductParameterAdNetworkTimestamp](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkTimestamp.md)
- [SKStoreProductParameterAdNetworkNonce](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkNonce.md)
- [SKStoreProductParameterAdNetworkAttributionSignature](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature.md)

---


## SKStoreProductParameterAdNetworkIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkIdentifier: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString).

Ad networks obtain an ad network identifier during registration. Ad networks are responsible for sharing their ad network IDs with participating app developers. Apps that display ads and need to initiate the app install validation process must include the ad network ID in their `Info.plist`. For more information see [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network) and `Configuring Apps`.

## See Also

- [SKStoreProductParameterAdNetworkCampaignIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier.md)
- [SKStoreProductParameterAdNetworkTimestamp](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkTimestamp.md)
- [SKStoreProductParameterAdNetworkNonce](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkNonce.md)
- [SKStoreProductParameterAdNetworkAttributionSignature](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature.md)

---


## SKStoreProductParameterAdNetworkNonce

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkNonce: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSUUID](doc://com.apple.documentation/documentation/Foundation/NSUUID). Ad networks generate a random value for this key at the time of the ad impression.

> **IMPORTANT:** When you generate the signature value ([doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature)), you must sign the nonce as an all-lowercase UUID string representation.

## See Also

- [SKStoreProductParameterAdNetworkIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkIdentifier.md)
- [SKStoreProductParameterAdNetworkCampaignIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier.md)
- [SKStoreProductParameterAdNetworkTimestamp](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkTimestamp.md)
- [SKStoreProductParameterAdNetworkAttributionSignature](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature.md)

---


## SKStoreProductParameterAdNetworkSourceAppStoreIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkSourceAppStoreIdentifier: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber). Provide the App Store item identifier of the app that’s displaying the ad.

During testing, if you’re using a development-signed build to display the ads and not an app from App Store, use `0` as the item identifier.

## See Also

- [SKStoreProductParameterAdNetworkVersion](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkVersion.md)

---


## SKStoreProductParameterAffiliateToken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterAffiliateToken: String
```

## 

The value for this key is an instance of [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString).

You receive an affiliate identifier when you sign up for the Affiliate Program. The affiliate associated with this view controller is paid a commission for any items purchased using the controller.

Learn more about the Affiliate Program at [https://apple.com/itunes/affiliates](https://apple.com/itunes/affiliates).

## See Also

- [SKStoreProductParameterProductIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterProductIdentifier.md)
- [SKStoreProductParameterAdvertisingPartnerToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAdvertisingPartnerToken.md)
- [SKStoreProductParameterCampaignToken](../com.apple.storekit/StoreKit/SKStoreProductParameterCampaignToken.md)
- [SKStoreProductParameterProviderToken](../com.apple.storekit/StoreKit/SKStoreProductParameterProviderToken.md)
- [SKStoreProductParameterCustomProductPageIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterCustomProductPageIdentifier.md)

---


## SKStoreProductParameterITunesItemIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterITunesItemIdentifier: String
```

## 

The value for this key, an iTunes item identifier, is an instance of [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber).

To find a product’s iTunes identifier, go to [http://linkmaker.itunes.apple.com/us/](http://linkmaker.itunes.apple.com/us/) and search for the product, then locate the iTunes identifier in the link URL. For example, the iTunes identifier for the iBooks app is 364709193.

---


## SKStoreProductParameterProductIdentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterProductIdentifier: String
```

## 

The value for this key is an instance of [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString).

When your app uses an [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController) to render an app page for another app, you can optionally choose to highlight an in-app purchase by displaying it at the top of the store page.  Set  [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterProductIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterProductIdentifier) to the identifier of the product you want displayed at the top of the page.

The product indicated by the identifier must be set up as a promoted product in the App Store, otherwise the identifier is ignored. See [https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/PromotingIn-AppPurchases/PromotingIn-AppPurchases.html#//apple_ref/doc/uid/TP40008267-CH11](https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/PromotingIn-AppPurchases/PromotingIn-AppPurchases.html#//apple_ref/doc/uid/TP40008267-CH11).

> **NOTE:** Use the same product identifiers as used in the [doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier) variable in the [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) class.

## See Also

- [SKStoreProductParameterAdvertisingPartnerToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAdvertisingPartnerToken.md)
- [SKStoreProductParameterAffiliateToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAffiliateToken.md)
- [SKStoreProductParameterCampaignToken](../com.apple.storekit/StoreKit/SKStoreProductParameterCampaignToken.md)
- [SKStoreProductParameterProviderToken](../com.apple.storekit/StoreKit/SKStoreProductParameterProviderToken.md)
- [SKStoreProductParameterCustomProductPageIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterCustomProductPageIdentifier.md)

---


## SKStoreProductViewController

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
@MainActor class SKStoreProductViewController
```

## 

To display a store for customers to purchase media from the App Store, follow these steps:

1. Create an `SKStoreProductViewController` object and set its [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/delegate](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/delegate).
2. Indicate a specific product to sell by passing its iTunes item identifier to the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) method.
3. Present the view controller modally from another view controller in your app. Your delegate dismisses the view controller when the customer completes the purchase.

Present the `SKStoreProductViewController` object immediately when someone triggers an interaction, such as tapping a Buy button. Load the product information before presenting the view controller to ensure a seamless user experience.

This class ignores [doc://com.apple.documentation/documentation/UIKit/UIViewController/modalPresentationStyle](doc://com.apple.documentation/documentation/UIKit/UIViewController/modalPresentationStyle) settings, and those settings have no impact on the sheet’s presentation.

To recommend another app without displaying a full product page, and to recommend an App Clip’s corresponding app from within the App Clip, use [doc://com.apple.storekit/documentation/StoreKit/SKOverlay](doc://com.apple.storekit/documentation/StoreKit/SKOverlay).

> **NOTE:** In a compatible iPad or iPhone app running in visionOS, this method displays a minimal sheet to enable an app purchase or to launch the App Store for more information. For an in-line experience that’s consistent across platforms, use [doc://com.apple.storekit/documentation/StoreKit/SKOverlay](doc://com.apple.storekit/documentation/StoreKit/SKOverlay) instead.

### 

The `SKStoreProductViewController` class doesn’t support subclassing or embedding, and must be used as-is.

> **IMPORTANT:** If you compile with the iOS 13 SDK, attempting to instantiate a subclass of `SKStoreProductViewController` results in a runtime exception.

This class throws the following runtime exceptions:

## Topics

### Setting a delegate

- [delegate](../com.apple.storekit/StoreKit/SKStoreProductViewController/delegate.md)
- [SKStoreProductViewControllerDelegate](../com.apple.storekit/StoreKit/SKStoreProductViewControllerDelegate.md)

### Loading a new product screen

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [loadProduct(withParameters:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:).md)
- [loadProduct(withParameters:impression:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:impression:completionBlock:).md)
- [loadProduct(parameters:impression:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:).md)
- [loadProduct(parameters:impression:reengagementURL:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:reengagementURL:).md)
- [product-dictionary-keys](../com.apple.storekit/StoreKit/product-dictionary-keys.md)

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [SKOverlay](../com.apple.storekit/StoreKit/SKOverlay.md)

---


## SKStoreProductViewControllerDelegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
protocol SKStoreProductViewControllerDelegate : NSObjectProtocol
```

## 

Typically, this protocol is implemented by the view controller in your application that originally displayed the store screen.

## Topics

### Responding to a Dismiss Action

- [productViewControllerDidFinish(_:)](../com.apple.storekit/StoreKit/SKStoreProductViewControllerDelegate/productViewControllerDidFinish(_:).md)

## See Also

- [delegate](../com.apple.storekit/StoreKit/SKStoreProductViewController/delegate.md)

---


## SKTerminateForInvalidReceipt()

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
func SKTerminateForInvalidReceipt()
```

## See Also

- [restoring-purchased-products](../com.apple.storekit/StoreKit/restoring-purchased-products.md)
- [SKReceiptRefreshRequest](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)

---


## StoreButtonKind

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct StoreButtonKind
```

## 

Use the [doc://com.apple.documentation/documentation/SwiftUI/View/storeButton(_:for:)](doc://com.apple.documentation/documentation/SwiftUI/View/storeButton(_:for:)) modifier on a view to set the visibility of the buttons.

## Topics

### Getting button types for store views

- [cancellation](../com.apple.storekit/StoreKit/StoreButtonKind/cancellation.md)
- [restorePurchases](../com.apple.storekit/StoreKit/StoreButtonKind/restorePurchases.md)

### Getting additional button types for subscription store views

- [signIn](../com.apple.storekit/StoreKit/StoreButtonKind/signIn.md)
- [redeemCode](../com.apple.storekit/StoreKit/StoreButtonKind/redeemCode.md)
- [policies](../com.apple.storekit/StoreKit/StoreButtonKind/policies.md)

## See Also

- [storeButton(_:for:)](../com.apple.SwiftUI/View/storeButton(_:for:).md)
- [subscriptionStoreSignInAction(_:)](../com.apple.SwiftUI/View/subscriptionStoreSignInAction(_:).md)
- [SubscriptionOfferViewButtonKind](../com.apple.storekit/StoreKit/SubscriptionOfferViewButtonKind.md)

---


## StoreContent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency protocol StoreContent
```

## Topics

### Implementing store content

- [body-swift.property](../com.apple.storekit/StoreKit/StoreContent/body-swift.property.md)
- [Body-swift.associatedtype](../com.apple.storekit/StoreKit/StoreContent/Body-swift.associatedtype.md)

### Configuring store content

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)
- [subscriptionStoreButtonLabel(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreButtonLabel(_:).md)
- [storeButton(_:for:)](../com.apple.storekit/StoreKit/StoreContent/storeButton(_:for:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlStyle(_:placement:).md)
- [productDescription(_:)](../com.apple.storekit/StoreKit/StoreContent/productDescription(_:).md)

### Configuring backgrounds

- [subscriptionStoreControlBackground(_:)-10hv8](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-10hv8.md)
- [subscriptionStoreControlBackground(_:)-3xzai](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreControlBackground(_:)-3xzai.md)
- [subscriptionStorePickerItemBackground(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:).md)
- [subscriptionStorePickerItemBackground(_:in:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStorePickerItemBackground(_:in:).md)

### Supporting types

- [IdentifiedStoreContent](../com.apple.storekit/StoreKit/IdentifiedStoreContent.md)

## See Also

- [SubscriptionOptionGroup](../com.apple.storekit/StoreKit/SubscriptionOptionGroup.md)
- [SubscriptionOptionGroupSet](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet.md)
- [SubscriptionPeriodGroupSet](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet.md)
- [SubscriptionOptionSection](../com.apple.storekit/StoreKit/SubscriptionOptionSection.md)
- [StoreContentBuilder](../com.apple.storekit/StoreKit/StoreContentBuilder.md)

---


## StoreView

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct StoreView<Icon, PlaceholderIcon> where Icon : View, PlaceholderIcon : View
```

## 

A `StoreView` displays a collection of in-app purchase products, including their localized names, descriptions, and prices, and displays a purchase button.

Create a store view by providing a collection of product identifiers for the view to load from the App Store, or a collection of [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) values you previously loaded. If you provide product identifiers, the store view automatically loads the product information from the App Store, and updates the view when the products are available.

You can provide a view to use as an icon or image for each individual product. If you provide product identifiers, you can optionally provide placeholder icons for the system to use instead of the automatic placeholder icon.

If you set up promoted images for your products in App Store Connect, you can choose to display those images for your products.

### 

The `StoreView` arranges products in rows. If the view has enough horizontal space available, the store adds columns. In tvOS, the view arranges the products in columns and adds rows as space permits.

The store view grows to fit its container, and scrolls when the container doesn’t have enough space to display all the products. Use the [doc://com.apple.documentation/documentation/SwiftUI/View/fixedSize(horizontal:vertical:)](doc://com.apple.documentation/documentation/SwiftUI/View/fixedSize(horizontal:vertical:)) modifier to change this behavior.

To achieve a custom layout, you can compose [doc://com.apple.storekit/documentation/StoreKit/ProductView](doc://com.apple.storekit/documentation/StoreKit/ProductView) instances with other container views instead of using the `StoreView`.

### 

You can customize the store by displaying additional buttons, and applying styles.

To display a button that syncs in-app purchase entitlements with the App Store, modify the in-app store view or an ancestor view using the `storeButton(_:for:)` modifier with the parameters [doc://com.apple.documentation/documentation/SwiftUI/Visibility/visible](doc://com.apple.documentation/documentation/SwiftUI/Visibility/visible) and [doc://com.apple.storekit/documentation/StoreKit/StoreButtonKind/restorePurchases](doc://com.apple.storekit/documentation/StoreKit/StoreButtonKind/restorePurchases). The app calls the [doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()](doc://com.apple.storekit/documentation/StoreKit/AppStore/sync()) method when people use this button.

You can customize the appearance of the products using product view styles, such as [doc://com.apple.storekit/documentation/StoreKit/CompactProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/CompactProductViewStyle), [doc://com.apple.storekit/documentation/StoreKit/LargeProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/LargeProductViewStyle), and [doc://com.apple.storekit/documentation/StoreKit/RegularProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/RegularProductViewStyle). To apply the style, call the [doc://com.apple.documentation/documentation/SwiftUI/View/productViewStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/productViewStyle(_:)) modifier.

## Topics

### Creating store views that load products

- [init(ids:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:).md)
- [init(ids:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:).md)
- [init(ids:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(ids:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/StoreView/init(ids:icon:placeholderIcon:).md)

### Creating store views with preloaded products

- [init(products:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/StoreView/init(products:prefersPromotionalIcon:).md)
- [init(products:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/StoreView/init(products:prefersPromotionalIcon:icon:).md)
- [init(products:icon:)](../com.apple.storekit/StoreKit/StoreView/init(products:icon:).md)

### Loading promotional images

- [ProductIconPhase](../com.apple.storekit/StoreKit/ProductIconPhase.md)

## See Also

- [ProductView](../com.apple.storekit/StoreKit/ProductView.md)
- [SubscriptionStoreView](../com.apple.storekit/StoreKit/SubscriptionStoreView.md)
- [SubscriptionOfferView](../com.apple.storekit/StoreKit/SubscriptionOfferView.md)
- [Backyard-birds-sample](../com.apple.SwiftUI/Backyard-birds-sample.md)

---


## SubscriptionOfferView

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor @preconcurrency struct SubscriptionOfferView<Icon, PlaceholderIcon> where Icon : View, PlaceholderIcon : View
```

## Topics

### Initializers

- [init(_:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:).md)
- [init(groupID:visibleRelationship:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:).md)
- [init(groupID:visibleRelationship:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:).md)
- [init(groupID:visibleRelationship:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:icon:placeholderIcon:).md)
- [init(groupID:visibleRelationship:useAppIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(groupID:visibleRelationship:useAppIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:icon:placeholderIcon:).md)
- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(_:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:icon:).md)
- [init(_:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:prefersPromotionalIcon:).md)
- [init(_:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/SubscriptionOfferView/init(_:prefersPromotionalIcon:icon:).md)

## See Also

- [ProductView](../com.apple.storekit/StoreKit/ProductView.md)
- [StoreView](../com.apple.storekit/StoreKit/StoreView.md)
- [SubscriptionStoreView](../com.apple.storekit/StoreKit/SubscriptionStoreView.md)
- [Backyard-birds-sample](../com.apple.SwiftUI/Backyard-birds-sample.md)

---


## SubscriptionOptionGroupSet

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionOptionGroupSet<GroupID, Label, MarketingContent> where GroupID : Hashable, Label : View, MarketingContent : View
```

## Topics

### Creating subscription option group sets

- [init(idType:groupedBy:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet/init(idType:groupedBy:label:).md)
- [init(idType:groupedBy:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet/init(idType:groupedBy:label:marketingContent:).md)

### Creating the group style

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreOptionGroupStyle(_:).md)

## See Also

- [SubscriptionOptionGroup](../com.apple.storekit/StoreKit/SubscriptionOptionGroup.md)
- [SubscriptionPeriodGroupSet](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet.md)
- [SubscriptionOptionSection](../com.apple.storekit/StoreKit/SubscriptionOptionSection.md)
- [StoreContent](../com.apple.storekit/StoreKit/StoreContent.md)
- [StoreContentBuilder](../com.apple.storekit/StoreKit/StoreContentBuilder.md)

---


## SubscriptionOptionSection

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionOptionSection<Header, Content, Footer> where Header : View, Content : StoreContent, Footer : View
```

## Topics

### Creating subscription option sections

- [init(_:isIncluded:footer:)-17lo3](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(_:isIncluded:footer:)-17lo3.md)
- [init(_:isIncluded:footer:)-36k79](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(_:isIncluded:footer:)-36k79.md)
- [init(isIncluded:header:footer:)](../com.apple.storekit/StoreKit/SubscriptionOptionSection/init(isIncluded:header:footer:).md)

### Choosing a subscription option group style

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreOptionGroupStyle(_:).md)

## See Also

- [SubscriptionOptionGroup](../com.apple.storekit/StoreKit/SubscriptionOptionGroup.md)
- [SubscriptionOptionGroupSet](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet.md)
- [SubscriptionPeriodGroupSet](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet.md)
- [StoreContent](../com.apple.storekit/StoreKit/StoreContent.md)
- [StoreContentBuilder](../com.apple.storekit/StoreKit/StoreContentBuilder.md)

---


## SubscriptionPeriod

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias SubscriptionPeriod = Product.SubscriptionPeriod
```

## See Also

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)
- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [SubscriptionRenewalInfo](../com.apple.storekit/StoreKit/SubscriptionRenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)
- [SubscriptionRenewalState](../com.apple.storekit/StoreKit/SubscriptionRenewalState.md)

---


## SubscriptionPeriodGroupSet

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionPeriodGroupSet<Label, MarketingContent> where Label : View, MarketingContent : View
```

## Topics

### Creating subscription period group sets

- [init()](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init().md)
- [init(marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init(marketingContent:).md)
- [init(marketingContent:label:)](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet/init(marketingContent:label:).md)

### Creating the group style

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreOptionGroupStyle(_:).md)

## See Also

- [SubscriptionOptionGroup](../com.apple.storekit/StoreKit/SubscriptionOptionGroup.md)
- [SubscriptionOptionGroupSet](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet.md)
- [SubscriptionOptionSection](../com.apple.storekit/StoreKit/SubscriptionOptionSection.md)
- [StoreContent](../com.apple.storekit/StoreKit/StoreContent.md)
- [StoreContentBuilder](../com.apple.storekit/StoreKit/StoreContentBuilder.md)

---


## SubscriptionRenewalState

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias SubscriptionRenewalState = Product.SubscriptionInfo.RenewalState
```

## See Also

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)
- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [SubscriptionRenewalInfo](../com.apple.storekit/StoreKit/SubscriptionRenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/SubscriptionPeriod.md)

---


## SubscriptionStoreButton

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionStoreButton
```

## 

When implementing custom subscription store control styles conforming to [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle), you can use this button to utilize the standard subscribe button as a component of the view you provide from [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)). The subscription store button automatically generates a localized label and optional caption for the corresponding subscription option. To configure a custom button label, use [doc://com.apple.documentation/documentation/SwiftUI/Button](doc://com.apple.documentation/documentation/SwiftUI/Button) instead.

Standard subscription store control styles use the subscription store button. For example, the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/buttons](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/buttons) style creates a `SubscriptionStoreButton` instance for each subscription option.

> **TIP:** Within the scope of your type conforming to [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle), you can spell `SubscriptionStoreButton` as `SubscribeButton` through the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/SubscribeButton](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/SubscribeButton) type alias.

In iOS, macOS, visionOS and watchOS you can configure the button’s label by modifying it with `subscriptionStoreButtonLabel(_:)`. Some button label configurations cause the button to have a caption, for example .`displayName.singleLine`.

Because the `SubscriptionStoreButton` is composed of a SwiftUI [doc://com.apple.documentation/documentation/SwiftUI/Button](doc://com.apple.documentation/documentation/SwiftUI/Button), you can also configure the button using other built-in view modifiers such as [doc://com.apple.documentation/documentation/SwiftUI/View/buttonStyle(_:)-66fbx](doc://com.apple.documentation/documentation/SwiftUI/View/buttonStyle(_:)-66fbx).

To create a `SubscriptionStoreButton`, provide a value of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) to the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreButton/init(_:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreButton/init(_:)) method. Get an option value from the required [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)) method on your [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle) implementation.

> **IMPORTANT:** Use `SubscriptionStoreButton` only in the view you return from the required [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)) method of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle). Using `SubscriptionStoreButton` in other contexts is not supported.

## Topics

### Creating a subscription store button

- [init(_:)](../com.apple.storekit/StoreKit/SubscriptionStoreButton/init(_:).md)

## See Also

- [SubscriptionStorePicker](../com.apple.storekit/StoreKit/SubscriptionStorePicker.md)
- [SubscriptionStorePickerOption](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption.md)

---


## SubscriptionStoreButtonLabel

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
struct SubscriptionStoreButtonLabel
```

## Topics

### Instance Properties

- [action-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.property.md)
- [displayName-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.property.md)
- [multiline-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.property.md)
- [price-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.property.md)
- [singleLine-swift.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.property.md)

### Type Properties

- [action-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/action-swift.type.property.md)
- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/automatic.md)
- [displayName-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/displayName-swift.type.property.md)
- [multiline-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/multiline-swift.type.property.md)
- [price-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/price-swift.type.property.md)
- [singleLine-swift.type.property](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel/singleLine-swift.type.property.md)

## See Also

- [subscriptionStoreControlIcon(icon:)](../com.apple.SwiftUI/View/subscriptionStoreControlIcon(icon:).md)
- [subscriptionStorePickerItemBackground(_:)](../com.apple.SwiftUI/View/subscriptionStorePickerItemBackground(_:).md)
- [subscriptionStorePickerItemBackground(_:in:)](../com.apple.SwiftUI/View/subscriptionStorePickerItemBackground(_:in:).md)
- [subscriptionStoreButtonLabel(_:)](../com.apple.SwiftUI/View/subscriptionStoreButtonLabel(_:).md)

---


## SubscriptionStoreContentView

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionStoreContentView<Content> where Content : StoreContent
```

## See Also

- [AutomaticSubscriptionStoreMarketingContent](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreMarketingContent.md)

---


## SubscriptionStoreControlPlacement

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
protocol SubscriptionStoreControlPlacement : RawRepresentable where Self.RawValue == SubscriptionStoreControlPlacementKey
```

## 

A placement indicates a position for placing a control in a view. Specifically, a subscription store control placement indicates a postion for placing a subscription control in a subscription store view. You typically don’t need to implement your own control placement; instead, use the conforming placement types. To see the available control placements for a type, such as a [doc://com.apple.storekit/documentation/StoreKit/PagedPickerSubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/PagedPickerSubscriptionStoreControlStyle), check the `Placement` associated type on a control style.

Not all subscription store control styles support all placements. For example, the picker control styles don’t support the bottom bar placement because the height obscures the scroll view.

## Topics

### Getting a placement

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacement/automatic.md)

### Placement types

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)

## See Also

- [subscriptionStoreControlStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:placement:).md)
- [SubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle.md)
- [SubscriptionStoreControlStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration.md)

---


## SubscriptionStoreControlPlacementKey

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SubscriptionStoreControlPlacementKey
```

## 

This type represents all available control placements. You typically don’t interact with this type directly. Use it if you create a custom control style that conforms to the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle) protocol to restrict the supported placements for your style. By default, a custom control style supports all placements. For more information, see [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlPlacement](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlPlacement).

## Topics

### Placing subscription store controls

- [bottom](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/bottom.md)
- [leading](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/leading.md)
- [scrollView](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/scrollView.md)
- [trailing](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/trailing.md)
- [bottomBar](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/bottomBar.md)
- [buttonsInBottomBar](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey/buttonsInBottomBar.md)

## See Also

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

---


## SubscriptionStoreControlStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency protocol SubscriptionStoreControlStyle
```

## 

Use the [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)) view modifier to configure the subscription store control style for a view hierarchy.

```swift
SubscriptionStoreView(groupID: "SAMPLE")
    .subscriptionStoreControlStyle(.prominentPicker)
```

You can also configure the control placement using the [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:placement:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:placement:)) view modifier.

### 

To create a custom style, declare a type that conforms to the `SubscriptionStoreControlStyle` protocol and implement the required [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)) method. For example, you can define a style that adds price comparison captions to buttons.

```swift
struct PriceComparisonButtonsSubscriptionStoreControlStyle: SubscriptionStoreControlStyle {

    func makeBody(configuration: Configuration) -> some View {
        // Return a view displaying a captioned button for each option.
    }
}
```

Inside the method, use the `configuration` parameter, which is a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration) value, to get the properties of the control, such as the subscriptions to merchandise. For examples that show constructing a view from the configuration value, see [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)).

The subscription store control style protocol has a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/Placement](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/Placement) associated type, which represents the placements that the style supports. To optionally restrict the placements your custom style supports, explicitly declare a type alias named `Placement`. For more information about restricting placements, see [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlPlacement](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlPlacement). If you don’t declare the type alias, your custom style automatically uses the [doc://com.apple.storekit/documentation/StoreKit/AutomaticSubscriptionStoreControlPlacement](doc://com.apple.storekit/documentation/StoreKit/AutomaticSubscriptionStoreControlPlacement) as its [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/Placement](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/Placement) associated type.

The following code example declares a `Placement` type alias:

```swift
struct PriceComparisonButtonsSubscriptionStoreControlStyle: SubscriptionStoreControlStyle {

    // Support the same placements as the standard buttons style.
    typealias Placement = ButtonsSubscriptionStoreControlStyle.Placement

    func makeBody(configuration: Configuration) -> some View {
        // Return a view displaying a captioned button for each option.
    }
}
```

To provide easy access to the new style, declare a corresponding static variable in an extension to `SubscriptionStoreControlStyle`.

```swift
extension SubscriptionStoreControlStyle where Self == 
PriceComparisonButtonsSubscriptionStoreControlStyle {
    static var priceComparisonButtons: Self { Self() }
}
```

Then, use your custom style as follows:

```swift
SubscriptionStoreView(groupID: "SAMPLE")
    .subscriptionStoreControlStyle(.priceComparisonButtons)
```

## Topics

### Getting built-in subscription store control styles

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)
- [buttons](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/buttons.md)
- [picker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/picker.md)
- [prominentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/prominentPicker.md)
- [pagedPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedPicker.md)
- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)
- [compactPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/compactPicker.md)

### Creating custom subscription store control styles

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Configuration.md)
- [SubscribeButton](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscribeButton.md)
- [SubscriptionPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPicker.md)
- [SubscriptionPickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/SubscriptionPickerOption.md)
- [SubscriptionStoreControlPlacementKey](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacementKey.md)
- [Placement](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Placement.md)
- [Body](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/Body.md)

### Supporting types

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [ProminentPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ProminentPickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)
- [PagedProminentPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedProminentPickerSubscriptionStoreControlStyle.md)
- [AutomaticSubscriptionStoreControlPlacement](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement.md)

## See Also

- [subscriptionStoreControlStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:placement:).md)
- [SubscriptionStoreControlStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration.md)
- [SubscriptionStoreControlPlacement](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacement.md)

---


## SubscriptionStoreControlStyleConfiguration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SubscriptionStoreControlStyleConfiguration
```

## 

When you define a custom subscription store control style by creating a type that conforms to the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle) protocol, you implement the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)) method. That method takes a `SubscriptionStoreControlStyleConfiguration` parameter, which has the information necessary to define the behavior and interactions of a subscription store view’s primary controls.

Decide whether your style supports dividing options into sections.

- If you support sections, use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/sections) property to preserve the structure and accessory views you declare using [doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection](doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionSection) instances.
- If you don’t support sections, use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/options) property to have a flattened array of the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) values to merchandise.

Provide a control that enables customers to subscribe to each option in either the `options` or `sections` properties.

To hide and sort the subscription options that your view displays, use the initializer of the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView). For example, you can initialize the subscription store to contain only the subscription options that upgrade the customer’s current subscription.

Display only the subscription options that appear in either the `options` or `sections` properties. For example, declaring [doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionGroup](doc://com.apple.storekit/documentation/StoreKit/SubscriptionOptionGroup) instances can hide certain subscription options from a control. To access information about other subscription options, use the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions) property.

In cases where a customer is actively subscribed, use [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference) to get the [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) value of the subscription product that renews at the next billing.

## Topics

### Getting subscription options to merchandise

- [options](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/options.md)
- [sections](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/sections.md)
- [Option](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Option.md)
- [PickerOption](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/PickerOption.md)
- [Section](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Section.md)
- [Icon](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/Icon.md)

### Getting subscription group properties

- [groupDisplayName](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/groupDisplayName.md)
- [autoRenewPreference](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/autoRenewPreference.md)
- [allOptions](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/allOptions.md)

### Getting subscription description visibility

- [descriptionVisibility](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration/descriptionVisibility.md)

## See Also

- [subscriptionStoreControlStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:placement:).md)
- [SubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle.md)
- [SubscriptionStoreControlPlacement](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacement.md)

---


## SubscriptionStorePickerOption

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionStorePickerOption<Label> where Label : View
```

## Topics

### Creating a subscription picker option

- [init(_:)-4cb3l](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:)-4cb3l.md)
- [init(_:)-3iu97](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:)-3iu97.md)
- [init(_:label:)](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption/init(_:label:).md)

### Supporting types

- [AutomaticSubscriptionStorePickerOptionLabel](../com.apple.storekit/StoreKit/AutomaticSubscriptionStorePickerOptionLabel.md)

## See Also

- [SubscriptionStoreButton](../com.apple.storekit/StoreKit/SubscriptionStoreButton.md)
- [SubscriptionStorePicker](../com.apple.storekit/StoreKit/SubscriptionStorePicker.md)

---


## SubscriptionStoreView

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionStoreView<Content> where Content : View
```

## 

A `SubscriptionStoreView` displays localized information about auto-renewable subscriptions, including their localized names, descriptions, and prices, as well as a purchase button.

Create a subscription store view by using one of the initializers and providing the following information:

- A subscription group identifier
- A collection of product identifiers
- A collection of product values you previously loaded from the App Store

If you provide a subscription group identifier or a collection of product identifiers, the subscription store view automatically loads the subscription data from the App Store, and updates the view when the data is available.

### 

The subscription store view doesn’t draw a background by default. You can add a background as follows:

- To layer a background behind the view, use a view modifier, such as `background(alignment:content:)`.
- To set the container background of the subscription store using a view, use the `containerBackground(_:for:)` or `containerBackground(for:alignment:content:)` view modifier and specify a [doc://com.apple.documentation/documentation/SwiftUI/ContainerBackgroundPlacement](doc://com.apple.documentation/documentation/SwiftUI/ContainerBackgroundPlacement), such as [doc://com.apple.documentation/documentation/SwiftUI/ContainerBackgroundPlacement/subscriptionStoreHeader](doc://com.apple.documentation/documentation/SwiftUI/ContainerBackgroundPlacement/subscriptionStoreHeader).

You can optionally provide a view as a decorative icon next to each subscription option. Use the [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlIcon(icon:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlIcon(icon:)) view modifier to set a view that decorates individual subscription options within a subscription store.

### 

If you create the subscription store view by providing a subscription group identifier, the system orders the subscription options according to their rank. If the customer is already subscribed, you may want to merchandise upgrade or crossgrade options. By default, the subscription store view lists all the subscriptions in the group. To hide certain subscription options, provide the `visibleRelationships` parameter in the initializer. For more information about the visible relationships, see [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionRelationship](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionRelationship).

If you create the subscription store view using one of the other initializers, the view orders the subscriptions according to the collection parameter’s order. The view excludes subscriptions that you don’t include in the collection parameter.

### 

The `SubscriptionStoreView` automatically displays buttons for the terms of service and privacy policy that you submit in App Store Connect. To override the destination of these buttons with a URL to custom terms of service and privacy policy pages, or a custom view, use the modifiers [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(url:for:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(url:for:)) and [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(for:destination:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(for:destination:)).

Use modifiers, such as [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyForegroundStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyForegroundStyle(_:)), to customize the button’s style, for example, to make the text more readable against your store’s background.

### 

You can show auxiliary buttons in the subscription store using view modifiers. Specify the button’s visibility within the subscription store by using the [doc://com.apple.documentation/documentation/SwiftUI/View/storeButton(_:for:)](doc://com.apple.documentation/documentation/SwiftUI/View/storeButton(_:for:)) view modifier.

If you offer your subscription through other services, you can configure the subscription store view to display a sign-in button. Use the [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreSignInAction(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreSignInAction(_:)) modifier to set the function your app calls when someone uses the sign-in button.

The subscription store view automatically shows a Close button. To override this behavior, use the `storeButton(_:for:)` modifier to unconditionally show, or hide, the Close button.

### 

You can further customize the subscription store’s appearance using control styles. Use subscription store control styles to customize the display of subscription options, and how people interact with your store. To try out standard styles, such as [doc://com.apple.storekit/documentation/StoreKit/PickerSubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/PickerSubscriptionStoreControlStyle), apply the style using the [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStoreControlStyle(_:)) modifier.

## Topics

### Creating subscription store views with automatic marketing content

- [init(groupID:visibleRelationships:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:).md)
- [init(productIDs:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:).md)
- [init(subscriptions:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:).md)

### Creating subscription store views with custom marketing content

- [init(groupID:visibleRelationships:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:marketingContent:).md)
- [init(productIDs:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:marketingContent:).md)
- [init(subscriptions:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:marketingContent:).md)

### Creating subscription store views with a hierarchichal structure

- [init(groupID:visibleRelationships:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(groupID:visibleRelationships:content:).md)
- [init(productIDs:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(productIDs:content:).md)
- [init(subscriptions:content:)](../com.apple.storekit/StoreKit/SubscriptionStoreView/init(subscriptions:content:).md)

### Supporting types

- [AutomaticSubscriptionStoreMarketingContent](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreMarketingContent.md)
- [SubscriptionStoreContentView](../com.apple.storekit/StoreKit/SubscriptionStoreContentView.md)

## See Also

- [ProductView](../com.apple.storekit/StoreKit/ProductView.md)
- [StoreView](../com.apple.storekit/StoreKit/StoreView.md)
- [SubscriptionOfferView](../com.apple.storekit/StoreKit/SubscriptionOfferView.md)
- [Backyard-birds-sample](../com.apple.SwiftUI/Backyard-birds-sample.md)

---


## TabsSubscriptionOptionGroupStyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
struct TabsSubscriptionOptionGroupStyle
```

## Topics

### Getting the tabs style

- [tabs](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/tabs.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/TabsSubscriptionOptionGroupStyle/init().md)

## See Also

- [AutomaticSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOptionGroupStyle.md)
- [LinksSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/LinksSubscriptionOptionGroupStyle.md)
- [SubscriptionOptionGroupStyleOutput](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyleOutput.md)

---


## Transaction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Transaction
```

## 

A *transaction* represents a successful In-App Purchase. The App Store generates a transaction each time a customer purchases an In-App Purchase product or renews a subscription. For each transaction that represents a current purchase, your app unlocks the purchased content or service and finishes the transaction.

Use the `Transaction` type to perform these transaction-related tasks:

- Get the customer’s transaction history, latest transactions, and current entitlements to unlock content and services.
- Access transaction properties.
- Finish a transaction after your app delivers the purchased content or service.
- Access the raw JSON Web Signature (JWS) string and supporting values to verify the transaction information.
- Listen for new transactions while the app is running.
- Begin a refund request from within your app.

### 

Your app doesn’t create transaction objects. Instead, StoreKit automatically makes up-to-date transactions available to your app, including when someone launches the app for the first time.

> **NOTE:** Session 110404: [https://developer.apple.com/videos/play/wwdc2022/110404/](https://developer.apple.com/videos/play/wwdc2022/110404/)

You access transactions in several ways:

- Get transaction history anytime by accessing the static [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all) sequence, or get just the most recent transaction for a product with the [doc://com.apple.storekit/documentation/StoreKit/Product/latestTransaction](doc://com.apple.storekit/documentation/StoreKit/Product/latestTransaction) property of [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product).
- Receive notifications for new transactions while your app is running when customers complete a purchase outside of the app, including on another device, through the transaction listener, [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).
- Access the latest transaction for a subscription group through the subscription status API, using [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/transaction](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/transaction).
- After a successful In-App Purchase, StoreKit returns the transaction through [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/success(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/success(_:)).

The most important use of transaction information is for determining which In-App Purchases the customer has paid access to, so your app can unlock the content or service. The [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) API provides the information you need to unlock all of the customer’s paid content in your app. Use `currentEntitlements` to get a list of transactions for all the products the customer is currently entitled to, including non-consumable In-App Purchases and currently active subscriptions.

### 

The App Store cryptographically signs transaction information in JWS format. StoreKit automatically validates and returns the signed information, wrapped in a [doc://com.apple.storekit/documentation/StoreKit/VerificationResult](doc://com.apple.storekit/documentation/StoreKit/VerificationResult). When the `VerificationResult` wraps a `Transaction` value, it provides the raw JWS string in the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) property. If you get a transaction through [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/verified(_:)](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/verified(_:)), the information passed validation. If you get it through [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unverified(_:_:)](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/unverified(_:_:)), the information didn’t pass StoreKit’s automatic validation. Your app can immediately access the transaction information in the [doc://com.apple.storekit/documentation/StoreKit/transaction-properties](doc://com.apple.storekit/documentation/StoreKit/transaction-properties).

To perform your own validation on the device, use the verification result’s [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) string, and use the provided convenience properties [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/headerData-9egfp](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/headerData-9egfp), [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/payloadData-uyle](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/payloadData-uyle), and [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signatureData-4pyv8](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/signatureData-4pyv8). For added control and security, send the `jwsRepresentation` to your server to verify. Consider using the App Store Server Library to implement your verification. The library provides the functions `verifyAndDecodeTransaction` and `verifyAndDecodeRenewalInfo` in each language the library supports. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

> **TIP:** The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) is the same as the [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction) that the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI) returns and to the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransaction) that you receive in [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2). You can validate them on your server in the same way.

If StoreKit returns a transaction as verified, the transaction is valid for the device. For information about performing your own verification for a device, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification](doc://com.apple.storekit/documentation/StoreKit/Transaction/deviceVerification).

For more information about JWS, see the [https://datatracker.ietf.org/doc/html/rfc7515](https://datatracker.ietf.org/doc/html/rfc7515) specification.

### 

All In-App Purchases that customers make are equally available to your app in this `Transaction` API, and in receipts using the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase), as follows:

- New purchases that customers make with the original API are available immediately using the `Transaction` API.
- Purchases that customers make with the [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) method are available in the original API when your app refreshes the receipt. For more information, see [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest).

## Topics

### Transaction properties

- [transaction-properties](../com.apple.storekit/StoreKit/transaction-properties.md)
- [appTransactionID](../com.apple.storekit/StoreKit/Transaction/appTransactionID.md)

### Monitoring transaction-related changes

- [updates](../com.apple.storekit/StoreKit/Transaction/updates.md)
- [Transactions](../com.apple.storekit/StoreKit/Transaction/Transactions.md)

### Getting transaction history

- [latest(for:)](../com.apple.storekit/StoreKit/Transaction/latest(for:).md)
- [all](../com.apple.storekit/StoreKit/Transaction/all.md)
- [unfinished](../com.apple.storekit/StoreKit/Transaction/unfinished.md)
- [SKIncludeConsumableInAppPurchaseHistory](../com.apple.BundleResources/Information-Property-List/SKIncludeConsumableInAppPurchaseHistory.md)

### Getting current entitlements

- [currentEntitlements](../com.apple.storekit/StoreKit/Transaction/currentEntitlements.md)

### Getting transactions for a product

- [all(for:)](../com.apple.storekit/StoreKit/Transaction/all(for:).md)

### Finishing the transaction

- [finish()](../com.apple.storekit/StoreKit/Transaction/finish().md)
- [unfinished](../com.apple.storekit/StoreKit/Transaction/unfinished.md)

### Verifying transactions

- [deviceVerification](../com.apple.storekit/StoreKit/Transaction/deviceVerification.md)
- [deviceVerificationNonce](../com.apple.storekit/StoreKit/Transaction/deviceVerificationNonce.md)
- [signedDate](../com.apple.storekit/StoreKit/Transaction/signedDate.md)

### Getting transaction info in JSON format

- [jsonRepresentation](../com.apple.storekit/StoreKit/Transaction/jsonRepresentation.md)

### Requesting refunds

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [beginRefundRequest(in:)-9k0pj](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj.md)
- [beginRefundRequest(in:)-63bvd](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(in:)-63bvd.md)
- [beginRefundRequest(for:in:)-65tph](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph.md)
- [beginRefundRequest(for:in:)-9mscy](../com.apple.storekit/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy.md)
- [RefundRequestError](../com.apple.storekit/StoreKit/Transaction/RefundRequestError.md)
- [RefundRequestStatus](../com.apple.storekit/StoreKit/Transaction/RefundRequestStatus.md)

### Advanced Commerce transaction data

- [advancedCommerceInfo-swift.property](../com.apple.storekit/StoreKit/Transaction/advancedCommerceInfo-swift.property.md)
- [AdvancedCommerceInfo-swift.struct](../com.apple.storekit/StoreKit/Transaction/AdvancedCommerceInfo-swift.struct.md)

### Getting offer types

- [OfferType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OfferType-swift.struct.md)

### Deprecated

- [currentEntitlement(for:)](../com.apple.storekit/StoreKit/Transaction/currentEntitlement(for:).md)
- [currentEntitlements(for:)](../com.apple.storekit/StoreKit/Transaction/currentEntitlements(for:).md)
- [offerPeriodStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPeriodStringRepresentation.md)

## See Also

- [updates](../com.apple.storekit/StoreKit/Transaction/updates.md)
- [all](../com.apple.storekit/StoreKit/Transaction/all.md)
- [currentEntitlements](../com.apple.storekit/StoreKit/Transaction/currentEntitlements.md)

---


## TupleStoreContent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct TupleStoreContent<each Content> where repeat each Content : StoreContent
```

## See Also

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)

---


## ad-network-attribution

## Topics

### Ad impressions and installation validations

- [adattributionkit-skadnetwork-interoperability](../com.apple.AdAttributionKit/adattributionkit-skadnetwork-interoperability.md)
- [SKAdNetwork](../com.apple.storekit/StoreKit/SKAdNetwork.md)
- [SKAdImpression](../com.apple.storekit/StoreKit/SKAdImpression.md)

### Error handling

- [SKANErrorDomain](../com.apple.storekit/StoreKit/SKANErrorDomain.md)
- [SKANError-swift.struct](../com.apple.storekit/StoreKit/SKANError-swift.struct.md)
- [Code](../com.apple.storekit/StoreKit/SKANError-swift.struct/Code.md)

---


## ad-network-install-validation-keys

## 

Ad networks use these keys when calling the product view controller’s [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) method. These keys describe an ad impression in an advertising campaign. The information they contain associates an app installation with an ad campaign. The [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier) key identifies the advertised app.

Include all the required validation keys in the parameter dictionary for the SKAdNetwork version you’re using.

You also use the values of these keys to generate a signature for the ad impression. For more information, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads).

## Topics

### Required keys for SKAdNetwork 4 and later

- [SKStoreProductParameterAdNetworkSourceIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier.md)

### Required keys for SKAdNetwork 2 and later

- [SKStoreProductParameterAdNetworkVersion](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkVersion.md)
- [SKStoreProductParameterAdNetworkSourceAppStoreIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier.md)

### Required keys

- [SKStoreProductParameterAdNetworkIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkIdentifier.md)
- [SKStoreProductParameterAdNetworkCampaignIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier.md)
- [SKStoreProductParameterAdNetworkTimestamp](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkTimestamp.md)
- [SKStoreProductParameterAdNetworkNonce](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkNonce.md)
- [SKStoreProductParameterAdNetworkAttributionSignature](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature.md)

## See Also

- [generating-the-signature-to-validate-storekit-rendered-ads](../com.apple.storekit/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads.md)

---


## advancedcommerceproduct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct AdvancedCommerceProduct
```

## 

For more information about [doc://com.apple.documentation/documentation/AdvancedCommerceAPI](doc://com.apple.documentation/documentation/AdvancedCommerceAPI), see [https://developer.apple.com/in-app-purchase/advanced-commerce-api/](https://developer.apple.com/in-app-purchase/advanced-commerce-api/).

## Topics

### Getting the product ID and type

- [id](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/id.md)
- [ProductType](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/ProductType.md)
- [type](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/type.md)

### Initiating purchases

- [PurchaseOption](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseOption.md)
- [purchase(compactJWS:confirmIn:options:)-7x4bh](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-7x4bh.md)
- [purchase(compactJWS:confirmIn:options:)-54lkw](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:confirmIn:options:)-54lkw.md)
- [purchase(compactJWS:options:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/purchase(compactJWS:options:).md)
- [PurchaseResult](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/PurchaseResult.md)

### Getting transactions and entitlements

- [allTransactions](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/allTransactions.md)
- [currentEntitlements](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/currentEntitlements.md)
- [latestTransaction](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/latestTransaction.md)

### Initializing an instance

- [init(id:)](../com.apple.storekit/StoreKit/AdvancedCommerceProduct/init(id:).md)

### Handling errors

- [InvalidRequestError](../com.apple.storekit/StoreKit/InvalidRequestError.md)

## See Also

- [sending-advanced-commerce-api-requests-from-your-app](../com.apple.storekit/StoreKit/sending-advanced-commerce-api-requests-from-your-app.md)
- [generating-jws-to-sign-app-store-requests](../com.apple.storekit/StoreKit/generating-jws-to-sign-app-store-requests.md)

---


## appstore

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum AppStore
```

## 

Use these static functions and variables to perform tasks like showing the manage subscriptions sheet, getting the device verification ID, determining whether users can make purchases, and more.

## Topics

### Checking the environment

- [Environment](../com.apple.storekit/StoreKit/AppStore/Environment.md)

### Checking payment setup

- [canMakePayments](../com.apple.storekit/StoreKit/AppStore/canMakePayments.md)

### Checking current age rating

- [ageRatingCode](../com.apple.storekit/StoreKit/AppStore/ageRatingCode.md)

### Verifying devices

- [deviceVerificationID](../com.apple.storekit/StoreKit/AppStore/deviceVerificationID.md)

### Getting the platform

- [Platform](../com.apple.storekit/StoreKit/AppStore/Platform.md)

### Managing subscriptions

- [showManageSubscriptions(in:)](../com.apple.storekit/StoreKit/AppStore/showManageSubscriptions(in:).md)
- [showManageSubscriptions(in:subscriptionGroupID:)](../com.apple.storekit/StoreKit/AppStore/showManageSubscriptions(in:subscriptionGroupID:).md)

### Requesting reviews

- [RequestReviewAction](../com.apple.storekit/StoreKit/RequestReviewAction.md)
- [requestReview(in:)-1q8qs](../com.apple.storekit/StoreKit/AppStore/requestReview(in:)-1q8qs.md)
- [requestReview(in:)-4r0y9](../com.apple.storekit/StoreKit/AppStore/requestReview(in:)-4r0y9.md)

### Presenting the offer code redemption sheet

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [presentOfferCodeRedeemSheet(in:)](../com.apple.storekit/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:).md)
- [offerCodeRedemption(isPresented:onCompletion:)](../com.apple.SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:).md)
- [presentOfferCodeRedeemSheet(from:)](../com.apple.storekit/StoreKit/AppStore/presentOfferCodeRedeemSheet(from:).md)

### Restoring purchases

- [sync()](../com.apple.storekit/StoreKit/AppStore/sync().md)

### Merchandising

- [AppStoreMerchandisingKind](../com.apple.storekit/StoreKit/AppStoreMerchandisingKind.md)

### Type Methods

- [presentMerchandising(_:from:)-8bblo](../com.apple.storekit/StoreKit/AppStore/presentMerchandising(_:from:)-8bblo.md)
- [presentMerchandising(_:from:)-hkrd](../com.apple.storekit/StoreKit/AppStore/presentMerchandising(_:from:)-hkrd.md)

## See Also

- [AppTransaction](../com.apple.storekit/StoreKit/AppTransaction.md)

---


## automaticproductplaceholdericon

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct AutomaticProductPlaceholderIcon
```

## 

You don’t use this type directly. Instead, create a [doc://com.apple.storekit/documentation/StoreKit/ProductView](doc://com.apple.storekit/documentation/StoreKit/ProductView) or [doc://com.apple.storekit/documentation/StoreKit/StoreView](doc://com.apple.storekit/documentation/StoreKit/StoreView) and provide product identifiers without a custom placeholder icon.

---


## automaticproductviewstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct AutomaticProductViewStyle
```

## Topics

### Creating automatic product view styles

- [init()](../com.apple.storekit/StoreKit/AutomaticProductViewStyle/init().md)

## See Also

- [CompactProductViewStyle](../com.apple.storekit/StoreKit/CompactProductViewStyle.md)
- [RegularProductViewStyle](../com.apple.storekit/StoreKit/RegularProductViewStyle.md)
- [LargeProductViewStyle](../com.apple.storekit/StoreKit/LargeProductViewStyle.md)

---


## automaticsubscriptionofferviewstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor struct AutomaticSubscriptionOfferViewStyle
```

## Topics

### Initializers

- [init()](../com.apple.storekit/StoreKit/AutomaticSubscriptionOfferViewStyle/init().md)

## See Also

- [CompactSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/CompactSubscriptionOfferViewStyle.md)
- [SubscriptionOfferViewStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration.md)
- [SubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle.md)

---


## automaticsubscriptionstorecontrolstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct AutomaticSubscriptionStoreControlStyle
```

## Topics

### Getting the automatic subscription store control style

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/automatic.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle/init().md)

## See Also

- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)

---


## automaticsubscriptionstoremarketingcontent

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct AutomaticSubscriptionStoreMarketingContent
```

## 

You don’t use this type directly. Instead, create a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView) using an initializer that doesn’t include a `marketingContent` parameter for providing custom marketing content.

## See Also

- [SubscriptionStoreContentView](../com.apple.storekit/StoreKit/SubscriptionStoreContentView.md)

---


## automaticsubscriptionstorepickeroptionlabel

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct AutomaticSubscriptionStorePickerOptionLabel
```

---


## choosing-a-receipt-validation-technique

## 

> **NOTE:** The receipt isn’t necessary if you use [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) to validate the app download, or [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) to validate in-app purchases. Only use the receipt if your app uses the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase), or needs the receipt to validate the app download because it can’t use [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

An App Store receipt provides a record of the sale of an app and any purchases the person makes within the app. You can authenticate purchased content by adding receipt validation code to your app or server. Receipt validation requires an understanding of secure coding techniques to employ a solution that’s secure and unique to your app.

### 

There are two ways to verify a receipt’s authenticity:

- Locally, on the device. Validating receipts locally requires code that reads and validates a binary file that Apple encodes and signs as a PKCS #7 container. For more information, see [doc://com.apple.documentation/documentation/AppStoreReceipts/validating-receipts-on-the-device](doc://com.apple.documentation/documentation/AppStoreReceipts/validating-receipts-on-the-device).
- On your server with the App Store. Validating receipts with the App Store requires secure connections between your app and your server, and between your server and the App Store. For more information, see [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).

Compare the approaches and determine the method that best fits your app and your infrastructure. You can also choose to implement both approaches. For managing auto-renewable subscriptions, see the following table for the key advantages that server-side receipt validation provides over on-device receipt validation:

| Capability | On-device validation | Server-side validation |
| --- | --- | --- |
| Validates authenticity of receipt | Yes | Yes |
| Includes subscription renewal transactions | Yes | Yes |
| Includes additional subscription information | No | Yes |
| Resistant to device clock change | No | Yes |

Receipts contain non-consumable in-app purchases, auto-renewable subscriptions, and non-renewing subscriptions indefinitely. Consumable in-app purchases remain in the receipt until you call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)). You may choose to maintain and manage records of consumable in-app purchases on your server.

### 

The App Store updates receipts immediately after completed purchases. When you call [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) from your server, the App Store returns the latest transaction information, regardless of the contents of the receipt you send in the request.

On the device, the system updates the receipt immediately when it has an internet connection, and any of the following occur:

- The customer completes an in-app purchase.
- The app launches its transaction observer ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver)) and has unfinished transactions or subscription renewals.
- The app calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:)) to restore transactions.
- The app sends a request to [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest) to get a receipt if the receipt is invalid or missing.

Transactions can also occur at times when the app isn’t running. When necessary, call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) to ensure the receipt you’re working with is up-to-date. For example, if a customer purchases an auto-renewable subscription on another device, call this method to get those transactions and update the receipt.

To ensure that your app receives all transactions, add the transaction observer, [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-5ciz2](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-5ciz2), at app launch time. For more information, see [doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue](doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue).

> **NOTE:** Session 705: [https://developer.apple.com/videos/play/wwdc2018/705/](https://developer.apple.com/videos/play/wwdc2018/705/)

## See Also

- [validating-receipts-with-the-app-store](../com.apple.storekit/StoreKit/validating-receipts-with-the-app-store.md)
- [appStoreReceiptURL](../com.apple.Foundation/Bundle/appStoreReceiptURL.md)
- [SKReceiptRefreshRequest](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest.md)

---


## choosing-a-storekit-api-for-in-app-purchases

## 

The StoreKit framework provides two APIs to implement a store in your app and offer in-app purchases:

- [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) is a Swift-based API that provides App Store-signed transactions in JSON Web Signature (JWS) format, available starting in iOS 15, macOS 12, tvOS 15, watchOS 8, and visionOS 1.
- [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase) provides transaction information using App Store receipts, available starting in iOS 3, macOS 10.7, tvOS 9, watchOS 6.2, and visionOS 1.

> **NOTE:** The [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase) is deprecated.

If your app has a minimum required operating system that the [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) API supports, use this API to take advantage of Swift concurrency and simplified in-app purchase workflows. Use this API for visionOS apps that use multiple scenes.

Use the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase) to maintain and update app versions that have a minimum required operating system of the following versions: macOS 11 or earlier, iOS 14 or earlier, iPadOS 14 or earlier, tvOS 14 or earlier, or watchOS 7 or earlier.

An app can use both the [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) API and the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase) if the app runs in iOS 15, macOS 12, tvOS 15, watchOS 8, and visionOS 1 or later. However, only the [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) API supports multi-scene apps for visionOS.

Both APIs provide access to your data in the App Store, such as your configured in-app purchases and transaction information for your customers. In-app purchases that users make using either API are fully available to both APIs.

### 

The following features are available only with the Swift-based [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs:

- [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views), which provide the UI to build a store in your app
- Refund request sheets, such as [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph), that enable customers to request refunds
- Information about a subscription’s renewal status, such as auto-renew preferences. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct).
- Information about available promotional offers and a subscriber’s eligibility for an introductory offer. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo).
- Deferring or suppressing Billing Issue messages that the system displays. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).
- Presenting the App Store sheet for managing subscriptions. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:subscriptionGroupID:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:subscriptionGroupID:)).
- Transaction information in JSON Web Signature (JWS) format. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

### 

You might need to use the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase) for the following features, if your app supports them:

- Promoting in-app purchases in apps that run in iOS 11 through 16.3. For more informaton, see [doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases). For information about this feature in iOS 16.4, see [doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app).
- The Volume Purchase Program (VPP). For more information, see [doc://com.apple.documentation/documentation/DeviceManagement](doc://com.apple.documentation/documentation/DeviceManagement).

## See Also

- [original-api-for-in-app-purchase](../com.apple.storekit/StoreKit/original-api-for-in-app-purchase.md)

---


## combining-parameters-for-previous-skadnetwork-postback-versions

## 

Combine postback parameters to recreate a byte array that you use to verify Apple’s signature. To recreate the byte array, create a UTF-8 string by combining the parameter values in an exact order, with an invisible separator (`‘\u2063’`) between them. You must combine the parameters in the exact orders as show in the examples. For more information about the parameters and verifying the signature, and an example using newer versions, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

### 

The following JSON shows an example of a version 2.2 install-validation postback that contains all possible parameters and a valid signature:

```javascript
{
  "version" : "2.2",
  "ad-network-id" : "com.example",
  "campaign-id" : 42,
  "transaction-id" : "6aafb7a5-0170-41b5-bbe4-fe71dedf1e28",
  "app-id" : 525463029,
  "attribution-signature" : "MEYCIQDTuQ1Z4Tpy9D3aEKbxLl5J5iKiTumcqZikuY/AOD2U7QIhAJAaiAv89AoquHXJffcieEQXdWHpcV8ZgbKN0EwV9/sY",
  "redownload": true,
  "source-app-id": 1234567891,
  "fidelity-type": 1,
  "conversion-value": 20
}  
```

To verify the signature, combine version 2.2 postback parameters in this order:

- `version`
- `ad-network-id`
- `campaign-id`
- `app-id`
- `transaction-id`
- `redownload` Note: use the strings `“true”` or `“false”` to represent the Boolean value of the redownload parameter.
- `source-app-id`
- `fidelity-type`

Include `source-app-id` only if you received it in the postback. Note that the signature never includes a conversion value, even if it’s present in the postback.

The following is an example of the UTF-8 string for a postback with `source-app-id` present in the postback:

```javascript
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + source-app-id
+ '\u2063' + fidelity-type
 
```

The following is an example of the UTF-8 string for a postback without `source-app-id`:

```javascript
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + fidelity-type

```

### 

Version 2 and 2.1 postbacks contain the following parameters. Combine their values in this order:

- `version`
- `ad-network-id`
- `campaign-id`
- `app-id`
- `transaction-id`
- `redownload` Note: use the strings `“true”` or `“false”` to represent the Boolean value of the redownload parameter.
- `source-app-id`

Include `source-app-id` only if you receive it in the postback. Note that the signature never includes a conversion value, even if it’s present in the postback.

The following is an example of the UTF-8 string for a postback with `source-app-id` present in the postback:

```javascript
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + source-app-id
 
```

The following is an example of the UTF-8 string for a postback without `source-app-id`:

```swift
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload

```

### 

Version 1 postbacks contain the following parameters. Combine their values in this order:

- `ad-network-id`
- `campaign-id`
- `app-id`
- `transaction-id`

The following is an example of the UTF-8 string for a version 1.0 postback:

```javascript
ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id 
```

## See Also

- [combining-parameters-for-skadnetwork-3-postbacks](../com.apple.storekit/StoreKit/combining-parameters-for-skadnetwork-3-postbacks.md)

---


## combining-parameters-for-skadnetwork-3-postbacks

## 

Check your postback’s version, and use the version-specific instructions to combine the parameters to validate the postback. The order of the parameters depends on the version of the postback you receive.

To verify the signature, combine the postback parameter values in this order for a version 3 postback:

- `version`
- `ad-network-id`
- `campaign-id`
- `app-id`
- `transaction-id`
- `redownload` (Use the strings `“true”` or `“false”` to represent the Boolean value of the redownload parameter.)
- `source-app-id`
- `fidelity-type`
- `did-win`

Include `source-app-id` only if you receive it in the postback. Note that the signature doesn’t include a conversion value, even if it’s present in the postback. Postbacks that win the attribution have a `did-win` value of `true`. Postbacks that don’t win the attribution have a `did-win` value of `false`, and don’t include `source-app-id`.

The following example of the UTF-8 string includes `source-app-id:`

```javascript
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + source-app-id + '\u2063' + fidelity-type + '\u2063' + did-win
 
```

The following example of the UTF-8 string doesn’t include `source-app-id:`

```javascript
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + fidelity-type + '\u2063' + did-win

```

### 

The following JSON example shows a version 3 install-validation postback the device sends to an ad network that wins the attribution. This example contains all possible parameters and a valid signature:

```javascript
{ 
  "version": "3.0", 
  "ad-network-id": "example123.skadnetwork", 
  "campaign-id": 42, 
  "transaction-id": "6aafb7a5-0170-41b5-bbe4-fe71dedf1e28", 
  "app-id": 525463029, 
  "attribution-signature": "MEYCIQD5eq3AUlamORiGovqFiHWI4RZT/PrM3VEiXUrsC+M51wIhAPMANZA9c07raZJ64gVaXhB9+9yZj/X6DcNxONdccQij", 
  "redownload": true, 
  "source-app-id": 1234567891, 
  "fidelity-type": 1, 
  "conversion-value": 20,
  "did-win": true
}
```

### 

In iOS 14.6 and later, ad networks that sign ads with version 3 may receive a postback for their qualifying ad impression that don’t win the attribution. Such postbacks have a `did-win` value of `false`, and don’t include `source-app-id` or `conversion-value`.

The following example shows a version 3 postback for an ad that doesn’t win the attribution. This example contains all the parameters the system includes in a nonwinning postback:

```javascript
{ 
  "version": "3.0",
  "ad-network-id": "example123.skadnetwork",
  "campaign-id": 42,
  "transaction-id": "f9ac267a-a889-44ce-b5f7-0166d11461f0",
  "app-id": 525463029,
  "attribution-signature": "MEUCIQDDetUtkyc/MiQvVJ5I6HIO1E7l598572Wljot2Onzd4wIgVJLzVcyAV+TXksGNoa0DTMXEPgNPeHCmD4fw1ABXX0g=",
  "redownload": true,
  "fidelity-type": 1,
  "did-win": false
}
```

Up to five ad networks may receive a nonwinning postback. A single ad network can receive at most one postback per advertised app, per conversion. For example, if the device registers three qualifying ad impressions from your ad network, you receive only one postback.

If your ad network wins the attribution, you only receive the winning postback, even if the device registers other qualifying impressions for your ad.

For more information about ad impressions qualifying for attribution, and receiving winning or nonwinning postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

## See Also

- [combining-parameters-for-previous-skadnetwork-postback-versions](../com.apple.storekit/StoreKit/combining-parameters-for-previous-skadnetwork-postback-versions.md)

---


## combining-parameters-to-generate-a-signature-for-skadnetwork-1

## 

Generate a signature using the parameters for version 1.0 if you compile your app with an iOS SDK version from 11.3 through 13.7.

To generate the signature, first combine the values of [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) for the version 1.0.

The parameters required for a version 1.0 signature are:

### 

Create the UTF-8 string for version 1.0 if you compile your app with an SDK prior to iOS 14.

> **IMPORTANT:** You must use lowercase for the string representation of the nonce: [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce).

Combine the values into a UTF-8 string with an invisible separator (`‘\u2063’`) between them, in the exact order shown:

```javascript
ad-network-id + '\u2063' + campaign-id + '\u2063' + itunes-item-id + '\u2063' + nonce + '\u2063' + timestamp

```

Next, follow the instructions to sign the combined string, encode the signature, and use the generated signature string as described in [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads).

## See Also

- [combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3](../com.apple.storekit/StoreKit/combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3.md)
- [combining-parameters-to-generate-a-signature-for-skadnetwork-2](../com.apple.storekit/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-2.md)

---


## combining-parameters-to-generate-a-signature-for-skadnetwork-2

## 

To generate the signature, first combine the values of [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) for the version 2.

> **IMPORTANT:** Lowercase the string representation of the nonce: [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce). Failing to do so results in an invalid signature. Only ads with valid signatures can get ad attributions.

Strings for version 2 and earlier don’t include a `fidelity-type` parameter. For version 2, combine the values into a UTF-8 string with an invisible separator (`‘\u2063’`) between them, in the exact order shown:

Listing 1. Parameter values combined, in order, for version 2.

```javascript
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + itunes-item-id + '\u2063' + nonce + '\u2063' + source-app-id + '\u2063' + timestamp

```

## See Also

- [combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3](../com.apple.storekit/StoreKit/combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3.md)
- [combining-parameters-to-generate-a-signature-for-skadnetwork-1](../com.apple.storekit/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-1.md)

---


## combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3

## 

To generate the signature, combine the required values of [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) for version 2, and include a `fidelity-type` value of `1` for StoreKit-rendered ads.

> **IMPORTANT:** Lowercase the string representation of the nonce: [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce). Failing to do so results in an invalid signature. Only ads with valid signatures can get ad attributions.

For versions 2.2 and 3, combine the values into a UTF-8 string with an invisible separator (`‘\u2063’`) between them, in the exact order the code below shows:

```javascript
//Parameter values combined, in order, for version 2.2 and 3.
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + itunes-item-id + '\u2063' + nonce + '\u2063' + source-app-id + '\u2063' + fidelity-type + '\u2063' + timestamp

```

## See Also

- [combining-parameters-to-generate-a-signature-for-skadnetwork-2](../com.apple.storekit/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-2.md)
- [combining-parameters-to-generate-a-signature-for-skadnetwork-1](../com.apple.storekit/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-1.md)

---


## compactsubscriptionofferviewstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor struct CompactSubscriptionOfferViewStyle
```

## Topics

### Initializers

- [init()](../com.apple.storekit/StoreKit/CompactSubscriptionOfferViewStyle/init().md)

## See Also

- [AutomaticSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOfferViewStyle.md)
- [SubscriptionOfferViewStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration.md)
- [SubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle.md)

---


## configuring-a-source-app

## 

A *source app* is an app that participates in ad campaigns by displaying ads that an ad network signs. To participate in install validation, the source app needs to include ad network IDs in its `Info.plist` file. Ad networks are responsible for publishing or providing their ad network IDs to developers.

Only ads from ad networks that have an entry in the app’s `Info.plist` file are eligible for install validation. To work with multiple ad networks, include each of the ad network IDs in the source app’s `Info.plist` file, as follows:

1. Select `Info.plist` in the Project navigator in Xcode.
2. Click the Add button (+) beside a key in the property list editor and press Return.
3. Type the key name [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKAdNetworkItems](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKAdNetworkItems).
4. Choose Array from the pop-up menu in the Type column.

Create an array that contains one dictionary for each allowed ad network, using the single key [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKAdNetworkItems/SKAdNetworkIdentifier](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKAdNetworkItems/SKAdNetworkIdentifier). The string value for the key is the ad network ID.

> **IMPORTANT:** Lowercase the ad network ID string; otherwise, the system doesn’t recognize it as valid.

The following example shows an array with two dictionaries that represent the example ad network IDs `example100.skadnetwork` and `example200.skadnetwork`:

```xml
<array>
    <dict>
        <key>SKAdNetworkIdentifier</key>
        <string>example100.skadnetwork</string>
    </dict>
    <dict>   
         <key>SKAdNetworkIdentifier</key>
         <string>example200.skadnetwork</string>
    </dict>
</array>
```

For more information about property lists, see [https://help.apple.com/xcode/mac/current/#/dev3f399a2a6](https://help.apple.com/xcode/mac/current/#/dev3f399a2a6).

## See Also

- [registering-an-ad-network](../com.apple.storekit/StoreKit/registering-an-ad-network.md)
- [configuring-an-advertised-app](../com.apple.storekit/StoreKit/configuring-an-advertised-app.md)
- [SKAdNetworkItems](../com.apple.BundleResources/Information-Property-List/SKAdNetworkItems.md)
- [NSAdvertisingAttributionReportEndpoint](../com.apple.BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint.md)

---


## configuring-an-advertised-app

## 

An *advertised app* is an app a user installs after viewing an ad that an ad network signs. The advertised app doesn’t require any configuration to participate in install validation. However, to register ad attributions, the app needs to call one of the methods that update conversion values when the app first launches. Those methods are: [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)), [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)), and [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)).

Developers opt in to get copies of winning install-validation postbacks.

### 

To opt in to receive copies of winning install-validation postbacks for your advertised app, add the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint) key in your app’s `Info.plist` file, and configure your server to receive the postbacks.

To add the key in your app’s `Info.plist` file:

1. Select `Info.plist` in the Project navigator in Xcode.
2. Click the Add button (+) beside a key in the property list editor and press Return.
3. Type the key name [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint).
4. Choose String from the pop-up menu in the Type column.
5. Type a valid URL in the format of `“https://example.com”` that contains your domain name in place of `example.com`.

For more information about editing property lists, see [https://help.apple.com/xcode/mac/current/#/dev3f399a2a6](https://help.apple.com/xcode/mac/current/#/dev3f399a2a6).

The system uses the registrable part of the domain name you provide in the key, and ignores any subdomains. Using your domain name, the system generates a *well-known path* and sends postbacks to that URL. To receive postbacks, your domain needs to have a valid SSL certificate. Configure your server to accept HTTPS POST messages at the following well-known path:

`https://example.com/.well-known/skadnetwork/report-attribution/`

Replace `example.com` with your domain name.

For more information about receiving postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

## See Also

- [registering-an-ad-network](../com.apple.storekit/StoreKit/registering-an-ad-network.md)
- [configuring-a-source-app](../com.apple.storekit/StoreKit/configuring-a-source-app.md)
- [SKAdNetworkItems](../com.apple.BundleResources/Information-Property-List/SKAdNetworkItems.md)
- [NSAdvertisingAttributionReportEndpoint](../com.apple.BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint.md)

---


## determining-a-person-s-apple-music-capabilities

## 

After you request the user’s permission to access their Apple Music library (see [doc://com.apple.storekit/documentation/StoreKit/requesting-access-to-apple-music-library](doc://com.apple.storekit/documentation/StoreKit/requesting-access-to-apple-music-library)), you confirm that authorization and then identify Apple Music capabilities on the user’s device.

### 

Use [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController)’s [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/authorizationStatus()](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/authorizationStatus()) to check whether the user has authorized access to Apple Music Library. If the authorization status is [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined), call [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController)’s [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestAuthorization(_:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestAuthorization(_:)) to prompt the user for access.

If the authorization status is [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/authorized](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/authorized), your app can proceed to determine which Apple Music capabilities ([doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback), [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible), or [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary)) are available on the user’s device.

### 

First, create an [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController) object:

Then call its [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:)) method to fetch the current Apple Music capabilities, as described in the sections that follow.

### 

If you want your app to play Apple Music content, check whether `capabilities` includes [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback):

### 

A user is eligible for an Apple Music subscription offer when `capabilities` doesn’t include [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback) but contains [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible). If you want your app to present the user with an offer to subscribe to Apple Music, check `capabilities` for these features:

You can present the offer using [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController).

### 

If you want your app to add tracks to the user’s iCloud music library, check whether `capabilities` includes [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/addToCloudMusicLibrary):

## See Also

- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

---


## determining-service-entitlement-on-the-server

## 

> **NOTE:** This sample code project is associated with WWDC22 session [https://developer.apple.com/wwdc22/110404/](https://developer.apple.com/wwdc22/110404/). It’s also associated with WWDC 2020 session [https://developer.apple.com/wwdc20/10671/](https://developer.apple.com/wwdc20/10671/).

When your app provides a subscription service, you receive data in the form of in-app receipts and App Store server notifications that provide a subscription’s state. After reading this data, your app determines whether to allow or restrict the user’s access to service, products, offers, and messages.

This server-side sample code project analyzes a receipt to help the app determine entitlement by systematically examining all potential subscription states that affect service entitlement, such as offers periods and billing states. The output from this sample’s REST API endpoints is a response that indicates whether the app can enable service or needs to perform other steps to retain or communicate with customers. You can extend this code and customize the response based on your own business logic. The sample code contains two endpoints:

- URL: `localhost:3000/simulate` — Use `/simulate` for testing using real or artificial receipts. This endpoint requires no special configuration.
- URL: `localhost:3000/entitle` — Use `/entitle` with real Base64-encoded receipts. This endpoint requires additional configuration.

### 

Follow these steps to run the sample code project:

1. Install the latest stable version of Node.js.
2. Open the Terminal app (`/Applications/Utilities`).
3. Navigate to the sample code `/Sample` directory.
4. In Terminal, enter `npm install` and press Return. Make sure it completes successfully.
5. In Terminal, copy the example environment file: `cp env.example`.
6. In Terminal, enter `npm start` and press Return to start the server. The server runs in your Terminal window. To stop the server, press Control-C while in Terminal.
7. In Terminal, choose Shell > New Windows > New Window with Profile to open a second Teminal window to use to send the requests.

### 

The requests to the service entitlement engine take JSON data from a receipt. The data must be in the same JSON format that you receive by calling the `/verifyReceipt` endpoint when you pass it a valid receipt. The example file `flatJSONExample` in the `Source/Example` directory contains sample receipt data in the correct format for the requests.

To run the request, switch to the second Terminal window and type the following `curl` command. Replace the `<FLAT JSON DATA>` with the `flatJSONExample`.

```swift
curl -XPOST -H "Content-type: application/json" -d '<FLAT JSON DATA>' 'localhost:3000/simulate'
```

If the mocked JSON receipt data is in the correct format, the response contains the analyzed data the entitlement engine produces based on the receipt data.

If you have real receipt data, replace the `<FLAT JSON DATA>` in the command with your receipt data.

### 

The response contains the result of the engine’s analysis of the receipt data. Use it to determine whether a customer has the necessary entitlements to service, offers, or other messaging. The response object contains an array of subscription objects organized by product ID, each containing fields that provide insights for that subscription.

The following example response shows a customer who was previously subscribed and then resubscribed. The customer is in state 5, which indicates an active subscription with autorenew still in an enabled state.

```swift
{
    "products": [
        {
            "product_id": "com.example.monthly",
            "entitlementCode": 5,
            "expiration": 1599391591000,
            "totalRenewals": 7,
            "groupID": "13472270",
            "originalTransactions": [
                {
                    "originalTX": "190000625698817",
                    "start": 1564455960000,
                    "expiration": 1599391591000,
                    "renewals": 7
                }
            ],
            "trialConsumed": true
        }
    ],
    "trialConsumedForGroup": [
        "13472270"
    ]
}
```

In this case, the sample app issues an offer for a yearly subscription to the customer because they’re in state `5`, and they have a history of seven total renewals.

---


## enabling-app-store-server-notifications

## 

[doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications) is a server-to-server service that sends real-time notifications for in-app purchase events, and notifications for unreported external purchase tokens. To enable notifications, set up an HTTPS URL on your server, and configure settings in App Store Connect.

For information about parsing and interpreting notifications, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/receiving-app-store-server-notifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications/receiving-app-store-server-notifications).

### 

To receive server notifications from the App Store, your server must support the Transport Layer Security (TLS) 1.2 protocol or later.

To enable App Store Server Notifications, follow these steps:

1. Determine the HTTPS URL on your server to receive notifications for the production environment.
2. Optionally, determine the HTTPS URL on your server to receive notifications for the sandbox environment for testing notifications. You may use the same URL for both the production and the sandbox environments.
3. App Store Connect gives you the choice of receiving version 2 or version 1 notifications for each environment. To choose version 2, set up your endpoint as [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2).
4. Configure your URL in App Store Connect. For more information, see [https://help.apple.com/app-store-connect/#/dev0067a330b](https://help.apple.com/app-store-connect/#/dev0067a330b).

> **IMPORTANT:** If you specify a port in your URL, the port must be either `443` or greater than or equal to `1024`. For example, the URL `https://example.com:1234/notifications` specifies the port `1234`.

Configure your server to respond with HTTP status codes to indicate whether the App Store server notification `POST` is successful. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/responding-to-app-store-server-notifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications/responding-to-app-store-server-notifications).

For new implementations, use [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2). To transition from using version 1 notifications to version 2, test version 2 notifications in the sandbox environment before you update your production environment to version 2.

For information about changes to App Store Server Notifications, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/app-store-server-notifications-changelog](doc://com.apple.documentation/documentation/AppStoreServerNotifications/app-store-server-notifications-changelog).

### 

If your server requires IP addresses to be on an allow list, add the IP address subnet `17.0.0.0/8` to allow your server to receive notifications from the App Store server. This subnet applies to both the sandbox and the production environments.

### 

To determine whether your server is receiving notifications, call the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Request-a-Test-Notification](doc://com.apple.documentation/documentation/AppStoreServerAPI/Request-a-Test-Notification) endpoint in the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI). This endpoint asks the App Store server to send a notification with the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) `TEST`. Use the [doc://com.apple.documentation/documentation/AppStoreServerAPI/testNotificationToken](doc://com.apple.documentation/documentation/AppStoreServerAPI/testNotificationToken) you receive to call the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-Test-Notification-Status](doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-Test-Notification-Status) endpoint to learn how your server responds to the test notification.

The App Store server sends the `TEST` notification in the version 2 notification format. However, it sends it to your server regardless of whether you configure a version 1 or version 2 notification URL in App Store Connect.

## See Also

- [handling-subscriptions-billing](../com.apple.storekit/StoreKit/handling-subscriptions-billing.md)
- [offering-a-subscription-across-multiple-apps](../com.apple.storekit/StoreKit/offering-a-subscription-across-multiple-apps.md)
- [reducing-involuntary-subscriber-churn](../com.apple.storekit/StoreKit/reducing-involuntary-subscriber-churn.md)

---


## entitlementtaskstate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum EntitlementTaskState<Value>
```

## 

To get an entitlement task state, use [doc://com.apple.documentation/documentation/SwiftUI/View/currentEntitlementTask(for:priority:action:)](doc://com.apple.documentation/documentation/SwiftUI/View/currentEntitlementTask(for:priority:action:)) or [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStatusTask(for:priority:action:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStatusTask(for:priority:action:)) on a [doc://com.apple.documentation/documentation/SwiftUI/View](doc://com.apple.documentation/documentation/SwiftUI/View).

## Topics

### Getting the task state

- [loading](../com.apple.storekit/StoreKit/EntitlementTaskState/loading.md)
- [success(_:)](../com.apple.storekit/StoreKit/EntitlementTaskState/success(_:).md)
- [failure(_:)](../com.apple.storekit/StoreKit/EntitlementTaskState/failure(_:).md)

### Getting the transaction with the entitlement

- [transaction](../com.apple.storekit/StoreKit/EntitlementTaskState/transaction.md)
- [value](../com.apple.storekit/StoreKit/EntitlementTaskState/value.md)

### Helper methods

- [flatMap(_:)-7gsnv](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-7gsnv.md)
- [flatMap(_:)-66eb8](../com.apple.storekit/StoreKit/EntitlementTaskState/flatMap(_:)-66eb8.md)
- [map(_:)-8ly3v](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-8ly3v.md)
- [map(_:)-250dk](../com.apple.storekit/StoreKit/EntitlementTaskState/map(_:)-250dk.md)

## See Also

- [storeProductTask(for:priority:action:)](../com.apple.SwiftUI/View/storeProductTask(for:priority:action:).md)
- [storeProductsTask(for:priority:action:)](../com.apple.SwiftUI/View/storeProductsTask(for:priority:action:).md)
- [currentEntitlementTask(for:priority:action:)](../com.apple.SwiftUI/View/currentEntitlementTask(for:priority:action:).md)
- [subscriptionStatusTask(for:priority:action:)](../com.apple.SwiftUI/View/subscriptionStatusTask(for:priority:action:).md)
- [CollectionTaskState](../com.apple.storekit/StoreKit/Product/CollectionTaskState.md)
- [TaskState](../com.apple.storekit/StoreKit/Product/TaskState.md)

---


## external-link-account

## 

If you develop a qualifying app, you can complete a request for an entitlement that allows you to link to an external website for account creation or management. For more information about whether your app qualifies and how to request an entitlement, see [https://developer.apple.com/support/reader-apps/](https://developer.apple.com/support/reader-apps/).

If your account has the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-link.account](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-link.account) entitlement, implement the following to link to an external website for account creation and management:

- Configure the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalLinkAccount](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalLinkAccount) property list key.
- Use the [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount) type’s [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/canOpen) property and [doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()](doc://com.apple.storekit/documentation/StoreKit/ExternalLinkAccount/open()) method.

> **NOTE:** In a compatible iPad or iPhone app running in visionOS, on a Mac with Apple silicon, or on a Mac app built with Mac Catalyst, the External Link Account APIs throw an error or return `false`.

## Topics

### External accounts

- [com.apple.developer.storekit.external-link.account](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-link.account.md)
- [SKExternalLinkAccount](../com.apple.BundleResources/Information-Property-List/SKExternalLinkAccount.md)
- [ExternalLinkAccount](../com.apple.storekit/StoreKit/ExternalLinkAccount.md)

---


## external-purchase

## 

If you develop a qualifying app, you may complete a request for optional entitlements that allow you to offer external purchases. For more information about whether your app qualifies, requesting an entitlement, and implementation requirements, see:

- [https://developer.apple.com/support/communication-and-promotion-of-offers-on-the-app-store-in-the-eu/](https://developer.apple.com/support/communication-and-promotion-of-offers-on-the-app-store-in-the-eu/)
- [https://developer.apple.com/support/storekit-external-entitlement/](https://developer.apple.com/support/storekit-external-entitlement/)
- [https://developer.apple.com/contact/request/storekit-external-entitlement-ru/](https://developer.apple.com/contact/request/storekit-external-entitlement-ru/)
- [https://developer.apple.com/support/storekit-external-entitlement-kr/](https://developer.apple.com/support/storekit-external-entitlement-kr/)
- [https://developer.apple.com/support/music-streaming-services-entitlement-eea/](https://developer.apple.com/support/music-streaming-services-entitlement-eea/)

### 

If your account receives the StoreKit External Purchase entitlement or the StoreKit External Purchase Regions entitlement, implement the following to offer external purchases within your app:

- Depending on the entitlement you receive, configure the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase.allowed-regions entitlement for your app, or the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase) entitlement and the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchase](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchase) property list key.
- Use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase) type’s [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/canPresent) property to determine whether external purchase is available.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()) method and use the external purchase token you receive from the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)) result to record transactions.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

### 

If your account receives the StoreKit External Purchase Link entitlement or the StoreKit External Custom Purchase Link Regions entitlement, your app can communicate and promote offers for digital goods or services available for purchase or download, in a distribution channel of your choice. Implement the following:

- Depending on the entitlement you receive, configure the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions) entitlement for your app, or the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) entitlement and the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) property list key, providing the country code for each permitted region where your app communicates and promotes offers.
- Check the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) property of the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API to determine whether the API is available at runtime.
- At launch and before every potential transaction, call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) function to request the external purchase tokens, using the token types `ACQUISITION` and `SERVICES`. Associate these tokens with a customer account on your server.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)) function after a deliberate customer interaction, such as tapping a button, and before communicating and promoting offers.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

### 

If your account receives the Music Streaming Services (EEA) entitlement or the StoreKit External Purchase Link Regions For Music Streaming entitlement, your music-streaming app can use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API to communicate and promote offers for music streaming services. Custom links can be to a distribution channel of your choice. Implement the following:

- Depending on the entitlement you receive, configure the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link-streaming.allowed-regions entitlement for your app, or the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming) entitlement and the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions) property list key, providing the country code for each permitted region where your app communicates and promotes offers for music streaming.
- Check the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) property of the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API to determine whether external purchase is available at runtime.
- At launch and before every potential transaction, call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) function to request the external purchase tokens, using the token types `ACQUISITION` and `SERVICES`. Associate these tokens with a customer account on your server.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/showNotice(type:)) function after a deliberate customer interaction, such as tapping a button, and before communicating and promoting offers.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

### 

If your account receives the StoreKit External Purchase Link entitlement or the StoreKit External Purchase Link Regions entitlement, implement the following to offer multiple external purchase links:

- Depending on the entitlement you receive, configure the doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link.allowed-regions entitlement for your app, or the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link).
- Configure the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list key, providing one or more external purchase links for each permitted country code.
- Use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink) type’s [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/eligibleURLs) array to determine whether one or more external purchase links are available, then select one of those eligible URLs.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)) method with the URL you select. StoreKit appends the external purchase token to your website’s URL. Use this token to record purchases.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

### 

If your account receives the StoreKit External Purchase Link entitlement or the StoreKit External Purchase Link Regions entitlement, implement the following to offer a single external purchase link for each country code:

- Depending on the entitlement your app receives, configure the  doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase-link.allowed-regions entitlement for your app, or the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) entitlement.
- Configure the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink) property list key, providing one external purchase link for each permitted country code.
- Use the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink) type’s [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/canOpen) property to determine whether external purchase link is available.
- Call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open()) method. StoreKit appends the external purchase token to your website’s URL. Use this token to record purchases.
- From your server, report the external purchase tokens and the transactions associated with the tokens by using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

Your app may configure both the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink) and [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list keys.

### 

An external purchase token is a unique string that your app or website receives when your app’s customer chooses to view your external purchase offerings. Record all tokens in your system and report them and their associated transactions using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI). For more information about tokens, see [doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens](doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens).

### 

The External Purchase APIs, including [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink), [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase), and [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) provide *external purchase tokens* that you use to report transactions to Apple. [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink) and [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase) are available starting in iOS 17.4, iPadOS 17.4, macOS 14.4, Mac Catalyst 17.4, tvOS 17.4, visionOS 1.1, and watchOS 10.4. [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) is available starting in iOS 18.1, iPadOS 18.1, Mac Catalyst 18.1, and macOS 15.1.

For apps that run on iOS 15.4 through 17.3 and iPadOS 15.4 through 17.3, the External Purchase APIs have the following behavior:

- [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase) and [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink) APIs throw errors or return `false` for compatible iPad or iPhone apps running in visionOS, on a Mac with Apple silicon, or on a Mac app built with Mac Catalyst.
- The APIs don’t provide external purchase tokens.
- The APIs are available in iOS and iPadOS only.

## Topics

### Offering external purchases

- [ExternalPurchase](../com.apple.storekit/StoreKit/ExternalPurchase.md)
- [com.apple.developer.storekit.external-purchase](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase.md)
- [SKExternalPurchase](../com.apple.BundleResources/Information-Property-List/SKExternalPurchase.md)

### Communicating and promoting offers

- [ExternalPurchaseCustomLink](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink.md)
- [Token](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/Token.md)
- [com.apple.developer.storekit.custom-purchase-link.allowed-regions](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions.md)
- [com.apple.developer.storekit.external-purchase-link](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link.md)
- [SKExternalPurchaseCustomLinkRegions](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions.md)
- [testing-transactions-that-use-custom-link-tokens](../com.apple.storekit/StoreKit/testing-transactions-that-use-custom-link-tokens.md)

### Communicating and promoting offers for music streaming services

- [ExternalPurchaseCustomLink](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink.md)
- [com.apple.developer.storekit.external-purchase-link-streaming](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming.md)
- [SKExternalPurchaseLinkStreamingRegions](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions.md)

### Offering external purchase links

- [ExternalPurchaseLink](../com.apple.storekit/StoreKit/ExternalPurchaseLink.md)
- [com.apple.developer.storekit.external-purchase-link](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link.md)
- [SKExternalPurchaseMultiLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseMultiLink.md)
- [SKExternalPurchaseLink](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseLink.md)

### Managing external purchase tokens

- [receiving-and-decoding-external-purchase-tokens](../com.apple.storekit/StoreKit/receiving-and-decoding-external-purchase-tokens.md)

---


## externalpurchase

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum ExternalPurchase
```

## 

This functionality is only available to and required by apps with the [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase) or doc://com.apple.documentation/documentation/bundleresources/entitlements/com.apple.developer.storekit.external-purchase.allowed-regions entitlement. For more information, see:

- [https://developer.apple.com/go/?id=storekit-external-purchase-eu](https://developer.apple.com/go/?id=storekit-external-purchase-eu)
- [https://developer.apple.com/support/storekit-external-entitlement/](https://developer.apple.com/support/storekit-external-entitlement/)
- [https://developer.apple.com/support/storekit-external-entitlement-kr/](https://developer.apple.com/support/storekit-external-entitlement-kr/)

> **NOTE:** You must check [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) before calling the External Purchase APIs. If [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments) is `false`, don’t call the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink) or [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase) APIs.

## Topics

### Offering an external purchase

- [canPresent](../com.apple.storekit/StoreKit/ExternalPurchase/canPresent.md)
- [presentNoticeSheet()](../com.apple.storekit/StoreKit/ExternalPurchase/presentNoticeSheet().md)
- [NoticeResult](../com.apple.storekit/StoreKit/ExternalPurchase/NoticeResult.md)
- [SKExternalPurchase](../com.apple.BundleResources/Information-Property-List/SKExternalPurchase.md)

## See Also

- [com.apple.developer.storekit.external-purchase](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase.md)
- [SKExternalPurchase](../com.apple.BundleResources/Information-Property-List/SKExternalPurchase.md)

---


## fetching-product-information-from-the-app-store

## 

To ensure your customers see only products that are available for them to purchase, query the App Store before displaying your app’s store UI. Compare the App Store’s list of product identifiers to your local product identifiers. To retrieve a list of your app’s product identifiers, see [doc://com.apple.storekit/documentation/StoreKit/loading-in-app-product-identifiers](doc://com.apple.storekit/documentation/StoreKit/loading-in-app-product-identifiers).

### 

To query the App Store, create an [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) and initialize it with a list of your product identifiers. Keep a strong reference to the request object; otherwise, the system might deallocate the request before it can complete.

The products request retrieves information about valid products, along with a list of invalid product identifiers, and then calls its delegate to process the result. The delegate needs to implement the [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequestDelegate](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequestDelegate) protocol to handle the response from the App Store. Here’s a simple implementation of both pieces of code:

Keep a reference to the array of [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) objects that the delegate receives. Use these same product objects to create a payment request when a user purchases a product.

If the list of products you sell in your app is subject to change, such as when you add or remove a product from sale, consider creating a custom class that encapsulates a reference to the product object along with other information, such as pictures or descriptions that you fetch from your server. For more information on payment requests, see [doc://com.apple.storekit/documentation/StoreKit/requesting-a-payment-from-the-app-store](doc://com.apple.storekit/documentation/StoreKit/requesting-a-payment-from-the-app-store).

### 

Invalid product identifiers in the App Store response to your products request usually indicate an error in your app’s list of product identifiers. Invalid product identifiers may also indicate an incorrectly configured product in App Store Connect. Actionable UI and insightful logging can help you resolve this type of issue, as follows:

- In production builds, display your app’s store UI and omit the invalid product.
- In development builds, display an error to call attention to the issue.
- In both production and development builds, use [doc://com.apple.documentation/documentation/Foundation/NSLog(_:_:)](doc://com.apple.documentation/documentation/Foundation/NSLog(_:_:)) to write a message to the console to record the invalid identifier.
- If your app fetches the list from your server, you can define a logging mechanism to let your app send the list of invalid identifiers back to your server.
- Verify that you have a signed Paid Applications Agreement for your developer account. For more information about this agreement, see [https://help.apple.com/app-store-connect/#/deva001f4a14](https://help.apple.com/app-store-connect/#/deva001f4a14).

For more information about troubleshooting invalid product identifiers, see [doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse/invalidProductIdentifiers](doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse/invalidProductIdentifiers).

## See Also

- [loading-in-app-product-identifiers](../com.apple.storekit/StoreKit/loading-in-app-product-identifiers.md)
- [SKProductsRequest](../com.apple.storekit/StoreKit/SKProductsRequest.md)
- [SKProductsResponse](../com.apple.storekit/StoreKit/SKProductsResponse.md)
- [SKProduct](../com.apple.storekit/StoreKit/SKProduct.md)

---


## finishing-a-transaction

## 

Finishing a transaction tells StoreKit that your app completed its workflow to make a purchase complete. Unfinished transactions remain in the queue until they’re finished, so be sure to add the transaction queue observer every time your app launches, to enable your app to finish the transactions. Your app needs to finish each transaction, whether it succeeds or fails.

Do all of the following before you finish a transaction:

- Persist the purchase.
- Deliver, download, or unlock the purchased content.
- Update your app’s UI so the user can access the product.

To finish the transaction, call the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) method on the payment queue.

After you finish a transaction, don’t take any actions on it or do any work to deliver the product. If any work remains, your app isn’t ready to finish the transaction.

> **IMPORTANT:** Don’t call the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) method before the transaction is actually complete and attempt to use some other mechanism in your app to track the transaction as unfinished. StoreKit doesn’t function that way, and doing that prevents your app from downloading Apple-hosted content and can lead to other issues.

## See Also

- [unlocking-purchased-content](../com.apple.storekit/StoreKit/unlocking-purchased-content.md)
- [persisting-a-purchase](../com.apple.storekit/StoreKit/persisting-a-purchase.md)
- [SKDownload](../com.apple.storekit/StoreKit/SKDownload.md)

---


## generating-a-promotional-offer-signature-on-the-server

## 

> **NOTE:** This sample code project is associated with WWDC 2019 session [https://developer.apple.com/videos/play/wwdc19/305/](https://developer.apple.com/videos/play/wwdc19/305/).

This sample code is a simple server written using JavaScript and Node.js. It demonstrates how to generate a signature for promotional offers. The sample demonstrates:

- Receiving a request.
- Generating a cryptographic signature using your private key.
- Sending back a response with the signature.

All of the work is done in `routes/index.js`. You set up environment variables for your key ID and your private key in the `start-server` file.

### 

1. Install the latest stable version of Node.js.
2. Open Terminal.app and navigate to the sample code directory.
3. Run `npm install` from the command line, and make sure it completes successfully.
4. The `start-server` file contains a key ID and private key PEM string. The values provided in the sample are for example purposes only and will not generate signatures that are valid for your apps. You can optionally open `start-server` with a text editor and replace the example key ID and private key PEM string with your own key ID and private key PEM string that you received from App Store Connect.

### 

To test the code on your local machine, from the command line:

- Navigate to the sample code source folder and run `./start-server` from the command line. The server is now running locally and is ready to accept connections on port 3000.
- Open another terminal window and use the `curl` command to send a request. This example command uses the same data listed in the JSON example below:

```swift
curl -X GET -H "Content-type: application/json" -d '{"appBundleID": "com.example.yourapp", "productIdentifier": "com.example.yoursubscription", "offerID": "your_offer_id", "applicationUsername": "8E3DC5F16E13537ADB45FB0F980ACDB6B55839870DBCE7E346E1826F5B0296CA"}' http://127.0.0.1:3000/offer
```

You will get a response that includes the signature.

### 

To run this sample code, send a request to this URL: `GET http://<yourdomain>/offer`, where `<yourdomain>` is the domain name or IP address of the server this sample code is running on.

The request must have a `Content-type` header of `application/json`, and JSON body data with the following format:

```swift
{
    "appBundleID": "com.example.yourapp",
    "productIdentifier": "com.example.yoursubscription",
    "offerID": "your_offer_id",
    "applicationUsername": "8E3DC5F16E13537ADB45FB0F980ACDB6B55839870DBCE7E346E1826F5B0296CA"
}
```

## See Also

- [setting-up-promotional-offers](../com.apple.storekit/StoreKit/setting-up-promotional-offers.md)
- [implementing-promotional-offers-in-your-app](../com.apple.storekit/StoreKit/implementing-promotional-offers-in-your-app.md)
- [generating-a-signature-for-promotional-offers](../com.apple.storekit/StoreKit/generating-a-signature-for-promotional-offers.md)
- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

---


## generating-a-signature-for-promotional-offers

## 

Before you can create a signature on your server, you need to complete the one-time setup to generate a private key in App Store Connect, as [doc://com.apple.storekit/documentation/StoreKit/setting-up-promotional-offers](doc://com.apple.storekit/documentation/StoreKit/setting-up-promotional-offers) describes. Always use a secure connection when sending data, including the signature, between your app and server. For more information on ensuring your data’s security, see [doc://com.apple.documentation/documentation/Security/preventing-insecure-network-connections](doc://com.apple.documentation/documentation/Security/preventing-insecure-network-connections).

To create the signature, you use parameters that identify the product and the offer, parameters your server generates, and your private key. To generate the signature, you combine the required parameters, then sign and encode the resulting string.

### 

In the first step of generating the signature, you need the following parameters, most of which you also supply for [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount):

> **IMPORTANT:** Use lowercase for the string representation of the `nonce` and the `appAccountToken`.

Combine the parameters into a UTF-8 string with an invisible separator (`'\u2063'`) between them in the same order as the following example:

```http
appBundleId + '\u2063' + keyIdentifier + '\u2063' + productIdentifier + '\u2063' + offerIdentifier + '\u2063' + appAccountToken + '\u2063' + nonce + '\u2063' + timestamp
```

If you provide `applicationUsername` instead of `appAccountToken`, replace it accordingly in the UTF-8 string above.

### 

Sign the combined UTF-8 string with the following key and algorithm:

- Your PKCS #8 private key (downloaded from App Store Connect) that corresponds to the `keyIdentifier` in the UTF-8 string
- The Elliptic Curve Digital Signature Algorithm (ECDSA) with a SHA-256 hash

The result is a Digital Encoding Rules (DER)-formatted binary value, which is the signature.

### 

Consider validating your signatures locally to ensure your signing process works correctly. You can create a public key derivative of your private key to test against. One way to create this key is by running the `openSSL` command from the terminal app, as the example below shows:

```shell
openssl ec -in {downloaded_private_key} -pubout -out public_key.pem
```

Use Base64 encoding for the binary signature you generated to obtain the final signature string to send to the App Store for validation. The signature string resembles the following:

```None
MEQCIEQlmZRNfYzKBSE8QnhLTIHZZZWCFgZpRqRxHss65KoFAiAJgJKjdrWdkLUOCCjuEx2RmFS7daRzSVZRVZ8RyMyUXg==
```

### 

Respond to the app’s request for the signature over a secure connection, providing the encoded signature string, the `nonce`, the `timestamp`, and the `keyIdentifier`. Note that each payload, signature, and `nonce` is only valid for one buy request, even if the buy fails.

See [doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app#Create-a-Signature](doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app#Create-a-Signature) for information about the app’s request and how it uses the signature.

## See Also

- [setting-up-promotional-offers](../com.apple.storekit/StoreKit/setting-up-promotional-offers.md)
- [implementing-promotional-offers-in-your-app](../com.apple.storekit/StoreKit/implementing-promotional-offers-in-your-app.md)
- [generating-a-promotional-offer-signature-on-the-server](../com.apple.storekit/StoreKit/generating-a-promotional-offer-signature-on-the-server.md)
- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

---


## generating-jws-to-sign-app-store-requests

## 

JWS is an open standard ([https://datatracker.ietf.org/doc/html/rfc7515](https://datatracker.ietf.org/doc/html/rfc7515)) that defines a way to securely transmit information. You create the JWS header and payload using information specific to the App Store feature. You sign the JWS on your server using a private API key that you download from App Store Connect.

The following App Store features require a JWS Compact Serialization to authorize calls in StoreKit:

- Advanced Commerce API in-app requests
- Promotional offer signatures
- Introductory offer eligibility

The data you sign when generating the JWS is a JSON Web Token (JWT). The JWT contains name-value pairs called *claims*, including claims specific to the feature you’re using. Your server returns the JWS Compact Serialization to your app. Your app uses the JWS in the relevant StoreKit API call.

> **TIP:** The App Store Server Library provides a signing utility that creates JWS specific for each of these uses. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

To get started, you need your key ID and issuer ID from App Store Connect. Then, to generate a signed JWS, you perform these steps on your server:

1. Create the JWS header.
2. Create the JWS payload. The payload includes the base payload claims, and may also require feature-specific claims.
3. Sign the JWS.

### 

First you need your key ID for the JWS header and your issuer ID for the JWS payload. Sign in to [https://appstoreconnect.apple.com/](https://appstoreconnect.apple.com/) to get these values.

To get the key ID:

1. Select Users and Access, then select the Keys tab.
2. Hover the cursor next to a key ID to display the Copy Key ID link. The key IDs appear in a column under the Active heading.
3. Click Copy Key ID.

If you have more than one API key, copy the key ID of the private key that you use to sign the JWS. For information about creating keys, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/creating-api-keys-to-authorize-api-requests](doc://com.apple.documentation/documentation/AppStoreServerAPI/creating-api-keys-to-authorize-api-requests).

To get the issuer ID:

1. Select Users and Access, then select the Keys tab.
2. To copy the issuer ID that appears near the top of the page, click Copy next to the ID.

### 

The App Store features all use the same JWS header.

To create a JWS to communicate with the App Store, use the following fields and values in the header:

| **Header field** | **Value** |
| --- | --- |
| `alg` - Encryption Algorithm | `ES256`   You need to sign JWS with ES256 encryption. |
| `kid` - Key ID | Your private key ID from App Store Connect (example: `2X9R4HXF34`) |
| `typ` - Token Type | `JWT` |

Here’s an example of a JWS header:

```javascript
{
  "alg": "ES256",
  "kid": "2X9R4HXF34",
  "typ": "JWT"
}
```

### 

The JWS payload contains base claims specific to the App Store, such as an issuer ID and issuance time.  It also includes custom claims that are specific to App Store features.  The following table shows the base claims. The next sections shows the feature-specific claims that you also include in the JWS payload.

Include the following base claims in the JWS payload:

| **Payload field** | **Value** |
| --- | --- |
| `iss` - Issuer | Your issuer ID from the Keys page in App Store Connect (example: “`57246542-96fe-1a63-e053-0824d011072a"`) |
| `iat` - Issued At | The UNIX time, in seconds, that you issue the token, which the App Store server uses to calculate an expiration time (example: `1623085200`) |
| `aud` - Audience | A value that depends on the feature you’re using (see the table below) |
| `bid` - Bundle ID | Your app’s bundle ID (example: `“com.example.testbundleid”)` |
| `nonce` - Nonce | A one-time-use UUID that identifies this request (example: “`368f3888-dcd8-11ef-b3c8-325096b39f47"`) |

Don’t include an `exp` field in your payload, because including it makes the request fail. The App Store server enforces an expiration time based on your `iat` value.

Choose the `aud` value to match the feature you’re using:

| **Feature** | **`aud` value** |
| --- | --- |
| Advanced Commerce API in-app request | “`advanced-commerce-api"` |
| Promotional offer signature | “`promotional-offer"` |
| Introductory offer eligibility | “`introductory-offer-eligibility"` |

Here’s an example of the base payload, without any feature-specific fields:

```javascript
{
  "iss": "57246542-96fe-1a63e053-0824d011072a",
  "iat": 1741043663,
  "aud": "promotional-offer",
  "bid": "com.example.testbundleid",
  "nonce": "6584bedf-2ed0-4c01-93ed-c0c64a1670cc"
}
```

Be sure to include feature-specific custom claims in the JWS payload as well.

### 

For custom claims for Advanced Commerce in-app requests, use the following values:

| **Payload field** | **Value** |
| --- | --- |
| `request` | Base64-encoded request data |

For more information on generating the base64-encoded request data, see [doc://com.apple.storekit/documentation/StoreKit/sending-advanced-commerce-api-requests-from-your-app#Create-the-base64-encoded-request-data](doc://com.apple.storekit/documentation/StoreKit/sending-advanced-commerce-api-requests-from-your-app#Create-the-base64-encoded-request-data).

Here’s an example of a payload for an Advanced Commerce API in-app request:

```javascript
{
  "iss": "57246542-96fe-1a63e053-0824d011072a",
  "iat": 1741043663,
  "aud": "advanced-commerce-api",
  "bid": "com.example.testbundleid",
  "nonce": "df2b8374-95a1-425b-a6a5-77a4d7648333",
  "request": "<base64-encoded request data>"
}
```

For more information about making Advanced Commerce API requests in StoreKit, see [doc://com.apple.storekit/documentation/StoreKit/sending-advanced-commerce-api-requests-from-your-app](doc://com.apple.storekit/documentation/StoreKit/sending-advanced-commerce-api-requests-from-your-app).

### 

For promotional offer signature custom claims, use the following values:

| **Payload field** | **Value** |
| --- | --- |
| `productId` | The unique identifier of the product (for more information, see [doc://com.apple.storekit/documentation/StoreKit/Product/id](doc://com.apple.storekit/documentation/StoreKit/Product/id)) |
| `offerIdentifier` | The promotional offer identifier that you set up in App Store Connect |
| `transactionId` | The unique identifier of any transaction that belongs to the customer. You can use the customer’s [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/appTransactionID](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/appTransactionID), even for customers who haven’t made any In-App Purchases in your app. This field is optional, but recommended. |

Here’s an example of a payload for a promotional offer signature:

```javascript
{ 
    "iss": "57246542-96fe-1a63e053-0824d011072a",
    "iat": 1741043663,
    "aud": "promotional-offer",
    "bid": "com.example.testbundleid",
    "nonce": "368f3088-dcd5-11ef-b3c8-325096b39f46",
    "productId": "com.example.product",
    "offerIdentifier": "com.example.product.offer",
    "transactionId": "1000011859217"
}
```

### 

For introductory offer eligibility custom claims, use the following values:

| **Payload field** | **Value** |
| --- | --- |
| `productId` | The unique identifier of the product (for more information, see [doc://com.apple.storekit/documentation/StoreKit/Product/id](doc://com.apple.storekit/documentation/StoreKit/Product/id)) |
| `allowIntroductoryOffer` | A Boolean value, `true` or `false`, that determines whether the customer is eligible for an introductory offer |
| `transactionId` | The unique identifier of any transaction that belongs to the customer. You can use the customer’s [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/appTransactionID](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/appTransactionID), even for customers who haven’t made any In-App Purchases in your app. |

Here’s an example of a payload for introductory offer eligibility:

```javascript
{
  "iss": "57246542-96fe-1a63e053-0824d011072a",
  "iat": 1741043663,
  "aud": "introductory-offer-eligibility",
  "bid": "com.example.testbundleid",
  "nonce": "cfb43594-4f92-4fe2-8b06-d947a848adaa",
  "productId": "com.example.product",
  "allowIntroductoryOffer": false,
  "transactionId": "1000011859217"
}
```

For more information about providing the introductory offer eligibility signed value in a purchase option, see [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption).

### 

On your server, use the private key associated with the key ID you specified in the header to generate the signature using ES256 encryption.  The process of signing combines the JWS Header and JWS Payload into a single signed string.

There are a variety of open source libraries available online for creating and signing JWT tokens; see [https://jwt.io/](https://jwt.io/) for more information.  Consider using the App Store Server Library to create the JWS. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

After signing, you should have a string in JWS compact serialization format.  Send that string to your app.

> **NOTE:** Always use a secure connection when sending data, including the signature, between your app and server. For more information on ensuring your data’s security, see [doc://com.apple.documentation/documentation/Security/preventing-insecure-network-connections](doc://com.apple.documentation/documentation/Security/preventing-insecure-network-connections).

## See Also

- [AdvancedCommerceProduct](../com.apple.storekit/StoreKit/AdvancedCommerceProduct.md)
- [sending-advanced-commerce-api-requests-from-your-app](../com.apple.storekit/StoreKit/sending-advanced-commerce-api-requests-from-your-app.md)

---


## generating-the-signature-to-validate-storekit-rendered-ads

## 

Install validation informs an ad network when users install and launch an app they purchase after viewing an ad. Ad networks first provide an ad with cryptographically signed information that includes their ad network ID. Later, if the ad results in a conversion, the customer’s device sends install-validation postbacks. For information about attribution-winning and nonwinning postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

> **NOTE:** These instructions are for signing StoreKit-rendered ads. If you’re presenting a view-through ad, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads).

To display a StoreKit-rendered ad and initiate a validation, an app needs to call [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) with a signature key that the ad network generates, [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature). To generate the signature, combine the required values from [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) and cryptographically sign the resulting string. Use the ad network ID and PKCS#8 private key that you establish when registering to use the API. For more information, see [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network).

### 

Select the required values of [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) based on the version of the signature you’re generating. The API supports multiple versions of signed ads. Use the most recent version available in the SDK whenever possible. For information about availability, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

The following table lists the required signature parameters for version 4 and later. Combine them in a UTF-8 string as the example shows in the [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads#Combine-the-parameters](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads#Combine-the-parameters) section below.

| Signature parameter | Equivalent key |
| --- | --- |
| `version` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkVersion](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkVersion) |
| `ad-network-id` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkIdentifier) |
| `source-identifier` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier)  This value replaces [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier) from previous versions. |
| `itunes-item-id` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier) |
| `nonce` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce)  Lowercase the string representation of the nonce value in the signature. |
| `source-app-id` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier)  During testing, use an ID of `0` if you’re using a development-signed build and not an app from the App Store. |
| `fidelity-type` | Version 2.2 and later signatures require this parameter.  Set `fidelity-type` to `1` for StoreKit-rendered ads. |
| `timestamp` | [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkTimestamp](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkTimestamp) |

To create signatures for previous SKAdNetwork versions, see:

- [doc://com.apple.storekit/documentation/StoreKit/combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3](doc://com.apple.storekit/documentation/StoreKit/combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3).
- [doc://com.apple.storekit/documentation/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-2](doc://com.apple.storekit/documentation/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-2).
- If you build your app with iOS SDK 11.3 through 13.7, see [doc://com.apple.storekit/documentation/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-1](doc://com.apple.storekit/documentation/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-1).

#### 

Create the UTF-8 string using the parameters in the example below.

> **IMPORTANT:** Lowercase the string representation of the nonce: [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkNonce). Failing to do so results in an invalid signature. Only ads with valid signatures can get ad attributions.

For version 4 and later, combine the values into a UTF-8 string with an invisible separator (`‘\u2063’`) between them, in the exact order the code below shows:

```javascript
// Parameter values combined, in order, for version 4 and later.
version + '\u2063' + ad-network-id + '\u2063' + source-identifier + '\u2063' + itunes-item-id + '\u2063' + nonce + '\u2063' + source-app-id + '\u2063' + fidelity-type + '\u2063' + timestamp

```

### 

Sign the combined UTF-8 string with the following key and algorithm:

- Your PKCS#8 private key.
- The Elliptic Curve Digital Signature Algorithm (ECDSA) with a SHA-256 hash.

The resulting Digital Encoding Rules (DER)-formatted binary value is the signature.

### 

Encode the binary signature you generate into a Base64 string. The result is your ad network attribution signature, [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature). The signature string should look similar to the following:

```None
MEQCIEQlmZRNfYzKBSE8QnhLTIHZZZWCFgZpRqRxHss65KoFAiAJgJKjdrWdkLUOCCjuEx2RmFS7daRzSVZRVZ8RyMyUXg==
```

For more information about Base64 encoding, see [doc://com.apple.documentation/documentation/Foundation/Data/base64EncodedString(options:)](doc://com.apple.documentation/documentation/Foundation/Data/base64EncodedString(options:)).

### 

After you generate the signature, you have all the required [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) an app needs to call [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) to intiate a validation.

If the user installs and launches the advertised app, the attribution-winning ad network receives an install-validation postback. For more information about postbacks, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

## Topics

### Signatures for SKAdNetwork 1, 2, and 2.2–3

- [combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3](../com.apple.storekit/StoreKit/combining-parameters-to-generate-signatures-for-skadnetwork-2-2-and-3.md)
- [combining-parameters-to-generate-a-signature-for-skadnetwork-2](../com.apple.storekit/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-2.md)
- [combining-parameters-to-generate-a-signature-for-skadnetwork-1](../com.apple.storekit/StoreKit/combining-parameters-to-generate-a-signature-for-skadnetwork-1.md)

## See Also

- [ad-network-install-validation-keys](../com.apple.storekit/StoreKit/ad-network-install-validation-keys.md)

---


## generating-the-signature-to-validate-view-through-ads

## 

Install validation informs an ad network when users install and launch an app they purchase after viewing an ad. Ad networks provide an ad with cryptographically signed information that includes their ad network ID. If the ad results in a conversion, the customer’s device sends install-validation postbacks. For information about attribution-winning and nonwinning postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

Starting in iOS 14.5 with SKAdNetwork 2.2, ad networks can present view-through ads to provide custom ads using any media.

> **NOTE:** These instructions are for signing view-through ads. If you’re presenting a StoreKit-rendered ad, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads).

To provide a view-through ad and initiate a validation, the app calls [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)), presents the ad, and then calls [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)). The ad network needs to generate the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature) in the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) instance that both methods share.

Ad networks generate the signature on their server using their ad network ID and the PKCS#8 private key they establish when registering to use the API. For more information, see [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network).

### 

Create an instance of [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) to set the properties for the ad impression. These properties contain the same values you use to generate the signature.

The following table maps the parameters you use in the signature string to their equivalent [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) properties, as the code example demonstrates in the [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads#Combine-parameter-values](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads#Combine-parameter-values) section below:

| Signature parameter | Equivalent properties |
| --- | --- |
| `version` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version).  For view-through ads, use version 2.2 and later. |
| `ad-network-id` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adNetworkIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adNetworkIdentifier) |
| `campaign-id` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier) for version 3 or earlier. For version 4 and later, the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier) replaces this parameter. |
| `source-identifier` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier) for version 4 and later. This parameter replaces the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adCampaignIdentifier) parameter. |
| `itunes-item-id` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/advertisedAppStoreItemIdentifier) |
| `nonce` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adImpressionIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/adImpressionIdentifier) |
| `source-app-id` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceAppStoreItemIdentifier) |
| `fidelity-type` | An additional parameter in the signature that isn’t part of [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression). Required for version 2.2 and later signatures. For view-through ads, use a fidelity type value of `0`. |
| `timestamp` | [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/timestamp](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/timestamp) |

### 

The order and content of the signature parameters depends on the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version) of the signature you’re creating. Choose one of the parameter combinations below, based on your [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version).

To generate a signature for version 4 or later, combine the signature parameter values into a UTF-8 string with an invisible separator (`‘\u2063’`) between them, in the exact order the code below shows:

```http
version + '\u2063' + ad-network-id + '\u2063' + source-identifier + '\u2063' + itunes-item-id + '\u2063' + nonce + '\u2063' + source-app-id + '\u2063' + fidelity-type + '\u2063' + timestamp

```

To generate a signature for versions 2.2 and 3, combine the signature parameter values into a UTF-8 string with an invisible separator (`‘\u2063’`) between them, in the exact order the code below shows:

```http
version + '\u2063' + ad-network-id + '\u2063' + campaign-id + '\u2063' + itunes-item-id + '\u2063' + nonce + '\u2063' + source-app-id + '\u2063' + fidelity-type + '\u2063' + timestamp

```

Use the most recent version available in the SDK whenever possible. For information about availability, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

### 

Sign the combined UTF-8 string with the following key and algorithm:

- Your PKCS#8 private key.
- The Elliptic Curve Digital Signature Algorithm (ECDSA) with a SHA-256 hash.

The resulting Digital Encoding Rules (DER)-formatted binary value is the signature.

### 

Encode the binary signature you generate into a Base64 string. The result is your ad network attribution signature, [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature), to use for view-through ads. The signature string should resemble the following:

```None
MEQCIEQlmZRNfYzKBSE8QnhLTIHZZZWCFgZpRqRxHss65KoFAiAJgJKjdrWdkLUOCCjuEx2RmFS7daRzSVZRVZ8RyMyUXg==
```

For more information about Base64 encoding, see [doc://com.apple.documentation/documentation/Foundation/Data/base64EncodedString(options:)](doc://com.apple.documentation/documentation/Foundation/Data/base64EncodedString(options:)).

### 

After you generate the signature, you have all the required values for your [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) instance and can use it to call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)). Present your view-through ad, and then call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) using the same [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) instance.

## See Also

- [SKAdImpression](../com.apple.storekit/StoreKit/SKAdImpression.md)
- [startImpression(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/startImpression(_:completionHandler:).md)
- [endImpression(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/endImpression(_:completionHandler:).md)

---


## getting-started-with-in-app-purchases-using-storekit-views

## 

StoreKit provides a streamlined system for building basic In-App Purchase (IAP) capabilities that allow you to provide purchases in your app and process transactions using simple SwiftUI views. You can use this capability to build a basic store with default styling, or you can customize your store’s experience using the full, expressive capabilities of SwiftUI.

## 

StoreKit supports the following product types, and StoreKit views can display all of them without any custom programming:

## 

With StoreKit, you can create a file that allows you to prototype and test your In-App Purchase code in Xcode without needing to set up products in App Store Connect. Xcode calls this a StoreKit local configuration; to create a local configuration file, follow these steps:

1. Open your app’s Xcode project.
2. Create the local StoreKit configuration by selecting File > New > File From Template.
3. In the sheet that appears, enter *storekit* in the Filter search field.
4. Click the StoreKit Configuration File, then click Next.
5. In the dialog, enter a name for the file, for example `LocalConfiguration.storekit`. Leave the configuration sync checkbox unchecked and click Next.
6. Select a location for your file in your app’s project, then click Create to save the file.

For more information about setting up a local configuration file, see [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

This local configuration file allows you to experiment with product IDs and various purchase types offline. To use the product IDs in a published app, create the same product IDs in App Store Connect after you finish prototyping.

## 

In your app, define products that someone can buy, in order to prototype your store. Choose descriptive product IDs that are easy for you to read and understand. In this example, the product IDs describe the product type they represent.

Although you could write product IDs in your code as an array of strings, defining an enumeration whose raw value is a string can help make your code easier to read. For example, when you add a new product, any `switch` that handles product IDs but omits the new product produces a compile-time error.

```swift
enum ProductID: String {
    case consumable = "consumable"
    case consumablePack = "consumable_pack"

    case nonconsumable = "nonconsumable"

    case subscriptionMonthly = "subscription_monthly"
    case subscriptionYearly = "subscription_yearly"
    case subscriptionPremiumYearly = "premium_subscription_yearly"
}
```

> **NOTE:** In a production app, consider fetching the list of product IDs programmatically — either from App Store Connect, or from your own server. This approach lets you enable and disable products without recompiling your app. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).

## 

StoreKit provides several asynchronous sequences that provide your app with information and updates. For example, the class below checks [doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished](doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) at startup, and continues to check [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) in the background while the app is running.

```swift
import Foundation
import Observation
import StoreKit

@MainActor
@Observable
final class Store {
    private let defaultsKey = "com.example.consumable count"
    private let nonConsumableDefaultsKey = "com.example.nonconsumable"

    public var consumableCount: Int {
        willSet {
            UserDefaults.standard.set(newValue, forKey: defaultsKey)
        }
    }
    public var boughtNonConsumable: Bool = false
    public var activeSubscription: String? = nil

    init() {
        self.consumableCount = UserDefaults.standard.integer(forKey: defaultsKey)  // Returns 0 on first app launch.

        // Because the tasks below capture 'self' in their closures, this object must be fully initialized before this point.
        Task(priority: .background) {
            // Finish any unfinished transactions -- for example, if the app was terminated before finishing a transaction.
            for await verificationResult in Transaction.unfinished {
                await handle(updatedTransaction: verificationResult)
            }

            // Fetch current entitlements for all product types except consumables.
            for await verificationResult in Transaction.currentEntitlements {
                await handle(updatedTransaction: verificationResult)
            }
        }
        Task(priority: .background) {
            for await verificationResult in Transaction.updates {
                await handle(updatedTransaction: verificationResult)
            }
        }
    }
}
```

The `handle(updatedTransaction:)` method handles new verification results from all three sources of updates, to provide access to newly purchased content. For example, this work could include allocating consumable in-game coins, or delivering an in-game object.

```swift
private func handle(updatedTransaction verificationResult: VerificationResult<Transaction>) async {
    // The code below handles only verified transactions; handle unverified transactions based on your business model.
    guard case .verified(let transaction) = verificationResult else { return }

    if let _ = transaction.revocationDate {
        // Remove access to the product identified by `transaction.productID`.
        // `Transaction.revocationReason` provides details about the revoked transaction.
        guard let productID = ProductID(rawValue: transaction.productID) else {
            print("Unexpected product: \(transaction.productID).")
            return
        }

        switch productID {
        case .consumable:
            consumableCount -= 1
        case .consumablePack:
            consumableCount -= 10
        case .nonconsumable:
            boughtNonConsumable = false
        case .subscriptionMonthly, .subscriptionYearly, .subscriptionPremiumYearly:
            // In an app that supports Family Sharing, there might be another entitlement that still provides access to the subscription.
            activeSubscription = nil
        }
        await transaction.finish()
        return
    } else if let expirationDate = transaction.expirationDate, expirationDate < Date() {
        // In an app that supports Family Sharing, there might be another entitlement that still provides access to the subscription.
        activeSubscription = nil
        return
    } else {
        // Provide access to the product identified by transaction.productID.
        guard let productID = ProductID(rawValue: transaction.productID) else {
            print("Unexpected product: \(transaction.productID).")
            return
        }
        print("transaction ID \(transaction.id), product ID \(transaction.productID)")
        switch productID {
        case .consumable:
            consumableCount += 1
        case .consumablePack:
            consumableCount += 10
        case .nonconsumable:
            boughtNonConsumable = true
        case .subscriptionMonthly, .subscriptionYearly, .subscriptionPremiumYearly:
            // In an app that supports Family Sharing, there might be another entitlement that already provides access to the subscription.
            activeSubscription = transaction.productID
        }
        await transaction.finish()
        return
    }
}
```

## 

Before moving on to the views that display these products, define these products in the local configuration file you created earlier.

To create the local products, follow these steps:

1. In Xcode, open the local StoreKit configuration file you created earlier.
2. In the lower left corner click the plus (+) button; select the kind of product to add.
3. Edit the new product name, product ID string, price, and other properties.
4. Repeat steps 2 and 3 with additional product ID strings, and product types as needed.



## 

After completing the local configuration, you can show all of your products on one page with a simple, compact SwiftUI view.

```swift
import StoreKit
import SwiftUI

struct AllProductsView: View {
    // Your app's data store.
    @Environment(Store.self) private var store: Store

    var body: some View {
        @Bindable var store = store
        VStack {
            // ProductID.all is an array of your product ID strings.
            StoreView(ids: ProductID.all)
                .storeButton(.hidden, for: .cancellation)
                .storeButton(.visible, for: .restorePurchases)
        }
        .padding()
    }
}
```

Here, the `StoreView` view from StoreKit constructs a page and lays out a grid that contains each product, as shown in the following screenshot:



To show a specific subset of your available products, use the same view structure, but change the list of product IDs you provide to the `StoreView()`. So, change `store.allProductIDs` to another array of product IDs. For example, the `subscriptionProductIDs` array contains only subscription purchase types, so replace `store.allProductIDs` with the `subscriptionProductIDs` array to show subscriptions as shown here.



For more information on StoreKit Testing in Xcode, see [https://developer.apple.com/documentation/xcode/setting-up-storekit-testing-in-xcode/](https://developer.apple.com/documentation/xcode/setting-up-storekit-testing-in-xcode/). For more information on the presentation of In-App purchase products, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase). For more information on creating products in App Store Connect, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).

## See Also

- [in-app-purchase](../com.apple.storekit/StoreKit/in-app-purchase.md)
- [understanding-storekit-workflows](../com.apple.storekit/StoreKit/understanding-storekit-workflows.md)

---


## handling-errors

## 

A StoreKit request may fail for one of many possible reasons, including invalid product information, invalid payment details, problems with your App Store Connect account, or networking issues. When an error occurs, check the error code to find out what went wrong.

### 

When handling errors, such as with the [doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/request(_:didFailWithError:)](doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/request(_:didFailWithError:)) delegate method, it’s important to use the [doc://com.apple.documentation/documentation/Foundation/NSError/domain](doc://com.apple.documentation/documentation/Foundation/NSError/domain) and [doc://com.apple.documentation/documentation/Foundation/NSError/code](doc://com.apple.documentation/documentation/Foundation/NSError/code) of the resulting error to determine the underlying cause of failure.

StoreKit uses [doc://com.apple.storekit/documentation/StoreKit/SKErrorDomain](doc://com.apple.storekit/documentation/StoreKit/SKErrorDomain) for errors related to payments, store products, and cloud services, as described in [doc://com.apple.storekit/documentation/StoreKit/SKError/Code](doc://com.apple.storekit/documentation/StoreKit/SKError/Code). For additional information on troubleshooting StoreKit framework issues, see the [https://developer.apple.com/library/archive/technotes/tn2413/_index.html#//apple_ref/doc/uid/DTS40016228](https://developer.apple.com/library/archive/technotes/tn2413/_index.html#//apple_ref/doc/uid/DTS40016228).

Errors related to networking use [doc://com.apple.documentation/documentation/Foundation/NSURLErrorDomain](doc://com.apple.documentation/documentation/Foundation/NSURLErrorDomain). The following table describes some of the most common networking errors that may occur when using StoreKit:

| Error code | Description |
| --- | --- |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorTimedOut-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorTimedOut-swift.var) (`-1001`) | The connection timed out. |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorCannotFindHost-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorCannotFindHost-swift.var) (`-1003`) | The connection failed because it can’t find the host. |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorCannotConnectToHost-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorCannotConnectToHost-swift.var) (`-1004`) | The connection failed because it can’t connect to the host. |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorNetworkConnectionLost-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorNetworkConnectionLost-swift.var) (`-1005`) | The connection failed because it lost the network connection. |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorNotConnectedToInternet-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorNotConnectedToInternet-swift.var) (`-1009`) | The connection failed because the device isn’t connected to the internet. |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorUserCancelledAuthentication-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorUserCancelledAuthentication-swift.var) (`-1012`) | The connection failed because the user canceled required authentication. |
| [doc://com.apple.documentation/documentation/Foundation/NSURLErrorSecureConnectionFailed-swift.var](doc://com.apple.documentation/documentation/Foundation/NSURLErrorSecureConnectionFailed-swift.var) (`-1200`) | The secure connection failed for an unknown reason. |

## See Also

- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [SKError](../com.apple.storekit/StoreKit/SKError.md)
- [SKErrorDomain](../com.apple.storekit/StoreKit/SKErrorDomain.md)

---


## handling-refund-notifications

## 

The App Store server sends near real-time notifications when customers receive refunds for in-app purchases. If you offer content across multiple platforms, for example gems or coins for games, and you update player account balances on your server, receiving refund notifications is important. Respond to refund notifications by interpreting and handling the refund information, and informing customers in the app of any actions you take as a result of the refund.

To enable notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications) and [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications).

### 

Customers request refunds in several ways, such as:

- Contacting Apple Customer Support and asking for a refund
- Logging in and using Apple’s self-service tool, [https://reportaproblem.apple.com](https://reportaproblem.apple.com), to request a refund
- Asking their payment method issuer for a refund

When the App Store processes a refund, the App Store server sends a `REFUND` notification to your server, at the URL you configure. Your server must respond to the post with a 200 response code. The `REFUND` notification applies to consumable, non-consumable, and non-renewing subscriptions only. To detect refunds for auto-renewable subscriptions, see [doc://com.apple.storekit/documentation/StoreKit/handling-subscriptions-billing#Detect-a-Refund](doc://com.apple.storekit/documentation/StoreKit/handling-subscriptions-billing#Detect-a-Refund).

### 

Your server is responsible for parsing and interpreting all notifications from the App Store server. For the `REFUND` notification, identify the specific transaction, product ID, and relevant dates from the response:

- Find the most recent transaction for the `product_id i`n the `unified_receipt.latest_receipt_info` by checking the `purchase_date` to select the most recent transaction.
- The date when App Store issued the refund is in the `cancellation_date_ms` field for the transaction.

For more information about the response, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications).

You’re responsible to store, monitor, and take appropriate action for each refunded transaction when you receive a `REFUND` notification. For example, you might build your own in-game currency-rebalancing logic that handles refunded transactions by linking a notification to a player account or session.

Inform customers by presenting contextual messaging in the app for any actions you take as a result of the refund.

### 

Reduce refund abuse and identify repeated refunded purchases by mapping `REFUND` notifications to the player accounts on your server. Monitor and analyze your data to identify suspicious refund activity.

If you offer content across multiple platforms, keep the balances for user accounts up to date on your server. Use [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications) to get near real-time status updates for the transactions that affect your customers.

## See Also

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)

---


## handling-subscriptions-billing

## 

Apps that offer subscriptions have some unique behaviors and considerations. Because subscriptions involve an element of time, your app must be able to determine whether the subscription is currently active and determine the subscription states for past dates. Your app must also react to new, renewed, and lapsed subscriptions, and properly handle expired auto-renewable subscriptions that may be in a billing retry state.

To validate changes in and identify the status of a subscription, you can use the different values in the receipt, which provides details on app and in-app purchases. For information about server-side receipt validation, see [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).

> **NOTE:** Each subscription has a unique product identifier associated with a single app. Apps with an iOS and a macOS version have separate products, with a unique product identifier on each platform. You could let users who have a subscription in an iOS app access the content from a macOS app, or vice versa, but implementing that functionality is your responsibility. In order to support cross-platform subscription products, you would need a system to identify users and keep track of the content to which they subscribe. For more information, see [doc://com.apple.storekit/documentation/StoreKit/offering-a-subscription-across-multiple-apps](doc://com.apple.storekit/documentation/StoreKit/offering-a-subscription-across-multiple-apps).

There are two types of subscriptions you can offer in your app: *non-renewing* and *auto-renewable*. Non-renewing subscriptions differ from auto-renewable subscriptions in a few key ways. These differences give your app the flexibility to implement the correct behavior for a non-renewing subscription, as follows:

- Your app is responsible for calculating the time period that the subscription is active and determining what content needs to be made available to the user.
- Your app is responsible for detecting that a non-renewing subscription is approaching its expiration date and prompting the user to renew the subscription by purchasing the same product again.
- Your app is responsible for making purchased subscriptions available across all the user’s devices and for letting users restore past purchases. For example, most subscriptions are provided by a server; your server would need some mechanism to identify users and associate subscription purchases with the user who purchased them.

The following sections provide guidance for handling auto-renewable subscriptions. To quickly react to changes in users’ auto-renewable subscriptions, you can choose to receive status update notifications on your server. Status update notifications inform you of real-time changes in a user’s subscription status and are only supported for auto-renewable subscriptions. For more information on setting up and handling server notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications).

### 

You can set up promotional offers in App Store Connect to provide users with free or discounted service for a subscription. All new and eligible subscribers can redeem an introductory offer, and all lapsed and existing subscribers can redeem a subscription offer. There are multiple types of introductory and subscription offers, each with different billing cycles. Customers who redeem a free trial introductory offer or a downgrade subscription offer will not be billed for the subscription until the end of the free trial period. For more information, see [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app) and [doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app).

Check the `is_in_intro_offer_period` or `is_trial_period` field from each receipt entry to validate whether the user redeemed an introductory offer at the beginning of their subscription. You can use this information to accurately present subscription products from the same subscription group at the end of the introductory offer period for that user. Check the `promotional_offer_id` field from each receipt entry to validate whether the user redeemed a subscription offer. You can use this information to determine eligibility for this user to redeem subscription offers in the future.

### 

Your app needs to determine which content the user has access to based on the period of time their auto-renewable subscription is active. To provide the customer access to the content to which they are entitled, keep a record of the date that each piece of content is published. Read the `original_purchase_date`, `purchase_date`, and `expires_date` field from each receipt entry to determine the start and end dates of each subscription period. The user has access to all content published between each subscription start and end date in addition to the content that was initially unlocked when the subscription was purchased.

For example, because purchasing a subscription always unlocks content, a user who purchases a monthly subscription mid-month to a magazine that publishes a new issue on the first day of every month gets access to two issues in their first month of subscribing: the most recently published issue, which is unlocked at the time that the subscription is purchased, and the issue you publish on the subsequent first day of the month, which is unlocked at the time you publish it.

> **IMPORTANT:** Don’t calculate the subscription period by adding a subscription duration to the purchase date. That approach fails to take into account the free trial period, the marketing opt-in period, and the content made available immediately after the user purchased the subscription.

If the subscription lapsed, there will be multiple periods of time during which the subscription was active, and there will be pieces of content unlocked at the beginning of a subscription period. To identify lapses in a subscription, compare the `expires_date` field from each receipt entry to the `purchase_date` field of the previous receipt entry for all entries in the receipt.

### 

The subscription renewal process begins in the 10 days before the expiration date. During those 10 days, the App Store checks for any billing issues that might delay or prevent the subscription from being automatically renewed, for example, whether:

- The customer’s payment method is active.
- The product increased in price since the user bought the subscription.
- The product is no longer available.

The App Store notifies users of any issue so that they can resolve it before the subscription expires and avoid an interruption in their service.

During the 24-hour period before the subscription expires, the App Store starts trying to renew it automatically. The App Store makes several attempts to automatically renew the subscription over a period of time but eventually stops if there are too many failed attempts.

### 

The App Store renews the subscription slightly before it expires, to prevent any lapse in the subscription. However, lapses are still possible. For example, if the user’s payment information is no longer valid, the first renewal attempt fails. Billing-related issues trigger the subscription to enter a billing retry state where the App Store attempts to renew the subscription for up to 60 days. You can check the `expiration_intent` and `is_in_billing_retry_period` values to monitor the retry status of the subscription. During this period, your app may optionally offer a grace period to the user and show them a message in the app to update their payment information. Additionally, your app can deep link customers to the payment details page within App Store on their device by opening this URL

```http
https://apps.apple.com/account/billing
```

The user can also cancel their subscription by disabling auto-renew and intentionally letting their subscription lapse. This action triggers the App Store to send your server a status update notification of type `DID_CHANGE_RENEWAL_STATUS`. Your server can parse the `auto_renew_status` and the `auto_renew_status_change_date` to determine the current renewal status of the subscription.

You can also check the `expiration_intent` field in the receipt to further validate the reason for the subscription to lapse. Make sure your app’s subscription logic can handle different values of `expiration_intent` along with `expires_date` to show the appropriate message to the user.

### 

Users pay for a subscription when they purchase it, and they can receive a refund by contacting Apple customer service. For example, if the user accidentally buys the wrong product and requests a refund, customer support can cancel the subscription and issue a full or partial refund. Customers may cancel a subscription in the middle of a subscription period, but the subscription remains paid through the end of the same period. Additionally, users may also receive a refund when they upgrade their subscription to another subscription product at a higher level in the same subscription group.

To identify whether a subscription has been refunded, look for the `cancellation_date` field in the receipt. The App Store notifies your server of refunds with a status update notification of type `CANCEL`, at which point you can handle the refund. For example, if the user upgraded the subscription, immediately unlock service for the higher level subscription product purchased.

### 

A user-initiated payment information update for an auto-renewable subscription in the billing retry period triggers an automatic renewal attempt to succeed. For this event, the App Store notifies your server with a notification of type `RENEWAL` and a new receipt will be generated for the successful transaction. You can look for a new value of the `expires_date` field to know the next renewal date of the subscription.

StoreKit adds a new transaction for the renewal to the transaction queue on the device. Your app can check the transaction queue on launch and handle the renewal the same way as any other transaction. If your app is already running when the subscription renews, the transaction observer is not called; your app finds out about the renewal the next time the app launches.

### 

Users can manage their auto-renewable subscriptions in their App Store settings on-device or within your app’s interface. For each subscription purchased by the user, the App Store shows all the renewal options that the subscription group offers. Users can easily change their service levels and choose to upgrade, downgrade, or cross-grade as often as they like. Upgrades of any duration or cross-grades with same durations go into effect immediately. Downgrades of any duration or cross-grades with different durations go into effect at the next renewal date.

You can check the receipt’s `auto_renew_product_id` field to learn about any plan changes the user selected that will go into effect at the next renewal date. Additionally, you can also use the notification of type `DID_CHANGE_RENEWAL_PREF` to get notified for any user initiated plan changes that will go into effect at the next renewal date.

### 

When you increase the price of a subscription, the App Store informs the affected subscribers with an email, push notification, and in-app price consent sheet, and asks your subscribers to agree to the new price. In the app, the system asks your delegate’s function [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:)) whether to immediately display the price consent sheet, or to delay displaying the sheet until later. For example, you may want to delay showing the sheet if it would interrupt a multistep user interaction, such as setting up a user account. Return `false` in [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueueShouldShowPriceConsent(_:)) to prevent the dialog from displaying immediately.

To show the price consent sheet after a delay, call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/showPriceConsentIfNeeded()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/showPriceConsentIfNeeded()), which shows the sheet only if the user hasn’t responded to the price increase notifications.

If users don’t agree to the subscription price increase or take no action, their subscription expires at the end of their current billing cycle. App Store attempts to notify users in the app twice. For a notification schedule, see [https://help.apple.com/app-store-connect/#/devc9870599e](https://help.apple.com/app-store-connect/#/devc9870599e).

> **NOTE:** The price consent sheet appears only on devices running iOS. All affected subscribers receive an email and push notification.

### 

Consider building auto-renewable subscription management UI in the app for subscribers to easily move between different subscription levels in their subscription group. Use the [doc://com.apple.storekit/documentation/StoreKit/SKProduct/subscriptionGroupIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKProduct/subscriptionGroupIdentifier) property of `SKProduct` to determine which products to display in the UI. For users who wish to cancel their subscription, your app can open the following URL:

```http
https://apps.apple.com/account/subscriptions
```

Opening this URL launches iTunes or iTunes Store and displays the Manage Subscriptions page where the user can upgrade, downgrade, or cancel their subscription by disabling auto-renew. If you configure your backend server to receive status update notifications, your server receives a `DID_CHANGE_RENEWAL_STATUS` notification if the user cancels their subscription.

## See Also

- [enabling-app-store-server-notifications](../com.apple.storekit/StoreKit/enabling-app-store-server-notifications.md)
- [offering-a-subscription-across-multiple-apps](../com.apple.storekit/StoreKit/offering-a-subscription-across-multiple-apps.md)
- [reducing-involuntary-subscriber-churn](../com.apple.storekit/StoreKit/reducing-involuntary-subscriber-churn.md)

---


## identifying-the-parameters-in-install-validation-postbacks

## 

The following list describes all the possible parameters you may get in a postback, and their version availability. To verify that Apple signed the postback, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

Note: The `source-app-id` only appears in the postback if providing the parameter meets Apple’s privacy threshold.

Note: The signature doesn’t include the `conversion-value`. Postbacks may contain either `conversion-value` or `coarse-conversion-value`, not both.

Note: The signature doesn’t include the `coarse-conversion-value`. Postbacks may contain either `conversion-value` or `coarse-conversion-value`, not both.

To ensure crowd anonymity, Apple assigns a postback data tier to app downloads. The postback data tier determines whether certain parameters appear in the postback, as well as the number of digits in the hierarchical source identifier. The following postback parameters are subject to the postback data tier:

- `source-identifier` (affects the number of digits the postback returns)
- `coarse-conversion-value`
- `conversion-value`
- `source-app-id`
- `source-domain`
- `country-code`

For more information about receiving postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

## See Also

- [verifying-an-install-validation-postback](../com.apple.storekit/StoreKit/verifying-an-install-validation-postback.md)

---


## implementing-a-store-in-your-app-using-the-storekit-api

## 

The sample project demonstrates how to use StoreKit in a SwiftUI-based iOS app with a simulated app server, SKDemoServer. SKDemoServer is a Swift package that acts as the app’s backend by vending product identifiers and persisting consumable purchase entitlements using SwiftData.

To test your implementation of In-App Purchases using StoreKit, you can use StoreKit Testing in Xcode and the sandbox environment. For more information, see [doc://com.apple.documentation/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox](doc://com.apple.documentation/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox), [doc://com.apple.documentation/documentation/StoreKit/testing-in-app-purchases-with-sandbox](doc://com.apple.documentation/documentation/StoreKit/testing-in-app-purchases-with-sandbox), and [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

> **NOTE:** This sample code project is associated with WWDC25 session 241: [https://developer.apple.com/videos/play/wwdc2025/241/](https://developer.apple.com/videos/play/wwdc2025/241/).

### 

This sample code project implements StoreKit Testing in Xcode to let you test In-App Purchases without completing any product set up in App Store Connect. It defines In-App Purchases in a `Products.storekit` file.

To test the sample in Xcode:

1. Select the sample target, then configure it to use your Developer team for signing. For more information, see Assign the project to a team in [doc://com.apple.documentation/documentation/Xcode/preparing-your-app-for-distribution](doc://com.apple.documentation/documentation/Xcode/preparing-your-app-for-distribution).
2. Edit the SKDemo “Run” scheme, and select `Products.storekit` for StoreKit configuration. For more information, see Enable StoreKit Testing in Xcode in [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).
3. Build and run the sample app on a device or in the Simulator.
4. The sample app displays a list of products available for sale in `Products.storekit` upon launching. If the sample app fails to display an In-App Purchase, see [doc://com.apple.documentation/documentation/Technotes/tn3185-troubleshooting-in-app-purchases-availability-in-xcode](doc://com.apple.documentation/documentation/Technotes/tn3185-troubleshooting-in-app-purchases-availability-in-xcode).

### 

To test your app in the sandbox environment, sign in to a Sandbox Apple Account. In the sandbox environment, you can test In-App Purchases using real product information from App Store Connect without incurring charges. This sample code project defines In-App Purchases in a `Products.plist` file. Before you can start testing the sample app in the sandbox environment, you need to complete configuration steps in App Store Connect and Xcode. For more information, see Prepare for sandbox testing in [doc://com.apple.documentation/documentation/StoreKit/testing-in-app-purchases-with-sandbox](doc://com.apple.documentation/documentation/StoreKit/testing-in-app-purchases-with-sandbox).

To prepare this sample code project to run in the sandbox, perform the following steps in App Store Connect:

1. Find or create an app that supports In-App Purchases and you can use for testing purposes.
2. Select the app and make a note of its bundle ID.
3. Create an In-App Purchase that uses a product identifier from `Products.plist`. Use information from `Products.storekit` to set up the In-App Purchase. Repeat this step for all identifiers in `Products.plist`.
4. After you create the SKDemo+ subscription group, make note of its Group ID.
5. Create a [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-a-sandbox-apple-account/](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-a-sandbox-apple-account/).

To prepare this sample code project to use information from App Store Connect, perform the following steps in Xcode:

1. Select the sample target, then change the bundle ID to your testing app’s bundle ID. For more information, see Set the bundle ID in [doc://com.apple.documentation/documentation/Xcode/preparing-your-app-for-distribution](doc://com.apple.documentation/documentation/Xcode/preparing-your-app-for-distribution).
2. Configure the target to use your Developer team for signing. For more information, see Assign the project to a team in [doc://com.apple.documentation/documentation/Xcode/preparing-your-app-for-distribution](doc://com.apple.documentation/documentation/Xcode/preparing-your-app-for-distribution).
3. Edit the SKDemo “Run” scheme, and remove `Products.storekit` from StoreKit configuration. For more information, see Disable StoreKit Testing in Xcode in [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).
4. In the `Server.swift` file, replace 3F19ED53 with your new SKDemo+ subscription Group ID from App Store Connect.

You’re now ready to test this sample in the sandbox environment. Sign in to the device with a Sandbox Apple Account, then build and run this sample in Xcode. The sample app displays a list of products available for sale in the App Store upon launching. If the sample app fails to display an In-App Purchase, see [doc://com.apple.documentation/documentation/Technotes/tn3186-troubleshooting-in-app-purchases-availability-in-the-sandbox](doc://com.apple.documentation/documentation/Technotes/tn3186-troubleshooting-in-app-purchases-availability-in-the-sandbox).

## See Also

- [Product](../com.apple.storekit/StoreKit/Product.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/SubscriptionInfo.md)
- [SubscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionStatus.md)

---


## implementing-introductory-offers-in-your-app

## 

Apps with auto-renewable subscriptions can offer a discounted introductory price, including a free trial, to eligible users. You can make introductory offers to customers who haven’t previously received an introductory offer for the given product, or for any products in the same subscription group.

Start by setting up introductory offers in App Store Connect. Then, in your app, determine if the user is eligible to receive an introductory offer. When the app queries the App Store for a list of available products, display the introductory pricing if the user is eligible to receive them.

### 

Before you can display introductory offers in your app, you must first configure the offers in App Store Connect. For more information, see [https://help.apple.com/app-store-connect/#/deve1d49254f](https://help.apple.com/app-store-connect/#/deve1d49254f).

Choose from one of three types of introductory offers, which differ in their mode of payment. All subscriptions renew at the regular price when the introductory period is over. The offer types are “pay as you go”, “pay up front”, and “free trial”.

#### 

The [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payAsYouGo) value represents the pay as you go offer type. In this introductory offer, new subscribers pay an introductory price each billing period for a specific duration (for example, $1.99 per month for 3 months).



#### 

The [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/payUpFront) value represents the pay up front offer type. In this introductory offer, new subscribers pay a one-time introductory price for a specific duration (for example, $1.99 for 2 months).



#### 

The [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum/freeTrial) value represents a free trial offer type. In this introductory offer, new subscribers access content for free for a specified duration. Subscriptions begin immediately, but subscribers won’t be billed until the free trial period is over.



### 

To determine if a user is eligible for an introductory offer, check their receipt:

1. Validate the receipt as described in [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).
2. In the receipt, check the values of the [doc://com.apple.documentation/documentation/AppStoreReceipts/is_trial_period](doc://com.apple.documentation/documentation/AppStoreReceipts/is_trial_period) and the [doc://com.apple.documentation/documentation/AppStoreReceipts/is_in_intro_offer_period](doc://com.apple.documentation/documentation/AppStoreReceipts/is_in_intro_offer_period) for all in-app purchase transactions. If either of these fields are `true` for a given subscription, the user is not eligible for an introductory offer on that subscription product or any other products within the same subscription group. Use `subscription_group_identifier` in the [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary) array to determine the subscription group to which the subscription belongs.

Typically, you check the user’s eligibility from your server. Determine eligibility early—for example, on the first launch of the app, if possible.



Based on the receipt, you will find that new and returning customers are eligible for introductory offers, including free trials:

- New subscribers are always eligible.
- Lapsed subscribers who renew are eligible if they haven’t previously used an introductory offer for the given product (or any product within the same subscription group).

Existing subscribers are not eligible for an introductory offer for any product within the same subscription group. For example, customers are not eligible if they are upgrading, downgrading, or crossgrading their subscription from another product, regardless of whether they consumed an introductory offer in the past.

### 

Once you determine the user is eligible for an introductory offer, query the App Store for available products, and present the offer to the user:

1. Retrieve localized information from the App Store about a specified list of subscription products using the [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) class. Products that have an available discount defined in App Store Connect always include an [doc://com.apple.storekit/documentation/StoreKit/SKProduct/introductoryPrice](doc://com.apple.storekit/documentation/StoreKit/SKProduct/introductoryPrice) object.
2. Use the properties in the [doc://com.apple.storekit/documentation/StoreKit/SKProduct/introductoryPrice](doc://com.apple.storekit/documentation/StoreKit/SKProduct/introductoryPrice) object to display the discounted price for the subscription. Based on the type of the introductory offer (represented by [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/PaymentMode-swift.enum)), display a UI that describes the offer accordingly.

For design guidance, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/).

## See Also

- [TP40010573](../https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Introduction.html#//apple_ref/doc/uid/TP40010573.md)
- [testing-introductory-offers](../com.apple.storekit/StoreKit/testing-introductory-offers.md)
- [SKProductDiscount](../com.apple.storekit/StoreKit/SKProductDiscount.md)

---


## implementing-offer-codes-in-your-app

## 

> **IMPORTANT:** This article refers to some deprecated APIs from the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase) and receipts, also deprecated. To implement offer codes using the  [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) APIs with the [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) class, that apply to all product types and not only auto-renewable subscriptions, see [doc://com.apple.storekit/documentation/StoreKit/supporting-offer-codes-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-offer-codes-in-your-app) instead.

To help you acquire, retain, and win back subscribers, you can use offer codes.

Offer codes are alphanumeric codes that provide auto-renewable subscriptions at a discount or for free for a specific duration. Configure the offers and create offer codes in App Store Connect, and distribute them to your customers. Customers can redeem offer codes in the App Store, using offer code redemption URLs, or in your app if you’ve implemented one of the following APIs:

- [doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)](doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)) or [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)), which are available in iOS 16 and later and iPadOS 16 and later
- [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()), which is available in iOS 14 and later and iPadOS 14 and later.

When customers redeem a valid offer code, your app receives a successful transaction on the payment queue, and you receive a server notification if you’ve enabled [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications). The receipt contains an `offer_code_ref_name` field that identifies the offer.

For information on subscription offer types and choosing the offer type to suit your business needs, see [https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers](https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers).

### 

Configure offers and manage your offer codes in App Store Connect. You can have up to 10 active offers per subscription, and create codes for a maximum of 1,000,000 redemptions per app, per quarter. There are two types of offer codes: one-time use codes, and custom codes. The offer code redemption APIs support both.

Download the offer codes from App Store Connect to distribute them to your customers. For more information on creating and distributing offer codes, and to learn which type of offer code may work for your campaign, see [https://help.apple.com/app-store-connect/#/dev6a098e4b1](https://help.apple.com/app-store-connect/#/dev6a098e4b1).

### 

To display the system sheet for customers to redeem offer codes within your app, call one of the redemption APIs, depending on your app’s UI implementation:

- Call [doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)](doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)) if your app uses SwiftUI.
- Call [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)) if your app uses UIKit.
- Call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()) for apps running on devices prior to iOS 16 and iPadOS 16.

The redemption sheet takes care of the redemption flow, including alerting customers about invalid entries, as appropriate. Invalid entries may include, for example, expired offer codes, invalid codes, or codes that would result in a subscription downgrade.

Including the redemption sheet in your app is recommended, but optional. For more guidance on supporting offer code redemption within your app, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase).

### 

Customers may redeem offer codes outside your app. If a customer doesn’t have your app, the App Store prompts them to download it as part of the redemption flow.

To handle offer codes — and other transactions that can occur outside of your app – you need to set up a transaction observer at app launch. For more information on this best practice, see [doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue](doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue). Check that your app’s customer-onboarding experience verifies the receipt and provides subscription service. Update your records if you keep a backend system to manage your subscribers.

### 

When a customer successfully redeems an offer code, the receipt contains a transaction with the field: `offer_code_ref_name`. This field’s value is the offer reference name that you configure in App Store Connect. The field appears in the [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Latest_receipt_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Latest_receipt_info-data.dictionary) and [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary) objects for receipts, and in the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt/Latest_receipt_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt/Latest_receipt_info-data.dictionary) and [doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt/Pending_renewal_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt/Pending_renewal_info-data.dictionary) objects for server notifications.

### 

When an existing customer redeems an offer code, your app receives a transaction on the payment queue ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state. This flow is the same as a typical subscription purchase flow, but the receipt contains the offer code reference. Your app follows these steps:

1. Validates the receipt. For more information, see [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).
2. Looks for the `offer_code_ref_name` field in the receipt to determine if the subscription is from an offer code.
3. Provides the subscription service based on the offer.
4. Calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

When you acquire new customers with an offer code, they open your app for the first time already having a subscription. In addition to providing subscription service, you may need to update your backend system’s records. Your app follows these steps:

1. When the app first launches, validate the receipt.
2. In the receipt, look for a transaction with the `offer_code_ref_name` field to determine if the subscription is from an offer code.
3. Provide the subscription service based on the offer.
4. Guide the customer through your new-customer experience as needed. Update your backend system’s records.
5. Call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

---


## implementing-promotional-offers-in-your-app

## 

Promotional offers can be effective in winning back lapsed subscribers or retaining current subscribers. You can provide lapsed or current subscribers a limited-time offer of a discounted or free period of service for auto-renewable subscriptions on macOS, iOS, and tvOS. To implement the offers, first complete the setup on App Store Connect, including generating a private key. See [doc://com.apple.storekit/documentation/StoreKit/setting-up-promotional-offers](doc://com.apple.storekit/documentation/StoreKit/setting-up-promotional-offers) for more details.

You decide the criteria for which subscribers qualify for an offer. In your app, the details of the offers you set up in App Store Connect appear in the [doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts](doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts) array in [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct). To indicate the offer you want to give to a user, include a signed [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/paymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/paymentDiscount) in the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment) object.

For business guidance on using promotional offers, see [https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers](https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers).

> **NOTE:** If your goal is to attract new users, you can use introductory offers and promote the in-app purchase on the App Store. Users are eligible to receive only one introductory offer, but redeeming an introductory offer doesn’t affect their eligibility for a promotional offer. For more information on introductory offers, see [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app).

### 

To present a promotional offer, first determine the subscriber’s eligibility, get the product details from the App Store, and generate a signature on your server.



#### 

There are two aspects to determining a user’s eligibility for promotional offers:

- The App Store deems all customers with an existing or expired subscription in the app eligible to redeem a promotional offer. You can check whether the receipt contains any existing or expired subscription purchases to identify these current or lapsed subscribers.
- You determine any additional eligibility criteria for a specific promotional offer. Eligibility can be contingent on a wide range of business logic determined by your business needs.

Consider using the App Store server notification `DID_CHANGE_RENEWAL_STATUS` to determine eligibility. This notification is triggered by changes in a subscription’s auto-renew status. For example, you receive a notification when a subscriber disables auto-renew in Manage Subscriptions or contacts AppleCare to cancel their subscription. For more information on server notifications, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications). Your server can notify your app if the user is eligible for an offer so the app can present it to the customer.

> **NOTE:** Customers can redeem promotional offers only on devices running iOS 12.2 and later, macOS 10.14.4 and later, and tvOS 12.2 and later. Consider providing messaging prompting your customer to update their OS if they try to redeem a promotional offer in your app on a device running an older OS version.

Consider also implementing [doc://com.apple.documentation/documentation/DeviceCheck](doc://com.apple.documentation/documentation/DeviceCheck) to keep track of devices that have previously redeemed offers. `TwoBitKit` allows you to maintain user privacy while defining parameters you use to determine eligibility.

#### 

Once you determine that the subscriber is eligible for an offer, the next step is requesting the product details, including offers, from the App Store. To fetch the details, use [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) with the subscription’s product identifier.

In response, the App Store returns the localized information in [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct). The [doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts](doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts) array of [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) contains all promotional offers you configured in App Store Connect for that product. The [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount) object contains offer details including the localized price.

You determine which offer from the [doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts](doc://com.apple.storekit/documentation/StoreKit/SKProduct/discounts) array to present to the user.

#### 

A signature is a unique string that your server generates using specified parameters and your private key. You include it in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount/signature) parameter of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount), and the App Store uses it to validate the promotional offer. The signature is time sensitive, unique per offer, and redeemable only once.

To generate the signature, send a secure request to your server. The server will need to know the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername), [doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier), and [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/identifier](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount/identifier). Your app should supply these parameters in the request if the server doesn’t already know them. See [doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers](doc://com.apple.storekit/documentation/StoreKit/generating-a-signature-for-promotional-offers) for more information.

Your server should respond with the signature string and the additional values it used to generate the signature: a `nonce`, `timestamp`, and the `keyIdentifier`. Use these values to complete the parameters in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount) object nested in the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment) object representing the offer. If the App Store determines that the signature isn’t a match for the parameters in the payment, the transaction fails.

> **TIP:** To minimize latency, consider generating the signature when you display the offer.

The following code example shows how to request a signature from your server and prepare the discount offer.

```swift
// Fetch the signature from your server to be applied to the offer.
// At this point you know the user and the product the offer is for, and which offer you want to display.
public func prepareOffer(usernameHash: String, productIdentifier: String, offerIdentifier: String, completion: (SKPaymentDiscount) -> Void) {

    // Make a secure request to your server, providing the username, product, and discount data
    // Your server will use these values to generate the signature and return it, along with the nonce, timestamp, and key identifier that it uses to generate the signature.
    YourServer.fetchOfferDetails(username: usernameHash, productIdentifier: productIdentifier, offerIdentifier: offerIdentifier, completion: { (nonce: UUID, timestamp: NSNumber, keyIdentifier: String, signature: String) in 

        // Create an SKPaymentDiscount to be used later when the user initiates the purchase
        let discountOffer = SKPaymentDiscount(identifier: offerIdentifier, keyIdentifier: keyIdentifier, nonce: nonce, signature: discountsignature, timestamp: timestamp)

        completion(discountOffer)
    })
}
```

#### 

You can present offers to users through various channels, such as email, but they must interact with the offer inside your app’s UI. Display the offer in your app at the time you choose, using the pricing and terms from the [doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount](doc://com.apple.storekit/documentation/StoreKit/SKProductDiscount) object. By using the details from this object, you ensure that the offer displayed to the user accurately reflects the offer you intend to give. For design guidance, see [https://developer.apple.com/app-store/subscriptions/#clear-description](https://developer.apple.com/app-store/subscriptions/#clear-description).

Present offers to eligible subscribers only, to avoid misleading or confusing users.

### 

After a user chooses to buy the promotional offer, submit the payment request, verify the receipt, and unlock the offer.



#### 

When the user initiates a buy of the offer in the app, send an [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment) to the App Store with the signed offer. Create an [doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPaymentDiscount) object that includes the signature you generated and its `identifier`, `keyIdentifier`, `nonce` (one-time use), and `timestamp` parameters. Add this object as the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/paymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/paymentDiscount) property to the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment) object.

Include in the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment) object the same [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername), often a unique hash of the username, that the signature contains. Add the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment) object to the queue.

```swift
// An example function that makes a buy request with a promotional offer attached.
public func buyProduct(productIdentifier: SKProduct, forUser usernameHash: String, withOffer discountOffer: SKPaymentDiscount) {

    // The original product being purchased.
    let payment = SKMutablePayment(product: product)

    // You must set applicationUsername to be the same as the one used to generate the signature.
    payment.applicationUsername = usernameHash

    // Add the offer to the payment.
    payment.paymentDiscount = discountOffer

    // Add the payment to the queue for purchase.
    SKPaymentQueue.default().add(payment)
}
```

#### 

Once the App Store validates the offer, it processes your payment request and generates an [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction). Your app uses it to validate the transaction and unlock content accordingly.

Handle the transaction state of the payment request and notify the customer as needed. If the transaction is successful, the App Store automatically updates the app receipt with the transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state. Base64-encode the receipt on-device and securely send the receipt data to your server.

> **NOTE:** If the transaction fails with a state of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed), you must generate a new signature and a new payment request for any further attempts to purchase the offer.

#### 

As you do for all purchases, verify the receipt with the App Store by calling the [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) endpoint from your server. The App Store sends a JSON response containing information about the user’s purchase. See [https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ValidateRemotely.html](https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ValidateRemotely.html) for more information.

When a subscriber redeems an offer, the receipt contains a [doc://com.apple.documentation/documentation/AppStoreReceipts/promotional_offer_id](doc://com.apple.documentation/documentation/AppStoreReceipts/promotional_offer_id) in the purchase transaction. This receipt field is a string containing the offer ID that you configured in App Store Connect. You can look at past transactions in the receipt to identify the offers the customer redeemed.

#### 

After validating that the user has purchased the subscription product, unlock the subscription service in the app for the user. Update the customer’s eligibility criteria for offers, as needed.

When a customer redeems a promotional offer, the offer period starts at the next billing event.

- For upgrades or crossgrades to a different subscription with the same duration, the promotional offer triggers a billing event and goes into effect immediately.
- For downgrades or crossgrades to a different subscription with different durations, the promotional offer period goes into effect at the next renewal date.
- For the same subscription in an introductory offer, this promotional offer period goes into effect at the next scheduled billing event.

Once the offer period concludes, a promotional offer auto-renews at the standard price.

A user can redeem and have active only one promotional offer at a time. If the user accepts another offer before a current offer ends, the current offer is canceled in the following billing event and the new offer takes effect.

## See Also

- [setting-up-promotional-offers](../com.apple.storekit/StoreKit/setting-up-promotional-offers.md)
- [generating-a-signature-for-promotional-offers](../com.apple.storekit/StoreKit/generating-a-signature-for-promotional-offers.md)
- [generating-a-promotional-offer-signature-on-the-server](../com.apple.storekit/StoreKit/generating-a-promotional-offer-signature-on-the-server.md)
- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

---


## in-app-purchase

## 

With the In-App Purchase API, you can offer customers the opportunity to purchase digital content and services in your app. Customers can make the purchases within your app, and find your promoted products on the App Store.

The StoreKit framework connects to the App Store on your app’s behalf to prompt for, and securely process, payments. The framework then notifies your app, making the transactions for In-App Purchases available to your app on all of the customer’s devices. For each transaction that represents a current purchase, your app delivers the purchased products. To validate purchases, you can verify transactions on your server, or rely on StoreKit’s verification.



The App Store can also communicate with your server. It notifies your server of transactions and auto-renewable subscription events through [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications), and provides the same transaction information, and more, through the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI).

To learn how adding In-App Purchases fits in an overall app development workflow for the App Store, see [https://developer.apple.com/app-store/pathway/](https://developer.apple.com/app-store/pathway/). For an overview of In-App Purchases and its features, including its configuration, testing capabilities, marketing for your products, and more, see [https://developer.apple.com/in-app-purchase/](https://developer.apple.com/in-app-purchase/). For an overview on subscriptions, including creating subscription groups, Family Sharing, and more, see [https://developer.apple.com/app-store/subscriptions/](https://developer.apple.com/app-store/subscriptions/).

### 

To use the In-App Purchase API, you first need to configure the products that your app merchandises.

- In the early stages of development, you can configure the products in the StoreKit configuration file in Xcode, and test your code without any dependency on App Store Connect. For more information, see [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).
- When you’re ready for sandbox testing and production, configure the products in App Store Connect. You can add or remove products and refine or reconfigure existing products as you develop your app. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).

You can also offer apps and In-App Purchases that run on multiple platforms as a single purchase. For more information on universal purchase, see [https://developer.apple.com/help/app-store-connect/create-an-app-record/add-platforms/](https://developer.apple.com/help/app-store-connect/create-an-app-record/add-platforms/).

### 

The In-App Purchase API takes advantage of Swift features like concurrency to simplify your In-App Purchase workflows, and SwiftUI to build stores with [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views). Use the API to manage access to content and subscriptions, receive App Store-signed transaction information, get the history of all In-App Purchase transactions, and more.

> **NOTE:** Session 10114: [https://developer.apple.com/videos/play/wwdc2021/10114/](https://developer.apple.com/videos/play/wwdc2021/10114/)

The In-App Purchase API offers:

- Transaction information that’s App Store-signed in JSON Web Signature (JWS) format.
- Transaction and subscription status information that’s simple to parse in your app.
- An entitlements API, [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements), that simplifies determining entitlements to unlock content and services for your customers.

> **NOTE:** Session 110404: [https://developer.apple.com/videos/play/wwdc2022/110404/](https://developer.apple.com/videos/play/wwdc2022/110404/)

To support a store in your app, implement the following functionality:

- Listen for transaction state changes using the transaction listener, [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates), to provide up-to-date service and content while your app is running.
- Use [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views) to merchandise your products; or request products to display from the App Store with [doc://com.apple.storekit/documentation/StoreKit/Product/products(for:)](doc://com.apple.storekit/documentation/StoreKit/Product/products(for:)) and enable purchases using [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)). Unlock purchased content and services based on the purchase result, [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult).
- Iterate through a customer’s purchases anytime using the transaction sequence [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all), and unlock the purchased content and services.
- Optionally, validate the signed transactions and signed subscription status information that you receive from the API.

## Topics

### In-App Purchase merchandising

- [storekit-views](../com.apple.storekit/StoreKit/storekit-views.md)

### Product and subscription information

- [implementing-a-store-in-your-app-using-the-storekit-api](../com.apple.storekit/StoreKit/implementing-a-store-in-your-app-using-the-storekit-api.md)
- [Product](../com.apple.storekit/StoreKit/Product.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/SubscriptionInfo.md)
- [SubscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionStatus.md)

### Purchase requests and results

- [PurchaseAction](../com.apple.storekit/StoreKit/PurchaseAction.md)
- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)

### Transaction history and entitlements

- [Transaction](../com.apple.storekit/StoreKit/Transaction.md)
- [updates](../com.apple.storekit/StoreKit/Transaction/updates.md)
- [all](../com.apple.storekit/StoreKit/Transaction/all.md)
- [currentEntitlements](../com.apple.storekit/StoreKit/Transaction/currentEntitlements.md)

### JWS verification

- [VerificationResult](../com.apple.storekit/StoreKit/VerificationResult.md)
- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

### Subscription status and renewal information

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)
- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [SubscriptionRenewalInfo](../com.apple.storekit/StoreKit/SubscriptionRenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)
- [SubscriptionRenewalState](../com.apple.storekit/StoreKit/SubscriptionRenewalState.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/SubscriptionPeriod.md)

### Offers

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [supporting-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/supporting-win-back-offers-in-your-app.md)
- [merchandising-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/merchandising-win-back-offers-in-your-app.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)
- [OfferType](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType.md)

### Promoted In-App Purchases

- [supporting-promoted-in-app-purchases-in-your-app](../com.apple.storekit/StoreKit/supporting-promoted-in-app-purchases-in-your-app.md)
- [PurchaseIntent](../com.apple.storekit/StoreKit/PurchaseIntent.md)
- [PromotionInfo](../com.apple.storekit/StoreKit/Product/PromotionInfo.md)
- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)

### App Store interactions

- [AppStore](../com.apple.storekit/StoreKit/AppStore.md)
- [AppTransaction](../com.apple.storekit/StoreKit/AppTransaction.md)

### Storefront information

- [Storefront](../com.apple.storekit/StoreKit/Storefront.md)
- [current](../com.apple.storekit/StoreKit/Storefront/current.md)
- [updates](../com.apple.storekit/StoreKit/Storefront/updates.md)

### In-App Purchase Testing

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)
- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [testing-win-back-offers-in-xcode](../com.apple.storekit/StoreKit/testing-win-back-offers-in-xcode.md)
- [testing-ask-to-buy-in-xcode](../com.apple.storekit/StoreKit/testing-ask-to-buy-in-xcode.md)

### Advanced Commerce API interactions

- [AdvancedCommerceProduct](../com.apple.storekit/StoreKit/AdvancedCommerceProduct.md)
- [sending-advanced-commerce-api-requests-from-your-app](../com.apple.storekit/StoreKit/sending-advanced-commerce-api-requests-from-your-app.md)
- [generating-jws-to-sign-app-store-requests](../com.apple.storekit/StoreKit/generating-jws-to-sign-app-store-requests.md)

### Errors

- [StoreKitError](../com.apple.storekit/StoreKit/StoreKitError.md)

### Deprecated

- [choosing-a-storekit-api-for-in-app-purchases](../com.apple.storekit/StoreKit/choosing-a-storekit-api-for-in-app-purchases.md)
- [original-api-for-in-app-purchase](../com.apple.storekit/StoreKit/original-api-for-in-app-purchase.md)

## See Also

- [understanding-storekit-workflows](../com.apple.storekit/StoreKit/understanding-storekit-workflows.md)
- [getting-started-with-in-app-purchases-using-storekit-views](../com.apple.storekit/StoreKit/getting-started-with-in-app-purchases-using-storekit-views.md)

---


## linkssubscriptionoptiongroupstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct LinksSubscriptionOptionGroupStyle
```

## Topics

### Getting the links style

- [links](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/links.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/LinksSubscriptionOptionGroupStyle/init().md)

## See Also

- [AutomaticSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOptionGroupStyle.md)
- [TabsSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/TabsSubscriptionOptionGroupStyle.md)
- [SubscriptionOptionGroupStyleOutput](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyleOutput.md)

---


## loading-in-app-product-identifiers

## 

Implementing an in-app purchase flow consists of three stages. In the first stage, your app retrieves product information. Then your app requests payment when the user selects a product in your app’s store. Finally, your app delivers the product.



To begin the purchase process, your app needs the product identifiers so it can retrieve information about the products from the App Store and present its store UI to the user. Every product you sell in your app has a unique product identifier. You provide this value in App Store Connect when you create a new in-app purchase product (see [https://help.apple.com/app-store-connect/#/devae49fb316](https://help.apple.com/app-store-connect/#/devae49fb316) for more information). Your app uses these product identifiers to fetch information about products available for sale in the App Store, such as pricing, and to submit payment requests when users purchase those products.

There are several strategies for storing a list of product identifiers in your app, such as embedding them in the app bundle or storing them on your server. You can then retrieve the product identifiers by reading them locally in the app bundle or fetching them from your server. Choose the method that best serves your app’s needs.

> **NOTE:** There’s no runtime mechanism to fetch a list of the configured products in App Store Connect for a particular app. You’re responsible for managing your app’s list of products and providing that information to your app.

### 

Embed the product identifiers in your app bundle if:

- Your app has a fixed list of in-app purchase products. For example, apps with an in-app purchase to remove ads or unlock functionality can embed the product identifier list in the app bundle.
- You expect users to update the app to see new in-app purchase products.
- The app or product doesn’t require a server.

Include a property list file in your app bundle containing an array of product identifiers, such as the following:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"
 "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
    <string>com.example.level1</string>
    <string>com.example.level2</string>
    <string>com.example.rocket_car</string>
</array>
</plist>
```

To get product identifiers from the property list, locate the file in the app bundle and read it.

### 

Store the product identifiers on your server if:

- You update the list of in-app products frequently, without updating your app. For example, games that support additional levels or characters can fetch the product identifiers list from your server.
- The products consist of delivered content.
- Your app or product requires a server.

Host a JSON file on your server with the product identifiers. For example, the following JSON file contains three product IDs:

```xml
[
    "com.example.level1",
    "com.example.level2",
    "com.example.rocket_car"
]
```

To get product identifiers from your server, fetch and read the JSON file.

Consider versioning the JSON file so future versions of your app can change its structure without breaking older versions of your app. For example, you might name the file that uses the old structure `products_v1.json` and the file that uses a new structure `products_v2.json`. This is especially useful if your JSON file is more complex than the simple array in the example.

To ensure that your app remains responsive, use a background thread to download the JSON file and extract the list of product identifiers. To minimize the data that transfers, use standard HTTP caching mechanisms, such as the `Last-Modified` and `If-Modified-Since` headers.

After loading all in-app product identifiers, pass them into the product information request to the App Store. For details on obtaining product information, see [doc://com.apple.storekit/documentation/StoreKit/fetching-product-information-from-the-app-store](doc://com.apple.storekit/documentation/StoreKit/fetching-product-information-from-the-app-store).

## See Also

- [fetching-product-information-from-the-app-store](../com.apple.storekit/StoreKit/fetching-product-information-from-the-app-store.md)
- [SKProductsRequest](../com.apple.storekit/StoreKit/SKProductsRequest.md)
- [SKProductsResponse](../com.apple.storekit/StoreKit/SKProductsResponse.md)
- [SKProduct](../com.apple.storekit/StoreKit/SKProduct.md)

---


## macros



---


## managing-price-increases-for-auto-renewable-subscriptions

## 

If you increase the price of an auto-renewable subscription in App Store Connect, the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/priceIncreaseStatus-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/priceIncreaseStatus-swift.property) in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo) object indicates if the subscription is subject to the price increase. Auto-renewable subscriptions have two types of price increases: those that require customer consent, and those that don’t require customer consent.

For price increases that require customer consent, look for the following status values in your app:

| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/noIncreasePending](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/noIncreasePending) | Indicates there’s no price increase for this auto-renewable subscription. |
| --- | --- |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending) | Indicates there’s a pending price increase for the auto-renewable subscription that requires customer consent, and the customer hasn’t yet consented.   If the customer doesn’t consent, the auto-renewable subscription expires at the end of the billing cycle. When it expires, your app gets a status update in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/updates](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/updates) with an [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/didNotConsentToPriceIncrease](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/didNotConsentToPriceIncrease). |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/agreed](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/agreed) | Indicates that the customer consented to a price increase for the auto-renewable subscription. |

For price increases that don’t require customer consent, look for the following status values in your app:

| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/noIncreasePending](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/noIncreasePending) | Doesn’t apply. |
| --- | --- |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/pending) | Doesn’t apply. |
| [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/agreed](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum/agreed) | Indicates that the App Store informed the customer of the price increase for the auto-renewable subscription, and the subscription is subject to the price increase.  If the customer cancels the auto-renewable subscription, your app gets a status update in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/updates](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/updates) with an [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/expirationReason-swift.property) of [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/autoRenewDisabled](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/ExpirationReason-swift.struct/autoRenewDisabled). |

For more information about managing subscription prices in App Store Connect, see [https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers](https://developer.apple.com/app-store/subscriptions/#managing-prices-for-existing-subscribers).

### 

If you’ve enabled [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2), your server receives notifications for events related to auto-renewable subscription price increases.

For auto-renewable subscription price increases that require customer consent, look for the following notifications:

| Notification type | Subtype | Description |
| --- | --- | --- |
| `PRICE_INCREASE` | `PENDING` | Indicates that the App Store informed the customer of the price increase for the auto-renewable subscription, and the customer hasn’t yet responded. |
| `PRICE_INCREASE` | `ACCEPTED` | Indicates that the customer consented to the price increase for the auto-renewable subscription. |
| `EXPIRED` | `PRICE_INCREASE` | Indicates that the auto-renewable subscription expired because the customer didn’t consent to the price increase, and allowed the subscription to expire. |
| `EXPIRED` | `VOLUNTARY` | Indicates that the customer voluntarily canceled the auto-renewable subscription. (Note: This notification type and subtype isn’t specific to price increases.) |

For auto-renewable subscription price increases that don’t require customer consent, look for the following notifications:

| Notification type | Subtype | Description |
| --- | --- | --- |
| `PRICE_INCREASE` | `ACCEPTED` | Indicates that the App Store informed the customer of the auto-renewable subscription price increase, and the subscription is subject to the price increase. |
| `EXPIRED` | `VOLUNTARY` | Indicates that the customer voluntarily canceled the auto-renewable subscription. (Note: This notification type and subtype isn’t specific to price increases.) |

For more information about App Store Server Notifications, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications). For more information about notification types and subtypes, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) and [doc://com.apple.documentation/documentation/AppStoreServerNotifications/subtype](doc://com.apple.documentation/documentation/AppStoreServerNotifications/subtype).

## See Also

- [priceIncreaseStatus-swift.property](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/priceIncreaseStatus-swift.property.md)
- [PriceIncreaseStatus-swift.enum](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo/PriceIncreaseStatus-swift.enum.md)

---


## merchandising-win-back-offers-in-your-app

## 

If a customer is eligible for a win-back offer, StoreKit provides several ways to for your app to merchandise the offer. By default, StoreKit automatically displays a win-back offer sheet to eligible customers when the app launches. You can choose to suppress (or delay) this sheet using the [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message) API, present the win-back offer using [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views), or use StoreKit APIs and customize your UI.

> **NOTE:** Session 10110: [https://developer.apple.com/wwdc24/10110](https://developer.apple.com/wwdc24/10110)

For information on configuring win-back offers, handling redeemed offers, and more, see [doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app).

### 

By default, when StoreKit receives a [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/winBackOffer](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/winBackOffer) message from the App Store, it displays a win-back offer sheet when the app launches. You don’t need any code to choose this default behavior.

You may choose to delay this message, or suppress it if you customize the way your app presents win-back offers. Listen for messages using the [doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property](doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property) asynchronous sequence when your app launches. Intercept the win-back offer message, which has a [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/winBackOffer](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/winBackOffer) reason. After you intercept the message, you can suppress it by not calling `displayStoreMessage`, as in the example below.

The following example code suppresses the win-back offer redemption message, and displays all other App Store messages immediately.

```swift
struct MessageExampleView: View {
    @Environment(\.displayStoreKitMessage) private var displayStoreMessage
    
    var body: some View {
        MyContentView()
            .task {
                for await message in StoreKit.Message.messages {
                    if message.reason != .winBackOffer {
                        // Ask the system to display messages now.
                        try? displayStoreMessage(message)
                    }
                }
            }
    }
}
```

For more information about App Store messages, see [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).

> **NOTE:** Redeeming an offer in the win-back offer sheet results in a transaction that StoreKit treats the same as transactions that occur outside of the app; your app observes the transaction in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) sequence.

### 

StoreKit views automatically support displaying pricing details in the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView) for all subscription offers the customer is eligible for, including win-back offers. The StoreKit views fetch the offer metadata and set up the purchase for you. If a customer is eligible for multiple offers, use the view modifier [doc://com.apple.documentation/documentation/SwiftUI/View/preferredSubscriptionOffer(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/preferredSubscriptionOffer(_:)) to control which offer to present.

The [doc://com.apple.documentation/documentation/SwiftUI/View/preferredSubscriptionOffer(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/preferredSubscriptionOffer(_:)) modifier takes a single parameter: a function that StoreKit calls for each subscription in the group. In this function, StoreKit provides the product object, the subscription information, and a list of all offers the customer is eligible for. Use this information and your own logic to decide which offer to present, and return its [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer) object. If you return `nil` and the customer is eligible for an introductory offer, the app always displays the introductory offer in the view.

### 

If you choose to fully control the in-app merchandising experience, use the folllowing APIs to get information about the customer’s eligibility for win-back offers and the offer details:

- Check the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs) in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo) to get the list of the product’s win-back offers the customer is eligibile for. If the customer is eligible for multiple offers, the App Store sorts this array with the best offer first.
- Get the win-back offer details from the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/winBackOffers](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/winBackOffers) array in [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo), which contains all the available win-back offers that you configure in App Store Connect. Compare the IDs from the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/eligibleWinBackOfferIDs) array to the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer/id](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer/id) of the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionOffer) in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/winBackOffers](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/winBackOffers) array.

To add a win-back offer to a purchase, include the win-back offer the customer chooses in the purchase options, [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)).

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [supporting-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/supporting-win-back-offers-in-your-app.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)
- [OfferType](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType.md)

---


## message

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct Message
```

## 

A StoreKit message represents a sheet that appears over your app to display important information from the App Store. Messages have a reason, which the  [doc://com.apple.storekit/documentation/StoreKit/Message/reason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Message/reason-swift.property) value indicates. StoreKit retrieves any messages from the App Store each time your app launches, and presents them by default.

> **NOTE:** StoreKit displays messages from the App Store regardless of the SDK version you use to build your app. Apps built for iOS 16 and later can implement a message listener and delay or suppress messages.

You can optionally use the `Message` API to control message presentation by delaying or suppressing messages. Your app can listen for messages with the [doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property](doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property) asynchronous sequence, and can display them at a particular time by calling [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)), or [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction) for SwiftUI views. For example, you may choose to delay messages in views where an interrupting sheet might confuse someone, such as in the middle of an onboarding flow, or if your app is providing real-time instructions.

StoreKit presents message sheets only if a message is still relevant. For example, if a person resolves the issue outside your app before it calls [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)), StoreKit doesn’t present the message. StoreKit ensures that it presents each unique message once, even if the app asks to display messages multiple times.

### 

If you want to defer or suppress App Store messages, set up the message listener in your app when your app launches.

To control when a message may display, call [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)) or [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction) when your app’s ready to have StoreKit present the message. If your app doesn’t call either of these APIs after it listens for messages, it suppresses the messages. The following example is for apps that use [doc://com.apple.documentation/documentation/UIKit](doc://com.apple.documentation/documentation/UIKit):

```swift
// Listen for App Store messages.
for await message in StoreKit.Message.messages {
    // Call display on the message when the app is ready.
}

// Indicate the app is ready to display the message.
guard let windowScene = self.view.window?.windowScene else {
    fatalError("Could not get window scene.")
}
try? message.display(in: windowScene)
```

For a code example that uses SwiftUI, see [doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction](doc://com.apple.storekit/documentation/StoreKit/DisplayMessageAction).

## Topics

### Getting messages and message reasons

- [messages-swift.type.property](../com.apple.storekit/StoreKit/Message/messages-swift.type.property.md)
- [reason-swift.property](../com.apple.storekit/StoreKit/Message/reason-swift.property.md)
- [Messages-swift.struct](../com.apple.storekit/StoreKit/Message/Messages-swift.struct.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)

### Displaying messages

- [display(in:)](../com.apple.storekit/StoreKit/Message/display(in:).md)

## See Also

- [Reason-swift.struct](../com.apple.storekit/StoreKit/Message/Reason-swift.struct.md)
- [DisplayMessageAction](../com.apple.storekit/StoreKit/DisplayMessageAction.md)

---


## offering-a-subscription-across-multiple-apps

## 

You can offer customers auto-renewable subscription services that are accessible through multiple apps across one or more operating systems.

To offer this functionality, your server must grant access to the subscription content across all apps, despite the user having purchased the subscription within a specific app. You can use a unified account management database along with server-side receipt validation to validate a user’s purchase and handle in-app transactions. By entitling subscription access from your server, you can provide users the ability to access your subscription across multiple apps.

### 

To get started, use App Store Connect to create a separate and equivalent [https://help.apple.com/app-store-connect/#/dev06f89ce98](https://help.apple.com/app-store-connect/#/dev06f89ce98) for each app that offers the multi-app subscription so that users can subscribe from any app. For design guidance, see [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase/overview/introduction/).

> **TIP:** Use an [https://help.apple.com/app-store-connect/#/dev96d99635a](https://help.apple.com/app-store-connect/#/dev96d99635a) to group apps that share auto-renewable subscriptions on the same platform in a single App Store product page. An app bundle enables customers to view and download apps in a single purchase.

The following image illustrates the steps for implementing a multi-app subscription:



### 

When providing auto-renewable subscription access across multiple apps, you must authenticate the user in a way that correlates across apps. Authenticating users using a login allows you to determine if the user has access to the content. To provide a consistent user experience, ensure that the login process is similar across your apps.

To provide an easy and secure login, take advantage of [https://developer.apple.com/sign-in-with-apple/](https://developer.apple.com/sign-in-with-apple/). Sign in with Apple allows you to identify a user across your apps, while maintaining user privacy and protecting your app against fraud. You can store and retrieve user account data across your apps and the user’s devices, and use that data to unlock access appropriately.

### 

After authenticating the user, determine whether to grant access to the content based on their transaction history in the receipt.

Check if the user has purchased any subscription products before showing a subscription offer in the app. If there’s a subscription purchase from any app, verify if the subscription is active by looking at the [https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ReceiptFields.html#//apple_ref/doc/uid/TP40010573-CH106-SW28](https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ReceiptFields.html#//apple_ref/doc/uid/TP40010573-CH106-SW28) in the receipt.

Present users who don’t have an active subscription with the subscription for purchase. Consider all potential billing scenarios within your account database when determining eligibility and granting access to a user.

> **IMPORTANT:** If the user has purchased the subscription from an app, you must propagate the purchase across all the apps that provide the subscription service. Failing to persist the purchase to the other apps opens the possibility of a user paying multiple times for the same service.

### 

A user’s subscription status can change any time. Validate the receipt and check the latest [https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ReceiptFields.html#//apple_ref/doc/uid/TP40010573-CH106-SW28](https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ReceiptFields.html#//apple_ref/doc/uid/TP40010573-CH106-SW28) to maintain the billing status for each user and reflect any changes.

[doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications) keeps your server aware of changes made to a customer’s subscription status. Update your records to keep users’ subscription status and content current. The billing status must be accurate in your account database to provide the expected user experience across all apps.

### 

After determining that the user should have access, you can enable access in each app based on the [https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ReceiptFields.html#//apple_ref/doc/uid/TP40010573-CH106-SW28](https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Chapters/ReceiptFields.html#//apple_ref/doc/uid/TP40010573-CH106-SW28). The user can access the subscription within any app that offers the same service. Repeat the previous steps as necessary across each app or user’s session to unlock the subscription.

## See Also

- [handling-subscriptions-billing](../com.apple.storekit/StoreKit/handling-subscriptions-billing.md)
- [enabling-app-store-server-notifications](../com.apple.storekit/StoreKit/enabling-app-store-server-notifications.md)
- [reducing-involuntary-subscriber-churn](../com.apple.storekit/StoreKit/reducing-involuntary-subscriber-churn.md)

---


## offering-apple-music-subscription-in-your-app

## 

With an Apple Music membership, customers can play songs from the entire Apple Music catalog or access their iCloud music library across all their devices. You can offer users the option to sign up for an Apple Music subscription directly from your app by following these steps:

1. Request Apple Music Library access from the customer.
2. Determine if the customer is eligible for an Apple Music subscription.
3. Present the sign-up subscription offer if the customer is eligible.

### 

The user must grant permission before your app can access Apple Music library. See [doc://com.apple.storekit/documentation/StoreKit/requesting-access-to-apple-music-library](doc://com.apple.storekit/documentation/StoreKit/requesting-access-to-apple-music-library) for details. Use [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/authorizationStatus()](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/authorizationStatus()) to determine your app’s authorization status. If the authorization status is [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/authorized](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/authorized), your app can check if the user is eligible for an Apple Music subscription offer.

> **IMPORTANT:** When the Music app is absent on the user’s device, [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:)) fails to load.

### 

After getting Apple Music access from the user, call [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:)) on an instance of [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController) to query the user’s capabilities. Then, inspect the `capabilities` parameter of this method to determine eligibility. See [doc://com.apple.storekit/documentation/StoreKit/determining-a-person-s-apple-music-capabilities](doc://com.apple.storekit/documentation/StoreKit/determining-a-person-s-apple-music-capabilities) for details. A user has an active subscription to Apple Music when `capabilities` contains [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback). A user is eligible for the offer when `capabilities` doesn’t include [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogPlayback) but contains [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceCapability/musicCatalogSubscriptionEligible).

### 

For users who are eligible for an Apple Music subscription, use the following steps to allow users to sign up for it.

First, create a dictionary with an [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/action](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/action) key to [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupAction/subscribe](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupAction/subscribe):

If you have an [https://help.apple.com/app-store-connect/#/itcfa7936330](https://help.apple.com/app-store-connect/#/itcfa7936330), you can add the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken) key to the dictionary to earn commision if the user subscribes:

By default, the setup view is configured with the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier) key set to [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/join](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/join). Add [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier) to the dictionary and set it to [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/addMusic](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/addMusic), [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/connect](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/connect), or [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/playMusic](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupMessageIdentifier/playMusic) if you wish to change the default message that your app shows to the user:

Next, create an [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController) object and set the view controller class as its delegate:

Then, pass the dictionary to the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:)) method of the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController) object. Finally, present the [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceSetupViewController) object modally from your app:

## See Also

- [SKCloudServiceSetupOptionsKey](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey.md)
- [load(options:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:).md)
- [SKArcadeService](../com.apple.storekit/StoreKit/SKArcadeService.md)

---


## offering-completing-and-restoring-in-app-purchases

## 

Use the In-App Purchase API to give people the ability to purchase virtual goods within your app or directly from the App Store using the StoreKit framework. This sample code project demonstrates how to retrieve, display, and restore in-app purchases. First, you set up your app to register and use a single-transaction queue observer at launch. The transaction queue observer manages all payment transactions and handles all transaction states. Confirm that it’s a shared instance of a custom class that conforms to the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol. Then, remove the transaction observer when the system is about to terminate the app. See [doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue](doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue) for more information.

This sample code project, which builds the InAppPurchases app, supports the iOS, iPadOS, macOS, and tvOS platforms. After launching, the app queries the App Store about product identifiers in the `Products.plist` file. The app updates its UI with the App Store’s response, which may include available products for sale, unrecognized product identifiers, or both. The app also displays all available purchased and restored payment transactions.

### 

Before you can run and test this sample code project, you need to:

1. Start with a completed app that supports in-app purchases and has some configured in-app purchases in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).
2. Create [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-a-sandbox-apple-account/](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-a-sandbox-apple-account/) in App Store Connect.
3. Open the sample code project in Xcode, select the target that you want to build, click Signing & Capabilities, and change its bundle identifier to one that supports in-app purchases.
4. Choose the appropriate team from the Team pop-up menu to let Xcode automatically manage your provisioning profile. See [https://help.apple.com/xcode/mac/current/#/dev23aab79b4](https://help.apple.com/xcode/mac/current/#/dev23aab79b4) for details.
5. Open the `ProductIds.plist` file in the sample and update its content with your existing in-app purchases product IDs.
6. For iOS and tvOS devices, build and run the `InAppPurchases` and `InAppPurchasestvOS` targets, respectively, which the sample uses to build the app. If you have any code-signing issues, see [https://help.apple.com/xcode/mac/current/#/dev01865b392](https://help.apple.com/xcode/mac/current/#/dev01865b392).
7. For macOS, before building the `InAppPurchasesmacOS` target, sign out of the Mac App Store. Build the target, then launch the resulting app from the Finder the first time to obtain a receipt. See [doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox](doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox) for details.
8. Upon launching, the app queries the App Store about the product identifiers in `ProductIds.plist`. When successful, it displays a list of products available for sale in the App Store. Tap any product in that list to purchase it. When you receive a prompt to authenticate the purchase, use your test user account. If the product request fails, see [doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse/invalidProductIdentifiers](doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse/invalidProductIdentifiers) for reasons the App Store may return invalid product identifiers.

### 

The sample configures the app so it confirms that the user has authorization to make payments on the device before presenting products for sale.

```swift
var isAuthorizedForPayments: Bool {
    return SKPaymentQueue.canMakePayments()
}
```

After the app confirms authorization, it sends a products request to the App Store to fetch localized product information. Querying the App Store ensures that the app only presents users with products available for purchase. The app initializes the products request with a list of product identifiers associated with products to sell in its UI. Be sure to keep a strong reference to the products request object; the system may release it before the request completes. See [https://help.apple.com/app-store-connect/#/dev84b80958f](https://help.apple.com/app-store-connect/#/dev84b80958f) for more information.

```swift
fileprivate func fetchProducts(matchingIdentifiers identifiers: [String]) {
    // Create a set for the product identifiers.
    let productIdentifiers = Set(identifiers)
    
    // Initialize the product request with the above identifiers.
    productRequest = SKProductsRequest(productIdentifiers: productIdentifiers)
    productRequest.delegate = self
    
    // Send the request to the App Store.
    productRequest.start()
}
```

The App Store responds to the products request with an [doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse](doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse) object. Its [doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse/products](doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse/products) property contains information about all the products that are available for purchase in the App Store. The app uses this property to update its UI. The response’s `invalidProductIdentifiers` property includes all product identifiers that the App Store doesn’t recognize. See `invalidProductIdentifiers` for reasons the App Store may return invalid product identifiers.

```swift
// Contains products with identifiers that the App Store recognizes. As such, they are available for purchase.
if !response.products.isEmpty {
    availableProducts = response.products
}

// invalidProductIdentifiers contains all product identifiers that the App Store doesn’t recognize.
if !response.invalidProductIdentifiers.isEmpty {
    invalidProductIdentifiers = response.invalidProductIdentifiers
}
```

To display the price of a product in the UI, the app uses the locale and currency that the App Store returns. For instance, consider a user who is logged in to the French App Store and their device uses the United States locale. When attempting to purchase a product, the App Store displays the product’s price in Euros. Converting and showing the product’s price in U.S. dollars to match the device’s locale would be incorrect.

```swift
extension SKProduct {
    /// - returns: The cost of the product formatted in the local currency.
    var regularPrice: String? {
        let formatter = NumberFormatter()
        formatter.numberStyle = .currency
        formatter.locale = self.priceLocale
        return formatter.string(from: self.price)
    }
}
```

### 

Users can tap any product available for sale in the UI to purchase it. The app allows users to restore non-consumable products and auto-renewable subscriptions. The sample implements the Restore button and Settings > Restore all restorable purchases to implement this feature in the iOS and tvOS version of the app, respectively. It implements the Store > Restore menu item to restore purchases in the macOS version of the app.

Tapping any purchased item brings up purchase information, such as product identifier, transaction identifier, and transaction date. When the purchase is a restored one, the purchase information also contains its original transaction’s identifier and date.

### 

When a transaction is pending in the payment queue, StoreKit notifies the app’s transaction observer by calling its [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) method. Every transaction has five possible states, including [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing), [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased), [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed), [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored), and [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/deferred](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/deferred). For more information, see [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState). The observer’s `paymentQueue(_:updatedTransactions:)` needs to be able to respond to any of these states at any time.

```swift
func paymentQueue(_ queue: SKPaymentQueue, updatedTransactions transactions: [SKPaymentTransaction]) {
    for transaction in transactions {
        switch transaction.transactionState {
        case .purchasing: break
        // Don’t block the UI. Allow the user to continue using the app.
        case .deferred: print(Messages.deferred)
        // The purchase was successful.
        case .purchased: handlePurchased(transaction)
        // The transaction failed.
        case .failed: handleFailed(transaction)
        // There are restored products.
        case .restored: handleRestored(transaction)
        @unknown default: fatalError(Messages.unknownPaymentTransaction)
        }
    }
}
```

When a transaction fails, the app inspects the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/error](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/error) property to determine what happened. The app only displays errors with code that is different from [doc://com.apple.storekit/documentation/StoreKit/SKError/paymentCancelled](doc://com.apple.storekit/documentation/StoreKit/SKError/paymentCancelled).

```swift
// Don’t send any notifications when the user cancels the purchase.
if (transaction.error as? SKError)?.code != .paymentCancelled {
    DispatchQueue.main.async {
        self.delegate?.storeObserverDidReceiveMessage(message)
    }
}
```

When the user defers a transaction, apps need to allow them to continue using the UI while waiting for StoreKit to update the transaction.

### 

When users purchase non-consumables, auto-renewable subscriptions, or non-renewing subscriptions, they expect them to be available on all their devices indefinitely. The app provides a UI that allows users to restore their past purchases. See [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase#Understand-product-types](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase#Understand-product-types) for more information.

```swift
@IBAction func restore(_ sender: UIBarButtonItem) {
    // Calls StoreObserver to restore all restorable purchases.
    StoreObserver.shared.restore()
}
```

The sample uses [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) to restore non-consumables and auto-renewable subscriptions. StoreKit notifies the app’s transaction observer by calling `paymentQueue(_:updatedTransactions:)` with a transaction state of `.restored` for each restored transaction. Restoring non-renewing subscriptions isn’t within the scope of this sample code project. For information about restore failures, see `restoreCompletedTransactions()`.

### 

Apps need to deliver the content or unlock the purchased functionality after receiving a transaction with a state of `.purchased` or `.restored`. These states indicate that the App Store has received a payment for a product from the user.

Unfinished transactions stay in the payment queue. StoreKit calls the app’s persistent observer’s `paymentQueue(_:updatedTransactions:)` each time upon launching or resuming from the background until the app finishes these transactions. As a result, the App Store may repeatedly prompt users to authenticate their purchases or prevent them from purchasing products from the app.

The sample calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) on transactions with a state of `.failed`, `.purchased`, or `.restored` to remove them from the queue. Finished transactions aren’t recoverable. Therefore, apps need to provide the purchased content or complete their purchase process before finishing transactions.

```swift
// Finish the successful transaction.
SKPaymentQueue.default().finishTransaction(transaction)
```

## See Also

- [setting-up-the-transaction-observer-for-the-payment-queue](../com.apple.storekit/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue.md)
- [SKPaymentQueue](../com.apple.storekit/StoreKit/SKPaymentQueue.md)
- [SKPaymentTransactionObserver](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver.md)
- [SKPaymentQueueDelegate](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)

---


## offering-media-for-sale-in-your-app

## 

This sample code project shows how to let users purchase media from your app using the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController) class. Additionally, the sample demonstrates how to measure the effectiveness of a cross-promotional campaign for your apps or third-party apps using the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterCampaignToken](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterCampaignToken) and [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterProviderToken](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterProviderToken) keys. When cross-promoting your apps, set `SKStoreProductParameterProviderToken` to your own provider token. When promoting apps for other developers, set it to their provider token.

The app in this sample project displays a list of media items that the user can tap to make purchases from the App Store. You can also track advertising and promotions from this interactive list of media items for sale.

The sample app requires an iOS or iPadOS device.

### 

This sample code project defines a `Product` data type to represent media information it saves in the `Products.plist` file. `Products.plist` contains a single `Product` entry. Before you can run this sample on your device, you need to update this entry with your own data.

1. Set the sample’s `productIdentifier` key to your media’s iTunes identifier. For more information about iTunes identifiers, see [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier).
2. Set the `title` key to your media’s name.
3. Set the `isApplication` key to YES if your media is an app, and NO, otherwise.
4. Set the `campaignToken` and `providerToken` keys to the appropriate tokens if you’re cross-promoting apps, and leave them empty if you’re not. For more information about generating campaign and provider tokens, see [https://help.apple.com/app-store-connect/#/itcfa7936330](https://help.apple.com/app-store-connect/#/itcfa7936330), [https://help.apple.com/app-store-connect/#/itc5e30b4d89](https://help.apple.com/app-store-connect/#/itc5e30b4d89), and [https://help.apple.com/app-store-connect/#/itc1ae92f9ee](https://help.apple.com/app-store-connect/#/itc1ae92f9ee).

To add more data, duplicate and update the `Product` entry in `Products.plist` as necessary.

### 

This sample launches to the `TableViewController`, which shows a list of media associated with iTunes identifiers in `Products.plist`. When the user taps any item in the list, `TableViewController` presents a page where they can purchase the media from the App Store.

The sample creates a parameters dictionary and sets the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier) key to the media’s iTunes identifier.

```swift
var parametersDictionary = [SKStoreProductParameterITunesItemIdentifier: product.productIdentifier]
```

The sample creates an `SKStoreProductViewController` object and sets the view controller class as its delegate. Then it passes the dictionary to the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) method of the `SKStoreProductViewController` object.

```swift
// Create a store product view controller.
let store = SKStoreProductViewController()
store.delegate = self
```

Then the sample presents the `SKStoreProductViewController` object modally.

```swift
/*
   Attempt to load the selected product from the App Store. Display the
   store product view controller if successful. Print an error message,
   otherwise.
*/
store.loadProduct(withParameters: parametersDictionary, completionBlock: {[unowned self] (result: Bool, error: Error?) in
    if result {
        self.present(store, animated: true, completion: {
            print("The store view controller was presented.")
        })
    } else {
        if let error = error {
            print("Error: \(error.localizedDescription)")
        }
    }})
```

The delegate needs to dismiss the store view controller when the purchase completes, or if the user cancels it. `TableViewController` implements the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewControllerDelegate/productViewControllerDidFinish(_:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewControllerDelegate/productViewControllerDidFinish(_:)) method to dismiss the presented store product view controller. Apps can also use this method to resume any activities that they pause before presenting the store.

### 

The `SKStoreProductParameterCampaignToken` and `SKStoreProductParameterProviderToken` keys track advertising and promotion for the app. When the user taps an item in the list, `TableViewController` adds these keys and their values to a dictionary, which already contains `SKStoreProductParameterItunesItemIdentifier` with the iTunes identifier.

`TableViewController` passes the dictionary to a created `SKStoreProductViewController` object, and then displays the store product view controller modally.

```swift
/*
    Update `parametersDictionary` with the `campaignToken` and
    `providerToken` values if they exist and the specified `product`
    is an app.
*/
if product.isApplication, !product.campaignToken.isEmpty, !product.providerToken.isEmpty {
    parametersDictionary[SKStoreProductParameterCampaignToken] = product.campaignToken
    parametersDictionary[SKStoreProductParameterProviderToken] = product.providerToken
}
```

## See Also

- [SKStoreProductViewController](../com.apple.storekit/StoreKit/SKStoreProductViewController.md)
- [SKOverlay](../com.apple.storekit/StoreKit/SKOverlay.md)

---


## original-api-for-in-app-purchase

## 

The In-App Purchase APIs, including the original API and the Swift-based [doc://com.apple.storekit/documentation/StoreKit/in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/in-app-purchase) API, allow you to offer customers the opportunity to purchase in-app content and features. Customers can make the purchases within your app, and find your promoted products on the App Store.

The StoreKit framework connects to the App Store on your app’s behalf to prompt for, and securely process, payments. The framework then notifies your app, which delivers the purchased products. To validate purchases, you can verify receipts on your server with the App Store or on the device. For auto-renewable subscriptions, the App Store can also notify your server of key subscription events.



For more information about In-App Purchases, including configuration, testing, marketing, and more, see [https://developer.apple.com/in-app-purchase/](https://developer.apple.com/in-app-purchase/).

### 

To use the In-App Purchase API, you need to configure the products in App Store Connect. As you develop your app, you can add or remove products and refine or reconfigure existing products. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).

You can also offer apps and In-App Purchases that run on multiple platforms as a single purchase. For more information about universal purchase, see [https://help.apple.com/app-store-connect/#/dev2cd126805](https://help.apple.com/app-store-connect/#/dev2cd126805).

### 

There are four In-App Purchase types you can offer:

- *Consumables* are a type that are depleted after one use. Customers can purchase them multiple times.
- *Non-consumables* are a type that customers purchase once. They don’t expire. Non-consumable In-App Purchases can offer Family Sharing.
- *Auto-renewable subscriptions* to services or content are a type that customers purchase once and that renew automatically on a recurring basis until customers decide to cancel. Auto-renewable subscriptions can offer Family Sharing.
- *Non-renewing subscriptions* to services or content provide access over a limited duration and don’t renew automatically. Customers need to purchase a new subscription after it concludes if they want to retain access.

You can sync and restore non-consumables and auto-renewable subscriptions across devices using StoreKit. When a customer purchases an auto-renewable or non-renewing subscription, your app is responsible for making it available across all the person’s devices, and for restoring past purchases.

## Topics

### Essentials

- [setting-up-the-transaction-observer-for-the-payment-queue](../com.apple.storekit/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue.md)
- [offering-completing-and-restoring-in-app-purchases](../com.apple.storekit/StoreKit/offering-completing-and-restoring-in-app-purchases.md)
- [SKPaymentQueue](../com.apple.storekit/StoreKit/SKPaymentQueue.md)
- [SKPaymentTransactionObserver](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver.md)
- [SKPaymentQueueDelegate](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)

### Product information

- [loading-in-app-product-identifiers](../com.apple.storekit/StoreKit/loading-in-app-product-identifiers.md)
- [fetching-product-information-from-the-app-store](../com.apple.storekit/StoreKit/fetching-product-information-from-the-app-store.md)
- [SKProductsRequest](../com.apple.storekit/StoreKit/SKProductsRequest.md)
- [SKProductsResponse](../com.apple.storekit/StoreKit/SKProductsResponse.md)
- [SKProduct](../com.apple.storekit/StoreKit/SKProduct.md)

### Storefronts

- [SKStorefront](../com.apple.storekit/StoreKit/SKStorefront.md)

### Purchases

- [requesting-a-payment-from-the-app-store](../com.apple.storekit/StoreKit/requesting-a-payment-from-the-app-store.md)
- [processing-a-transaction](../com.apple.storekit/StoreKit/processing-a-transaction.md)
- [SKPayment](../com.apple.storekit/StoreKit/SKPayment.md)
- [SKMutablePayment](../com.apple.storekit/StoreKit/SKMutablePayment.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)

### Purchase validation

- [choosing-a-receipt-validation-technique](../com.apple.storekit/StoreKit/choosing-a-receipt-validation-technique.md)
- [validating-receipts-with-the-app-store](../com.apple.storekit/StoreKit/validating-receipts-with-the-app-store.md)
- [appStoreReceiptURL](../com.apple.Foundation/Bundle/appStoreReceiptURL.md)
- [SKReceiptRefreshRequest](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest.md)

### Content delivery

- [unlocking-purchased-content](../com.apple.storekit/StoreKit/unlocking-purchased-content.md)
- [persisting-a-purchase](../com.apple.storekit/StoreKit/persisting-a-purchase.md)
- [finishing-a-transaction](../com.apple.storekit/StoreKit/finishing-a-transaction.md)
- [SKDownload](../com.apple.storekit/StoreKit/SKDownload.md)

### Refunds

- [handling-refund-notifications](../com.apple.storekit/StoreKit/handling-refund-notifications.md)
- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)

### Providing access to previously purchased products

- [restoring-purchased-products](../com.apple.storekit/StoreKit/restoring-purchased-products.md)
- [SKReceiptRefreshRequest](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)
- [SKTerminateForInvalidReceipt()](../com.apple.storekit/StoreKit/SKTerminateForInvalidReceipt().md)

### Family Sharing

- [supporting-family-sharing-in-your-app](../com.apple.storekit/StoreKit/supporting-family-sharing-in-your-app.md)
- [isFamilyShareable](../com.apple.storekit/StoreKit/SKProduct/isFamilyShareable.md)
- [paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:).md)

### Subscriptions

- [subscriptions-and-offers](../com.apple.storekit/StoreKit/subscriptions-and-offers.md)

### Promotions

- [promoting-in-app-purchases](../com.apple.storekit/StoreKit/promoting-in-app-purchases.md)
- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)
- [SKProductStorePromotionController](../com.apple.storekit/StoreKit/SKProductStorePromotionController.md)

### Testing In-App Purchases

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [setting-up-storekit-testing-in-xcode](../com.apple.Xcode/setting-up-storekit-testing-in-xcode.md)
- [testing-in-app-purchases-in-xcode](../com.apple.storekit/StoreKit/testing-in-app-purchases-in-xcode.md)
- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)

### Errors

- [handling-errors](../com.apple.storekit/StoreKit/handling-errors.md)
- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [SKError](../com.apple.storekit/StoreKit/SKError.md)
- [SKErrorDomain](../com.apple.storekit/StoreKit/SKErrorDomain.md)

## See Also

- [choosing-a-storekit-api-for-in-app-purchases](../com.apple.storekit/StoreKit/choosing-a-storekit-api-for-in-app-purchases.md)

---


## pagedprominentpickersubscriptionstorecontrolstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
@MainActor @preconcurrency struct PagedProminentPickerSubscriptionStoreControlStyle
```

## Topics

### Getting the paged prominent picker control style

- [pagedProminentPicker](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle/pagedProminentPicker.md)

### Creating the style

- [init()](../com.apple.storekit/StoreKit/PagedProminentPickerSubscriptionStoreControlStyle/init().md)

### Placing the controls

- [Placement](../com.apple.storekit/StoreKit/PagedProminentPickerSubscriptionStoreControlStyle/Placement.md)

## See Also

- [AutomaticSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlStyle.md)
- [ButtonsSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ButtonsSubscriptionStoreControlStyle.md)
- [PickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PickerSubscriptionStoreControlStyle.md)
- [ProminentPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/ProminentPickerSubscriptionStoreControlStyle.md)
- [CompactPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/CompactPickerSubscriptionStoreControlStyle.md)
- [PagedPickerSubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/PagedPickerSubscriptionStoreControlStyle.md)
- [AutomaticSubscriptionStoreControlPlacement](../com.apple.storekit/StoreKit/AutomaticSubscriptionStoreControlPlacement.md)

---


## persisting-a-purchase

## 

After making a product available, your app needs to make a persistent record of the purchase. Your app uses that persistent record to continue making the product available on launch and to restore purchases. Your app’s persistence strategy depends on the type of products you sell:

- For non-consumable products and auto-renewable subscriptions, use the app receipt as your persistent record. If the app receipt isn’t available, use the user defaults system or iCloud to keep a persistent record.
- For non-renewing subscriptions, use iCloud or your own server to keep a persistent record.
- For consumable products, your app updates its internal state to reflect the purchase. Ensure that the updated state is part of an object that supports state preservation (in iOS) or that you manually preserve the state across app launches (in iOS or macOS).

When using the user defaults system or iCloud, your app can store a value, such as a number or Boolean value, or a copy of the transaction receipt. In macOS, users can edit the user defaults system using the `defaults` command. Storing a receipt requires more application logic, but protects the persistent record from tampering.

> **NOTE:** When persisting with iCloud, your app’s persistent record syncs across devices, but your app is responsible for downloading any associated content on other devices.

### 

The app receipt contains a record of the user’s purchases, cryptographically signed by Apple. For more information, see [doc://com.apple.storekit/documentation/StoreKit/choosing-a-receipt-validation-technique](doc://com.apple.storekit/documentation/StoreKit/choosing-a-receipt-validation-technique).

The system adds information about consumable products to the receipt when the user purchases them, and it remains in the receipt until you finish the transaction. After you finish the transaction, the system removes this information the next time it updates the receipt, such as the next time the user makes a purchase.

The system adds information about all other kinds of purchases to the receipt when the user purchases the products, and it remains in the receipt indefinitely.

### 

To store information in user defaults or iCloud, set the value for a key.

### 

Send a copy of the receipt to your server, along with credentials or an identifier, so you can keep track of which receipts belong to a particular user. For example, let users identify themselves to your server with a user name and password. Don’t use the [doc://com.apple.documentation/documentation/UIKit/UIDevice/identifierForVendor](doc://com.apple.documentation/documentation/UIKit/UIDevice/identifierForVendor) property of [doc://com.apple.documentation/documentation/UIKit/UIDevice](doc://com.apple.documentation/documentation/UIKit/UIDevice). Different devices have different values for this property, so you can’t use it to identify and restore purchases that the same user makes on a different device.

## See Also

- [unlocking-purchased-content](../com.apple.storekit/StoreKit/unlocking-purchased-content.md)
- [finishing-a-transaction](../com.apple.storekit/StoreKit/finishing-a-transaction.md)
- [SKDownload](../com.apple.storekit/StoreKit/SKDownload.md)

---


## processing-a-transaction

## 

Implementing an in-app purchase flow consists of three stages. In the first stage, your app retrieves product information. Then your app requests payment when the user selects a product in your app’s store. Finally, your app delivers the product.

The App Store calls the transaction queue observer after it processes the payment request. Your app then records information about the purchase for future launches, downloads the purchased content, and marks the transaction as finished.



### 

The transaction queue plays a central role in letting your app communicate with the App Store through the StoreKit framework. You add work to the queue that the App Store needs to act on, such as a payment request for processing. When the transaction’s state changes, such as when a payment request succeeds, StoreKit calls the app’s transaction queue observer. You decide which class acts as the observer. In very small apps, you might handle all the StoreKit logic in the app delegate, including observing the transaction queue. In most apps, however, you create a separate class that handles this observer logic, along with the rest of your app’s store logic. The observer needs to conform to the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol.

By adding an observer, your app doesn’t need to constantly poll the status of its active transactions. Your app uses the transaction queue for payment requests, to download Apple-hosted content, and to determine when subscriptions renew.

It’s important to register a transaction queue observer as soon as your app launches, as the code shows below. For more guidance, see [doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue](doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue).

Make sure that the observer is ready to handle a transaction at any time, not only after you add a transaction to the queue. For example, if a user buys something in your app just before entering a tunnel, your app may not be able to deliver the purchased content if there isn’t a network connection. The next time your app launches, StoreKit calls your transaction queue observer again so your app can handle the transaction and deliver the purchased content. Similarly, if your app fails to mark a transaction as finished, StoreKit calls the observer every time your app launches until the transaction finishes.

Implement the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) method on your transaction queue observer. StoreKit calls this method when the status of a transaction changes, such as when a payment request has been processed. The transaction status tells you what action your app needs to perform, as described in the table below:

| Status | Action to take in your app |
| --- | --- |
| [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing) | Update your UI to reflect the in-progress status, and wait for StoreKit to call the method again. |
| [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/deferred](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/deferred) | Update your UI to reflect the deferred status, and wait for StoreKit to call the method again. |
| [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed) | Use the value of the `error` property to present a message to the user. For a list of error constants, see [doc://com.apple.storekit/documentation/StoreKit/SKErrorDomain](doc://com.apple.storekit/documentation/StoreKit/SKErrorDomain). |
| [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) | Provide the purchased functionality, typically by unlocking features or delivering content. |
| [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored) | Restore the previously purchased functionality. |

Transactions in the queue can change state in any order. Your app needs to be ready to work on any active transaction at any time. Act on every transaction according to its transaction state, as in this example:

### 

To keep your user interface up to date while waiting, the transaction queue observer can implement optional methods from the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol as follows:

- StoreKit calls the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:removedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:removedTransactions:)) method when it removes transactions from the queue. In your implementation of this method, remove the corresponding items from your app’s UI.
- StoreKit calls the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:)) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:restoreCompletedTransactionsFailedWithError:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:restoreCompletedTransactionsFailedWithError:)) methods when it finishes restoring transactions, depending on whether there is an error. In your implementation of these methods, update your app’s UI to reflect the success or failure.

For successfully processed transactions, validate the receipt associated with the transaction to verify the items the user purchased, and unlock content accordingly. For more information on validating receipts serverside, see [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).

## See Also

- [requesting-a-payment-from-the-app-store](../com.apple.storekit/StoreKit/requesting-a-payment-from-the-app-store.md)
- [SKPayment](../com.apple.storekit/StoreKit/SKPayment.md)
- [SKMutablePayment](../com.apple.storekit/StoreKit/SKMutablePayment.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)

---


## product-dictionary-keys

## 

These dictionary keys are used in the parameter for the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) method.

The [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterITunesItemIdentifier) key represents the product to display, and is always required. Other keys provide optional affiliate or promoted product information.

Learn more about the Affiliate Program at [https://apple.com/itunes/affiliates](https://apple.com/itunes/affiliates).

## Topics

### Required Key

- [SKStoreProductParameterITunesItemIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterITunesItemIdentifier.md)

### Affiliate and Analytics Keys

- [SKStoreProductParameterProductIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterProductIdentifier.md)
- [SKStoreProductParameterAdvertisingPartnerToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAdvertisingPartnerToken.md)
- [SKStoreProductParameterAffiliateToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAffiliateToken.md)
- [SKStoreProductParameterCampaignToken](../com.apple.storekit/StoreKit/SKStoreProductParameterCampaignToken.md)
- [SKStoreProductParameterProviderToken](../com.apple.storekit/StoreKit/SKStoreProductParameterProviderToken.md)
- [SKStoreProductParameterCustomProductPageIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterCustomProductPageIdentifier.md)

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [loadProduct(withParameters:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:).md)
- [loadProduct(withParameters:impression:completionBlock:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(withParameters:impression:completionBlock:).md)
- [loadProduct(parameters:impression:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:).md)
- [loadProduct(parameters:impression:reengagementURL:)](../com.apple.storekit/StoreKit/SKStoreProductViewController/loadProduct(parameters:impression:reengagementURL:).md)

---


## product

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Product
```

## 

The `Product` type represents the in-app purchases that you configure in App Store Connect and make available for purchase within your app. Use `Product` to perform all product-related tasks in your app, from displaying in-app purchases and offers to making a purchase and getting transaction and subscription status information.

To get a `Product` instance, call [doc://com.apple.storekit/documentation/StoreKit/Product/products(for:)](doc://com.apple.storekit/documentation/StoreKit/Product/products(for:)) and provide one or more in-app purchase product identifiers. Use a `Product` instance to display in-app purchases and subscription offers in your store, as follows:

- Show the localized name, description, and pricing information using [doc://com.apple.storekit/documentation/StoreKit/Product/displayName](doc://com.apple.storekit/documentation/StoreKit/Product/displayName), [doc://com.apple.storekit/documentation/StoreKit/Product/description](doc://com.apple.storekit/documentation/StoreKit/Product/description), and [doc://com.apple.storekit/documentation/StoreKit/Product/displayPrice](doc://com.apple.storekit/documentation/StoreKit/Product/displayPrice), respectively.
- Determine whether a user is eligible for an introductory offer for the product using [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/isEligibleForIntroOffer).
- Display your subscription offers using the subscription information in [doc://com.apple.storekit/documentation/StoreKit/Product/subscription](doc://com.apple.storekit/documentation/StoreKit/Product/subscription).

When users initiate a purchase, call [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) or [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-3bivf](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(confirmIn:options:)-3bivf) on the product instance. If your app uses SwiftUI, you can also use [doc://com.apple.storekit/documentation/StoreKit/PurchaseAction](doc://com.apple.storekit/documentation/StoreKit/PurchaseAction). Set purchase options ([doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption)) to define an optional app account token, apply a promotional offer, or set a product quantity. Purchase options can also simulate an Ask to Buy scenario when you’re testing your app in the sandbox environment.

Use a `Product` instance to learn whether a user is entitled to a product by checking [doc://com.apple.storekit/documentation/StoreKit/Product/currentEntitlement](doc://com.apple.storekit/documentation/StoreKit/Product/currentEntitlement), which holds the transaction that entitles the user to the product. This transaction information, as well as the transaction in [doc://com.apple.storekit/documentation/StoreKit/Product/latestTransaction](doc://com.apple.storekit/documentation/StoreKit/Product/latestTransaction), are cryptographically signed by the App Store in JSON Web Signature (JWS) format.

If the product is an auto-renewable subscription, use the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/status-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/status-swift.property) and [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo) in the [doc://com.apple.storekit/documentation/StoreKit/Product/subscription](doc://com.apple.storekit/documentation/StoreKit/Product/subscription) information to help manage subscriptions and inform business decisions, such as presenting subscription offers.

For information about configuring In-App Purchases in App Store Connect, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).

## Topics

### Requesting products from the App Store

- [products(for:)](../com.apple.storekit/StoreKit/Product/products(for:).md)

### Displaying a product description and price

- [displayName](../com.apple.storekit/StoreKit/Product/displayName.md)
- [description](../com.apple.storekit/StoreKit/Product/description.md)
- [displayPrice](../com.apple.storekit/StoreKit/Product/displayPrice.md)
- [price](../com.apple.storekit/StoreKit/Product/price.md)
- [priceFormatStyle](../com.apple.storekit/StoreKit/Product/priceFormatStyle.md)
- [subscriptionPeriodFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodFormatStyle.md)
- [subscriptionPeriodUnitFormatStyle](../com.apple.storekit/StoreKit/Product/subscriptionPeriodUnitFormatStyle.md)

### Purchasing a product

- [purchase(options:)](../com.apple.storekit/StoreKit/Product/purchase(options:).md)
- [purchase(confirmIn:options:)-6dj6y](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-6dj6y.md)
- [purchase(confirmIn:options:)-3bivf](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-3bivf.md)
- [purchase(confirmIn:options:)-8eai6](../com.apple.storekit/StoreKit/Product/purchase(confirmIn:options:)-8eai6.md)
- [PurchaseOption](../com.apple.storekit/StoreKit/Product/PurchaseOption.md)
- [PurchaseResult](../com.apple.storekit/StoreKit/Product/PurchaseResult.md)
- [PurchaseError](../com.apple.storekit/StoreKit/Product/PurchaseError.md)

### Receiving current entitlement information

- [currentEntitlements](../com.apple.storekit/StoreKit/Product/currentEntitlements.md)

### Getting the latest transaction

- [latestTransaction](../com.apple.storekit/StoreKit/Product/latestTransaction.md)

### Getting subscription information

- [subscription](../com.apple.storekit/StoreKit/Product/subscription.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/Product/SubscriptionPeriod.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)
- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)

### Getting product identifiers and type

- [id](../com.apple.storekit/StoreKit/Product/id.md)
- [type](../com.apple.storekit/StoreKit/Product/type.md)
- [ProductType](../com.apple.storekit/StoreKit/Product/ProductType.md)

### Getting Family Sharing status

- [isFamilyShareable](../com.apple.storekit/StoreKit/Product/isFamilyShareable.md)

### Managing promoted in-app purchases

- [PromotionInfo](../com.apple.storekit/StoreKit/Product/PromotionInfo.md)

### Loading products

- [CollectionTaskState](../com.apple.storekit/StoreKit/Product/CollectionTaskState.md)
- [TaskState](../com.apple.storekit/StoreKit/Product/TaskState.md)

### Getting product info in JSON format

- [jsonRepresentation](../com.apple.storekit/StoreKit/Product/jsonRepresentation.md)

### Getting subscription relationship

- [SubscriptionRelationship](../com.apple.storekit/StoreKit/Product/SubscriptionRelationship.md)

### Deprecated

- [currentEntitlement](../com.apple.storekit/StoreKit/Product/currentEntitlement.md)

## See Also

- [implementing-a-store-in-your-app-using-the-storekit-api](../com.apple.storekit/StoreKit/implementing-a-store-in-your-app-using-the-storekit-api.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/SubscriptionInfo.md)
- [SubscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionStatus.md)

---


## producticonphase

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum ProductIconPhase
```

## 

When you create a [doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase](doc://com.apple.storekit/documentation/StoreKit/ProductIconPhase) instance with an initializer such as [doc://com.apple.storekit/documentation/StoreKit/StoreView/init(ids:icon:placeholderIcon:)](doc://com.apple.storekit/documentation/StoreKit/StoreView/init(ids:icon:placeholderIcon:)), you define the appearance of the view’s icon, or image, using a content closure. SwiftUI calls the closure at different stages of the promotional image’s load operation with a phase value that indicates the current state.

Use the phase to decide what to draw. For example, you can draw a placeholder image during the loading phase, a view that indicates an error, a default image, or the loaded promotional image if it exists:

```swift
StoreView(products: [
     product1,
     product2,
     // Additional products, as needed.
 ]) { product, phase in
     switch phase {
     case .loading: MyPlaceholder()
     case .failure(let error): MyErrorView(error)
     case .unavailable: MyDefaultIcon()
     case .success(let promotedIcon): promotedIcon
     }
 }
```

You set up promotional images for in-app purchases in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

## Topics

### Getting the promotional image’s load phases

- [loading](../com.apple.storekit/StoreKit/ProductIconPhase/loading.md)
- [success(_:)](../com.apple.storekit/StoreKit/ProductIconPhase/success(_:).md)
- [unavailable](../com.apple.storekit/StoreKit/ProductIconPhase/unavailable.md)
- [failure(_:)](../com.apple.storekit/StoreKit/ProductIconPhase/failure(_:).md)

### Getting the promotional image

- [promotionalIcon](../com.apple.storekit/StoreKit/ProductIconPhase/promotionalIcon.md)

### Getting the error

- [error](../com.apple.storekit/StoreKit/ProductIconPhase/error.md)

---


## productview

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct ProductView<Icon, PlaceholderIcon> where Icon : View, PlaceholderIcon : View
```

## 

A `ProductView` shows information about an in-app purchase product, including its localized name, description, and price, and displays a purchase button.

You create a product view by providing a product identifier to load from the App Store, or a [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) value you previously loaded. If you provide a product identifier, the view loads the product’s information from the App Store automatically, and updates the view when the product is available.

You can customize the view by providing a view to use as an icon, or image, for the in-app purchase product. If you provide a product identifier, you can optionally provide a placeholder icon for the system to use instead of the automatic placeholder icon. If you set up promoted images for your products in App Store Connect, you can choose to use those images as the icon.

You can customize the product view’s appearance using the standard styles, including the [doc://com.apple.storekit/documentation/StoreKit/CompactProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/CompactProductViewStyle), [doc://com.apple.storekit/documentation/StoreKit/RegularProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/RegularProductViewStyle), and [doc://com.apple.storekit/documentation/StoreKit/LargeProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/LargeProductViewStyle) styles. Apply the style using the [doc://com.apple.documentation/documentation/SwiftUI/View/productViewStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/productViewStyle(_:)) view modifier.

You can also create your own custom styles by creating styles that conform to the [doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle](doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle) protocol.

## Topics

### Creating product views that load products

- [init(id:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:).md)
- [init(id:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:).md)
- [init(id:prefersPromotionalIcon:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:prefersPromotionalIcon:icon:placeholderIcon:).md)
- [init(id:icon:placeholderIcon:)](../com.apple.storekit/StoreKit/ProductView/init(id:icon:placeholderIcon:).md)

### Creating product views with preloaded products

- [init(_:prefersPromotionalIcon:icon:)](../com.apple.storekit/StoreKit/ProductView/init(_:prefersPromotionalIcon:icon:).md)
- [init(_:prefersPromotionalIcon:)](../com.apple.storekit/StoreKit/ProductView/init(_:prefersPromotionalIcon:).md)
- [init(_:icon:)](../com.apple.storekit/StoreKit/ProductView/init(_:icon:).md)

### Creating product views with a configuration

- [init(_:)](../com.apple.storekit/StoreKit/ProductView/init(_:).md)

### Loading promotional images

- [ProductIconPhase](../com.apple.storekit/StoreKit/ProductIconPhase.md)

### Supporting types

- [AutomaticProductPlaceholderIcon](../com.apple.storekit/StoreKit/AutomaticProductPlaceholderIcon.md)

## See Also

- [StoreView](../com.apple.storekit/StoreKit/StoreView.md)
- [SubscriptionStoreView](../com.apple.storekit/StoreKit/SubscriptionStoreView.md)
- [SubscriptionOfferView](../com.apple.storekit/StoreKit/SubscriptionOfferView.md)
- [Backyard-birds-sample](../com.apple.SwiftUI/Backyard-birds-sample.md)

---


## productviewstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency protocol ProductViewStyle
```

## 

To configure the in-app purchase product style for a view hierarchy, use the [doc://com.apple.documentation/documentation/SwiftUI/View/productViewStyle(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/productViewStyle(_:)) modifier.

To create a custom style, declare a type that conforms to the `ProductViewStyle` protocol. Implement the [doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/ProductViewStyle/makeBody(configuration:)) method to return a view that composes the elements of the configuration that the system provides to your method. The following code example shows how to create a custom product view style:

```swift
struct CustomProductViewStyle: ProductViewStyle {
    func makeBody(configuration: Configuration) -> some View {
        switch configuration.state {
        // Add other cases here.
        case .success(let product):
            VStack(alignment: .center) {
                configuration.icon
                Text(product.displayName)
                Button(product.displayPrice) {}
            }
        }
    }
}

ProductView(id: "com.example.product")
    .productViewStyle(CustomProductViewStyle())
    // Add your code here.
```

## Topics

### Getting built-in product view styles

- [automatic](../com.apple.storekit/StoreKit/ProductViewStyle/automatic.md)
- [compact](../com.apple.storekit/StoreKit/ProductViewStyle/compact.md)
- [large](../com.apple.storekit/StoreKit/ProductViewStyle/large.md)
- [regular](../com.apple.storekit/StoreKit/ProductViewStyle/regular.md)

### Creating custom product views

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/ProductViewStyle/makeBody(configuration:).md)
- [Configuration](../com.apple.storekit/StoreKit/ProductViewStyle/Configuration.md)
- [Body](../com.apple.storekit/StoreKit/ProductViewStyle/Body.md)

### Supporting types

- [AutomaticProductViewStyle](../com.apple.storekit/StoreKit/AutomaticProductViewStyle.md)
- [CompactProductViewStyle](../com.apple.storekit/StoreKit/CompactProductViewStyle.md)
- [RegularProductViewStyle](../com.apple.storekit/StoreKit/RegularProductViewStyle.md)
- [LargeProductViewStyle](../com.apple.storekit/StoreKit/LargeProductViewStyle.md)

## See Also

- [productViewStyle(_:)](../com.apple.SwiftUI/View/productViewStyle(_:).md)
- [productIconBorder()](../com.apple.SwiftUI/View/productIconBorder().md)
- [ProductViewStyleConfiguration](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration.md)

---


## promoting-in-app-purchases

## 

Starting in iOS 11, you can promote in-app purchases on the App Store.

> **NOTE:** To support promoted in-app purchases in apps with a minimum version of iOS 16.4 and later, use [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent). For more information, see [doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-promoted-in-app-purchases-in-your-app).

Promoted in-app purchases appear on your product page, can appear in search results, and can appear as featured items on an appropriate tab on the App Store. Users can start an in-app purchase on the App Store and then transition to your app to continue the transaction. If your app isn’t installed, they receive a prompt to download it.

Promoting in-app purchases requires two steps:

1. In App Store Connect, set up promotions by uploading promotional images. Use the App Store Promotions feature in App Store Connect to manage their order and visibility. For more information about the setup, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).
2. In your app, implement the delegate method [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)) from the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol to handle the purchase.

> **IMPORTANT:** To enable promoted in-app purchases, your app needs to use either [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) (starting in iOS 16.4) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)) (starting in iOS 11). Don’t use both at the same time. If necessary, use conditional compilation to identify the OS version the app is running in. For more information, see [doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version](doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version).

To customize the list of promoted in-app purchases for users, you can override their default order and visibility using [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController). Use overrides to show promotions that are relevant to the user. Overrides are specific to a device, and take effect after the user launches the app at least once. Using [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController) is optional and isn’t required for your in-app purchases to appear on the App Store.

For marketing guidance on this feature, see [https://developer.apple.com/app-store/promoting-in-app-purchases/](https://developer.apple.com/app-store/promoting-in-app-purchases/).

> **NOTE:** Promoted in-app purchases aren’t available to compatible iPad or iPhone apps running in visionOS.

### 

When a user selects an in-app product to purchase on the App Store, StoreKit automatically opens your app and sends the transaction information to the delegate in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol. Your app needs to complete the purchase transaction and any related actions that are specific to it.

In the delegate method, return `true` to continue the transaction, or `false` to defer or cancel it.

If your app isn’t installed when the user selects to purchase the in-app product, the App Store automatically downloads the app or prompts the user to purchase it. If the installed version of your app is an older version that doesn’t support in-app purchase promotions, the App Store prompts the user to upgrade the app.

### 

To continue an in-app purchase transaction, implement the delegate method in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol and return `true`. StoreKit then displays the payment sheet, and the user can complete the transaction.

```swift
//Continuing a transaction from the App Store.

//MARK: - SKPaymentTransactionObserver

func paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment,
        for product: SKProduct) -> Bool {
    // Check to see if you can complete the transaction.
    // Return true if you can.
    return true
}
```

### 

If your app needs to defer or cancel a transaction, return `false`. For example, you may need to defer a transaction if the user is in the middle of onboarding, and continue it after they complete the onboarding. Or, you may need to cancel a transaction if the user has already unlocked the product they’re trying to buy.

To defer a transaction:

1. Save the `payment` to use when the app is ready. The payment already contains information about the product. Don’t create a new [doc://com.apple.storekit/documentation/StoreKit/SKPayment](doc://com.apple.storekit/documentation/StoreKit/SKPayment) with the same product.
2. Return `false`.
3. After the user finishes the onboarding or other actions that require a deferral, send the saved payment to the payment queue as you do with a typical in-app purchase.

To cancel a transaction:

1. Return `false`.
2. Provide feedback to the user. Although this step is optional, if you don’t provide feedback, the app’s lack of action after the user selects to purchase an in-app product in the App Store may seem like a bug.

```swift
//Handling a transaction from the App Store.

//MARK: - SKPaymentTransactionObserver

func paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment,
        for product: SKProduct) -> Bool {

    // Add code here to check if your app needs to defer the transaction.
    let shouldDeferPayment = ...
    // If you need to defer until onboarding is complete, save the payment and return false.
    if shouldDeferPayment {
        self.savedPayment = payment
        return false
    }

    // Add code here to check if your app needs to cancel the transaction.
    let shouldCancelPayment = ...
    // If you need to cancel the transaction, then return false:
    if shouldCancelPayment {
        return false
    }
}

// If you cancel the transaction, provide feedback to the user.

// Continuing a previously deferred payment.
SKPaymentQueue.default().add(savedPayment)
```

### 

To get the visibility settings for a promoted product, call [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/fetchStorePromotionVisibility(for:completionHandler:)), providing the product information.

```swift
// Reading visibility override of a promoted in-app purchase.

// Fetch product info for "Hidden Beaches pack."

let storePromotionController = SKProductStorePromotionController.default()
storePromotionController.fetchStorePromotionVisibility(forProduct: hiddenBeaches,
    completionHandler: { visibility: SKProductSTorePromotionVisiblity, error: Error?) in
        // visibility == .default
})
```

### 

For each device, you can decide whether to make in-app purchases visible or hidden. For example, you may want to hide products the customer already purchased, and show only the products they can buy.

For example, to hide the Pro Subscription product after a user purchases it, fetch the product information and update the store promotion controller with the `.hide` setting, as the following code example shows. The Pro Subscription promoted in-app purchase no longer appears in the App Store on the device.

```swift
// Hide the promoted product Pro Subscription after the user purchases it.

let storePromotionController = SKProductStorePromotionController.default()
storePromotionController.update(storePromotionVisibility: .hide, for: proSubscription,
    completionHandler: { (error: Error?) in
        // Completion.
    })
```

### 

You can customize the promoted in-app purchases on each device by overriding their default order. Use overrides to show promotions that are relevant to the user. For example, you can override the order to promote an in-app purchase that unlocks a level in your game when a user reaches the preceding level.

To override the promotion order, add the product information to an array in the order they are to appear. Pass the array to the [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)) method. The App Store displays the products in the array, followed by the remaining promoted products, which appear in the same relative order that you set in App Store Connect.

```swift
// Overriding the order of promoted in-app purchases.

// Fetch product information for three products: Pro Subscription, Fishing Hot Spots, and Hidden Beaches.
let storePromotionController = SKProductStorePromotionController.default()

// Update the order.
let newProductsOrder = [hiddenBeaches, proSubscription, fishingHotSpots]
storePromotionController.updateStorePromotionOrder(newProductsOrder,
    completionHandler: { (error: Error?) in
        // Complete.
    })
```

### 

To remove overrides and use the default promotion order, send an empty product array to the [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/update(storePromotionOrder:completionHandler:)) method. The App Store then displays the promoted in-app purchase products in the default order that you set in App Store Connect.

### 

To get the product promotion order for the device, call [doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/fetchStorePromotionOrder(completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKProductStorePromotionController/fetchStorePromotionOrder(completionHandler:)). This method returns an array of products that have an overridden order. If you get an empty array, there aren’t any overrides and the products are in the default order.

```swift
// Getting the order override of promoted in-app purchases.

let storePromotionController = SKProductStorePromotionController.default()
storePromotionController.fetchStorePromotionOrder(completionHandler: {
    (products: [SKProduct], error: Error?) in
        // products == [hiddenBeaches, proSubscription, fishingHotSpots]
    })
```

## See Also

- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)
- [SKProductStorePromotionController](../com.apple.storekit/StoreKit/SKProductStorePromotionController.md)

---


## receiving-ad-attributions-and-postbacks

## 

Ad networks receive attributions in the form of install-validation postbacks. Before an ad network can receive a postback, the following events need to occur within limited time-windows:

- Ad networks sign and present ads in the form of StoreKit-rendered ads, view-through ads, or attributable web ads. StoreKit records the ad impressions.
- Users install the advertised app.
- Users launch the app.
- The app updates the conversion values when the user first launches the app, and continues to update it as needed.

If all these events occur within their respective time-windows, the ad impression qualifies for an install-validation postback. The following table shows the time-windows for the events:

| Event | Time-window |
| --- | --- |
| The ad network presents a StoreKit-rendered ad. | The user has 30 days to install the app. |
| The ad network presents a view-through ad. | The user has 24 hours to install the app. |
| The user taps an attributable web ad. | The user has 30 days to install the app. |
| The user installs the app. | The user has 60 days to launch the app. |
| The user launches the app and the app calls any conversion update method, such as [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)), | The device has 60 days after the user installs the app to send the first conversion value update. |
| The user launches the app and the app calls a conversion update method, such as [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:)) for ads signed with version 3 or earlier. | For ads signed with version 3 or earlier, the device sends install-validation postbacks 0–24 hours after a 24-hour timer expires following the final call to update the conversion value. The total delay from the final conversion update to receiving the postback is 24–48 hours. |

The minimum elapsed time between an ad impression and the time the ad network receives an install-validation postback is 24 to 48 hours. To reduce that time to 5 to 10 minutes during testing, see [doc://com.apple.storekit/documentation/StoreKit/testing-ad-attributions-with-a-downloaded-profile](doc://com.apple.storekit/documentation/StoreKit/testing-ad-attributions-with-a-downloaded-profile).

Devices send one or more postbacks depending on the SKAdNetwork and iOS versions:

- For ads signed with SKAdNetwork 1 through 2.2, devices send a single, winning postback.
- Starting in iOS 14.6 for ads signed with version 3.0 or later, devices send a single winning postback, and up to five nonwinning postbacks.
- Starting in iOS 15, devices also send a copy of the winning postback to the advertised app’s developer, if the developer opts in to receive it.
- Starting in iOS 16.1 for ads signed using SKAdNetwork 4, devices can send up to three postbacks for the winning ad attribution, in three conversion windows.

Time-windows for events apply equally to winning and nonwinning postbacks.

### 

When multiple ad impressions qualify for install-validation postbacks, a device sends the winning postback to the ad network based on the following rules:

- In versions 1 through 2.1, the attribution goes to the most recent ad impression.
- Starting in version 2.2, the attribution goes to the most recent ad impression with the highest `fidelity-type` value.

The ad presentation option defines the `fidelity-type` value:

- StoreKit-rendered ads have the highest `fidelity-type` value of `1`.
- View-through ads have a `fidelity-type` value of `0`.

Indicate the `fidelity-type` when you generate the ad signature. Recorded ad impressions with a `fidelity-type` of `1` always take precedence over those with a `fidelity-type` of `0`. For example, if users see a StoreKit-rendered ad followed by a view-through ad for the same app, the StoreKit-rendered ad takes precedence over the view-through ad, despite the view-through ad being more recent. The source app can display StoreKit-rendered ads using  an [doc://com.apple.storekit/documentation/StoreKit/SKOverlay](doc://com.apple.storekit/documentation/StoreKit/SKOverlay) or [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController); the `fidelity-type` value is `1` in either case. For information about the fidelity of ads that an ad network presents on a Safari web page using the [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds) API, see [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds/signature](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds/signature).

In version 3 and later, the system indicates winning postbacks with a `did-win` parameter of value `true`.

### 

Starting in iOS 14.6, devices can send multiple postbacks to ad networks that sign ads using version 3 or later. The system indicates nonwinning postbacks with a `did-win` parameter of value `false`. These postbacks don’t include `conversion-value` or `source-app-id`.

Each ad network can receive only one install-validation postback, winning or not winning. If you receive the winning postback, you don’t receive any nonwinning postbacks even if your ads have multiple qualifying ad impressions.

Up to five ad networks receive one nonwinning postback each. The system orders the recorded ad impressions using recency and `fidelity-type`, with the most recent ad views and highest `fidelity-type` taking precedence. Devices send nonwinning postbacks for the top five ad impressions from different ad networks that qualify for ad attribution.

### 

Starting in iOS 15, devices can send a copy of the winning install-validation postback to the developer of the advertised app. Developers opt in to receive the postback by specifying a server endpoint in their app’s `Info.plist` file. For more information about opting in and specifying the endpoint, see [doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app](doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app).

The postback that developers receive is an exact copy of the winning install-validation postback that the device sends to the ad network. The device sends the postback to developers at the same time it sends the winning postback to the ad network. To verify the postback, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

### 

StoreKit records a maximum of 15 view-through ad impressions per source app before discarding the oldest one. The recorded ad impressions may advertise various products, and are each eligible to become pending attributions until they expire (after 24 hours).

### 

Use the [doc://com.apple.documentation/documentation/StoreKitTest](doc://com.apple.documentation/documentation/StoreKitTest) framework to validate your ad impressions and test your postbacks by creating unit tests. For more information, see [doc://com.apple.documentation/documentation/StoreKitTest/SKAdTestSession](doc://com.apple.documentation/documentation/StoreKitTest/SKAdTestSession) and [doc://com.apple.documentation/documentation/StoreKitTest/testing-and-validating-ad-impression-signatures-and-postbacks-for-skadnetwork](doc://com.apple.documentation/documentation/StoreKitTest/testing-and-validating-ad-impression-signatures-and-postbacks-for-skadnetwork).

## See Also

- [signing-and-providing-ads](../com.apple.storekit/StoreKit/signing-and-providing-ads.md)
- [receiving-postbacks-in-multiple-conversion-windows](../com.apple.storekit/StoreKit/receiving-postbacks-in-multiple-conversion-windows.md)
- [skadnetwork-release-notes](../com.apple.storekit/StoreKit/skadnetwork-release-notes.md)

---


## receiving-and-decoding-external-purchase-tokens

## 

An *external purchase token* is a unique string that your app or website receives when your customer chooses to view your external purchase offerings. You receive external purchase tokens within your app or appended to your website URL, depending on the API you call.

- When you call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) and your app configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) property list key, you receive an external purchase token for custom links (also called a *custom link token*) . For more information about these tokens, see the following section, [doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens#Receive-custom-link-tokens](doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens#Receive-custom-link-tokens).
- When you call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)), and your app configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions) property list key, you receive custom link tokens for a music streaming service.
- When you call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/presentNoticeSheet()) and the response is [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchase/NoticeResult/continuedWithExternalPurchaseToken(token:)), you receive an external purchase token in your app.
- When you call [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open()](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open()) or [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseLink/open(url:)), you receive an external purchase token appended to the current storefront’s destination URL. You configure the URLs in the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLink) or [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseMultiLink) property list keys, respectively.

In all cases, decode the token to obtain its [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId). Use the `externalPurchaseId` to report the token and its associated transactions to Apple using the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/Send-External-Purchase-Report](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/Send-External-Purchase-Report) endpoint of the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

The External Purchase API returns tokens that are specific to the app’s environment, either production or sandbox. Tokens in the sandbox environment have an `externalPurchaseId` value that begins with `SANDBOX`.

### 

The system automatically generates custom link tokens for your customer if your app configures the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) or [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions) property list keys. Your app calls the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) method to receive the tokens. These tokens have two possible token types: `ACQUISITION` and `SERVICES`.

The system automatically generates new custom link tokens when the following qualifying events occur:

| Qualifying event | Custom link tokens |
| --- | --- |
| Customer installs an app for the first time across all of their devices | The system generates both the `ACQUISITION` and `SERVICES` tokens. |
| Customer updates or redownloads an app on any of their devices | If there’s no active `SERVICES` token, the system generates a new `SERVICES` token. |

Custom link tokens have expiration dates. A token is considered *active* during the time between its creation date and expiration date.

Apps can request custom link tokens at any time, for example, when the app launches, or before displaying a store. If there’s an active token period, the system returns the token that corresponds to that active period. The returned token can be identical to the original token, or it can be a *refreshed* token. A refreshed token has the same creation and expiration dates as the original token, but a different [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId).

Use either the original token or a refreshed token to report transactions that occur during the active token period.

> **NOTE:** To report transactions for custom link tokens, you can use any token associated with the customer that is active (not expired) at the time of the transaction.

After a customer’s `ACQUISITION` token expires, the system doesn’t generate another. The `ACQUISITION` token type has only one active token period. After a customer’s `SERVICES` token expires, the system generates a new `SERVICES` token only if a qualifying event occurs, as listed in the table above.

Custom link tokens are available only on devices running iOS 18.1 and later, iPadOS 18.1 and later, macOS 15.1 and later, tvOS 18.1 and later, visionOS 2.1 and later, and watchOS 11.1 and later.

### 

The token your app or website’s server receives is a string that is Base64URL-encoded JSON. Decode the token using Base64URL decoding to read the JSON, which contains the following fields:

The following additional fields apply only to custom link tokens:

The [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/Send-External-Purchase-Report](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/Send-External-Purchase-Report) endpoint requires the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId) field to report tokens and transactions. To get the `externalPurchaseId`, decode the token string using Base64URL decoding.

The following example shows an external purchase token. For a token string that is:

```None
ewoJImFwcEFwcGxlSWQiOjEyMzQ1Njc4OTAsCgkiYnVuZGxlSWQiOiJjb20uZXhhbXBsZSIsCgkidG9rZW5DcmVhdGlvbkRhdGUiOjE3MDYxNjk2MDAwMDAsCgkiZXh0ZXJuYWxQdXJjaGFzZUlkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIgp9
```

The token’s value after Base64URL decoding is the following JSON:

```json
{  
  "appAppleId":1234567890,  
  "bundleId":"com.example",  
  "tokenCreationDate":1706169600000,
  "externalPurchaseId":"00000000-0000-0000-0000-000000000000"
}
```

The following example shows a custom link token with a `SERVICES` token type. The token string is:

```None
eyJhcHBBcHBsZUlkIjoxMjM0NTY3ODkwLCJidW5kbGVJZCI6ImNvbS5leGFtcGxlIiwidG9rZW5DcmVhdGlvbkRhdGUiOjE3NTA4OTYwMDAwMDAsImV4dGVybmFsUHVyY2hhc2VJZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInRva2VuVHlwZSI6IlNFUlZJQ0VTIiwidG9rZW5FeHBpcmF0aW9uRGF0ZSI6MTc4MjQzMjAwMDAwMH0K
```

The custom link token’s value after Base64URL decoding is the following JSON:

```json
{
  "appAppleId": 1234567890,
  "bundleId": "com.example",
  "tokenCreationDate": 1750896000000,
  "externalPurchaseId": "00000000-0000-0000-0000-000000000000",
  "tokenType": "SERVICES", // Present only in custom link tokens
  "tokenExpirationDate": 1782432000000 // Present only in custom link tokens
}
```

### 

The [doc://com.apple.storekit/documentation/StoreKit/external-purchase](doc://com.apple.storekit/documentation/StoreKit/external-purchase) API returns external purchase tokens that are specific to the app’s environment: production or sandbox. You can recognize a token for the sandbox environment by its `externalPurchaseId` property, which always begins with `SANDBOX`.

The following example is an external purchase token that the system created in the sandbox environment. The sandbox token string is:

```None
eyJhcHBBcHBsZUlkIjoxMjM0NTY3ODkwLCJidW5kbGVJZCI6ImNvbS5leGFtcGxlIiwidG9rZW5DcmVhdGlvbkRhdGUiOjE3MDYxNjk2MDAwMDAsImV4dGVybmFsUHVyY2hhc2VJZCI6IlNBTkRCT1hfMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwidG9rZW5UeXBlIjoiU0VSVklDRVMiLCJ0b2tlbkV4cGlyYXRpb25EYXRlIjoxNzA2MTczMjAwMDAwfQo=
```

The token’s JSON content after Base64URL decoding is:

```json
{
    "appAppleId":1234567890,
    "bundleId":"com.example",
    "tokenCreationDate":1706169600000,
    "externalPurchaseId":"SANDBOX_00000000-0000-0000-0000-000000000000"
}
```

The following example is a custom link token with a `SERVICES` token type, that the system created in the sandbox environment. The sandbox token string is:

```None
eyJhcHBBcHBsZUlkIjoxMjM0NTY3ODkwLCJidW5kbGVJZCI6ImNvbS5leGFtcGxlIiwidG9rZW5DcmVhdGlvbkRhdGUiOjE3MzA0NDg3MjAwMDAsImV4dGVybmFsUHVyY2hhc2VJZCI6IlNBTkRCT1hfMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwidG9rZW5UeXBlIjoiU0VSVklDRVMiLCJ0b2tlbkV4cGlyYXRpb25EYXRlIjoxNzMwNDUyMzIwMDAwfQ==
```

The custom link token’s JSON content after Base64URL decoding is:

```json
{
  "appAppleId": 1234567890,
  "bundleId": "com.example",
  "tokenCreationDate": 1706169600000,
  "externalPurchaseId": "SANDBOX_00000000-0000-0000-0000-000000000000",
  "tokenType": "SERVICES", // Present only in custom link tokens
  "tokenExpirationDate": 1706173200000 // Present only in custom link tokens
}
```

Notice that the custom link token has both a creation date and an expiration date. In the sandbox environment, the expiration date is one hour after the creation date. An `ACQUISITION` token has the same format, with a `tokenType` value of `ACQUISITION`.

For more information about testing and receiving custom link tokens in the sandbox environment, see [doc://com.apple.storekit/documentation/StoreKit/testing-transactions-that-use-custom-link-tokens](doc://com.apple.storekit/documentation/StoreKit/testing-transactions-that-use-custom-link-tokens).

---


## receiving-postbacks-in-multiple-conversion-windows

## 

SKAdNetwork supports three conversion windows that may result in up to three postbacks for a winning ad attribution. The conversion window begins when the user first launches the app. The first conversion window spans days 0 to 2; the second window spans days 3 to 7; and the third window spans days 8 to 35. Apps can update conversion values during all three time-windows.

To be eligible to receive multiple postbacks, all participants need to meet the following conditions:

- The ad network needs to sign the ad using SKAdNetwork 4 or later.
- The advertised app needs to call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) or [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:))to update the conversion values during each conversion window.

You may receive a single postback in the following cases:

- If the app’s postback data tier is Tier 0, the system sends only the first postback.
- Nonwinning ad attributions receive only the first postback.
- For ads signed using SKAdNetwork 3 or earlier, you receive only one winning postback.

### 

By default, the system waits until the end of a conversion window to get the final conversion value. Apps can continue to update the conversion value until the end of the conversion window. When the conversion window ends, the system prepares the postback and sends it after a random delay, as the following diagram shows:



The random delay is 24–48 hours for the first postback, and 24–144 hours for the second and third postbacks.

The [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) method provides an option for you to lock in and finalize a conversion value before the conversion window ends. You may choose to lock the conversion value in any or all conversion windows. The diagram below shows an app that locks the conversion value during the second conversion window:



After receiving a locked conversion value, the system immediately prepares the postback and ignores any further conversion value updates in the same conversion window. The system sends the postbacks after the same random delay following the locked conversion: a 24–48-hour delay for the first postback, and a 24–144-hour delay for the second and third postbacks. The system ignores further updates to the conversion value for the remaining time in the same conversion window.

> **NOTE:** The earliest you may receive the first postback is unchanged from version 3 to version 4: the total delay is 24–48 hours after the app updates its final conversion value.

- In version 3, the app finalizes the conversion value when a 24-hour timer expires after the last conversion value update. Then, the device sends the postback after a random 0–24 hour delay, making the earliest postback 24–48 hours after the app sets the final conversion value.
- In version 4, the app may finalize the conversion value by locking it. Then, the device sends the postback after a random 24–48 hour delay.

As a result, both version 3 and 4 have a total delay of 24–48 hours to receive the first postback after the app finalizes the conversion value.

### 

To maintain users’ privacy and ensure crowd anonymity, the device may limit the data that SKAdNetwork sends in postbacks. Apple determines a postback data tier that it assigns to each app download. The following diagram depicts the relationship between the tiers and relative crowd sizes. It’s for illustrative purposes only.



The postback data tier takes into account the crowd size associated with the app or domain displaying the ad, the advertised app, the country the advertised app was installed in, and the hierarchical source identifier that the ad network provides. The system computes the postback data tier for the two-, three-, and four-digit hierarchical source identifiers. It selects the source identifier with the highest postback data tier. If multiple source identifiers share the highest postback data tier, the system selects the source identifier with the most digits. If the highest postback data tier is Tier 1 or Tier 0, the system selects the two-digit source identifier.

The postback data tier affects the following fields in the postback, which may be present or absent, or may contain a limited number of digits:

- `source-identifier`, the hierarchical source identifier that may include two, three, or four digits
- `conversion-value`, a fine-grained conversion value available only in the first postback
- `coarse-conversion-value`, a coarse conversion value, which the system sends instead of the `conversion-value` in lower postback data tiers, and in the second and third postbacks
- `source-app-id` for ads that display in apps, or `source-domain` for attributable web ads
- `country-code`, an optional field representing the country the app was installed in. The system adds this field if the crowd size for a particular country is Tier 3.

The remaining postback data fields aren’t dependent on the postback date tier and appear in all postbacks, based on the SKAdNetwork version of the postback.``

### 

The first conversion window ends two days after the user first launches the app. The system prepares the postback after the conversion window ends, unless you use a lock. If you use a lock, the system prepares the first postback when the app calls [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) with the lock in an enabled state. The system then sends the postback after a random 24–48-hour delay.

The postback data tier determines the data you receive in the first postback, as follows:

For ads in Tier 3, the first postback contains:

- `source-identifier`, the hierarchical source identifier with two, three, or four digits
- `conversion-value`, the fine-grained conversion value, if the app provides one
- `source-app-id` for ads that display in apps, or `source-domain` for attributable web ads
- `country-code`, an optional field representing the country the app was installed in. The system adds this field if the crowd size for a particular country is Tier 3.

For ads in Tier 2, the first postback contains:

- `source-identifier`, the hierarchical source identifier with two, three, or four digits
- `conversion-value`, the fine-grained conversion value, if the app provides one

For ads in Tier 1, the first postback contains:

- `source-identifier`, the hierarchical source identifier with two digits
- `coarse-conversion-value`, a coarse value, if the app provides one

For ads in Tier 0, the first postback contains the `source-identifier`, the hierarchical source identifier, with two digits.

### 

The second conversion window ends seven days after the user first launches the app, and the third conversion window ends after 35 days. The system prepares the second and third postbacks after their conversion windows end, and sends them after a random 24–144-hour delay.

If you use a lock with the second or third conversion value updates, the system prepares the postback when you call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) with the lock in an enabled state. The system sends the postback after a random 24–144-hour delay.

The postback data tier determines the data you receive in the postbacks, as follows:

For ads in Tier 1, Tier 2, and Tier 3, the second and third postbacks contain:

- `source-identifier`, the hierarchical source identifier with two digits
- `coarse-conversion-value`, the coarse conversion value, if the app provides one

For ads in Tier 0, the system doesn’t send a second or third postback.

Ads signed with version 4 and later are eligible for second and third postbacks after a winning ad impression. Ads signed with version 3 and earlier are eligible for one winning postback.

## See Also

- [signing-and-providing-ads](../com.apple.storekit/StoreKit/signing-and-providing-ads.md)
- [receiving-ad-attributions-and-postbacks](../com.apple.storekit/StoreKit/receiving-ad-attributions-and-postbacks.md)
- [skadnetwork-release-notes](../com.apple.storekit/StoreKit/skadnetwork-release-notes.md)

---


## reducing-involuntary-subscriber-churn

## 

After acquiring new customers for your subscription service, you can minimize subscriber loss, known as churn, by keeping them engaged as active subscribers. However, irregular billing events can occur throughout the lifecycle of a subscription that can impact your customer’s subscription status.

Involuntary churn occurs when users do not intend to leave your service but their subscription fails to renew, usually due to billing issues. Because involuntary churn is not related to customer satisfaction, consider creating a user experience that avoids subscriber loss due to a failed renewal. For business guidance on retaining subscribers, see [https://developer.apple.com/app-store/subscriptions/#keeping-subscribers](https://developer.apple.com/app-store/subscriptions/#keeping-subscribers).

Billing-related issues trigger a subscription to automatically enter a billing retry state, where the App Store attempts to recover the subscription. While the App Store tries to recover these customers, you have the option to prompt users to update their billing information or implement a grace period, or both, to assist in recovery efforts. Enabling a grace period and providing uninterrupted service provides a great customer experience, and avoids interrupting your days of paid service and revenue loss if Apple is able to recover the subscription within the grace period. For information on auto-renewable subscription proceeds and days of paid service, see [https://developer.apple.com/app-store/subscriptions/#revenue-after-one-year](https://developer.apple.com/app-store/subscriptions/#revenue-after-one-year).

### 

If the customer’s billing is invalid, the renewal fails and the user’s subscription enters a billing retry state, where the App Store attempts to collect payment for up to 60 days. This billing retry lowers the rate of involuntary churn and prevents the need to re-acquire subscribers if they churned. If the user is recovered within the 60 days, the new billing date is established on the date of recovery and subsequent renewal dates are based on this new billing date, as shown in the figure below.



For example, if the user’s payment information is no longer valid, the first renewal attempt fails. If you have server-to-server notifications enabled, you receive a server notification of type `DID_FAIL_TO_RENEW`. You can check the `expiration_intent` and `is_in_billing_retry_period` values in the [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) response or [doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt](doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt) object in the server notification to validate the reason for the subscription to lapse and monitor the retry status of the subscription. If the user is recovered during this period, you receive a server notification of types `RENEWAL` and `DID_RECOVER` when the retry is successful. For more information on server-to-server notifications, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications).

> **IMPORTANT:** The `RENEWAL` notification type is scheduled for deprecation. Update any existing code to rely on the identical `DID_RECOVER` notification type instead.

Your app may optionally present in-app messaging that informs users they can avoid losing access to paid service by taking action and resolving their billing error. If you choose to prompt the user, ensure your app’s subscription logic can handle different values of [doc://com.apple.documentation/documentation/AppStoreReceipts/expiration_intent](doc://com.apple.documentation/documentation/AppStoreReceipts/expiration_intent) along with [doc://com.apple.documentation/documentation/AppStoreReceipts/expires_date_ms](doc://com.apple.documentation/documentation/AppStoreReceipts/expires_date_ms), to show the appropriate message. An invalid payment method could be due to a number of things, such as a low balance on a stored value card or an expired credit card. Your app should be ready to react immediately to a billing information update. Your app can deep link customers to the Manage Payments page on their account settings by opening this URL:

```http
https://apps.apple.com/account/billing
```

> **NOTE:** This URL is only supported for iOS and macOS.

For more general guidance on handling subscriptions that enter a billing retry state, see [https://developer.apple.com/videos/play/wwdc2018/705/](https://developer.apple.com/videos/play/wwdc2018/705/). You can also agree to provide a grace period for subscribers in a billing retry state. Billing error recoveries made within the set grace period automatically recover subscribers onto their current billing cycle, also providing revenue continuity.

### 

To avoid interrupting days of paid service, you can enable Billing Grace Period in App Store Connect, which allows subscribers to retain full access to your app’s paid content while Apple attempts to collect payment. For guidance on opting in to enable Billing Grace Period for your app, see [https://help.apple.com/app-store-connect/#/dev58bda3212](https://help.apple.com/app-store-connect/#/dev58bda3212).

Billing Grace Period is applied at the time of a billing error when it’s enabled for subscriptions in the app, and cannot be altered once assigned to a user. Grace period durations are dependent on the subscription period length as follows:

- 3 or 6 days for a weekly subscription
- 3, 16, or 28 days for monthly and longer subscriptions

If you choose to enable Billing Grace Period, ensure that you provide full service for the subscription throughout the grace period. You can check the `grace_period_expires_date_ms` field in the [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary) array of the `verifyReceipt` response or `unified_receipt` object in the server notification to determine the end of this grace period duration. For more information on reducing involuntary churn using a grace period, see [https://developer.apple.com/videos/play/wwdc2019/302/](https://developer.apple.com/videos/play/wwdc2019/302/).

If the user is recovered within this grace period, neither the subscriber’s days of paid service, nor your revenue for auto-renewable subscriptions will be interrupted. Billing error recoveries made after the grace period expires, but within the overall billing retry period, will maintain existing behavior and renew on the recovery date, starting a new billing cycle. Payment for the provided full service during the grace period would not be collected.



When implementing Billing Grace Period, use the [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) JSON response and server-to-server notifications. Consider using `expiration_intent`, `is_in_billing_retry_period`, and `grace_period_expires_date_ms` of the `unified_receipt` object in the server notifications of type `RENEWAL` and `DID_RECOVER` to identify whether the subscription is in a grace period.

The `expiration_intent` value can tell you if a subscription renewal failed due to a billing error, or simply because the user chose to cancel service. You can also see if the App Store is actively trying to recover a subscription by looking for an active `is_in_billing_retry_period flag`.

Consider all scenarios for subscription recovery:

- If the subscription renews before the time specified in `grace_period_expires_date_ms`, the `grace_period_expires_date` fields are removed along with the `is_in_billing_retry_period` indicator. You can look up a past transaction’s `purchase_date_ms` and `expires_date_ms` values to determine if a user’s subscription renewed after a lapse.
- If the subscription renews after the time specified in `grace_period_expires_date_ms` while still in the billing retry state, the `grace_period_expires_date` fields are removed along with the `is_in_billing_retry_period` indicator. You can use the `expires_date_ms` value for a past transaction to determine the lapse period.
- If attempts to renew the subscription fail, the `grace_period_expires_date` fields persist along with a value of `0` for the `auto_renew_status` and `is_in_billing_retry_period` indicators.

### 

When users update their payment information, the App Store immediately attempts to renew the payment. Once the App Store successfully bills the customer in a billing retry state, the App Store notifies your server with notifications of types `RENEWAL` and `DID_RECOVER`, and a new receipt is generated for the successful transaction. A new value appears in the `expires_date_ms` field in the app transaction receipt, based on the date of recovery, to mark the next renewal date of the subscription.

StoreKit adds a new transaction for the renewal to the transaction queue on the device. Your app can check the transaction queue on launch and handle the renewal the same way as any other transaction. If your app is already running when the subscription renews, the transaction observer is not called; your app finds out about the renewal the next time the app launches. Restore service once the subscription is renewed if needed.

## See Also

- [handling-subscriptions-billing](../com.apple.storekit/StoreKit/handling-subscriptions-billing.md)
- [enabling-app-store-server-notifications](../com.apple.storekit/StoreKit/enabling-app-store-server-notifications.md)
- [offering-a-subscription-across-multiple-apps](../com.apple.storekit/StoreKit/offering-a-subscription-across-multiple-apps.md)

---


## registering-an-ad-network

## 

Ad networks provide and cryptographically sign ads that are eligible for ad attribution through SKAdNetwork. Ad networks need to register with Apple before using the SKAdNetwork API.

To register your ad network, go to [https://developer.apple.com/contact/request/ad-network-id/](https://developer.apple.com/contact/request/ad-network-id/), which prompts you to sign in to Apple Developer and opens the request form.

When registering, you:

- Receive your ad network ID.
- Create an elliptic curve cryptographic key pair and share your public key with Apple for signature verification.
- Provide a URL for receiving SKAdNetwork install-validation postback requests.

### 

The ad network ID is a unique lowercased identifier in the format of “`example123.skadnetwork`”. Share your ad network ID with app developers who display your ads. Developers need to include your ad network ID in their app’s information property list to initiate the app install-validation process.

> **IMPORTANT:** Lowercase the ad network ID string; otherwise, the system doesn’t recognize it as valid.

### 

Ad networks use a private cryptographic key to generate a signature for each ad that an app displays. During registration, ad networks create a public-private key pair, and send the public key to Apple. The private key you create uses an Elliptic Curve Digital Signature Algorithm (ECDSA) with a prime256v1 curve.

To create your private key, open Terminal and enter the following command:

```shell
openssl ecparam -name prime256v1 -genkey -noout -out companyname_skadnetwork_private_key.pem
```

In the command, replace `companyname` with the name of your company. For example, the name of the private key file for a company named *Example* is `example_skadnetwork_private_key.pem`.

> **IMPORTANT:** Secure your private keys as you do other credentials, such as passwords. Don’t share your private keys, store keys in a code repository, or include keys in client-side code. Share only your public key.

### 

Next, you create a public key from the private key you created in the previous section. The public key is a PEM-encoded PKCS#8 EC key that uses the prime256v1 curve. In Terminal, enter the following command, again replacing `companyname` with the name of your company:

```shell
openssl ec -in companyname_skadnetwork_private_key.pem -pubout -out companyname_skadnetwork_public_key.pem
```

This command creates the file `companyname_skadnetwork_public_key.pem`, which contains your public key. Run this command any time to generate a copy of your public key file.

Send your public key file to Apple when you register your ad network.

## See Also

- [configuring-a-source-app](../com.apple.storekit/StoreKit/configuring-a-source-app.md)
- [configuring-an-advertised-app](../com.apple.storekit/StoreKit/configuring-an-advertised-app.md)
- [SKAdNetworkItems](../com.apple.BundleResources/Information-Property-List/SKAdNetworkItems.md)
- [NSAdvertisingAttributionReportEndpoint](../com.apple.BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint.md)

---


## requesting-a-payment-from-the-app-store

## 

After you present your app’s store UI, users can make purchases from within your app. When the user chooses a product, your app creates and submits a payment request to the App Store.

Implementing an in-app purchase flow consists of three stages. In the first stage, your app retrieves product information. Then your app requests payment when the user selects a product in your app’s store. Finally, your app delivers the products.



### 

When the user selects a product to buy, create a payment request using the corresponding [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) object and set the quantity if needed, as the code below shows. The product object comes from the array of products that your app’s products request returns, as described in [doc://com.apple.storekit/documentation/StoreKit/fetching-product-information-from-the-app-store](doc://com.apple.storekit/documentation/StoreKit/fetching-product-information-from-the-app-store).

### 

Submit your payment request to the App Store by adding it to the payment queue. If you add a payment object to the queue more than once, the system submits it to the App Store multiple times, charging the user and requiring your app to deliver the product each time.

For each payment request your app submits, it receives a corresponding transaction to process. For more information about transactions and the payment queue, see [doc://com.apple.storekit/documentation/StoreKit/processing-a-transaction](doc://com.apple.storekit/documentation/StoreKit/processing-a-transaction).

For auto-renewable subscriptions, you may submit a payment request with a subscription offer for users you determine eligible to receive an offer. For more information, see [doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app).

## See Also

- [processing-a-transaction](../com.apple.storekit/StoreKit/processing-a-transaction.md)
- [SKPayment](../com.apple.storekit/StoreKit/SKPayment.md)
- [SKMutablePayment](../com.apple.storekit/StoreKit/SKMutablePayment.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)

---


## requesting-access-to-apple-music-library

## 

Your app must obtain permission from the customer before accessing Apple Music Library.

### 

Provide a purpose string or usage description that describes how your app intends to use the user’s iCloud Music library or Apple Music catalog. Add the [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAppleMusicUsageDescription](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAppleMusicUsageDescription) key to your app’s Info.plist. Set its value to a string that explains why your app needs access to Apple Music library. The system displays the string to the user when prompting them for authorization.



> **IMPORTANT:** This key is required for apps that access the user’s music library. Apps crash when the key is absent.

See [doc://com.apple.documentation/documentation/UIKit/requesting-access-to-protected-resources](doc://com.apple.documentation/documentation/UIKit/requesting-access-to-protected-resources) for more details.

### 

The user determines whether apps can play items from the Apple Music catalog or add tracks to their iCloud Music library. They can grant or deny access when your app requests authorization. Because the user can change your app’s authorization status in Settings > Privacy > Media and Apple Music, be sure to call [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController)’s [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/authorizationStatus()](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/authorizationStatus()) before attempting to access their Apple Music library.

If the authorization status i`s` [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined), call [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController)’s [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestAuthorization(_:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestAuthorization(_:)) to prompt the user for access.

The system remembers the user’s answer so that subsequent calls to [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestAuthorization(_:)](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController/requestAuthorization(_:)) don’t prompt them again.

## See Also

- [authorizationStatus()](../com.apple.storekit/StoreKit/SKCloudServiceController/authorizationStatus().md)
- [requestAuthorization(_:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestAuthorization(_:).md)
- [SKCloudServiceAuthorizationStatus](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus.md)

---


## requesting-app-store-reviews

## 

Present your users with a request for an App Store review using [doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction](doc://com.apple.storekit/documentation/StoreKit/RequestReviewAction) to get feedback on your app. Be aware that the system displays the review prompt to a user a maximum of three times within a 365-day period. You can determine when and where your app displays the prompt to request a review. Consider the best places and conditions in your app to show the request, and when it might be appropriate to delay it. Here are some best practices:

- Make the request at a time that doesn’t interrupt what someone is trying to achieve in your app, for example, at the end of a sequence of events that they successfully complete.
- Avoid showing a request for a review immediately when a user launches your app, even if it isn’t the first time it launches.
- Avoid requesting a review as the result of a user action.

Also, remember that people can disable requests for reviews from *ever* appearing on their device.

### 

This sample project demonstrates a simulated three-step process. A person taps the Start Process button, and then taps Continue Process twice, after which the app presents a Process Completed scene. The request for review appears from this scene only.

In addition, the app and its use meets the following conditions before displaying the prompt:

- The app hasn’t shown a review prompt for a version of the app bundle that matches the current bundle version. This ensures that a person doesn’t receive a prompt to review the same version of an app multiple times.
- The person successfully completes the three-step process at least four times. This number is arbitrary and developers can choose something that fits well with how many times someone is likely to complete a process in their apps.
- A person must pause on the Process Completed scene for a few seconds. This requirement limits the possibility of the prompt interrupting them before they move to a different task in the app.

To present a review request, the app reads the [doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/requestReview](doc://com.apple.documentation/documentation/SwiftUI/EnvironmentValues/requestReview) environment value to get an instance of `RequestReviewAction` and calls it as a function:

```swift
@Environment(\.requestReview) private var requestReview
```

The conditions above exist purely to delay the call to `requestReview`, so days, weeks, or even months can elapse without the app prompting a user for a review.

```swift
/// Presents the rating and review request view after a two-second delay.
private func presentReview() {
    Task {
        // Delay for two seconds to avoid interrupting the person using the app.
        try await Task.sleep(for: .seconds(2))
        await requestReview()
    }
}
```

Techniques to delay the call are valuable because they cause an app to show a review request when people are more experienced at using the app and can provide better feedback.

```swift
/*
    The lastVersionPromptedForReview property stores the version of the app that last prompts for a review.
    The app presents the rating and review request view if the person completed the three-step process at least four times and
    its current version is different from the version that last prompted them for review.
*/
if processCompletedCount >= 4, currentAppVersion != lastVersionPromptedForReview {
    presentReview()
        
    // The app already displayed the rating and review request view. Store this current version.
    lastVersionPromptedForReview = currentAppVersion
}
```

In the following code, the app stores the usage data that delays the review request in [doc://com.apple.documentation/documentation/SwiftUI/AppStorage](doc://com.apple.documentation/documentation/SwiftUI/AppStorage):

```swift
/// An identifier for the three-step process the person completes before this app chooses to request a review.
@AppStorage("processCompletedCount") var processCompletedCount = 0

/// The most recent app version that prompts for a review.
@AppStorage("lastVersionPromptedForReview") var lastVersionPromptedForReview = ""
```

In other apps, there might be more appropriate on-device storage options. For more information about best practices for requesting reviews, see [https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews](https://developer.apple.com/design/human-interface-guidelines/ratings-and-reviews) in Human Interface Guidelines.

### 

To enable a person to initiate a review as a result of an action in the UI, the sample code uses a deep link to the App Store page for the app with the query parameter `action=write-review` appended to the URL:

```swift
// Replace the YOURAPPSTOREID value below with the App Store ID for your app.
// You can find the App Store ID in your app's product URL.
let url = "https://apps.apple.com/app/idYOURAPPSTOREID?action=write-review"

guard let writeReviewURL = URL(string: url) else {
    fatalError("Expected a valid URL")
}

openURL(writeReviewURL)
```

## See Also

- [RequestReviewAction](../com.apple.storekit/StoreKit/RequestReviewAction.md)
- [SKStoreReviewController](../com.apple.storekit/StoreKit/SKStoreReviewController.md)

---


## restoring-purchased-products

## 

Customers sometimes need to restore purchased content, such as when they upgrade to a new phone. Include some mechanism in your app, such as a Restore Purchases button, to let them restore their purchases.

> **IMPORTANT:** Don’t automatically restore purchases, especially when your app launches. Restoring purchases prompts for the user’s App Store credentials, which interrupts the flow of your app.

In most cases, you only need to refresh the app receipt and deliver the products on the receipt. The refreshed receipt contains a record of the user’s purchases in the app, from any device the user’s App Store account is logged into. However, an app might require an alternative approach under the given circumstances:

- You use Apple-hosted content — Restore completed transactions to give your app the transaction objects it uses to download the content.
- You need to support your app on devices where the app receipt isn’t available — Restore completed transactions instead.
- Your app uses non-renewing subscriptions — Your app is responsible for the restoration process.

Refreshing a receipt doesn’t create new transactions; it requests the latest copy of the receipt from the App Store. Refresh the receipt only once; refreshing it multiple times in a row has the same result.

Restoring completed transactions creates a new transaction for each previously completed transaction, essentially replaying history for your transaction queue observer. Your app maintains its own state to keep track of why it’s restoring completed transactions and how to handle them. Restoring multiple times creates multiple restored transactions for each completed transaction.

> **NOTE:** If the user attempts to purchase a product that they’ve already purchased, the App Store creates a regular transaction instead of a restore transaction, but the user isn’t charged again for the product. Unlock the content for these transactions the same way you do for original transactions.

Give the user an appropriate level of control over the content that’s downloaded again. For example, don’t automatically download three years of daily newspapers or hundreds of megabytes of game levels at the same time.

### 

Create a receipt refresh request, set a delegate, and start the request. The request supports optional properties for obtaining receipts in various states, such as expired receipts, during testing. For details, see the [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest/init(receiptProperties:)](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest/init(receiptProperties:)) method of [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest).

After the app receipt refreshes, examine it and deliver any additional products, as necessary.

### 

Your app starts restoring completed transactions by calling the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) method of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue). This call sends a request to the App Store to restore all of your app’s completed transactions. If your app sets a value for the [doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername](doc://com.apple.storekit/documentation/StoreKit/SKMutablePayment/applicationUsername) property of its payment requests, use the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:)) method to provide the same information when restoring the transactions.

The App Store generates a new transaction to restore each previously completed transaction. The restored transaction refers to the original transaction. Instances of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction) have an [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/original](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/original) property, and the entries in the receipt have an [doc://com.apple.documentation/documentation/AppStoreReceipts/original_transaction_id](doc://com.apple.documentation/documentation/AppStoreReceipts/original_transaction_id) field value.

> **NOTE:** The date fields have slightly different meanings for restored purchases. For details, see the `purchase_date` and `original_purchase_date` fields in the [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Receipt-data.dictionary/In_app-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Receipt-data.dictionary/In_app-data.dictionary).

StoreKit calls the transaction queue observer with a status of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored) for each restored transaction, as described in [doc://com.apple.storekit/documentation/StoreKit/processing-a-transaction](doc://com.apple.storekit/documentation/StoreKit/processing-a-transaction). The action you take depends on your app’s design.

If your app uses the app receipt and doesn’t have Apple-hosted content, this code isn’t needed because your app doesn’t restore completed transactions. Finish any restored transactions immediately.

If your app uses the app receipt and has Apple-hosted content, let the user select which products to restore before starting the restoration process. During restoration, download the user-selected content before finishing those transactions, and finish any other transactions immediately.

If your app doesn’t use the app receipt, it examines all completed transactions as it restores them. It uses a similar code path to the original purchase logic to make the product available and then finishes the transaction. Apps with more than a few products, especially products with associated content, let the user select which products to restore instead of restoring everything. These apps keep track of which completed transactions to process as they restore them, and which transactions to ignore by finishing them immediately without restoring them.

## See Also

- [SKReceiptRefreshRequest](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)
- [SKTerminateForInvalidReceipt()](../com.apple.storekit/StoreKit/SKTerminateForInvalidReceipt().md)

---


## sending-advanced-commerce-api-requests-from-your-app

## 

You can make certain [doc://com.apple.documentation/documentation/AdvancedCommerceAPI](doc://com.apple.documentation/documentation/AdvancedCommerceAPI) requests through StoreKit in your app, while you make other requests directly from your server.  In both cases, you authorize the calls with signatures you generate on your server.

The following Advanced Commerce API requests are available in your app using StoreKit APIs:

- [doc://com.apple.documentation/documentation/AdvancedCommerceAPI/OneTimeChargeCreateRequest](doc://com.apple.documentation/documentation/AdvancedCommerceAPI/OneTimeChargeCreateRequest)
- [doc://com.apple.documentation/documentation/AdvancedCommerceAPI/SubscriptionCreateRequest](doc://com.apple.documentation/documentation/AdvancedCommerceAPI/SubscriptionCreateRequest)
- [doc://com.apple.documentation/documentation/AdvancedCommerceAPI/SubscriptionModifyInAppRequest](doc://com.apple.documentation/documentation/AdvancedCommerceAPI/SubscriptionModifyInAppRequest)
- [doc://com.apple.documentation/documentation/AdvancedCommerceAPI/SubscriptionReactivateInAppRequest](doc://com.apple.documentation/documentation/AdvancedCommerceAPI/SubscriptionReactivateInAppRequest)

To make Advanced Commerce requests from your app, follow these steps:

1. Collect the request data according to the API you’re invoking.  On your server, create your *base64-encoded request data* by combining the request data into a UTF-8 JSON string and base64-encoding the string.
2. On your server, create a JWS compact serialization that includes your base64-encoded request data in the JWS payload, as described in [doc://com.apple.storekit/documentation/StoreKit/generating-jws-to-sign-app-store-requests#Include-custom-claims-for-Advanced-Commerce-API-in-app-requests](doc://com.apple.storekit/documentation/StoreKit/generating-jws-to-sign-app-store-requests#Include-custom-claims-for-Advanced-Commerce-API-in-app-requests). For more information, see [doc://com.apple.storekit/documentation/StoreKit/generating-jws-to-sign-app-store-requests](doc://com.apple.storekit/documentation/StoreKit/generating-jws-to-sign-app-store-requests).
3. Wrap the JWS in a JSON object, and convert it into a `Data` buffer to create the Advanced Commerce request data object, `advancedCommerceRequestData`.
4. In your app, use the `advancedCommerceRequestData` as the value of a purchase option in your product purchase call.

For more information on authorizing server-based calls, see [doc://com.apple.documentation/documentation/AdvancedCommerceAPI/authorizing-server-calls](doc://com.apple.documentation/documentation/AdvancedCommerceAPI/authorizing-server-calls).

## 

Place the Advanced Commerce request data in a UTF-8 JSON string and base64-encode the request.

For example, the following JSON represents a [doc://com.apple.documentation/documentation/AdvancedCommerceAPI/OneTimeChargeCreateRequest](doc://com.apple.documentation/documentation/AdvancedCommerceAPI/OneTimeChargeCreateRequest) for the purchase of a one-time charge product:

```JSON
{
    "operation": "CREATE_ONE_TIME_CHARGE",
    "version": "1",                     
    "requestInfo": {
        "requestReferenceId": "f55df048-4cd8-4261-b404-b6f813ff70e5"
    },
    "currency": "USD",
    "taxCode": "C003-00-2", 
    "storefront": "USA",
    "item": {
        "SKU": "BOOK_SHERLOCK_HOMLES",
        "displayName": "Sherlock Holmes", 
        "description": "The Sherlock Holmes, 5th Edition",
        "price": 4990
    }
}
```

The result of base64-encoding the example JSON request is:

`ewogICAgIm9wZXJhdGlvbiI6ICJDUkVBVEVfT05FX1RJTUVfQ0hBUkdFIiwKICAgICJ2ZXJzaW9uIjogIjEiLCAgICAgICAgICAgICAgICAgICAgIAogICAgInJlcXVlc3RJbmZvIjogewogICAgICAgICJyZXF1ZXN0UmVmZXJlbmNlSWQiOiAiZjU1ZGYwNDgtNGNkOC00MjYxLWI0MDQtYjZmODEzZmY3MGU1IgogICAgfSwKICAgICJjdXJyZW5jeSI6ICJVU0QiLAogICAgInRheENvZGUiOiAiQzAwMy0wMC0yIiwgCiAgICAic3RvcmVmcm9udCI6ICJVU0EiLAogICAgIml0ZW0iOiB7CiAgICAgICAgIlNLVSI6ICJCT09LX1NIRVJMT0NLX0hPTUxFUyIsCiAgICAgICAgImRpc3BsYXlOYW1lIjogIlNoZXJsb2NrIEhvbG1lcyIsIAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgU2hlcmxvY2sgSG9sbWVzLCA1dGggRWRpdGlvbiIsCiAgICAgICAgInByaWNlIjogNDk5MAogICAgfQp9 `

This value, calculated using your own data, is your *base64-encoded request data*.

## 

Follow the signing instructions for Advanced Commerce API in-app requests in [doc://com.apple.storekit/documentation/StoreKit/generating-jws-to-sign-app-store-requests](doc://com.apple.storekit/documentation/StoreKit/generating-jws-to-sign-app-store-requests). The Advanced Commerce API requires a custom claim, `request`. Provide the base64-encoded request data from the previous step as the value of the `request` claim in the JWS payload.

The result after following the instructions is a *JWS compact serialization*.

## 

Wrap the JWS to create a `signatureInfo` JSON string that contains a `token` key.  You can complete this step on your server or in your app. Create the `signatureInfo` JSON string as shown below:

```JSON
{
    "signatureInfo": {
        "token": "<your JWS compact serialization>"
    }
}
```

Set the value of the `token` key to your JWS compact serialization.

Next, convert the `signatureInfo` JSON string into a `Data` buffer, as shown below:

```swift
let jsonString ="<# your signatureInfo UTF-8 JSON string>"
let advancedCommerceRequestData = Data(jsonString.utf8)
```

The result is the Advanced Commerce request data object, referred to as `advancedCommerceRequestData` in the code snippets.

Securely send the `advancedCommerceRequestData` to your app.

## 

To complete the Advanced Commerce request in the app, call a StoreKit purchase method and provide the signed request, in the Advanced Commerce request data form, as a purchase option.

The following code example sets up the purchase request:

```swift
let purchaseResult = try await product.purchase(
    options: [ 
        Product.PurchaseOption.custom( 
            key: “advancedCommerceData”, 
            value: advancedCommerceRequestData
        )
    ]
)
```

In this example:

- Use the custom key `"advancedCommerceData"` for all Advanced Commerce in-app requests. For more information about the custom purchase option, see [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/custom(key:value:)-80cvh](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseOption/custom(key:value:)-80cvh).
- For the value attribute, provide your Advanced Commerce request data, which you created using your JWS compact serialization
- For more information about the product purchase method, see [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)).

## See Also

- [AdvancedCommerceProduct](../com.apple.storekit/StoreKit/AdvancedCommerceProduct.md)
- [generating-jws-to-sign-app-store-requests](../com.apple.storekit/StoreKit/generating-jws-to-sign-app-store-requests.md)

---


## setting-up-promotional-offers

## 

You can offer a discounted or free period of service for auto-renewable subscription products on macOS, iOS, and tvOS using promotional offers. Limited-time, discounted promotional offers can be effective in winning back lapsed subscribers or retaining current subscribers.

Before you can provide promotional offers in your app, you must first generate a subscription key and set up the offers in your App Store Connect account.

> **NOTE:** If your goal is to attract new users, use introductory offers and promote the in-app purchase on the App Store. Redeeming an introductory offer doesn’t affect a user’s eligibility for a promotional offer. For more information, see [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app).

### 

You generate a private key in App Store Connect that you use on your server to sign promotional offers. This key allows Apple to authenticate and validate subscription requests.

Keys don’t expire, and you can use them with any apps in your account. To get started, [https://help.apple.com/app-store-connect/#/dev689c93225](https://help.apple.com/app-store-connect/#/dev689c93225) in App Store Connect.

#### 

Once you’ve generated your subscription key, you’re given the opportunity to download the private half of the key. You can only download this key one time.

The keys are provided in base64-encoded PEM format. Apple doesn’t keep a copy of the private key.

> **IMPORTANT:** Store your private subscription key in a safe place. You should never share your keys, store keys in a code repository, or include keys in apps or client-side code.

If the key becomes lost or compromised, revoke it immediately and update your promotional offers. See [https://help.apple.com/app-store-connect/#/dev689c93225?sub=dev4587a2b9c](https://help.apple.com/app-store-connect/#/dev689c93225?sub=dev4587a2b9c) for more information.

### 

You configure promotional offers in App Store Connect, providing details such as a reference name, payment mode, duration, and price. To configure your offer, see [https://help.apple.com/app-store-connect/#/dev16dfca448](https://help.apple.com/app-store-connect/#/dev16dfca448). You can have up to 10 promotional offers active at any given time per subscription.

For business guidance on using promotional offers, see [https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers](https://developer.apple.com/app-store/subscriptions/#providing-subscription-offers).

## See Also

- [implementing-promotional-offers-in-your-app](../com.apple.storekit/StoreKit/implementing-promotional-offers-in-your-app.md)
- [generating-a-signature-for-promotional-offers](../com.apple.storekit/StoreKit/generating-a-signature-for-promotional-offers.md)
- [generating-a-promotional-offer-signature-on-the-server](../com.apple.storekit/StoreKit/generating-a-promotional-offer-signature-on-the-server.md)
- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

---


## setting-up-the-transaction-observer-for-the-payment-queue

## 

To process transactions in your app, you need to create and add an observer to the payment queue. The observer object responds to new transactions and synchronizes the queue of pending transactions with the App Store, and the payment queue prompts users to authorize payment. It’s important to add the transaction observer at app launch to ensure you don’t miss payment queue notifications that the system may send when the app launches.

### 

Create and build a custom observer class to handle changes to the payment queue.

```swift
class StoreObserver: NSObject, SKPaymentTransactionObserver {
                ....
    //Initialize the store observer.
    override init() {
        super.init()
        //Other initialization here.
    }

    //Observe transaction updates.
    func paymentQueue(_ queue: SKPaymentQueue,updatedTransactions transactions: [SKPaymentTransaction]) {
        //Handle transaction states here.
    }
                ....
}
```

Create an instance of this observer class to act as the observer of changes to the payment queue.

```swift
let iapObserver = StoreObserver()
```

> **TIP:** Consider creating your observer as a shared instance of the class for global reference in any other class. A shared instance also ensures the lifetime of the object, so that the same instance handles callbacks for the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol.

After you create the transaction observer, you can add it to the payment queue.

### 

StoreKit attaches your observer to the queue when your app calls.

```swift
SKPaymentQueue.default().add(iapObserver)
```

StoreKit can notify your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) instance automatically when the content of the payment queue changes upon resuming or while running your app.

Implement the transaction observer.

```swift
import UIKit
import StoreKit

class AppDelegate: UIResponder, UIApplicationDelegate {
                ....
    // Attach an observer to the payment queue.
    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
        SKPaymentQueue.default().add(iapObserver)
        return true
    }

    // The system calls this when the app is about to terminate.
    func applicationWillTerminate(_ application: UIApplication) {
        // Remove the observer.
        SKPaymentQueue.default().remove(iapObserver)
    }
                ....
}
```

It’s important to add the observer at launch, in [doc://com.apple.documentation/documentation/UIKit/UIApplicationDelegate/application(_:didFinishLaunchingWithOptions:)](doc://com.apple.documentation/documentation/UIKit/UIApplicationDelegate/application(_:didFinishLaunchingWithOptions:)), to ensure that it persists during all launches of your app, receives all payment queue notifications, and continues transactions that may initiate outside the app, such as:

- Promoted in-app purchases. For more information, see [doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases).
- Background subscription renewals
- Interrupted purchases

The observer needs to be persistent so the system doesn’t deallocate it when it sends the app to the background. Only a persistent observer can receive transactions that may occur while your app is in the background, such as a renewal transaction for an auto-renewable subscription.

## See Also

- [add(_:)-5ciz2](../com.apple.storekit/StoreKit/SKPaymentQueue/add(_:)-5ciz2.md)
- [offering-completing-and-restoring-in-app-purchases](../com.apple.storekit/StoreKit/offering-completing-and-restoring-in-app-purchases.md)
- [SKPaymentQueue](../com.apple.storekit/StoreKit/SKPaymentQueue.md)
- [SKPaymentTransactionObserver](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver.md)
- [SKPaymentQueueDelegate](../com.apple.storekit/StoreKit/SKPaymentQueueDelegate.md)
- [SKRequest](../com.apple.storekit/StoreKit/SKRequest.md)

---


## signing-and-providing-ads

## 

SKAdNetwork supports several ways for ad networks to provide ads:

- StoreKit-rendered ads, where StoreKit displays an App Store product page as the ad impression
- View-through ads, where the ad network presents an ad in any format and reports the ad impression using the SKAdNetwork API
- Attributable web ads, where the ad network presents an ad on a Safari web page using the [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds) API

To differentiate StoreKit-rendered ads from view-through ads, SKAdNetwork defines a `fidelity-type` parameter, which you include in the ad signature, and receive in the install-validation postback. Use a `fidelity-type` value of `1` for StoreKit-rendered ads and attributable web ads, and `0` for view-through ads. The following table compares the ad presentation options:

| Ad presentation option | Description | Fidelity type | Availability |
| --- | --- | --- | --- |
| StoreKit-rendered ads | App Store product page that StoreKit renders | `1` | All SKAdNetwork versions |
| View-through ads | Custom, from the ad network | `0` | SKAdNetwork 2.2 and later |
| Attributable web ads (SKAdNetwork for Web Ads) | Custom, from the ad network | `1` | SKAdNetwork 4 and later |

For more information about availability and versions, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

The `fidelity-type` can affect which ad receives attribution when the user experiences multiple ad impressions. For more information about how `fidelity-type` and the time of the ad impression affect attributions, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

Ad networks must cryptographically sign the ads. The signature contains information that includes a campaign identifier. If ads result in conversions, ad networks receive an install-validation postback that includes the campaign identifier. For more information about the postback, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

### 

Follow these steps to display a StoreKit-rendered ad in your app:

1. Set [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) with values that represent the ad impression.
2. On the ad network’s server, generate the signature using those key values. Then, set the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature) key with the signature value. For information about generating the signature, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads).
3. Call [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController/loadProduct(withParameters:completionBlock:)) using your ad network install-validation keys to load the ad.
4. Present the ad in your app according to your app’s design. You can use either an [doc://com.apple.storekit/documentation/StoreKit/SKOverlay](doc://com.apple.storekit/documentation/StoreKit/SKOverlay) or an [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController) to display a StoreKit-rendered ad. The `fidelity-type` value of a StoreKit-rendered ad is `1` in either case.

### 

Follow these steps to provide a view-through ad:

1. Create an [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) instance and set its properties to represent the ad impression.
2. On the ad network’s server, generate the signature based on those properties. Then set the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/signature) property in the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) instance to the generated signature. For more information, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads).
3. Call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)) and then present your custom ad to the user according to your app’s design.
4. Call [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)) when you finish presenting the ad.

### 

Ad networks can sign attributable ads that websites can display in Safari. For more information, see [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds).

## See Also

- [receiving-ad-attributions-and-postbacks](../com.apple.storekit/StoreKit/receiving-ad-attributions-and-postbacks.md)
- [receiving-postbacks-in-multiple-conversion-windows](../com.apple.storekit/StoreKit/receiving-postbacks-in-multiple-conversion-windows.md)
- [skadnetwork-release-notes](../com.apple.storekit/StoreKit/skadnetwork-release-notes.md)

---


## sk_class_final

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SK_CLASS_FINAL
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## sk_extern

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SK_EXTERN
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## sk_extern_class

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SK_EXTERN_CLASS
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## sk_extern_class_available

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SK_EXTERN_CLASS_AVAILABLE(_mac, _ios)
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## sk_extern_class_available_ios

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SK_EXTERN_CLASS_AVAILABLE_IOS(version)
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## sk_extern_class_available_mac

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SK_EXTERN_CLASS_AVAILABLE_MAC(version)
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## skadnetwork-1-release-notes

## 

You’re eligible to receive a version 1.0 postback when any of these conditions are met:

- The source app uses iOS 13.7 SDK or earlier.
- The advertised app is App Store-signed and running on a device with iOS 14 or earlier.

The original install-validation postback doesn’t include a version number. For more information, see [doc://com.apple.storekit/documentation/StoreKit/combining-parameters-for-previous-skadnetwork-postback-versions](doc://com.apple.storekit/documentation/StoreKit/combining-parameters-for-previous-skadnetwork-postback-versions).

When verifying an install-validation postback for version 1.0, use the following Apple P-192 public key:

```None
MEkwEwYHKoZIzj0CAQYIKoZIzj0DAQEDMgAEMyHD625uvsmGq4C43cQ9BnfN2xslVT5V1nOmAMP6qaRRUll3PB1JYmgSm+62sosG
```

For more information, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

### 

This is the original version of SKAdNetwork.

## See Also

- [skadnetwork-4-release-notes](../com.apple.storekit/StoreKit/skadnetwork-4-release-notes.md)
- [skadnetwork-3-release-notes](../com.apple.storekit/StoreKit/skadnetwork-3-release-notes.md)
- [skadnetwork-2-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-2-release-notes.md)
- [skadnetwork-2-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-1-release-notes.md)
- [skadnetwork-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-release-notes.md)

---


## skadnetwork-2-1-release-notes

## 

Use `“2.1”` as the version number when signing ads for this version.

Ad networks are eligible to receive a version 2.1 postback if all three of the following conditions are met:

- The source app generates a signature for version 2.1.
- The source app is built with the iOS 14 SDK or later.
- The advertised app is App Store-signed and running on a device with iOS 14 or later.

### 

New features include:

- SKAdNetwork now signs install-validation postbacks using Apple’s NIST P-256 public key. For more information, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

## See Also

- [skadnetwork-4-release-notes](../com.apple.storekit/StoreKit/skadnetwork-4-release-notes.md)
- [skadnetwork-3-release-notes](../com.apple.storekit/StoreKit/skadnetwork-3-release-notes.md)
- [skadnetwork-2-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-2-release-notes.md)
- [skadnetwork-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-release-notes.md)
- [skadnetwork-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-1-release-notes.md)

---


## skadnetwork-2-2-release-notes

## 

Use `“2.2”` as the version number when signing ads for this version.

Ad networks are eligible to receive a version 2.2 postback if all three of the following conditions are met:

- The source app generates a signature for version 2.2.
- The source app is built with iOS 14.5 SDK or later.
- The advertised app is App Store-signed and running on a device with iOS 14.5 or later.

### 

New features include:

- You can now create view-through ads using the new APIs [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression) , [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/startImpression(_:completionHandler:)), and [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/endImpression(_:completionHandler:)).
- You can now indicate whether an ad is a view-through ad or a StoreKit-rendered ad by using the new `fidelity-type` parameter. The `fidelity-type` value is `0` for view-through ads, and `1` for StoreKit-rendered ads. You include this parameter when you sign an ad, and receive it in the postback.

For more information about view-through ads and `fidelity-type`, see [doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads](doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads) and [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-view-through-ads). For more information about the postback, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

## See Also

- [skadnetwork-4-release-notes](../com.apple.storekit/StoreKit/skadnetwork-4-release-notes.md)
- [skadnetwork-3-release-notes](../com.apple.storekit/StoreKit/skadnetwork-3-release-notes.md)
- [skadnetwork-2-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-1-release-notes.md)
- [skadnetwork-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-release-notes.md)
- [skadnetwork-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-1-release-notes.md)

---


## skadnetwork-2-release-notes

## 

Use `“2.0”` as the version number when signing ads for this version.

Ad networks are eligible to receive a version 2.0 postback if all three of the following conditions are met:

- The source app generates a signature for version 2.0.
- The source app is built with the iOS 14 SDK or later.
- The advertised app is App Store-signed and running on a device with iOS 14 or later.

When verifying an install-validation postback for version 2.0, use the following Apple P-192 public key:

```None
MEkwEwYHKoZIzj0CAQYIKoZIzj0DAQEDMgAEMyHD625uvsmGq4C43cQ9BnfN2xslVT5V1nOmAMP6qaRRUll3PB1JYmgSm+62sosG
```

For more information, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

### 

New features include:

- The advertised app can now provide conversion values. For more information, see [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updateConversionValue(_:)).
- The install-validation postback now contains additional parameters, including the version number, conversion value, source app ID, and redownload value. For more information, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

## See Also

- [skadnetwork-4-release-notes](../com.apple.storekit/StoreKit/skadnetwork-4-release-notes.md)
- [skadnetwork-3-release-notes](../com.apple.storekit/StoreKit/skadnetwork-3-release-notes.md)
- [skadnetwork-2-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-2-release-notes.md)
- [skadnetwork-2-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-1-release-notes.md)
- [skadnetwork-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-1-release-notes.md)

---


## skadnetwork-3-release-notes

## 

Use `“3.0”` as the version number when signing ads for this version.

You’re eligible to receive a version 3.0 postback if all three of the following conditions are met:

- The source app generates a signature for version 3.0.
- The source app is built with iOS 14.6 SDK or later.
- The advertised app is App Store-signed and is running on a device with iOS 14.6 or later.

### 

New features include:

- Devices can now send install-validation postbacks to multiple ad networks that sign their ads using version 3.0. One ad network receives a postback with a `did-win` parameter value of `true` for the ad impression that wins the ad attribution. Up to five other ad networks receive a postback with a `did-win` parameter value of `false` if their ad impressions qualified for, but didn’t win, the attribution.

For more information about signing ads with version 3.0, see [doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads](doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads). For more information about your ad’s eligibility to receive an attribution or a non-winning postback, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks). For details about the postback, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

## See Also

- [skadnetwork-4-release-notes](../com.apple.storekit/StoreKit/skadnetwork-4-release-notes.md)
- [skadnetwork-2-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-2-release-notes.md)
- [skadnetwork-2-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-1-release-notes.md)
- [skadnetwork-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-release-notes.md)
- [skadnetwork-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-1-release-notes.md)

---


## skadnetwork-4-release-notes

## 

Use `“4.0”` as the version number when signing ads for this version.

You’re eligible to receive a version 4 postback if all participants meet the following conditions:

- The ad network generates an ad signature for version 4.
- For ads that appear in an app, the app is built with iOS 16.1 SDK or later. For web ads, the ad appears in Safari 16.1 or later.
- The advertised app is App Store-signed and is running on a device with iOS 16.1 or later.

Advertised apps built with iOS 16.1 SDK or later can register up to three conversions that result in postbacks for the winning ad impression. Apps built with earlier SDKs can register only one conversion, resulting in one winning postback.

### 

- Multiple postbacks. SKAdNetwork now supports multiple conversions in three conversion windows. When you call the new methods [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)) and [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)), the app can update conversion values in three separate conversion windows. The app may send up to three postbacks for the winning ad attribution.

You can lock a conversion during a conversion window to receive the postback sooner by calling [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)) and setting the lock to `true`. Otherwise, the system sends postbacks after the conversion window closes. For more information about postback timing, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks). For more information about multiple postbacks, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

- Coarse conversion values. The conversion value that you send can include both a fine-grained value and a coarse-grained value. For information about coarse conversion values, see [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/CoarseConversionValue). You provide the fine and coarse conversion values in the new methods [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:)) and [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)).
- Hierarchical source identifiers. Ad networks can now provide hierarchical source identifiers when they sign an ad, which replaces and expands on campaign identifiers. The source identifer is a four-digit integer, which you indicate in [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier) for view-through ads and in [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier) for StoreKit-rendered ads. Winning postbacks contain two, three, or four digits of the source identifier, depending on the ad impression’s privacy threshold tier.
- Attributed ads on the web. [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds) supports attributed ads that you initiate on Safari web pages.

## See Also

- [skadnetwork-3-release-notes](../com.apple.storekit/StoreKit/skadnetwork-3-release-notes.md)
- [skadnetwork-2-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-2-release-notes.md)
- [skadnetwork-2-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-1-release-notes.md)
- [skadnetwork-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-release-notes.md)
- [skadnetwork-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-1-release-notes.md)

---


## skadnetwork-release-notes

## 

Use the most recent version of SKAdNetwork available.

In version 2.0 and later, ad networks use a version number when signing ads. For StoreKit-rendered ads, you set the version number in the [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkVersion](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkVersion) parameter. For view-through ads, you set the version number in the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/version) property.

When you receive an install-validation postback, it contains the version number. Each version of SKAdNetwork has specific instructions for signing ads and validating the postback.

Developers of advertised apps are eligible to receive copies of winning postbacks, versions 2 and later, if the participants meet the following conditions:

- The developer of the advertised app opts-in to receive postbacks. For instructions on opting-in, see [doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app](doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app).
- The device is running iOS 15 or later.

## Topics

### SKAdNetwork versions

- [skadnetwork-4-release-notes](../com.apple.storekit/StoreKit/skadnetwork-4-release-notes.md)
- [skadnetwork-3-release-notes](../com.apple.storekit/StoreKit/skadnetwork-3-release-notes.md)
- [skadnetwork-2-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-2-release-notes.md)
- [skadnetwork-2-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-1-release-notes.md)
- [skadnetwork-2-release-notes](../com.apple.storekit/StoreKit/skadnetwork-2-release-notes.md)
- [skadnetwork-1-release-notes](../com.apple.storekit/StoreKit/skadnetwork-1-release-notes.md)

## See Also

- [signing-and-providing-ads](../com.apple.storekit/StoreKit/signing-and-providing-ads.md)
- [receiving-ad-attributions-and-postbacks](../com.apple.storekit/StoreKit/receiving-ad-attributions-and-postbacks.md)
- [receiving-postbacks-in-multiple-conversion-windows](../com.apple.storekit/StoreKit/receiving-postbacks-in-multiple-conversion-windows.md)

---


## skadnetwork

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
class SKAdNetwork
```

## 

> **IMPORTANT:** Use [doc://com.apple.documentation/documentation/AdAttributionKit](doc://com.apple.documentation/documentation/AdAttributionKit) for app ad campaigns on the App Store and alternative marketplaces. See the [https://developer.apple.com/app-store/ad-attribution/](https://developer.apple.com/app-store/ad-attribution/) for information on how AdAttributionKit helps advertisers measure the success of ad campaigns while helping maintain user privacy. For information on interoperability between SKAdNetwork and AdAttributionKit, see [doc://com.apple.documentation/documentation/AdAttributionKit/adattributionkit-skadnetwork-interoperability](doc://com.apple.documentation/documentation/AdAttributionKit/adattributionkit-skadnetwork-interoperability).

The ad network API helps advertisers measure the success of ad campaigns while maintaining user privacy. The API involves three participants:

- *Ad networks* that sign ads and receive install-validation postbacks after ads result in conversions
- *Source apps* that display ads from the ad networks, or websites that display the ads in Safari
- *Advertised apps* that update conversion values as people engage with the app

Ad networks register with Apple to get an ad network ID and to use the API. Developers configure their apps to accept attributable ads from ad networks, and to receive copies of winning postbacks. For information about setup, see [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network), [doc://com.apple.storekit/documentation/StoreKit/configuring-a-source-app](doc://com.apple.storekit/documentation/StoreKit/configuring-a-source-app), and [doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app](doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app). For information about displaying ads in Safari, see [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds).

The following diagram shows the path of an ad impression that wins ad attribution. The ad network serves an ad that an app or Safari web page displays. A user taps the ad and downloads the advertised app.



Apple determines a postback data tier for the app download, and the device uses the tier later to determine the level of detail the postback can contain to ensure crowd anonymity. For more information about the postback contents and the data tiers, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

If the user launches the app within an attribution time-window, the ad impression is eligible for install-attribution postbacks. As the user engages with the app, the app updates the conversion value. Starting in iOS 16.1, apps can update conversion values during three conversion windows, which results in up to three postbacks for an ad signed using version 4. The system sends the postbacks to the ad network, and to the app’s developer if they opt in to receive postbacks.

Devices send install-validation postbacks to multiple ad networks that sign their ads using version 3 or later.

- One ad network receives a postback with a `did-win` parameter value of `true` for the ad impression that wins the ad attribution.
- Up to five other ad networks receive a postback with a `did-win` parameter value of `false` if their ad impressions qualify for the attribution, but don’t win.

The following diagram shows the path of ad impressions that qualify for, but don’t win, the ad attribution. Up to five ad networks receive a single nonwinning postback.



For more information about receiving ad attributions, including time-window details and other constraints, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks).

The information in the postback that Apple cryptographically signs doesn’t include user- or device-specific data. It may include values from the ad network and the advertised app if providing those values meets Apple’s privacy threshold. For more information about postback values and postback data tiers, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows). For more information about the contents of postbacks for each SKAdNetwork version, see [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

### 

Each participant has specific responsibilities when using the ad network APIs to present ads and receive attribution.

The ad network’s responsibilities are to:

- Register and provide its ad network identifier to developers. See [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network).
- Serve signed ads to the source app. See [doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads](doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads).
- Serve signed ads for display in Safari web pages. See the [doc://com.apple.documentation/documentation/SKAdNetworkforWebAds](doc://com.apple.documentation/documentation/SKAdNetworkforWebAds) API.
- Receive install-validation postbacks at the URL it establishes during registration.
- Verify the postbacks. See [doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback](doc://com.apple.storekit/documentation/StoreKit/verifying-an-install-validation-postback).

The source app’s responsibilities are to:

- Add the ad network identifiers to its `Info.plist` file. See [doc://com.apple.storekit/documentation/StoreKit/configuring-a-source-app](doc://com.apple.storekit/documentation/StoreKit/configuring-a-source-app).
- Display ads that the ad network signs. See [doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads](doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads).

The advertised app’s responsibilities are to:

- Register an app installation by updating the conversion value when the user first launches the app by calling one of the conversion updating methods, such as [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)).
- Optionally, continue to update the conversion value as the user engages with the app, by calling one of the conversion updating methods, such as [doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](doc://com.apple.storekit/documentation/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)).
- Optionally, specify a server URL in its `Info.plist` file to receive a copy of the winning install-validation postback. See [doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app](doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app).

Apple designs SKAdNetwork APIs to maintain user privacy. Apps don’t need to use [doc://com.apple.documentation/documentation/AppTrackingTransparency](doc://com.apple.documentation/documentation/AppTrackingTransparency) before calling SKAdNetwork APIs, and can call these APIs regardless of their tracking authorization status. For more information about privacy, see [https://developer.apple.com/app-store/user-privacy-and-data-use/](https://developer.apple.com/app-store/user-privacy-and-data-use/).

> **NOTE:** The SKAdNetwork APIs have no effect, return empty strings, or return values that indicate unavailability when you call the APIs from a compatible iPad or iPhone app running in macOS or visionOS, from a Mac app built with Mac Catalyst, or from an App Clip’s code. For more information about App Clips, see [doc://com.apple.documentation/documentation/AppClip](doc://com.apple.documentation/documentation/AppClip).

## Topics

### Essentials

- [signing-and-providing-ads](../com.apple.storekit/StoreKit/signing-and-providing-ads.md)
- [receiving-ad-attributions-and-postbacks](../com.apple.storekit/StoreKit/receiving-ad-attributions-and-postbacks.md)
- [receiving-postbacks-in-multiple-conversion-windows](../com.apple.storekit/StoreKit/receiving-postbacks-in-multiple-conversion-windows.md)
- [skadnetwork-release-notes](../com.apple.storekit/StoreKit/skadnetwork-release-notes.md)

### Registering ad networks and configuring apps

- [registering-an-ad-network](../com.apple.storekit/StoreKit/registering-an-ad-network.md)
- [configuring-a-source-app](../com.apple.storekit/StoreKit/configuring-a-source-app.md)
- [configuring-an-advertised-app](../com.apple.storekit/StoreKit/configuring-an-advertised-app.md)
- [SKAdNetworkItems](../com.apple.BundleResources/Information-Property-List/SKAdNetworkItems.md)
- [NSAdvertisingAttributionReportEndpoint](../com.apple.BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint.md)

### Signing StoreKit-rendered ads

- [generating-the-signature-to-validate-storekit-rendered-ads](../com.apple.storekit/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads.md)
- [ad-network-install-validation-keys](../com.apple.storekit/StoreKit/ad-network-install-validation-keys.md)

### Signing view-through ads

- [generating-the-signature-to-validate-view-through-ads](../com.apple.storekit/StoreKit/generating-the-signature-to-validate-view-through-ads.md)
- [SKAdImpression](../com.apple.storekit/StoreKit/SKAdImpression.md)
- [startImpression(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/startImpression(_:completionHandler:).md)
- [endImpression(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/endImpression(_:completionHandler:).md)

### Providing conversion information

- [updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:lockWindow:completionHandler:).md)
- [updatePostbackConversionValue(_:coarseValue:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:coarseValue:completionHandler:).md)
- [CoarseConversionValue](../com.apple.storekit/StoreKit/SKAdNetwork/CoarseConversionValue.md)
- [updatePostbackConversionValue(_:completionHandler:)](../com.apple.storekit/StoreKit/SKAdNetwork/updatePostbackConversionValue(_:completionHandler:).md)

### Verifying postbacks

- [verifying-an-install-validation-postback](../com.apple.storekit/StoreKit/verifying-an-install-validation-postback.md)
- [identifying-the-parameters-in-install-validation-postbacks](../com.apple.storekit/StoreKit/identifying-the-parameters-in-install-validation-postbacks.md)

### Testing ad attributions and postbacks

- [testing-ad-attributions-with-a-downloaded-profile](../com.apple.storekit/StoreKit/testing-ad-attributions-with-a-downloaded-profile.md)
- [testing-and-validating-ad-impression-signatures-and-postbacks-for-skadnetwork](../com.apple.StoreKitTest/testing-and-validating-ad-impression-signatures-and-postbacks-for-skadnetwork.md)

### Deprecated

- [registerAppForAdNetworkAttribution()](../com.apple.storekit/StoreKit/SKAdNetwork/registerAppForAdNetworkAttribution().md)
- [updateConversionValue(_:)](../com.apple.storekit/StoreKit/SKAdNetwork/updateConversionValue(_:).md)

## See Also

- [adattributionkit-skadnetwork-interoperability](../com.apple.AdAttributionKit/adattributionkit-skadnetwork-interoperability.md)
- [SKAdImpression](../com.apple.storekit/StoreKit/SKAdImpression.md)

---


## skarcadeservice

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
class SKArcadeService
```

## Topics

### Type Methods

- [arcadeSubscriptionStatus(withNonce:resultHandler:)](../com.apple.storekit/StoreKit/SKArcadeService/arcadeSubscriptionStatus(withNonce:resultHandler:).md)
- [registerArcadeAppWithRandom(fromLib:randomFromLibLength:resultHandler:)](../com.apple.storekit/StoreKit/SKArcadeService/registerArcadeAppWithRandom(fromLib:randomFromLibLength:resultHandler:).md)
- [repairArcadeApp()](../com.apple.storekit/StoreKit/SKArcadeService/repairArcadeApp().md)

## See Also

- [offering-apple-music-subscription-in-your-app](../com.apple.storekit/StoreKit/offering-apple-music-subscription-in-your-app.md)
- [SKCloudServiceSetupOptionsKey](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey.md)
- [load(options:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:).md)

---


## skcloudserviceauthorizationstatus

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
enum SKCloudServiceAuthorizationStatus
```

## Topics

### Constants

- [notDetermined](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/notDetermined.md)
- [denied](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/denied.md)
- [restricted](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/restricted.md)
- [authorized](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/authorized.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus/init(rawValue:).md)

## See Also

- [requesting-access-to-apple-music-library](../com.apple.storekit/StoreKit/requesting-access-to-apple-music-library.md)
- [authorizationStatus()](../com.apple.storekit/StoreKit/SKCloudServiceController/authorizationStatus().md)
- [requestAuthorization(_:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestAuthorization(_:).md)

---


## skcloudservicecapabilitiesdidchangenotification

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
extern NSNotificationName const SKCloudServiceCapabilitiesDidChangeNotification;
```

## See Also

- [SKStorefrontIdentifierDidChangeNotification](../com.apple.storekit/StoreKit/SKStorefrontIdentifierDidChangeNotification.md)
- [SKStorefrontCountryCodeDidChangeNotification](../com.apple.storekit/StoreKit/SKStorefrontCountryCodeDidChangeNotification.md)

---


## skcloudservicecontroller

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
class SKCloudServiceController
```

## 

Use an [doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController](doc://com.apple.storekit/documentation/StoreKit/SKCloudServiceController) object to determine the current capabilities of a customer’s Music library, like whether the device allows playback of Apple Music catalog tracks and the addition of tracks to the library.

## Topics

### Getting authorization to access the Music library

- [requesting-access-to-apple-music-library](../com.apple.storekit/StoreKit/requesting-access-to-apple-music-library.md)
- [authorizationStatus()](../com.apple.storekit/StoreKit/SKCloudServiceController/authorizationStatus().md)
- [requestAuthorization(_:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestAuthorization(_:).md)
- [SKCloudServiceAuthorizationStatus](../com.apple.storekit/StoreKit/SKCloudServiceAuthorizationStatus.md)

### Determining capabilities

- [determining-a-person-s-apple-music-capabilities](../com.apple.storekit/StoreKit/determining-a-person-s-apple-music-capabilities.md)
- [requestUserToken(forDeveloperToken:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestUserToken(forDeveloperToken:completionHandler:).md)
- [requestStorefrontCountryCode(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontCountryCode(completionHandler:).md)
- [requestCapabilities(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestCapabilities(completionHandler:).md)
- [SKCloudServiceCapability](../com.apple.storekit/StoreKit/SKCloudServiceCapability.md)
- [requestStorefrontIdentifier(completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestStorefrontIdentifier(completionHandler:).md)
- [requestPersonalizationToken(forClientToken:withCompletionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceController/requestPersonalizationToken(forClientToken:withCompletionHandler:).md)

### Notifications

- [SKStorefrontIdentifierDidChange](../com.apple.Foundation/NSNotification/Name-swift.struct/SKStorefrontIdentifierDidChange.md)
- [SKCloudServiceCapabilitiesDidChange](../com.apple.Foundation/NSNotification/Name-swift.struct/SKCloudServiceCapabilitiesDidChange.md)
- [SKStorefrontCountryCodeDidChange](../com.apple.Foundation/NSNotification/Name-swift.struct/SKStorefrontCountryCodeDidChange.md)

## See Also

- [SKCloudServiceSetupViewController](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController.md)

---


## skcloudservicesetupmessageidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
struct SKCloudServiceSetupMessageIdentifier
```

## Topics

### Initializing Identifiers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/init(rawValue:).md)

### Message Identifiers

- [addMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/addMusic.md)
- [connect](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/connect.md)
- [join](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/join.md)
- [playMusic](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier/playMusic.md)

## See Also

- [action](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/action.md)
- [SKCloudServiceSetupAction](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction.md)
- [iTunesItemIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/iTunesItemIdentifier.md)
- [affiliateToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [messageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier.md)

---


## skcloudservicesetupoptionskey

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
struct SKCloudServiceSetupOptionsKey
```

## Topics

### Initializing

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/init(rawValue:).md)

### Indicating Setup Options

- [action](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/action.md)
- [SKCloudServiceSetupAction](../com.apple.storekit/StoreKit/SKCloudServiceSetupAction.md)
- [iTunesItemIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/iTunesItemIdentifier.md)
- [affiliateToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/affiliateToken.md)
- [campaignToken](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/campaignToken.md)
- [messageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupOptionsKey/messageIdentifier.md)
- [SKCloudServiceSetupMessageIdentifier](../com.apple.storekit/StoreKit/SKCloudServiceSetupMessageIdentifier.md)

## See Also

- [offering-apple-music-subscription-in-your-app](../com.apple.storekit/StoreKit/offering-apple-music-subscription-in-your-app.md)
- [load(options:completionHandler:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController/load(options:completionHandler:).md)
- [SKArcadeService](../com.apple.storekit/StoreKit/SKArcadeService.md)

---


## skcloudservicesetupviewcontrollerdelegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst

```swift
protocol SKCloudServiceSetupViewControllerDelegate : NSObjectProtocol
```

## Topics

### Receiving Notification of Dismissal

- [cloudServiceSetupViewControllerDidDismiss(_:)](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewControllerDelegate/cloudServiceSetupViewControllerDidDismiss(_:).md)

## See Also

- [delegate](../com.apple.storekit/StoreKit/SKCloudServiceSetupViewController/delegate.md)

---


## skdownload

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, watchOS

```swift
class SKDownload
```

## 

When you create a product in App Store Connect, you can associate one or more pieces of downloadable content with it. At runtime, when a product is purchased by a user, your app uses [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects to download the content from the App Store.

Your app never directly creates a [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) object. Instead, after a payment is processed, your app reads the transaction object’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/downloads](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/downloads) property to retrieve an array of [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) objects associated with the transaction.

To download the content, you queue a download object on the payment queue and wait for the content to be downloaded. After a download completes, read the download object’s [doc://com.apple.storekit/documentation/StoreKit/SKDownload/contentURL](doc://com.apple.storekit/documentation/StoreKit/SKDownload/contentURL) property to get a URL to the downloaded content. Your app must process the downloaded file before completing the transaction. For example, it might copy the file into a directory whose contents are persistent. When all downloads are complete, you finish the transaction. After the transaction is finished, the download objects cannot be queued to the payment queue and any URLs to the downloaded content are invalid.

## Topics

### Getting Content Information

- [expectedContentLength](../com.apple.storekit/StoreKit/SKDownload/expectedContentLength.md)
- [contentIdentifier](../com.apple.storekit/StoreKit/SKDownload/contentIdentifier.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKDownload/contentVersion.md)
- [transaction](../com.apple.storekit/StoreKit/SKDownload/transaction.md)
- [contentLength](../com.apple.storekit/StoreKit/SKDownload/contentLength.md)

### Getting State Information

- [state](../com.apple.storekit/StoreKit/SKDownload/state.md)
- [progress](../com.apple.storekit/StoreKit/SKDownload/progress.md)
- [timeRemaining](../com.apple.storekit/StoreKit/SKDownload/timeRemaining.md)
- [SKDownloadTimeRemainingUnknown](../com.apple.storekit/StoreKit/SKDownloadTimeRemainingUnknown.md)
- [SKDownloadState](../com.apple.storekit/StoreKit/SKDownloadState.md)
- [downloadState](../com.apple.storekit/StoreKit/SKDownload/downloadState.md)

### Accessing a Completed Download

- [error](../com.apple.storekit/StoreKit/SKDownload/error.md)
- [contentURL](../com.apple.storekit/StoreKit/SKDownload/contentURL.md)

### Managing Downloaded Content

- [contentURL(forProductID:)](../com.apple.storekit/StoreKit/SKDownload/contentURL(forProductID:).md)
- [deleteContent(forProductID:)](../com.apple.storekit/StoreKit/SKDownload/deleteContent(forProductID:).md)

## See Also

- [unlocking-purchased-content](../com.apple.storekit/StoreKit/unlocking-purchased-content.md)
- [persisting-a-purchase](../com.apple.storekit/StoreKit/persisting-a-purchase.md)
- [finishing-a-transaction](../com.apple.storekit/StoreKit/finishing-a-transaction.md)

---


## skdownloaderextension

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
@protocol SKDownloaderExtension <BAManagedDownloaderExtension>
```

## 

You can optionally implement the inherited `BAManagedDownloaderExtension` requirements, but don’t implement any of the inherited `BADownloaderExtension` requirements. For more information, see [doc://com.apple.documentation/documentation/BackgroundAssets](doc://com.apple.documentation/documentation/BackgroundAssets).

---


## skerrordomain

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let SKErrorDomain: String
```

## See Also

- [handling-errors](../com.apple.storekit/StoreKit/handling-errors.md)
- [Code](../com.apple.storekit/StoreKit/SKError/Code.md)
- [SKError](../com.apple.storekit/StoreKit/SKError.md)

---


## sklocalizedstring

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define SKLocalizedString(x)
```

## See Also

- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)
- [StoreKitBundle](../com.apple.storekit/StoreKit/StoreKitBundle.md)

---


## skmutablepayment

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKMutablePayment
```

## 

A mutable payment object identifies a product and the quantity of that item the user would like to purchase.

When a mutable payment is added to the payment queue, the payment queue copies the contents into an immutable request before queueing the request. Your app can safely change the contents of the mutable payment object.

## Topics

### Getting and Setting Attributes

- [productIdentifier](../com.apple.storekit/StoreKit/SKMutablePayment/productIdentifier.md)
- [quantity](../com.apple.storekit/StoreKit/SKMutablePayment/quantity.md)
- [requestData](../com.apple.storekit/StoreKit/SKMutablePayment/requestData.md)
- [applicationUsername](../com.apple.storekit/StoreKit/SKMutablePayment/applicationUsername.md)

### Simulating Buy for Testing

- [simulatesAskToBuyInSandbox](../com.apple.storekit/StoreKit/SKMutablePayment/simulatesAskToBuyInSandbox.md)

### Getting and Setting Discount Details

- [paymentDiscount](../com.apple.storekit/StoreKit/SKMutablePayment/paymentDiscount.md)

## See Also

- [requesting-a-payment-from-the-app-store](../com.apple.storekit/StoreKit/requesting-a-payment-from-the-app-store.md)
- [processing-a-transaction](../com.apple.storekit/StoreKit/processing-a-transaction.md)
- [SKPayment](../com.apple.storekit/StoreKit/SKPayment.md)
- [SKPaymentTransaction](../com.apple.storekit/StoreKit/SKPaymentTransaction.md)

---


## skoverlay

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
class SKOverlay
```

## 

By displaying an overlay, you can recommend another app to users and enable them to download it immediately. To recommend media that’s not an app, or to display a product page within your app, use [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductViewController).

> **IMPORTANT:** If you display an overlay in your App Clip, you may only recommend the App Clip’s corresponding full app and need to initialize the overlay with an [doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppClipConfiguration](doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppClipConfiguration) object. For more information, see [doc://com.apple.documentation/documentation/AppClip/recommending-your-app-to-app-clip-users](doc://com.apple.documentation/documentation/AppClip/recommending-your-app-to-app-clip-users).

If you’re using SwiftUI, make use of the `appStoreOverlay(isPresented:configuration:)` modifier. For example usage, see [doc://com.apple.documentation/documentation/AppClip/fruta-building-a-feature-rich-app-with-swiftui](doc://com.apple.documentation/documentation/AppClip/fruta-building-a-feature-rich-app-with-swiftui).

To display an App Store overlay in an app that uses [doc://com.apple.documentation/documentation/UIKit](doc://com.apple.documentation/documentation/UIKit):

1. Create an [doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppConfiguration](doc://com.apple.storekit/documentation/StoreKit/SKOverlay/AppConfiguration) with the iTunes identifier of the app you want to recommend.
2. Initialize `SKOverlay` with the configuration object.
3. Present the overlay.

The following code displays an overlay at the bottom of the visible scene:

```swift
func displayOverlay() {
    guard let scene = view.window?.windowScene else { return }

    let config = SKOverlay.AppConfiguration(appIdentifier: "The iTunes identifier of another app.", position: .bottom)
    let overlay = SKOverlay(configuration: config)
    overlay.present(in: scene)
}
```

To respond to the overlay’s appearance, dismissal, or failure to load, set the [doc://com.apple.storekit/documentation/StoreKit/SKOverlay/delegate](doc://com.apple.storekit/documentation/StoreKit/SKOverlay/delegate) and implement the methods defined in [doc://com.apple.storekit/documentation/StoreKit/SKOverlayDelegate](doc://com.apple.storekit/documentation/StoreKit/SKOverlayDelegate).

> **NOTE:** App extensions can’t display an overlay.

## Topics

### Creating an overlay

- [init(configuration:)](../com.apple.storekit/StoreKit/SKOverlay/init(configuration:).md)
- [configuration-swift.property](../com.apple.storekit/StoreKit/SKOverlay/configuration-swift.property.md)
- [AppConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppConfiguration.md)
- [AppClipConfiguration](../com.apple.storekit/StoreKit/SKOverlay/AppClipConfiguration.md)
- [Configuration-swift.class](../com.apple.storekit/StoreKit/SKOverlay/Configuration-swift.class.md)

### Presenting an overlay

- [present(in:)](../com.apple.storekit/StoreKit/SKOverlay/present(in:).md)

### Dismissing an overlay

- [dismiss(in:)](../com.apple.storekit/StoreKit/SKOverlay/dismiss(in:).md)

### Setting a delegate

- [delegate](../com.apple.storekit/StoreKit/SKOverlay/delegate.md)
- [SKOverlayDelegate](../com.apple.storekit/StoreKit/SKOverlayDelegate.md)

## See Also

- [offering-media-for-sale-in-your-app](../com.apple.storekit/StoreKit/offering-media-for-sale-in-your-app.md)
- [SKStoreProductViewController](../com.apple.storekit/StoreKit/SKStoreProductViewController.md)

---


## skoverlaydelegate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
protocol SKOverlayDelegate : NSObjectProtocol
```

## Topics

### Responding to the Overlay’s Appearance and Disappearance

- [storeOverlayWillStartPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartPresentation(_:transitionContext:).md)
- [storeOverlayDidFinishPresentation(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishPresentation(_:transitionContext:).md)
- [storeOverlayWillStartDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayWillStartDismissal(_:transitionContext:).md)
- [storeOverlayDidFinishDismissal(_:transitionContext:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFinishDismissal(_:transitionContext:).md)
- [TransitionContext](../com.apple.storekit/StoreKit/SKOverlay/TransitionContext.md)

### Responding to Failures

- [storeOverlayDidFailToLoad(_:error:)](../com.apple.storekit/StoreKit/SKOverlayDelegate/storeOverlayDidFailToLoad(_:error:).md)

## See Also

- [delegate](../com.apple.storekit/StoreKit/SKOverlay/delegate.md)

---


## skpaymenttransaction

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKPaymentTransaction
```

## 

A payment transaction is created whenever a payment is added to the payment queue. The system delivers transactions to your app when the App Store finishes processing the payment. Completed transactions provide a receipt and transaction identifier that your app can use to save a permanent record of the processed payment.

## Topics

### Getting Transaction Information

- [payment](../com.apple.storekit/StoreKit/SKPaymentTransaction/payment.md)
- [transactionIdentifier](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionIdentifier.md)
- [transactionDate](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionDate.md)
- [original](../com.apple.storekit/StoreKit/SKPaymentTransaction/original.md)
- [error](../com.apple.storekit/StoreKit/SKPaymentTransaction/error.md)
- [transactionReceipt](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionReceipt.md)

### Getting Downloads

- [downloads](../com.apple.storekit/StoreKit/SKPaymentTransaction/downloads.md)

### Getting Transaction State

- [transactionState](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionState.md)
- [SKPaymentTransactionState](../com.apple.storekit/StoreKit/SKPaymentTransactionState.md)

## See Also

- [requesting-a-payment-from-the-app-store](../com.apple.storekit/StoreKit/requesting-a-payment-from-the-app-store.md)
- [processing-a-transaction](../com.apple.storekit/StoreKit/processing-a-transaction.md)
- [SKPayment](../com.apple.storekit/StoreKit/SKPayment.md)
- [SKMutablePayment](../com.apple.storekit/StoreKit/SKMutablePayment.md)

---


## skpaymenttransactionstate

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum SKPaymentTransactionState
```

## Topics

### Constants

- [purchasing](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchasing.md)
- [purchased](../com.apple.storekit/StoreKit/SKPaymentTransactionState/purchased.md)
- [failed](../com.apple.storekit/StoreKit/SKPaymentTransactionState/failed.md)
- [restored](../com.apple.storekit/StoreKit/SKPaymentTransactionState/restored.md)
- [deferred](../com.apple.storekit/StoreKit/SKPaymentTransactionState/deferred.md)

### Initializers

- [init(rawValue:)](../com.apple.storekit/StoreKit/SKPaymentTransactionState/init(rawValue:).md)

## See Also

- [transactionState](../com.apple.storekit/StoreKit/SKPaymentTransaction/transactionState.md)

---


## skproduct

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKProduct
```

## 

[doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct) objects are returned as part of an [doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse](doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse) object.

## Topics

### Getting the Product Identifier

- [productIdentifier](../com.apple.storekit/StoreKit/SKProduct/productIdentifier.md)

### Getting Product Attributes

- [localizedDescription](../com.apple.storekit/StoreKit/SKProduct/localizedDescription.md)
- [localizedTitle](../com.apple.storekit/StoreKit/SKProduct/localizedTitle.md)
- [contentVersion](../com.apple.storekit/StoreKit/SKProduct/contentVersion.md)
- [isFamilyShareable](../com.apple.storekit/StoreKit/SKProduct/isFamilyShareable.md)
- [contentLengths](../com.apple.storekit/StoreKit/SKProduct/contentLengths.md)

### Getting Pricing Information

- [price](../com.apple.storekit/StoreKit/SKProduct/price.md)
- [priceLocale](../com.apple.storekit/StoreKit/SKProduct/priceLocale.md)
- [introductoryPrice](../com.apple.storekit/StoreKit/SKProduct/introductoryPrice.md)
- [discounts](../com.apple.storekit/StoreKit/SKProduct/discounts.md)
- [SKProductDiscount](../com.apple.storekit/StoreKit/SKProductDiscount.md)

### Getting Subscription Information

- [subscriptionGroupIdentifier](../com.apple.storekit/StoreKit/SKProduct/subscriptionGroupIdentifier.md)
- [subscriptionPeriod](../com.apple.storekit/StoreKit/SKProduct/subscriptionPeriod.md)
- [SKProductSubscriptionPeriod](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod.md)
- [PeriodUnit](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit.md)

### Getting Downloadable Content Information

- [isDownloadable](../com.apple.storekit/StoreKit/SKProduct/isDownloadable.md)
- [downloadContentLengths](../com.apple.storekit/StoreKit/SKProduct/downloadContentLengths.md)
- [downloadContentVersion](../com.apple.storekit/StoreKit/SKProduct/downloadContentVersion.md)
- [downloadable](../com.apple.storekit/StoreKit/SKProduct/downloadable.md)

## See Also

- [loading-in-app-product-identifiers](../com.apple.storekit/StoreKit/loading-in-app-product-identifiers.md)
- [fetching-product-information-from-the-app-store](../com.apple.storekit/StoreKit/fetching-product-information-from-the-app-store.md)
- [SKProductsRequest](../com.apple.storekit/StoreKit/SKProductsRequest.md)
- [SKProductsResponse](../com.apple.storekit/StoreKit/SKProductsResponse.md)

---


## skproductsrequest

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKProductsRequest
```

## 

Your app uses an [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) object to present localized prices and other information to the user without having to maintain that list of product information itself.

To use an [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest) object, you initialize it with a list of product identifier strings, attach a delegate, and then call the request’s [doc://com.apple.storekit/documentation/StoreKit/SKRequest/start()](doc://com.apple.storekit/documentation/StoreKit/SKRequest/start()) method. When the request completes, your delegate receives an [doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse](doc://com.apple.storekit/documentation/StoreKit/SKProductsResponse) object.

> **NOTE:** Be sure to keep a strong reference to the request object; otherwise, the system might deallocate the request before it can complete.

## Topics

### Initializing a Products Request

- [init(productIdentifiers:)](../com.apple.storekit/StoreKit/SKProductsRequest/init(productIdentifiers:).md)

### Setting the Delegate

- [delegate](../com.apple.storekit/StoreKit/SKProductsRequest/delegate.md)
- [SKProductsRequestDelegate](../com.apple.storekit/StoreKit/SKProductsRequestDelegate.md)

## See Also

- [loading-in-app-product-identifiers](../com.apple.storekit/StoreKit/loading-in-app-product-identifiers.md)
- [fetching-product-information-from-the-app-store](../com.apple.storekit/StoreKit/fetching-product-information-from-the-app-store.md)
- [SKProductsResponse](../com.apple.storekit/StoreKit/SKProductsResponse.md)
- [SKProduct](../com.apple.storekit/StoreKit/SKProduct.md)

---


## skproductsubscriptionperiod

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKProductSubscriptionPeriod
```

## 

A subscription period is a duration of time defined as some number of units, where a unit can be a [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/day](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/day), [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/week](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/week), [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/month](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/month), or [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/year](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/year).

For example, a subscription period of two weeks has a [doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/unit](doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/unit) of a [doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/week](doc://com.apple.storekit/documentation/StoreKit/SKProduct/PeriodUnit/week), and a  [doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/numberOfUnits](doc://com.apple.storekit/documentation/StoreKit/SKProductSubscriptionPeriod/numberOfUnits) equal to `2`.

## Topics

### Getting Subscription Period Details

- [numberOfUnits](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod/numberOfUnits.md)
- [unit](../com.apple.storekit/StoreKit/SKProductSubscriptionPeriod/unit.md)
- [PeriodUnit](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit.md)

## See Also

- [subscriptionGroupIdentifier](../com.apple.storekit/StoreKit/SKProduct/subscriptionGroupIdentifier.md)
- [subscriptionPeriod](../com.apple.storekit/StoreKit/SKProduct/subscriptionPeriod.md)
- [PeriodUnit](../com.apple.storekit/StoreKit/SKProduct/PeriodUnit.md)

---


## skreceiptpropertyisexpired

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
let SKReceiptPropertyIsExpired: String
```

## 

This key’s value is an instance of [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber) that the system interprets as a Boolean value that indicates whether the receipt is in an expired state.

## See Also

- [receiptProperties](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest/receiptProperties.md)
- [SKReceiptPropertyIsRevoked](../com.apple.storekit/StoreKit/SKReceiptPropertyIsRevoked.md)
- [SKReceiptPropertyIsVolumePurchase](../com.apple.storekit/StoreKit/SKReceiptPropertyIsVolumePurchase.md)

---


## skreceiptrefreshrequest

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKReceiptRefreshRequest
```

## 

> **NOTE:** The receipt isn’t necessary if you use [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) to validate the app download, or [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) to validate in-app purchases. Only use the receipt if your app uses the [doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase](doc://com.apple.storekit/documentation/StoreKit/original-api-for-in-app-purchase), or needs the receipt to validate the app download because it can’t use [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction).

Use this API to request a new app receipt from the App Store if the receipt is invalid or missing from its expected location, [doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL](doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL). To request the receipt using the [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest) object, you initialize it, attach a [doc://com.apple.storekit/documentation/StoreKit/SKRequest/delegate](doc://com.apple.storekit/documentation/StoreKit/SKRequest/delegate), and then call the request’s [doc://com.apple.storekit/documentation/StoreKit/SKRequest/start()](doc://com.apple.storekit/documentation/StoreKit/SKRequest/start()) method.

> **IMPORTANT:** The receipt refresh request displays a system prompt that asks users to authenticate with their App Store credentials. For a better user experience, initiate the request after an explicit user action, like tapping or clicking a button.

When the request completes successfully, your delegate receives an [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest) object in its [doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/requestDidFinish(_:)](doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/requestDidFinish(_:)) method. Locate the app receipt using the [doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL](doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL) property. For information about validating the receipt, see [doc://com.apple.storekit/documentation/StoreKit/choosing-a-receipt-validation-technique](doc://com.apple.storekit/documentation/StoreKit/choosing-a-receipt-validation-technique).

If the request fails and calls your delegate’s [doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/request(_:didFailWithError:)](doc://com.apple.storekit/documentation/StoreKit/SKRequestDelegate/request(_:didFailWithError:)) method, your app needs to release the request and not attempt to call it a second time. Requests can fail when a user doesn’t authenticate or chooses to cancel the request. Without a validated receipt, assume the user doesn’t have access to premium content.

In the sandbox environment, you can initialize a receipt with any combination of properties for testing when you call [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest/init(receiptProperties:)](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest/init(receiptProperties:)).

### 

There are times when using [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest) isn’t necessary, so avoid doing so, such as in the following scenarios:

- If the receipt is valid, but may be missing transactions, use [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) instead. For example, the receipt may be missing a transaction if a person purchases a new subscription on another device.
- In the sandbox environment, before the tester completes their first in-app purchase. Receipts are initially absent in the sandbox environment for iOS and iPadOS apps. For more information, see [doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL](doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL).

## Topics

### Initializing Receipt Refresh Requests

- [init(receiptProperties:)](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest/init(receiptProperties:).md)

### Receipt Properties and Keys

- [receiptProperties](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest/receiptProperties.md)
- [SKReceiptPropertyIsExpired](../com.apple.storekit/StoreKit/SKReceiptPropertyIsExpired.md)
- [SKReceiptPropertyIsRevoked](../com.apple.storekit/StoreKit/SKReceiptPropertyIsRevoked.md)
- [SKReceiptPropertyIsVolumePurchase](../com.apple.storekit/StoreKit/SKReceiptPropertyIsVolumePurchase.md)

## See Also

- [choosing-a-receipt-validation-technique](../com.apple.storekit/StoreKit/choosing-a-receipt-validation-technique.md)
- [validating-receipts-with-the-app-store](../com.apple.storekit/StoreKit/validating-receipts-with-the-app-store.md)
- [appStoreReceiptURL](../com.apple.Foundation/Bundle/appStoreReceiptURL.md)

---


## skstorefront

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
class SKStorefront
```

## 

In-app products you create through App Store Connect are available for sale in every region with an App Store. You can use the storefront information to determine the customer’s region, and offer in-app products suitable for that region. StoreKit exposes [doc://com.apple.storekit/documentation/StoreKit/SKStorefront](doc://com.apple.storekit/documentation/StoreKit/SKStorefront) storefront information as a read-only property in [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue).

You must maintain your own list of product identifiers and the storefronts in which you want to make them available.

> **NOTE:** Don’t save the storefront information with your customer information; storefront information can change at any time. Always get the storefront identifier immediately before you display product information or availability to the customer in your app. Storefront information may not be used to develop or enhance a customer profile, or track customers for advertising or marketing purposes.

### 

The following example function `shouldShow` returns `false` if your product isn’t suitable for the given storefront. You must create your own list of products available by storefront, referred to as `myProducts` below:

```swift
func shouldShow(_ productIdentifier: String, in storefront: SKStorefront) -> Bool {
    var shouldShow = true
     
    // myProducts is a dictionary representing your own metadata for products,
    // keyed on an SKProduct.productIdentifier.
    if let myProduct = myProducts[productIdentifier] {
        shouldShow = myProduct.countryCodes.contains(storefront.countryCode)
    }
    return shouldShow
}
```

The following code listing requests information for products that you wish to display based on the device’s storefront. It uses the `shouldShow` function defined above.

```swift
func fetchProductInfo() {
    var identifiers = Set<String>()
    if let storefront = SKPaymentQueue.default().storefront {
        for (identifier, _) in myProducts {
            if shouldShow(identifier, in: storefront) {
                identifiers.insert(identifier)
            }
        }
        let request = SKProductsRequest(productIdentifiers: identifiers)
        request.delegate = self
        request.start()
    }
}
```

### 

The storefront value can change at any time. To listen for changes in this value, implement the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueDidChangeStorefront(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueDidChangeStorefront(_:)) method. The `shouldShow` function is defined in [doc://com.apple.storekit/documentation/StoreKit/SKStorefront#Show-Products-Based-on-the-Current-Storefront](doc://com.apple.storekit/documentation/StoreKit/SKStorefront#Show-Products-Based-on-the-Current-Storefront). Refresh the list of your available products when the storefront changes, as shown below:

```swift
func paymentQueueDidChangeStorefront(_ queue: SKPaymentQueue) {
    if let storefront = queue.storefront {
        // Refresh the displayed products based on the new storefront.
        for product in storeProducts {
            if shouldShow(product.productIdentifier, in: storefront) {
                // Display this product in your store UI.
         }
      }
   }
}
```

### 

The current storefront can change at any time, including during a transaction. The following code listing determines whether the transaction should continue in the updated storefront. Your delegate’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueue(_:shouldContinue:in:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueueDelegate/paymentQueue(_:shouldContinue:in:)) method must return quickly, before the call times out. The `shouldShow` function is defined in [doc://com.apple.storekit/documentation/StoreKit/SKStorefront#Show-Products-Based-on-the-Current-Storefront](doc://com.apple.storekit/documentation/StoreKit/SKStorefront#Show-Products-Based-on-the-Current-Storefront).

```swift
SKPaymentQueue.default().delegate = self  // Set your object as the SKPaymentQueue delegate.

func paymentQueue(_ paymentQueue: SKPaymentQueue,
                  shouldContinue transaction: SKPaymentTransaction,
                  in newStorefront: SKStorefront) -> Bool {
    return shouldShow(transaction.payment.productIdentifier, in: newStorefront)
}
```

If the product isn’t available in the updated storefront, the transaction fails with the error [doc://com.apple.storekit/documentation/StoreKit/SKError/Code/storeProductNotAvailable](doc://com.apple.storekit/documentation/StoreKit/SKError/Code/storeProductNotAvailable). Handle this error in your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) method by displaying an alert to let the customer know why the app can’t complete the transaction, as shown below:

```swift
func paymentQueue(_ queue: SKPaymentQueue,
                  updatedTransactions transactions: [SKPaymentTransaction]) {
    for transaction in transactions {
        if let transactionError = transaction.error as NSError?,
            transactionError.domain == SKErrorDomain
            && transactionError.code == SKError.storeProductNotAvailable.rawValue {
            // Show an alert.
        }
    }
}
```

### 

When you change the App Store Country or Region in App Store Connect for a Sandbox Apple Account, it changes the storefront in your app. Change the region to test in-app purchases for different regions in your app. For more information about changing the App Store Country or Region in App Store Connect, see [https://help.apple.com/app-store-connect/#/dev7e89e149d](https://help.apple.com/app-store-connect/#/dev7e89e149d).

> **IMPORTANT:** To successfully activate a storefront after you change the region in App Store Connect, sign out of the Sandbox Apple Account on the device and sign back in.

## Topics

### Identifying the Storefront

- [countryCode](../com.apple.storekit/StoreKit/SKStorefront/countryCode.md)
- [identifier](../com.apple.storekit/StoreKit/SKStorefront/identifier.md)

---


## skstorefrontcountrycodedidchangenotification

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
extern NSNotificationName const SKStorefrontCountryCodeDidChangeNotification;
```

## See Also

- [SKStorefrontIdentifierDidChangeNotification](../com.apple.storekit/StoreKit/SKStorefrontIdentifierDidChangeNotification.md)
- [SKCloudServiceCapabilitiesDidChangeNotification](../com.apple.storekit/StoreKit/SKCloudServiceCapabilitiesDidChangeNotification.md)

---


## skstorefrontidentifierdidchangenotification

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
extern NSNotificationName const SKStorefrontIdentifierDidChangeNotification;
```

## See Also

- [SKCloudServiceCapabilitiesDidChangeNotification](../com.apple.storekit/StoreKit/SKCloudServiceCapabilitiesDidChangeNotification.md)
- [SKStorefrontCountryCodeDidChangeNotification](../com.apple.storekit/StoreKit/SKStorefrontCountryCodeDidChangeNotification.md)

---


## skstoreproductparameteradnetworkattributionsignature

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkAttributionSignature: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString). The ad network creates the cryptographic signature, used to sign ads. For instructions on generating this value, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads).

## See Also

- [SKStoreProductParameterAdNetworkIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkIdentifier.md)
- [SKStoreProductParameterAdNetworkCampaignIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier.md)
- [SKStoreProductParameterAdNetworkTimestamp](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkTimestamp.md)
- [SKStoreProductParameterAdNetworkNonce](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkNonce.md)

---


## skstoreproductparameteradnetworksourceidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkSourceIdentifier: String
```

## 

This key is available for ad impressions that use SKAdNetwork 4 and later. The [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceIdentifier), also known as the *hierarchical source identifier*, replaces and extends the campaign identifier value, [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier).

Ad networks and developers define the meaning of the hierarchical source identifier. This string represents an integer of up to four digits. You can encode information about your advertisement in each set of digits; you may receive two, three, or all four digits of the [doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKAdImpression/sourceIdentifier) in the first winning postback, depending on the ad impression’s postback data tier. For more information about the value you may get in the postback, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

---


## skstoreproductparameteradnetworktimestamp

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkTimestamp: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSNumber](doc://com.apple.documentation/documentation/Foundation/NSNumber). Ad networks generate the timestamp, represented as UNIX time in milliseconds, at the time you’re preparing to serve the ad.

## See Also

- [SKStoreProductParameterAdNetworkIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkIdentifier.md)
- [SKStoreProductParameterAdNetworkCampaignIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkCampaignIdentifier.md)
- [SKStoreProductParameterAdNetworkNonce](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkNonce.md)
- [SKStoreProductParameterAdNetworkAttributionSignature](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkAttributionSignature.md)

---


## skstoreproductparameteradnetworkversion

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, tvOS

```swift
let SKStoreProductParameterAdNetworkVersion: String
```

## 

The value for this key is an [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString). Set this key to version number “`4.0`”, “`3.0`”, “`2.2"`, `“2.1"`, or `"2.0"`. Use the highest available version whenever possible. For version availability, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

Ad networks use this key and the other [doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys](doc://com.apple.storekit/documentation/StoreKit/ad-network-install-validation-keys) when signing ads. For more information, see [doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads](doc://com.apple.storekit/documentation/StoreKit/generating-the-signature-to-validate-storekit-rendered-ads).

## See Also

- [SKStoreProductParameterAdNetworkSourceAppStoreIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier.md)

---


## skstoreproductparameteradvertisingpartnertoken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterAdvertisingPartnerToken: String
```

## 

The value for this key is an instance of [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString).

## See Also

- [SKStoreProductParameterProductIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterProductIdentifier.md)
- [SKStoreProductParameterAffiliateToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAffiliateToken.md)
- [SKStoreProductParameterCampaignToken](../com.apple.storekit/StoreKit/SKStoreProductParameterCampaignToken.md)
- [SKStoreProductParameterProviderToken](../com.apple.storekit/StoreKit/SKStoreProductParameterProviderToken.md)
- [SKStoreProductParameterCustomProductPageIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterCustomProductPageIdentifier.md)

---


## skstoreproductparametercampaigntoken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterCampaignToken: String
```

## 

The value for this key is an instance of [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString), containing any 40-byte string.

This token allows you to track the effectiveness of your Affiliate Program link and your App Analytics campaign.

For more information about the Affiliate Program, see the Affiliate Program at [https://apple.com/itunes/affiliates](https://apple.com/itunes/affiliates). For more information about App Store Connect Analytics, see [https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/About.html#//apple_ref/doc/uid/TP40011225](https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/About.html#//apple_ref/doc/uid/TP40011225).

## See Also

- [SKStoreProductParameterProductIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterProductIdentifier.md)
- [SKStoreProductParameterAdvertisingPartnerToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAdvertisingPartnerToken.md)
- [SKStoreProductParameterAffiliateToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAffiliateToken.md)
- [SKStoreProductParameterProviderToken](../com.apple.storekit/StoreKit/SKStoreProductParameterProviderToken.md)
- [SKStoreProductParameterCustomProductPageIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterCustomProductPageIdentifier.md)

---


## skstoreproductparametercustomproductpageidentifier

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterCustomProductPageIdentifier: String
```

## 

The value for this key is a UUID that represents a custom product page. Get this value from the `ppid` parameter of your custom product page’s URL. For example, in the following sample custom product page URL:

`https://apps.apple.com/us/app/example-appname/id1234567890?ppid=eb2b3606-2fef-4aab-a54e-b2e5547c9bc3`

- the custom product page identifier is the string that follows `ppid=`, which is `eb2b3606-2fef-4aab-a54e-b2e5547c9bc3`.

App Store Connect creates the URL when you configure your custom product page. For more information, see [https://developer.apple.com/help/app-store-connect/create-custom-product-pages/configure-multiple-product-page-versions/](https://developer.apple.com/help/app-store-connect/create-custom-product-pages/configure-multiple-product-page-versions/).

For more information about custom product pages, see [https://developer.apple.com/app-store/custom-product-pages/](https://developer.apple.com/app-store/custom-product-pages/).

## See Also

- [SKStoreProductParameterProductIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterProductIdentifier.md)
- [SKStoreProductParameterAdvertisingPartnerToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAdvertisingPartnerToken.md)
- [SKStoreProductParameterAffiliateToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAffiliateToken.md)
- [SKStoreProductParameterCampaignToken](../com.apple.storekit/StoreKit/SKStoreProductParameterCampaignToken.md)
- [SKStoreProductParameterProviderToken](../com.apple.storekit/StoreKit/SKStoreProductParameterProviderToken.md)

---


## skstoreproductparameterprovidertoken

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS

```swift
let SKStoreProductParameterProviderToken: String
```

## 

The value for this key is an instance of [doc://com.apple.documentation/documentation/Foundation/NSString](doc://com.apple.documentation/documentation/Foundation/NSString).

Use your own provider token when cross promoting your own apps. This token lets you track the effectiveness of the cross promotion effort separate from any affiliate campaign that shares the same campaign token.

When promoting apps for other developers, use their provider token instead. In this case, the token lets the developer track the effectiveness of your App Analytics campaign for their apps.

The key must be used in combination with your campaign token, [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterCampaignToken](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterCampaignToken). For more information, see [https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/About.html#//apple_ref/doc/uid/TP40011225](https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/About.html#//apple_ref/doc/uid/TP40011225).

## See Also

- [SKStoreProductParameterProductIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterProductIdentifier.md)
- [SKStoreProductParameterAdvertisingPartnerToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAdvertisingPartnerToken.md)
- [SKStoreProductParameterAffiliateToken](../com.apple.storekit/StoreKit/SKStoreProductParameterAffiliateToken.md)
- [SKStoreProductParameterCampaignToken](../com.apple.storekit/StoreKit/SKStoreProductParameterCampaignToken.md)
- [SKStoreProductParameterCustomProductPageIdentifier](../com.apple.storekit/StoreKit/SKStoreProductParameterCustomProductPageIdentifier.md)

---


## skstorereviewcontroller

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS

```swift
class SKStoreReviewController
```

## 

Use the [doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview(in:)](doc://com.apple.storekit/documentation/StoreKit/SKStoreReviewController/requestReview(in:)) method to indicate when it makes sense within the logic of your app to ask the customer for ratings and reviews.

## Topics

### Indicating an appropriate time for a review

- [requestReview(in:)](../com.apple.storekit/StoreKit/SKStoreReviewController/requestReview(in:).md)
- [requestReview()](../com.apple.storekit/StoreKit/SKStoreReviewController/requestReview().md)

## See Also

- [requesting-app-store-reviews](../com.apple.storekit/StoreKit/requesting-app-store-reviews.md)
- [RequestReviewAction](../com.apple.storekit/StoreKit/RequestReviewAction.md)

---


## storecontentbuilder

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@resultBuilder struct StoreContentBuilder
```

## Topics

### Building store content

- [buildBlock(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildBlock(_:).md)
- [buildEither(first:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(first:).md)
- [buildEither(second:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildEither(second:).md)
- [buildExpression(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildExpression(_:).md)
- [buildIf(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildIf(_:).md)
- [buildLimitedAvailability(_:)](../com.apple.storekit/StoreKit/StoreContentBuilder/buildLimitedAvailability(_:).md)
- [TupleStoreContent](../com.apple.storekit/StoreKit/TupleStoreContent.md)

## See Also

- [SubscriptionOptionGroup](../com.apple.storekit/StoreKit/SubscriptionOptionGroup.md)
- [SubscriptionOptionGroupSet](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet.md)
- [SubscriptionPeriodGroupSet](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet.md)
- [SubscriptionOptionSection](../com.apple.storekit/StoreKit/SubscriptionOptionSection.md)
- [StoreContent](../com.apple.storekit/StoreKit/StoreContent.md)

---


## storedownloaderextension

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS

```swift
protocol StoreDownloaderExtension : ManagedDownloaderExtension
```

## 

You can optionally implement the inherited `ManagedDownloaderExtension` requirements, but don’t implement any of the inherited `BADownloaderExtension` requirements for which this protocol provides a default implementation. For more information, see [doc://com.apple.documentation/documentation/BackgroundAssets](doc://com.apple.documentation/documentation/BackgroundAssets).

---


## storefront

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct Storefront
```

## 

In-app products you create through App Store Connect are available for sale in each region with an App Store. You can use the storefront information to determine the customer’s region, and offer in-app products suitable for that region.

You need to maintain your own list of product identifiers and the storefronts where you want to make them available.

> **NOTE:** Don’t save the storefront information with your customer information because storefront information can change at any time. Get the storefront identifier immediately before you display product information or availability in your app. Don’t use storefront information to develop or enhance a customer profile, or to track customers for advertising or marketing purposes.

### 

When you change the App Store Country or Region in App Store Connect for a Sandbox Apple Account, it changes the storefront in your app. Change the region to test In-App Purchases for different regions in your app. For more information about changing the App Store Country or Region in App Store Connect, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings/](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings/).

> **IMPORTANT:** To successfully activate a storefront after you change the region in App Store Connect, sign out of the Sandbox Apple Account on the device and sign back in.

## Topics

### Identifying the storefront

- [current](../com.apple.storekit/StoreKit/Storefront/current.md)
- [countryCode](../com.apple.storekit/StoreKit/Storefront/countryCode.md)
- [id](../com.apple.storekit/StoreKit/Storefront/id.md)

### Listening for storefront changes

- [updates](../com.apple.storekit/StoreKit/Storefront/updates.md)
- [Storefronts](../com.apple.storekit/StoreKit/Storefront/Storefronts.md)

### Getting the currency for the storefront

- [currency](../com.apple.storekit/StoreKit/Storefront/currency.md)

## See Also

- [current](../com.apple.storekit/StoreKit/Storefront/current.md)
- [updates](../com.apple.storekit/StoreKit/Storefront/updates.md)

---


## storekit-views

## 

The StoreKit views APIs provide UI to help you build a store for your In-App Purchases, and provide a way for customers to complete the purchase. The views support localization, so your customers see the product names, descriptions, and prices appropriate to their App Store storefront.

> **NOTE:** Session 10013: [https://developer.apple.com/videos/play/wwdc2023/10013](https://developer.apple.com/videos/play/wwdc2023/10013)

StoreKit manages the layouts across all platforms, so the views look great on any device. You can use SwiftUI APIs to customize how the views integrate with your app.

To use StoreKit views, configure your In-App Purchase metadata in App Store Connect, or in a StoreKit configuration file in Xcode if you’re testing your app. Next, create the views using [doc://com.apple.storekit/documentation/StoreKit/StoreView](doc://com.apple.storekit/documentation/StoreKit/StoreView), [doc://com.apple.storekit/documentation/StoreKit/ProductView](doc://com.apple.storekit/documentation/StoreKit/ProductView), or [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView). Finally, customize the default views to match your app by using your own icons, backgrounds, and other styling. Use [doc://com.apple.documentation/documentation/SwiftUI/Previews-in-Xcode](doc://com.apple.documentation/documentation/SwiftUI/Previews-in-Xcode) to see your progress as you iterate on your design.

For more information on configuring your In-App Purchase metadata, see [https://help.apple.com/app-store-connect/#/devae49fb316](https://help.apple.com/app-store-connect/#/devae49fb316). For more information on StoreKit configuration files in Xcode, see [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

## Topics

### Merchandising In-App Purchases, subscriptions, and offers

- [ProductView](../com.apple.storekit/StoreKit/ProductView.md)
- [StoreView](../com.apple.storekit/StoreKit/StoreView.md)
- [SubscriptionStoreView](../com.apple.storekit/StoreKit/SubscriptionStoreView.md)
- [SubscriptionOfferView](../com.apple.storekit/StoreKit/SubscriptionOfferView.md)
- [Backyard-birds-sample](../com.apple.SwiftUI/Backyard-birds-sample.md)

### Styling product views

- [productViewStyle(_:)](../com.apple.SwiftUI/View/productViewStyle(_:).md)
- [productIconBorder()](../com.apple.SwiftUI/View/productIconBorder().md)
- [ProductViewStyle](../com.apple.storekit/StoreKit/ProductViewStyle.md)
- [ProductViewStyleConfiguration](../com.apple.storekit/StoreKit/ProductViewStyleConfiguration.md)

### Styling subscription store controls

- [subscriptionStoreControlStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:).md)
- [subscriptionStoreControlStyle(_:placement:)](../com.apple.SwiftUI/View/subscriptionStoreControlStyle(_:placement:).md)
- [SubscriptionStoreControlStyle](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyle.md)
- [SubscriptionStoreControlStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionStoreControlStyleConfiguration.md)
- [SubscriptionStoreControlPlacement](../com.apple.storekit/StoreKit/SubscriptionStoreControlPlacement.md)

### Styling subscription offer views

- [AutomaticSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOfferViewStyle.md)
- [CompactSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/CompactSubscriptionOfferViewStyle.md)
- [SubscriptionOfferViewStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration.md)
- [SubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle.md)

### Configuring subscription store controls

- [subscriptionStoreControlIcon(icon:)](../com.apple.SwiftUI/View/subscriptionStoreControlIcon(icon:).md)
- [subscriptionStorePickerItemBackground(_:)](../com.apple.SwiftUI/View/subscriptionStorePickerItemBackground(_:).md)
- [subscriptionStorePickerItemBackground(_:in:)](../com.apple.SwiftUI/View/subscriptionStorePickerItemBackground(_:in:).md)
- [subscriptionStoreButtonLabel(_:)](../com.apple.SwiftUI/View/subscriptionStoreButtonLabel(_:).md)
- [SubscriptionStoreButtonLabel](../com.apple.storekit/StoreKit/SubscriptionStoreButtonLabel.md)

### Creating custom subscription store control styles

- [SubscriptionStoreButton](../com.apple.storekit/StoreKit/SubscriptionStoreButton.md)
- [SubscriptionStorePicker](../com.apple.storekit/StoreKit/SubscriptionStorePicker.md)
- [SubscriptionStorePickerOption](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption.md)

### Declaring the structure of a subscription store

- [SubscriptionOptionGroup](../com.apple.storekit/StoreKit/SubscriptionOptionGroup.md)
- [SubscriptionOptionGroupSet](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet.md)
- [SubscriptionPeriodGroupSet](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet.md)
- [SubscriptionOptionSection](../com.apple.storekit/StoreKit/SubscriptionOptionSection.md)
- [StoreContent](../com.apple.storekit/StoreKit/StoreContent.md)
- [StoreContentBuilder](../com.apple.storekit/StoreKit/StoreContentBuilder.md)

### Styling subscription option groups

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreOptionGroupStyle(_:).md)
- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)
- [SubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle.md)

### Adding backgrounds to subscription stores

- [containerBackground(_:for:)](../com.apple.SwiftUI/View/containerBackground(_:for:).md)
- [containerBackground(for:alignment:content:)](../com.apple.SwiftUI/View/containerBackground(for:alignment:content:).md)
- [subscriptionStoreControlBackground(_:)-7jxa9](../com.apple.SwiftUI/View/subscriptionStoreControlBackground(_:)-7jxa9.md)
- [subscriptionStoreControlBackground(_:)-7ev89](../com.apple.SwiftUI/View/subscriptionStoreControlBackground(_:)-7ev89.md)
- [subscriptionStore](../com.apple.SwiftUI/ContainerBackgroundPlacement/subscriptionStore.md)
- [subscriptionStoreHeader](../com.apple.SwiftUI/ContainerBackgroundPlacement/subscriptionStoreHeader.md)
- [subscriptionStoreFullHeight](../com.apple.SwiftUI/ContainerBackgroundPlacement/subscriptionStoreFullHeight.md)
- [SubscriptionStoreControlBackground](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground.md)

### Configuring accessory buttons

- [storeButton(_:for:)](../com.apple.SwiftUI/View/storeButton(_:for:).md)
- [subscriptionStoreSignInAction(_:)](../com.apple.SwiftUI/View/subscriptionStoreSignInAction(_:).md)
- [StoreButtonKind](../com.apple.storekit/StoreKit/StoreButtonKind.md)
- [SubscriptionOfferViewButtonKind](../com.apple.storekit/StoreKit/SubscriptionOfferViewButtonKind.md)

### Configuring the subscription store policies

- [subscriptionStorePolicyDestination(for:destination:)](../com.apple.SwiftUI/View/subscriptionStorePolicyDestination(for:destination:).md)
- [subscriptionStorePolicyDestination(url:for:)](../com.apple.SwiftUI/View/subscriptionStorePolicyDestination(url:for:).md)
- [subscriptionStorePolicyForegroundStyle(_:)](../com.apple.SwiftUI/View/subscriptionStorePolicyForegroundStyle(_:).md)
- [subscriptionStorePolicyForegroundStyle(_:_:)](../com.apple.SwiftUI/View/subscriptionStorePolicyForegroundStyle(_:_:).md)
- [SubscriptionStorePolicyKind](../com.apple.storekit/StoreKit/SubscriptionStorePolicyKind.md)

### Selecting subscription offers

- [subscriptionPromotionalOffer(offer:signature:)](../com.apple.SwiftUI/View/subscriptionPromotionalOffer(offer:signature:).md)
- [preferredSubscriptionOffer(_:)](../com.apple.SwiftUI/View/preferredSubscriptionOffer(_:).md)
- [offerCodeRedemption(isPresented:onCompletion:)](../com.apple.SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:).md)

### Configuring purchase options and product descriptions

- [inAppPurchaseOptions(_:)](../com.apple.SwiftUI/View/inAppPurchaseOptions(_:).md)
- [productDescription(_:)](../com.apple.SwiftUI/View/productDescription(_:).md)

### Responding to store events

- [onInAppPurchaseStart(perform:)](../com.apple.SwiftUI/View/onInAppPurchaseStart(perform:).md)
- [onInAppPurchaseCompletion(perform:)](../com.apple.SwiftUI/View/onInAppPurchaseCompletion(perform:).md)

### Loading StoreKit data

- [storeProductTask(for:priority:action:)](../com.apple.SwiftUI/View/storeProductTask(for:priority:action:).md)
- [storeProductsTask(for:priority:action:)](../com.apple.SwiftUI/View/storeProductsTask(for:priority:action:).md)
- [currentEntitlementTask(for:priority:action:)](../com.apple.SwiftUI/View/currentEntitlementTask(for:priority:action:).md)
- [subscriptionStatusTask(for:priority:action:)](../com.apple.SwiftUI/View/subscriptionStatusTask(for:priority:action:).md)
- [CollectionTaskState](../com.apple.storekit/StoreKit/Product/CollectionTaskState.md)
- [TaskState](../com.apple.storekit/StoreKit/Product/TaskState.md)
- [EntitlementTaskState](../com.apple.storekit/StoreKit/EntitlementTaskState.md)

### Requesting a refund

- [refundRequestSheet(for:isPresented:onDismiss:)](../com.apple.SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:).md)

---


## storekitbundle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
#define StoreKitBundle
```

## See Also

- [SKLocalizedString](../com.apple.storekit/StoreKit/SKLocalizedString.md)
- [SK_CLASS_FINAL](../com.apple.storekit/StoreKit/SK_CLASS_FINAL.md)
- [SK_EXTERN](../com.apple.storekit/StoreKit/SK_EXTERN.md)
- [SK_EXTERN_CLASS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS.md)
- [SK_EXTERN_CLASS_AVAILABLE](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE.md)
- [SK_EXTERN_CLASS_AVAILABLE_IOS](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_IOS.md)
- [SK_EXTERN_CLASS_AVAILABLE_MAC](../com.apple.storekit/StoreKit/SK_EXTERN_CLASS_AVAILABLE_MAC.md)

---


## storekiterror

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
enum StoreKitError
```

## Topics

### StoreKit Error Codes

- [networkError(_:)](../com.apple.storekit/StoreKit/StoreKitError/networkError(_:).md)
- [systemError(_:)](../com.apple.storekit/StoreKit/StoreKitError/systemError(_:).md)
- [userCancelled](../com.apple.storekit/StoreKit/StoreKitError/userCancelled.md)
- [notAvailableInStorefront](../com.apple.storekit/StoreKit/StoreKitError/notAvailableInStorefront.md)
- [notEntitled](../com.apple.storekit/StoreKit/StoreKitError/notEntitled.md)
- [unknown](../com.apple.storekit/StoreKit/StoreKitError/unknown.md)
- [unsupported](../com.apple.storekit/StoreKit/StoreKitError/unsupported.md)

---


## subscriptioninfo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias SubscriptionInfo = Product.SubscriptionInfo
```

## See Also

- [implementing-a-store-in-your-app-using-the-storekit-api](../com.apple.storekit/StoreKit/implementing-a-store-in-your-app-using-the-storekit-api.md)
- [Product](../com.apple.storekit/StoreKit/Product.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo.md)
- [SubscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionStatus.md)

---


## subscriptionofferviewbuttonkind

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct SubscriptionOfferViewButtonKind
```

## Topics

### Type Properties

- [detailLink](../com.apple.storekit/StoreKit/SubscriptionOfferViewButtonKind/detailLink.md)

## See Also

- [storeButton(_:for:)](../com.apple.SwiftUI/View/storeButton(_:for:).md)
- [subscriptionStoreSignInAction(_:)](../com.apple.SwiftUI/View/subscriptionStoreSignInAction(_:).md)
- [StoreButtonKind](../com.apple.storekit/StoreKit/StoreButtonKind.md)

---


## subscriptionofferviewstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
@MainActor protocol SubscriptionOfferViewStyle
```

## Topics

### Associated Types

- [Body](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle/Body.md)

### Instance Methods

- [makeBody(configuration:)](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle/makeBody(configuration:).md)

### Type Aliases

- [Configuration](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle/Configuration.md)

### Type Properties

- [automatic](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle/automatic.md)
- [compact](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle/compact.md)

## See Also

- [AutomaticSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOfferViewStyle.md)
- [CompactSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/CompactSubscriptionOfferViewStyle.md)
- [SubscriptionOfferViewStyleConfiguration](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration.md)

---


## subscriptionofferviewstyleconfiguration

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, visionOS

```swift
struct SubscriptionOfferViewStyleConfiguration
```

## Topics

### Structures

- [Icon-swift.struct](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/Icon-swift.struct.md)

### Instance Properties

- [activeOffer](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/activeOffer.md)
- [icon-swift.property](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/icon-swift.property.md)
- [state](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/state.md)
- [subscriptionGroupDisplayName](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionGroupDisplayName.md)
- [subscriptionStatus](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptionStatus.md)
- [subscriptions](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscriptions.md)
- [visibleSubscription](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/visibleSubscription.md)

### Instance Methods

- [displayDetails()](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/displayDetails().md)
- [subscribe()](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyleConfiguration/subscribe().md)

## See Also

- [AutomaticSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOfferViewStyle.md)
- [CompactSubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/CompactSubscriptionOfferViewStyle.md)
- [SubscriptionOfferViewStyle](../com.apple.storekit/StoreKit/SubscriptionOfferViewStyle.md)

---


## subscriptionoptiongroup

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionOptionGroup<Content, Label, MarketingContent> where Content : StoreContent, Label : View, MarketingContent : View
```

## Topics

### Creating subscription option groups

- [init(_:content:)-2nlpw](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-2nlpw.md)
- [init(_:content:)-24grh](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:)-24grh.md)
- [init(_:content:marketingContent:)-9jybc](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-9jybc.md)
- [init(_:content:marketingContent:)-550q0](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:content:marketingContent:)-550q0.md)
- [init(_:isIncluded:)-uhqa](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-uhqa.md)
- [init(_:isIncluded:)-5f3ml](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:)-5f3ml.md)
- [init(_:isIncluded:marketingContent:)-8vmdm](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-8vmdm.md)
- [init(_:isIncluded:marketingContent:)-4d72a](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(_:isIncluded:marketingContent:)-4d72a.md)
- [init(content:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:).md)
- [init(content:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:).md)
- [init(content:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:label:marketingContent:).md)
- [init(content:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(content:marketingContent:).md)
- [init(isIncluded:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:).md)
- [init(isIncluded:label:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:).md)
- [init(isIncluded:label:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:label:marketingContent:).md)
- [init(isIncluded:marketingContent:)](../com.apple.storekit/StoreKit/SubscriptionOptionGroup/init(isIncluded:marketingContent:).md)

### Supporting types

- [AutomaticSubscriptionOptionGroupLabel](../com.apple.storekit/StoreKit/AutomaticSubscriptionOptionGroupLabel.md)

## See Also

- [SubscriptionOptionGroupSet](../com.apple.storekit/StoreKit/SubscriptionOptionGroupSet.md)
- [SubscriptionPeriodGroupSet](../com.apple.storekit/StoreKit/SubscriptionPeriodGroupSet.md)
- [SubscriptionOptionSection](../com.apple.storekit/StoreKit/SubscriptionOptionSection.md)
- [StoreContent](../com.apple.storekit/StoreKit/StoreContent.md)
- [StoreContentBuilder](../com.apple.storekit/StoreKit/StoreContentBuilder.md)

---


## subscriptionoptiongroupstyle

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
protocol SubscriptionOptionGroupStyle
```

## Topics

### Getting built-in subscription option group styles

- [automatic](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/automatic.md)
- [links](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/links.md)
- [tabs](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyle/tabs.md)

### Supporting types

- [AutomaticSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOptionGroupStyle.md)
- [LinksSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/LinksSubscriptionOptionGroupStyle.md)
- [TabsSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/TabsSubscriptionOptionGroupStyle.md)
- [SubscriptionOptionGroupStyleOutput](../com.apple.storekit/StoreKit/SubscriptionOptionGroupStyleOutput.md)

## See Also

- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.SwiftUI/View/subscriptionStoreOptionGroupStyle(_:).md)
- [subscriptionStoreOptionGroupStyle(_:)](../com.apple.storekit/StoreKit/StoreContent/subscriptionStoreOptionGroupStyle(_:).md)

---


## subscriptionoptiongroupstyleoutput

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SubscriptionOptionGroupStyleOutput
```

## See Also

- [AutomaticSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/AutomaticSubscriptionOptionGroupStyle.md)
- [LinksSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/LinksSubscriptionOptionGroupStyle.md)
- [TabsSubscriptionOptionGroupStyle](../com.apple.storekit/StoreKit/TabsSubscriptionOptionGroupStyle.md)

---


## subscriptionrenewalinfo

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias SubscriptionRenewalInfo = Product.SubscriptionInfo.RenewalInfo
```

## See Also

- [Status-swift.struct](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/Status-swift.struct.md)
- [RenewalInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalInfo.md)
- [RenewalState](../com.apple.storekit/StoreKit/Product/SubscriptionInfo/RenewalState.md)
- [SubscriptionRenewalState](../com.apple.storekit/StoreKit/SubscriptionRenewalState.md)
- [SubscriptionPeriod](../com.apple.storekit/StoreKit/SubscriptionPeriod.md)

---


## subscriptions-and-offers

## Topics

### Essentials

- [handling-subscriptions-billing](../com.apple.storekit/StoreKit/handling-subscriptions-billing.md)
- [enabling-app-store-server-notifications](../com.apple.storekit/StoreKit/enabling-app-store-server-notifications.md)
- [offering-a-subscription-across-multiple-apps](../com.apple.storekit/StoreKit/offering-a-subscription-across-multiple-apps.md)
- [reducing-involuntary-subscriber-churn](../com.apple.storekit/StoreKit/reducing-involuntary-subscriber-churn.md)

### Introductory offers

- [implementing-introductory-offers-in-your-app](../com.apple.storekit/StoreKit/implementing-introductory-offers-in-your-app.md)
- [testing-introductory-offers](../com.apple.storekit/StoreKit/testing-introductory-offers.md)
- [SKProductDiscount](../com.apple.storekit/StoreKit/SKProductDiscount.md)

### Promotional offers

- [setting-up-promotional-offers](../com.apple.storekit/StoreKit/setting-up-promotional-offers.md)
- [implementing-promotional-offers-in-your-app](../com.apple.storekit/StoreKit/implementing-promotional-offers-in-your-app.md)
- [generating-a-signature-for-promotional-offers](../com.apple.storekit/StoreKit/generating-a-signature-for-promotional-offers.md)
- [generating-a-promotional-offer-signature-on-the-server](../com.apple.storekit/StoreKit/generating-a-promotional-offer-signature-on-the-server.md)
- [SKPaymentDiscount](../com.apple.storekit/StoreKit/SKPaymentDiscount.md)

### Offer codes

- [implementing-offer-codes-in-your-app](../com.apple.storekit/StoreKit/implementing-offer-codes-in-your-app.md)

### Subscription service entitlement

- [determining-service-entitlement-on-the-server](../com.apple.storekit/StoreKit/determining-service-entitlement-on-the-server.md)

---


## subscriptionstatus

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
typealias SubscriptionStatus = Product.SubscriptionInfo.Status
```

## See Also

- [implementing-a-store-in-your-app-using-the-storekit-api](../com.apple.storekit/StoreKit/implementing-a-store-in-your-app-using-the-storekit-api.md)
- [Product](../com.apple.storekit/StoreKit/Product.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/Product/SubscriptionInfo.md)
- [SubscriptionInfo](../com.apple.storekit/StoreKit/SubscriptionInfo.md)

---


## subscriptionstorecontrolbackground

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS

```swift
struct SubscriptionStoreControlBackground
```

## Topics

### Background types

- [automatic](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/automatic.md)
- [gradientMaterial](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/gradientMaterial.md)
- [gradientMaterialOnScroll](../com.apple.storekit/StoreKit/SubscriptionStoreControlBackground/gradientMaterialOnScroll.md)

## See Also

- [containerBackground(_:for:)](../com.apple.SwiftUI/View/containerBackground(_:for:).md)
- [containerBackground(for:alignment:content:)](../com.apple.SwiftUI/View/containerBackground(for:alignment:content:).md)
- [subscriptionStoreControlBackground(_:)-7jxa9](../com.apple.SwiftUI/View/subscriptionStoreControlBackground(_:)-7jxa9.md)
- [subscriptionStoreControlBackground(_:)-7ev89](../com.apple.SwiftUI/View/subscriptionStoreControlBackground(_:)-7ev89.md)
- [subscriptionStore](../com.apple.SwiftUI/ContainerBackgroundPlacement/subscriptionStore.md)
- [subscriptionStoreHeader](../com.apple.SwiftUI/ContainerBackgroundPlacement/subscriptionStoreHeader.md)
- [subscriptionStoreFullHeight](../com.apple.SwiftUI/ContainerBackgroundPlacement/subscriptionStoreFullHeight.md)

---


## subscriptionstorepicker

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, visionOS, watchOS

```swift
@MainActor @preconcurrency struct SubscriptionStorePicker<PickerContent, ConfirmationContent> where PickerContent : View, ConfirmationContent : View
```

## 

When implementing custom subscription store control styles conforming to [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle), you can use this view to utilize the standard subscription picker as a component of the view you provide from [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)). The subscription picker is a composite control: it contains both a picker for choosing an option, and a button to subscribe to the selected option.

This control is the same as used in standard control styles such as [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/picker](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/picker).

There are two primary ways to create a subscription picker:

- Provide the [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration) value to the subscription picker, and use the components of each option to declare the option’s label.
- Provide a collection of views for the picker’s content, using a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePickerOption](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStorePickerOption) to declare the options.

Either way, you also need to declare a view to confirm the subscription after someone selects an option.

You can optionally provide a binding to a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyleConfiguration/Option) to observe selection changes, or programmatically change selections. If you don’t provide a binding, the subscription picker manages its own selection state.

> **IMPORTANT:** Use the `SubscriptionStorePicker` only in the view you return from the required [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle/makeBody(configuration:)) method of [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreControlStyle). Using `SubscriptionStorePicker` in other contexts is not supported.

## Topics

### Creating a subscription store picker

- [init(pickerContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(pickerContent:confirmation:).md)
- [init(_:pickerOptionContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(_:pickerOptionContent:confirmation:).md)

### Managing a subscription picker’s selection state

- [init(selection:pickerContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(selection:pickerContent:confirmation:).md)
- [init(_:selection:pickerOptionContent:confirmation:)](../com.apple.storekit/StoreKit/SubscriptionStorePicker/init(_:selection:pickerOptionContent:confirmation:).md)

## See Also

- [SubscriptionStoreButton](../com.apple.storekit/StoreKit/SubscriptionStoreButton.md)
- [SubscriptionStorePickerOption](../com.apple.storekit/StoreKit/SubscriptionStorePickerOption.md)

---


## subscriptionstorepolicykind

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
struct SubscriptionStorePolicyKind
```

## 

To set the destination of a policy button in a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView), use [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(url:for:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(url:for:)) or [doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(for:destination:)](doc://com.apple.documentation/documentation/SwiftUI/View/subscriptionStorePolicyDestination(for:destination:)).

## Topics

### Getting policy types

- [privacyPolicy](../com.apple.storekit/StoreKit/SubscriptionStorePolicyKind/privacyPolicy.md)
- [termsOfService](../com.apple.storekit/StoreKit/SubscriptionStorePolicyKind/termsOfService.md)

## See Also

- [subscriptionStorePolicyDestination(for:destination:)](../com.apple.SwiftUI/View/subscriptionStorePolicyDestination(for:destination:).md)
- [subscriptionStorePolicyDestination(url:for:)](../com.apple.SwiftUI/View/subscriptionStorePolicyDestination(url:for:).md)
- [subscriptionStorePolicyForegroundStyle(_:)](../com.apple.SwiftUI/View/subscriptionStorePolicyForegroundStyle(_:).md)
- [subscriptionStorePolicyForegroundStyle(_:_:)](../com.apple.SwiftUI/View/subscriptionStorePolicyForegroundStyle(_:_:).md)

---


## supporting-business-model-changes-by-using-the-app-transaction

## 

The [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion) property indicates the app version that the customer purchased. If you change your business model from a paid app to a free app that offers in-app purchases, use this property to learn whether the customer purchased your app before you changed the business model. Then, use that information to determine your customers’ entitlement to features that were available in the paid app.

### 

For example, an app that is a paid app in version 1 has premium features available to everyone who buys it. For version 2, the developer changes the business model, making it a free app that offers in-app purchases. Version 2 of the app has the same premium features, but now they’re available as in-app purchases.

In version 2, the developer wants to continue to provide the premium features to customers who purchased version 1. To do so, the app performs the following steps:

1. The app’s code includes a constant that indicates the version the business model changed; that constant is `"2"` in this example.
2. The app compares the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion)  value with the constant. If the customer purchased the app before the business model changed, the app determines that they’re entitled to the premium features.
3. The app also checks the [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) sequence and delivers any in-app purchases the customers may have made.

### 

An app that performs these steps ensures that paid customers can access the premium features that were included with the app they purchased.

The code examples below demonstrate how an app obtains an [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction), compares the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion](doc://com.apple.storekit/documentation/StoreKit/AppTransaction/originalAppVersion) with a constant that represents a specific app version, and then determines the customer’s entitlements.

Here’s how it looks in macOS:

```swift
do {
    // Get the `appTransaction`.
    let shared = try await AppTransaction.shared
    if case .verified(let appTransaction) = shared {
        // Hard-code the major version number in which the app's business model changed.
        let newBusinessModelMajorVersion = "2" 

        // Get the major version number of the version the customer originally purchased.
        let versionComponents = appTransaction.originalAppVersion.split(separator: ".")
        let originalMajorVersion = versionComponents[0]

        if originalMajorVersion < newBusinessModelMajorVersion {
            // This customer purchased the app before the business model changed.
            // Deliver content that they're entitled to based on their app purchase.
        }
        else {
            // This person purchased the app after the business model changed.
        }
    }
}
catch {
    // Handle errors.
}


// Iterate over any other products they purchased.
for await result in Transaction.currentEntitlements {
    if case .verified(let transaction) = result {
        // Deliver the content based on their current entitlements.
    }
}
```

Here’s an example of the code for an app in iOS, tvOS, watchOS, and visionOS:

```swift
do {
    // Get the `appTransaction`.
    let shared = try await AppTransaction.shared
    if case .verified(let appTransaction) = shared {
        // Hard-code the `CFBundleVersion` number in which the app's business model changed.
        let newBusinessModelVersion = "2"

        // Compare this number with the version number the person originally purchased.
        if appTransaction.originalAppVersion < newBusinessModelVersion {
            // Handle a case in which a person purchased the app before the business model changed.
            // Deliver content that they're entitled to based on their app purchase.
        }
        else {
            // This person purchased the app after the business model changed.
        }
    }
}
catch {
    // Handle errors.
}

// Iterate over any other products they purchased.
for await result in Transaction.currentEntitlements {
    if case .verified(let transaction) = result {
    // Deliver the content based on their current entitlements.
    }
}
```

> **NOTE:** Session 10007:  [https://developer.apple.com/videos/play/wwdc2022/10007/](https://developer.apple.com/videos/play/wwdc2022/10007/)

## See Also

- [AppTransaction](../com.apple.storekit/StoreKit/AppTransaction.md)

---


## supporting-family-sharing-in-your-app

## 

Family Sharing allows a customer to share access to auto-renewable subscriptions or non-consumables with up to five family members on all of their Apple devices. Enabling Family Sharing for a subscription can make your content or service more appealing to subscribers, and may encourage conversion to a paid subscription, increase customer engagement, and improve retention. Developers can choose to turn on Family Sharing for in-app purchases and non-consumables in App Store Connect. Users can also choose whether to share their purchases with family.

When users share a purchase through Family Sharing, each family member gets their own unique receipts and transactions. Process the transactions in the same way you already handle purchases — you don’t need any special logic for shared products. However, you do need to implement a new method in your transaction observer, and listen for a new notification type in server notifications. Specifically, to support Family Sharing, you need to:

- Enable Family Sharing for your in-app purchases in App Store Connect. For more information, see [https://help.apple.com/app-store-connect/#/dev45b03fab9](https://help.apple.com/app-store-connect/#/dev45b03fab9).
- During runtime, check whether in-app purchases support Family Sharing using either  [doc://com.apple.storekit/documentation/StoreKit/Product/isFamilyShareable](doc://com.apple.storekit/documentation/StoreKit/Product/isFamilyShareable) in [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) or [doc://com.apple.storekit/documentation/StoreKit/SKProduct/isFamilyShareable](doc://com.apple.storekit/documentation/StoreKit/SKProduct/isFamilyShareable) in [doc://com.apple.storekit/documentation/StoreKit/SKProduct](doc://com.apple.storekit/documentation/StoreKit/SKProduct). Then inform users when merchandising your subscriptions.
- Process purchased and restored transactions in your app. This is standard processing you already do for any purchases.
- Implement [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)) in your transaction observer to handle conditions in which products are no longer shared.
- Listen for the `REVOKE` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type) from [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications) on your server.

> **NOTE:** Session 10661: [https://developer.apple.com/videos/play/wwdc2020/10661/](https://developer.apple.com/videos/play/wwdc2020/10661/)

### 

To make Family Sharing available for an in-app purchase, developers need to turn on Family Sharing in App Store Connect. After you enable Family Sharing for an in-app purchase, you can’t turn it off. For more information, see [https://help.apple.com/app-store-connect/#/dev45b03fab9](https://help.apple.com/app-store-connect/#/dev45b03fab9).

Users can choose whether to share their purchases with family. As users join or leave family groups and enable or disable sharing, your app needs to update the family’s access to your products. For information about how users manage their Family Sharing choices, see [https://support.apple.com/guide/iphone/set-up-family-sharing-iph223f61318/ios](https://support.apple.com/guide/iphone/set-up-family-sharing-iph223f61318/ios).

### 

Your app receives a unique receipt for each family member entitled to a shared purchase, on each of their devices. For subscriptions, your app unlocks access through the normal purchase flow. For non-consumable products, unlocking access may require users to initiate a restored purchase, depending on the Family Sharing settings at the time of purchase.

To provide access for family members to a subscription or non-consumable, your app needs to handle purchased and restored transactions as usual. Specifically, follow these steps:

1. Set up a transaction observer at app launch so your app receives transactions that occur outside of your app, such as receiving a Family Sharing purchase. For more information on this best practice, see [doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue](doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue).
2. Verify the receipt. Look for a transaction in the latest receipt info array ([doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Latest_receipt_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Latest_receipt_info-data.dictionary)) with the new Family Sharing purchase.
3. Handle purchased ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased)) transactions. This is a standard state apps need to handle, and you don’t need anything special for Family Sharing. For shared subscriptions, the transaction always has a purchased state. For shared non-consumable products, the transaction has a purchased state if Family Sharing was enabled for the product at the time of the purchase. For more information about handling transactions, see [doc://com.apple.storekit/documentation/StoreKit/processing-a-transaction](doc://com.apple.storekit/documentation/StoreKit/processing-a-transaction).
4. Handle restored ([doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/restored)) transactions, which is also a standard state apps need to handle. For shared non-consumable products, your app gets a restored transaction if developers enable Family Sharing after the user purchases the product. To gain access to the shared product, family members use your app’s restore functionality. For more information about restoring, see [doc://com.apple.storekit/documentation/StoreKit/restoring-purchased-products](doc://com.apple.storekit/documentation/StoreKit/restoring-purchased-products).
5. Unlock access to the shared subscription or non-consumable product.
6. Call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

### 

With Family Sharing products, users have access to products only while Family Sharing is enabled. If the purchaser leaves the group, gets a refund, or stops sharing, the expectation is that the family’s access to the product stops immediately.

When a condition occurs that disables sharing, StoreKit informs your app by updating the receipt, and then calling the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)) method of the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol. Implement this method on your transaction observer, and do the following:

1. Verify the receipt. Revoked products appear in the receipt with a `cancellation_date` field present.
2. Provide the app with access to all the products to which the user is entitled.

For more information, including a list of conditions that trigger this call, see [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)).

### 

If you set up your server to receive [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications), your server gets a `REVOKE` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type) as soon as a shared purchase is no longer shared. This notification serves the same purpose as the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:))call. Listen for and process this notification by:

1. Checking the latest receipt ([doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt/Latest_receipt_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreServerNotifications/unified_receipt/Latest_receipt_info-data.dictionary)) in the response body. Revoked products appear in the receipt with a `cancellation_date` field present.
2. Providing the app with access to all products to which the user is entitled.
3. Updating your records, if you keep server-based records to manage your customers’ subscriptions.

### 

When your app displays in-app purchases, indicate in your UI whether users can share the product with family. Call [doc://com.apple.storekit/documentation/StoreKit/SKProduct/isFamilyShareable](doc://com.apple.storekit/documentation/StoreKit/SKProduct/isFamilyShareable) to determine at runtime whether the in-app purchase supports Family Sharing. Knowing whether a product is shareable helps users make a selection that best fits their needs.

## See Also

- [isFamilyShareable](../com.apple.storekit/StoreKit/SKProduct/isFamilyShareable.md)
- [paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)](../com.apple.storekit/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:).md)

---


## supporting-promoted-in-app-purchases-in-your-app

## 

With iOS, you can promote In-App Purchases so users can browse them directly on the App Store. Promoted In-App Purchases display on your product page, appear in search results, and may be featured on an appropriate tab on the App Store. Users can start a purchase on the App Store, which takes them into your app to continue the transaction.

If your app isn’t installed when the user selects to purchase the in-app product, the App Store automatically downloads the app or prompts the user to purchase it. If the installed version of your app is an older version that doesn’t support In-App Purchase promotions, the App Store prompts the user to upgrade the app.

Promoting In-App Purchases requires two steps:

1. In your app, starting in iOS 16.4, implement [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) to complete the purchase users initiate on the App Store. To support this feature in apps that run in iOS 11–16.3, see [doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/promoting-in-app-purchases).
2. In App Store Connect, configure promoted In-App Purchases. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

> **IMPORTANT:** To enable promoted in-app purchases, your app needs to use either [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) (starting in iOS 16.4) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:shouldAddStorePayment:for:)) (starting in iOS 11). Don’t use both at the same time. If necessary, use conditional compilation to identify the OS version the app is running in. For more information, see [doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version](doc://com.apple.documentation/documentation/Xcode/running-code-on-a-specific-version).

You can optionally customize which promoted In-App Purchases a users sees on a specific device using the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) API. Using [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) isn’t required for your promoted In-App Purchases to appear on the App Store.

For marketing guidance on this feature, see [https://developer.apple.com/app-store/promoting-in-app-purchases/](https://developer.apple.com/app-store/promoting-in-app-purchases/).

To test promoted In-App Purchases, see [doc://com.apple.storekit/documentation/StoreKit/testing-promoted-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/testing-promoted-in-app-purchases).

> **NOTE:** Promoted In-App Purchases aren’t available to compatible iPad or iPhone apps running in visionOS.

### 

In App Store Connect, set up promoted In-App Purchases by uploading promotional images. Use the App Store Promotions feature in App Store Connect to manage their default order and visibility. For more information about the setup, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

### 

When users initiate an In-App Purchase on the App Store, StoreKit automatically opens your app and sends the product information in the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents) asynchronous sequence of [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent). Your app needs to complete the purchase transaction and perform any related actions that are specific to it.

To complete the transaction, call the [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) method on the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product) of the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent). Follow the same workflow your app uses for any In-App Purchase, such as unlocking the purchased content and finishing the transaction ([doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish())).

The following code example listens for purchase intents from the App Store. It receives a [doc://com.apple.storekit/documentation/StoreKit/Product](doc://com.apple.storekit/documentation/StoreKit/Product) object when the user taps a promoted In-App Purchase on the App Store, and performs its purchase workflow.

```swift
for await purchaseIntent in PurchaseIntent.intents {
    // Complete the purchase workflow.
    do {
        try await purchaseIntent.product.purchase()
    }
    catch {
        <#Handle Error#>
    }
}
```

### 

In some cases, your app may need to defer or cancel the purchase transaction. For example, you may need to defer the transaction if the user is in the middle of onboarding, and complete it after they finish. Or, you may need to cancel the transaction if the user has already unlocked the product they’re trying to buy.

To defer the transaction, store the purchase intent and process it later after the user finishes onboarding or other actions that require deferring.

To cancel the transaction, don’t call [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)). Instead, provide feedback to the user. Although this step is optional, if you don’t provide feedback, the app’s lack of action after the user initiates the purchase on the App Store may seem like a bug.

### 

To customize promoted In-App Purchases on a device, you can override their default order and visibility using [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo). Use it to show only promotions that are relevant to your user, based on their experience with your app, or based on their previous purchases. For example, suppose a game has In-App Purchases to promote for each game level. You can show only the promoted products for the user’s game level, and hide those they already purchased.

To control whether a promoted In-App Purchase appears in the App Store on the device, use any of these methods:

- Add or remove it from the list. Set the product order by calling [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)) or [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)). Leave out the products you don’t want to display.
- Set its visibility. Show or hide the product by setting its [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) value and calling [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/update()) or [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)), or call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductVisibility(_:for:)).

These overrides are specific to the device, and take effect after the user launches the app at least once.

The following code example uses an array of product identifiers to set their order. It calls [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/currentOrder](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/currentOrder) to get the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo) objects, and sets their visibility directly. It then calls [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)) to save the changes.

```swift
// Set the product order.
let orderedProductIdentifiers = [
    "com.example.ExampleApp.product1",
    "com.example.ExampleApp.product2",
    "com.example.ExampleApp.product3"
]

do {
    try await Product.PromotionInfo.updateProductOrder(byID: orderedProductIdentifiers)
}
catch {
    <#Handle Error#>
}

// Get the current product order.
var promotions: [Product.PromotionInfo] = []

do {
    promotions = try await Product.PromotionInfo.currentOrder
}
catch {
    <#Handle Error#>
}

// Set the visibility for all the products and save the changes.
for i in promotions.indices {
    promotions[i].visibility = .visible
}

do {
    try await Product.PromotionInfo.updateAll(promotions)
}
catch {
    <#Handle Error#>
}
```

The following code example hides a promoted product after the user purchases it:

```swift
// Change the visibility to hide a promoted product after a user purchases it.
let purchasedProductIdentifier = "com.example.ExampleApp.product1"

do {
    try await Product.PromotionInfo.updateProductVisibility(.hidden, for: purchasedProductIdentifier)
}
catch {
    <#Handle Error#>
}
```

### 

To control a promotion’s visibility from App Store Connect, set its [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/visibility-swift.property) value in the app to the default of [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault). Products with this value are visible or hidden based on the setting you configure in App Store Connect. For more information about using App Store Connect, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/promote-in-app-purchases).

For example, to promote a product on a holiday for all users, ensure the app sets the product’s visibility to [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/Visibility-swift.enum/appStoreConnectDefault). In App Store Connect, start with its visibility set as hidden. On the holiday, use App Store Connect to manually change the product to be visible. The promoted product becomes visible in the App Store for all users automatically.

### 

To reset changes your app makes to the promoted products’ order and visibility, call the [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateAll(_:)) or [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/updateProductOrder(byID:)) methods with an empty array. This cancels the overrides so the user can see the promoted In-App Purchases in their default order.

Call [doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/currentOrder](doc://com.apple.storekit/documentation/StoreKit/Product/PromotionInfo/currentOrder) to get a list of your overrides. If the list is empty, the device displays promoted In-App Purchases in their default order.

## See Also

- [PurchaseIntent](../com.apple.storekit/StoreKit/PurchaseIntent.md)
- [PromotionInfo](../com.apple.storekit/StoreKit/Product/PromotionInfo.md)
- [testing-promoted-in-app-purchases](../com.apple.storekit/StoreKit/testing-promoted-in-app-purchases.md)

---


## supporting-subscription-offer-codes-in-your-app

## 

To help you acquire, retain, and win back customers, you can use offer codes. Offer codes are alphanumeric codes that provide In-App Purchases at a discount or for free, for a specific duration. Offer codes are available for all in-app purchase types:  consumables, non-consumables, non-renewing subscriptions, and auto-renewable subscriptions. You can merchandise offer codes within your app or outside of it through your marketing channels.

Create and configure offer codes in App Store Connect, and distribute them to your customers. Customers can redeem offer codes throught a redemption URL, or by entering the code directly in the App Store, or within your app if it implements one of the following APIs:

- [doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)](doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)) on iOS, iPadOS, macOS, and visionOS
- [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)) on iOS, iPadOS, and visionOS
- [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(from:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(from:)) on macOS

When customers redeem a valid offer code, your app receives a successful transaction. If customers redeem offer codes in the App Store and don’t have your app installed, they’re prompted to download it as part of the redemption flow. Successfully redeeming an offer code entitles the customer to the product, the same as a purchase does. Your app needs to provide service for the product.

Offer codes for auto-renewable subscriptions are available starting in iOS 14.2, iPadOS 14.2, macOS 15.0, and visionOS 1.0. Offer codes for consumables, non-consumables, and non-renewing subscriptions are available starting in iOS 16.3, iPadOS 16.3,  macOS 15.0, and visionOS 1.0.

### 

Configure offers and manage your offer codes in App Store Connect. There are three types of offer codes: one-time use codes, custom codes, and sandbox codes for testing. The offer code redemption APIs support all offer codes types. You can have up to 10 active offers at at time, with a limit of 1,000,000 codes per app, per quarter. To distribute offer codes to your customers, download them from App Store Connect.

For more information on creating and distributing offer codes, and to learn which type of offer code may work for your campaign, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-offer-codes](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-offer-codes) and [https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/create-offer-codes-for-in-app-purchases](https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/create-offer-codes-for-in-app-purchases).

### 

To display the system sheet for customers to redeem offer codes within your app, call one of the redemption APIs, depending on your app’s UI implementation:

- Call [doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)](doc://com.apple.documentation/documentation/SwiftUI/View/offerCodeRedemption(isPresented:onCompletion:)) if your app uses SwiftUI.
- Call [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(in:)) if your app uses UIKit.
- Call [doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(from:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/presentOfferCodeRedeemSheet(from:)) if your app uses AppKit for macOS.

The redemption sheet takes care of the redemption flow, including alerting customers about invalid entries, as appropriate. For example, an entry may be invalid if the offer code is expired or invalid, or if redeeming the code would result in a subscription downgrade.

When customers redeem an offer code, StoreKit emits the resulting transaction in [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).  To ensure your app receives all the transactions that `updates` emits, set up the task to listen for transactions as soon as your app launches. See [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) for a code example.

Including the redemption sheet in your app is recommended, but optional. For more guidance on supporting offer code redemption within your app, see Human Interface Guidelines > [https://developer.apple.com/design/human-interface-guidelines/in-app-purchase](https://developer.apple.com/design/human-interface-guidelines/in-app-purchase).

### 

Customers may redeem offer codes outside your app, by entering the offer code in the App Store, or by using a redemption URL. To handle offer codes — and other transactions that can occur outside of your app — your app needs to use [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) to receive new transactions while the app is running. Create a [doc://com.apple.documentation/documentation/Swift/Task](doc://com.apple.documentation/documentation/Swift/Task) to iterate through the transactions from the listener as soon as your app launches. For more information and sample code, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).

When your app launches, it needs to check [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished](doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished) on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) to get any transactions that may have occurred while the app wasn’t running. Process the transactions to ensure your app provides service for all products it’s entitled to. Call [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()) after you process the unfinished transactions.

### 

When customers successfully redeem offer codes, the transaction contains fields that identify the offer and its offer type. Find the offer code details in the transaction information, in your app and on your server, as follows.

In your app, use the following StoreKit APIs to locate the offer code information:

- Check the [doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property) property of [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction), and its [doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/type](doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/type) property. An offer type value of [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/code](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/code) indicates the customer redeemed an offer code.
- If the offer code redemption applies to an auto-renewable subscription’s next renewal period, see the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo) properties [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/offerID](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/offerID) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/offerType-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/offerType-swift.property). An offer type value of [doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/code](doc://com.apple.storekit/documentation/StoreKit/Transaction/OfferType-swift.struct/code) indicates the customer redeemed an offer code.

On your server, use the following server-side APIs to locate offer code information:

- In the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI), when you call endpoints such as [doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-Transaction-History](doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-Transaction-History), [doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-All-Subscription-Statuses](doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-All-Subscription-Statuses), and others, the response contains the signed transaction, [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction). In its decoded payload, [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransactionDecodedPayload](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransactionDecodedPayload), look for the fields [doc://com.apple.documentation/documentation/AppStoreServerAPI/offerIdentifier](doc://com.apple.documentation/documentation/AppStoreServerAPI/offerIdentifier) and [doc://com.apple.documentation/documentation/AppStoreServerAPI/offerType](doc://com.apple.documentation/documentation/AppStoreServerAPI/offerType). An [doc://com.apple.documentation/documentation/AppStoreServerAPI/offerType](doc://com.apple.documentation/documentation/AppStoreServerAPI/offerType) value of `3` indicates the customer redeemed an offer code.
- You receive a notification on your [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) endpoint if someone redeems an offer code. The [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) is `OFFER_REDEEMED` when someone redeems an offer for an active auto-renewable subscription; `SUBSCRIBED` when they redeem the offer code as an initial purchase or to resubscribe. The `notificationType` is `ONE_TIME_CHARGE` when someone redeems an offer code for a consumable, non-consumable, or non-renewing subscription product type. The decoded payloads [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransactionDecodedPayload](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransactionDecodedPayload) and [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSRenewalInfoDecodedPayload](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSRenewalInfoDecodedPayload) contain the fields [doc://com.apple.documentation/documentation/AppStoreServerNotifications/offerIdentifier](doc://com.apple.documentation/documentation/AppStoreServerNotifications/offerIdentifier) and [doc://com.apple.documentation/documentation/AppStoreServerNotifications/offerType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/offerType).

### 

When you acquire new customers with an offer code, they already have an In-App Purchase when they open your app for the first time. In addition to enabling that In-App Purchase, you may need to update your backend system’s records. Your app follows these steps:

1. When the app launches, check [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished](doc://com.apple.storekit/documentation/StoreKit/Transaction/unfinished) on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) to get the current entitlements and any new consumable transactions, respectively. StoreKit automatically validates the transactions, and returns verified results in [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/verified(_:)](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/verified(_:)). To perform your own validation, use the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) property.
2. To determine whether a transaction includes an offer code redemption, check the [doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property) property of [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/type](doc://com.apple.storekit/documentation/StoreKit/Transaction/Offer-swift.struct/type) property of `offer`.
3. Provide the service or product based on the offer, and call [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()) on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).
4. Guide new customers through your new-user experience, as needed. Update your backend system’s records.

When an existing customer redeems an offer code within your app, the transaction comes in through the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) sequence on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction). Process the transaction as usual, providing service based on the offer, and call [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()).

### 

You can test your app’s handling of offer codes in the sandbox environment for all In-App Purchase product types: consumable, non-consumable, non-renewing subscription, and auto-renewable subscription. First, create offer codes for the sandbox environment in App Store Connect. For more information on creating these codes, see [https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/create-offer-codes-for-in-app-purchases](https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/create-offer-codes-for-in-app-purchases). Each quarter, you can create up to 10,000 codes for testing.

To redeem an offer code in the sandbox environment, follow these steps:

- On your device, sign in using a Sandbox Apple Account.
- On the Sandbox Account Settings page, tap Initiate Transaction.
- Select Offer Codes and redeem a sandbox offer code you created in App Store Connect.

If your app supports redeeming offer codes in your app, test redeeming a sandbox offer code from your app. Navigate to the redemption sheet in your app and enter the offer code.

The sandbox environment operates with these conditions:

- It doesn’t enforce a redemption limit for a Sandbox Apple Account. This means you can test multiple offer codes using the same testing account.
- It ignores eligibility criteria for offer codes for consumable, non-consumable, and non-recurring subscription product types.
- It applies eligibility criteria to offer codes for auto-renewable subscriptions. To test subscription offer codes again, clear the sandbox account purchase history. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings)
- It verifies whether an offer code is available in the storefront of the Sandbox Apple Account.

On your server, [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications) notifies you of offer code redemptions in the sandbox environment if you enable a notifications endpoint for the sandbox environment. For more information, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications).

For more information on sandbox testing, see [doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox](doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox).

### 

If your app runs on iOS 16 or earlier, and iPadOS 16 or earlier, you can support offer codes for auto-renewable subscriptions only. Use [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()) to display the offer code redemption UI. Otherwise, use the APIs referred to in this article. For more information about supporting earlier systems, see [doc://com.apple.storekit/documentation/StoreKit/implementing-offer-codes-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-offer-codes-in-your-app).

## See Also

- [supporting-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/supporting-win-back-offers-in-your-app.md)
- [merchandising-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/merchandising-win-back-offers-in-your-app.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)
- [OfferType](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType.md)

---


## supporting-win-back-offers-in-your-app

## 

A win-back offer is a free or discounted offer for an auto-renewable subscription for eligible customers whose subscription is *churned*. A churned subscription is one that has an [doc://com.apple.storekit/documentation/StoreKit/Transaction/expirationDate](doc://com.apple.storekit/documentation/StoreKit/Transaction/expirationDate) in the past, and a [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/willAutoRenew](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/willAutoRenew) value of `false`. You set up win-back offers in App Store Connect, including the criteria that determines whether a customer is eligible. You can base eligibility on the duration of the customer’s paid subscription, the time since the subscription expired, and the time that must pass between redeemed offers. You also set the discount type, and specify the regions or countries in which the offer is available.

> **NOTE:** Session 10110: [https://developer.apple.com/wwdc24/10110](https://developer.apple.com/wwdc24/10110)

You can merchandise win-back offers in multiple ways. App Store Connect provides a direct link that you can share through your own channels, such as email. Customers can also discover and redeem win-back offers in the App Store, in their Apple account in the Subscription settings, and in your app.

Within your app, you can merchandise win-back offers with the win-back offer sheet, using StoreKit views, or by using other StoreKit APIs to fully customize your own merchandising.

Your app needs to handle win-back offers that customers redeem outside the app. By default, your app receives a completed purchase transaction when someone redeems the offer outside of the app. This workflow results when the Streamlined Purchasing option in App Store Connect is on, its default state. You can choose to turn off Streamlined Purchasing to enable the customer to complete the purchase within your app. For more information, see [doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app#Handle-win-back-offers-redeemed-outside-of-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app#Handle-win-back-offers-redeemed-outside-of-your-app) below.

### 

Set up win-back offers in App Store Connect by following the instructions in [https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers](https://developer.apple.com/help/app-store-connect/manage-subscriptions/set-up-win-back-offers). As you set up a win-back offer, consider the following:

- You create the win-back offer identifier. This alphanumeric string appears in transaction information and subscription renewal information.
- After you confirm the win-back offer details, App Store Connect creates a numeric win-back offer Apple ID for the offer, and a direct link. The direct link uses the offer’s Apple ID, and has the format `https://apps.apple.com/win-back/<win-back offer Apple ID>`.
- Add an approved subscription image in App Store Connect. The App Store requires the image if you choose to promote the win-back offer on the App Store. The win-back offer sheet and the direct link also use the image, if it’s available. For more information, see [https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/view-and-edit-in-app-purchase-information#add-or-remove-an-image](https://developer.apple.com/help/app-store-connect/manage-in-app-purchases/view-and-edit-in-app-purchase-information#add-or-remove-an-image).

> **TIP:** Store the win-back offer identifier and its corresponding direct link on your server, for easy access later.

### 

When you set up your win-back offer, you can also set the Streamlined Purchasing option in App Store Connect. This setting applies to all win-back offers and contingent pricing in your app. It affects how your app handles a win-back offer redemption, as follows:

- With Streamlined Purchasing on (default), the customer completes the win-back offer purchase outside of your app. Your app receives a completed purchase transaction in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) sequence if it’s running, and in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all) or [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) sequences otherwise. Your app is responsible for unlocking the purchased product, as usual.
- With Streamlined Purchasing turned off, your app has the opportunity to perform processing related to the win-back offer before it enables the customer to complete the purchase. The workflow starts when the customer initiates the purchase outside of your app. The system prompts them to install the app if it isn’t already installed. Your app receives a_ _purchase intent in the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents) sequence, instead of a transaction, and must use the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) API to complete the purchase.
- If customers redeem a win-back offer through the manage subscriptions page in their Apple account, the redemption always behaves as if Streamline Purchasing is on, and your app receives a completed purchase transaction.

> **IMPORTANT:** Before you can turn off the Streamlined Purchasing option in App Store Connect, your lastest approved app binary must use the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) API.

For more information on configuring this setting in App Store Connect, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/manage-streamlined-purchasing](https://developer.apple.com/help/app-store-connect/manage-subscriptions/manage-streamlined-purchasing).

### 

StoreKit provides several ways to merchandise win-back offers to eligible customers in your app. By default, StoreKit displays a win-back offer sheet when it receives a [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/winBackOffer](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/winBackOffer) message from the App Store. You can also merchandise the win-back offer using StoreKit views, or other StoreKit APIs to fully customize the experience.

For information on implementing each of these options, see [doc://com.apple.storekit/documentation/StoreKit/merchandising-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/merchandising-win-back-offers-in-your-app).

### 

After you create a win-back offer, App Store Connect provides a direct link. Use the direct link to merchandise the win-back offer through your own channels.

Before you send a direct link to a customer, check whether the customer is eligible to redeem the offer by calling the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-All-Subscription-Statuses](doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-All-Subscription-Statuses) endpoint from your server. The [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfoDecodedPayload](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfoDecodedPayload) from the response contains the [doc://com.apple.documentation/documentation/AppStoreServerAPI/eligibleWinBackOfferIds](doc://com.apple.documentation/documentation/AppStoreServerAPI/eligibleWinBackOfferIds) array, which lists the eligible offers. Send the direct link to eligible customers only.

If the [doc://com.apple.documentation/documentation/AppStoreServerAPI/eligibleWinBackOfferIds](doc://com.apple.documentation/documentation/AppStoreServerAPI/eligibleWinBackOfferIds) array has multiple entries, the customer is eligible for more than one offer. The App Store sets the order of the win-back offer IDs with the best offer first. The order takes into account the available offers you configure in App Store Connect for the customer’s most recent subscription in the subscription group.

### 

When customers redeem a win-back offer using the win-back offer sheet, StoreKit treats this transaction the same as a purchase that occurs outside of the app. Specifically, the app receives the transaction in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) sequence of [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction). Be sure your app creates a task to iterate through [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) as soon as it launches. For more information and sample code, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).

### 

Customers can discover and redeem win-back offers outside of your app in several ways: through the direct link that you merchandise, in the App Store, and when they manage their subscriptions in their Apple account. How your app handles the redemption depends on the whether the Streamlined Purchasing setting is on or off in App Store Connect.

If Streamlined Purchasing is on (the default setting), customers complete the win-back offer purchase outside of your app. Your app receives the completed purchase transaction the next time they open the app. Treat this transaction the same as any purchase that completes outside of your app, and unlock the purchased content. Specifically:

- To get the transactions that occurred in the past, including while your app wasn’t running, iterate the [doc://com.apple.storekit/documentation/StoreKit/Transaction/all](doc://com.apple.storekit/documentation/StoreKit/Transaction/all) or [doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements](doc://com.apple.storekit/documentation/StoreKit/Transaction/currentEntitlements) sequences on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) when the app launches.
- To observe transactions that occur outside of the app while the app is running, iterate [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) on [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction). Create a [doc://com.apple.documentation/documentation/Swift/Task](doc://com.apple.documentation/documentation/Swift/Task) to iterate through the transactions from the listener as soon as your app launches. For more information and sample code, see [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates).

The transaction entitles the customer to the auto-renewable subscription. Your app unlocks the purchased content and finishes the transaction with [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()).

If you turn off Streamlined Purchasing in App Store Connect, your app receives a purchase intent instead of a completed transaction. When a customer initiates a redemption outside your app, with Streamlined Purchasing off, the flow is as follows:

1. The system opens your app if it isn’t already running. StoreKit doesn’t display the win-back offer sheet when a purchase intent is in progress.
2. StoreKit sends the win-back offer information to the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/intents) asynchronous sequence of [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent).
3. Your app has the opportunity to perform any actions related to the purchase before it prompts the customer to complete the purchase. For example, your app might ask the customer to log in.
4. Your app calls the [doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)](doc://com.apple.storekit/documentation/StoreKit/Product/purchase(options:)) method on the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/product) of the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) to enable the customer to complete the purchase. Be sure to add the win-back offer to the purchase options.

The following example checks the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/offer](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/offer) property of [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) to detect whether the purchase intent is for a win-back offer, and adds the offer to the purchase options:

```swift
// Prepare the purchase options.
var purchaseOptions: Set<Product.PurchaseOption> = []

// Add the win-back offer to the purchase.
if let offer = purchaseIntent.offer, offer.type == .winBack {
    purchaseOptions.insert(.winBackOffer(offer))
}

// Present the purchase.
let result = try await purchaseIntent.product.purchase(options: purchaseOptions)
```

Finally, follow the same workflow your app uses for any successful purchase, such as unlocking the purchased content and finishing the transaction with [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()).

> **NOTE:** If your app uses the [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent) API but doesn’t explicitly add support for win-back offers using [doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/offer](doc://com.apple.storekit/documentation/StoreKit/PurchaseIntent/offer), StoreKit adds the win-back offer to the purchase options on devices running iOS 18 and later and visionOS 2 and later.

### 

When customers successfully redeem subscription offers, including win-back offers, the transaction information contains the offer details. Find those details in the app and on your server, as follows:

- In your app, check the [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) property, [doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/offer-swift.property). An offer type value of `winback` indicates the customer redeemed a win-back offer.
- On your server, check the [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransactionDecodedPayload](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransactionDecodedPayload) that you receive in [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) notifications or [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI) responses. The [doc://com.apple.documentation/documentation/AppStoreServerAPI/offerIdentifier](doc://com.apple.documentation/documentation/AppStoreServerAPI/offerIdentifier) represents the offer that’s applied to the transaction. An [doc://com.apple.documentation/documentation/AppStoreServerAPI/offerType](doc://com.apple.documentation/documentation/AppStoreServerAPI/offerType) of `4` indicates a win-back offer.

### 

You can test win-back offers early in your development using StoreKit Testing in Xcode, and in the sandbox environment. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-xcode](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-xcode) and [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment).

## See Also

- [supporting-offer-codes-in-your-app](../com.apple.storekit/StoreKit/supporting-offer-codes-in-your-app.md)
- [merchandising-win-back-offers-in-your-app](../com.apple.storekit/StoreKit/merchandising-win-back-offers-in-your-app.md)
- [SubscriptionOffer](../com.apple.storekit/StoreKit/Product/SubscriptionOffer.md)
- [OfferType](../com.apple.storekit/StoreKit/Product/SubscriptionOffer/OfferType.md)

---


## testing-a-payment-request

## 

Create an instance of [doc://com.apple.storekit/documentation/StoreKit/SKPayment](doc://com.apple.storekit/documentation/StoreKit/SKPayment) using a valid product identifier that you’ve already tested, as described in [doc://com.apple.storekit/documentation/StoreKit/testing-fetching-product-identifiers](doc://com.apple.storekit/documentation/StoreKit/testing-fetching-product-identifiers). Set a breakpoint and inspect the payment request. Add the payment request to the transaction queue, and set a breakpoint to confirm that the system calls your observer’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) method.

Though you can finish the transaction immediately without providing the content of the purchase during testing, failing to finish the transaction can cause problems. Unfinished transactions remain in the queue indefinitely, which could interfere with later testing. Complete the transaction as described in [doc://com.apple.storekit/documentation/StoreKit/finishing-a-transaction](doc://com.apple.storekit/documentation/StoreKit/finishing-a-transaction) at the end of each test.

## See Also

- [testing-purchases-made-outside-your-app](../com.apple.storekit/StoreKit/testing-purchases-made-outside-your-app.md)
- [testing-win-back-offers-in-the-sandbox-environment](../com.apple.storekit/StoreKit/testing-win-back-offers-in-the-sandbox-environment.md)
- [testing-an-interrupted-purchase](../com.apple.storekit/StoreKit/testing-an-interrupted-purchase.md)
- [testing-failing-subscription-renewals-and-in-app-purchases](../com.apple.storekit/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases.md)

---


## testing-a-product-request

## 

After setting a breakpoint in your code, use the list of product identifiers that you tested in [doc://com.apple.storekit/documentation/StoreKit/testing-fetching-product-identifiers](doc://com.apple.storekit/documentation/StoreKit/testing-fetching-product-identifiers) to create and submit an instance of [doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest](doc://com.apple.storekit/documentation/StoreKit/SKProductsRequest). Then inspect the lists of valid and invalid product identifiers. If there are invalid product identifiers, review your products in App Store Connect and correct your JSON file or property list.

> **NOTE:** Changes that you make to product metadata in App Store Connect can take up to one hour to appear in the sandbox environment.

See [doc://com.apple.storekit/documentation/StoreKit/testing-invalid-product-identifier-handling](doc://com.apple.storekit/documentation/StoreKit/testing-invalid-product-identifier-handling) for more information.

## See Also

- [testing-fetching-product-identifiers](../com.apple.storekit/StoreKit/testing-fetching-product-identifiers.md)
- [testing-invalid-product-identifier-handling](../com.apple.storekit/StoreKit/testing-invalid-product-identifier-handling.md)

---


## testing-a-successful-transaction

## 

Set a breakpoint in your implementation of the transaction queue observer’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) method. Then sign in to the App Store with a Sandbox Apple Account, and make a purchase in your app. Inspect the transaction to verify that its status is [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased).

Set a breakpoint at the point in your code where your app stores the purchase, and confirm that your code saves the data in response to a successful purchase. Inspect the user default or iCloud key-value store, to verify that your code correctly records the information. For more information on saving data in response to a successful purchase, see [doc://com.apple.storekit/documentation/StoreKit/persisting-a-purchase](doc://com.apple.storekit/documentation/StoreKit/persisting-a-purchase).

## See Also

- [testing-transaction-observer-code](../com.apple.storekit/StoreKit/testing-transaction-observer-code.md)
- [testing-complete-transactions](../com.apple.storekit/StoreKit/testing-complete-transactions.md)

---


## testing-ad-attributions-with-a-downloaded-profile

## 

You can reduce the time window for receiving ad attribution postbacks by installing an SKAdNetwork testing profile on your test device.

> **IMPORTANT:** To download the latest profile, see the [doc://com.apple.documentation/documentation/AdAttributionKit](doc://com.apple.documentation/documentation/AdAttributionKit) article on [doc://com.apple.documentation/documentation/AdAttributionKit/testing-ad-attributions-with-a-downloaded-profile](doc://com.apple.documentation/documentation/AdAttributionKit/testing-ad-attributions-with-a-downloaded-profile). This profile is compatible with both AdAttributionKit and SKAdNetwork.

For information about installing profiles, see [https://support.apple.com/en-us/HT209435](https://support.apple.com/en-us/HT209435). You can install this profile on devices running iOS or iPadOS 14 or later.

With this profile, the installed app has five minutes to update the conversion value after initially registering. The device sends the postback within another five minutes after the rolling five-minute timer for conversion updates expires. Using this profile reduces the conversion value update and postback window from 24–48 hours to 5–10 minutes.

This testing profile expires two weeks after you install it on the device. To continue testing, download the latest profile and reinstall it.

### 

To test ad attributions, you must log in to the device with a production Apple Account. SKAdNetwork doesn’t support Sandbox Apple Accounts.

### 

On devices running iOS 14.7 and later with this profile installed, the system can send SKAdNetwork postbacks through an HTTP proxy that you configure. By using an HTTP proxy, you can monitor the HTTP traffic between your device and the network, including SKAdNetwork postbacks.

To configure the HTTP proxy, do the following on a testing device:

1. Go to Settings > Wi-Fi and select the Wi-Fi network you’re connected to.
2. Under the HTTP Proxy heading, select Configure Proxy.
3. Select Manual to configure the Server, Port, and Authentication settings for your proxy, or select Automatic to provide a URL for your proxy.
4. Tap Save.

With the profile installed, the SKAdNetwork postbacks that the device sends now go through the proxy you configured.

## See Also

- [testing-and-validating-ad-impression-signatures-and-postbacks-for-skadnetwork](../com.apple.StoreKitTest/testing-and-validating-ad-impression-signatures-and-postbacks-for-skadnetwork.md)

---


## testing-age-assurance-in-sandbox

## 

You can provide people the ability to make decisions about who can access your app, or parts of your app. [doc://com.apple.documentation/documentation/DeclaredAgeRange](doc://com.apple.documentation/documentation/DeclaredAgeRange) API enables you to request people’s age and create custom experiences based on the information they share, and [doc://com.apple.documentation/documentation/PermissionKit](doc://com.apple.documentation/documentation/PermissionKit) gives you the ability to provide parents or guardians the opportunity to decide if their child can access your app. Make sure your app implements age restrictions and processes permission revocation as parents or guardians instruct.

In the Sandbox environment you can test how your app responds to various age range scenarios, location-based restrictions, approval state changes, and consent revocation. Focus on testing age range variations across your target audience, and consider regulatory compliance in different regions.

### 

Test various age range scenarios on the Sandbox Apple Account page in iOS or iPadOS by following these steps:

1. Confirm that you have enabled Developer Mode. If you haven’t, see [doc://com.apple.documentation/documentation/Xcode/enabling-developer-mode-on-a-device](doc://com.apple.documentation/documentation/Xcode/enabling-developer-mode-on-a-device)
2. Open Settings and select Developer.
3. Scroll down to Sandbox Apple Account.
4. If you’re not logged in to an account, select Sign In to authenticate yourself.
5. Once you’re signed in, select your Apple Account.
6. In the Sandbox Apple Account modal, select Manage.
7. Scroll down and select Age Assurance or Revoke App Consent.

You can also change these settings in App Store Connect.

When you select a scenario, the Declared Age Range API returns the corresponding [doc://com.apple.documentation/documentation/DeclaredAgeRange/AgeRangeService/AgeRange/upperBound](doc://com.apple.documentation/documentation/DeclaredAgeRange/AgeRangeService/AgeRange/upperBound), [doc://com.apple.documentation/documentation/DeclaredAgeRange/AgeRangeService/AgeRange/lowerBound](doc://com.apple.documentation/documentation/DeclaredAgeRange/AgeRangeService/AgeRange/lowerBound), and [doc://com.apple.documentation/documentation/DeclaredAgeRange/AgeRangeService/AgeRange/ageRangeDeclaration](doc://com.apple.documentation/documentation/DeclaredAgeRange/AgeRangeService/AgeRange/ageRangeDeclaration) values, and PermissionKit returns the associated response status. Refer to the following table to check the specific values returned for each test case.

> **NOTE:** The age ranges in the test case are inclusive, meaning that all the ages between and including that age qualify as valid inputs in the test case.

| Test case | Lower bound | Upper bound | Age declaration | Significant app update notification | PermissionKit response |
| --- | --- | --- | --- | --- | --- |
| Under 13, approved | — | 12 | [https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/guardianpaymentchecked](https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/guardianpaymentchecked) | True | [doc://com.apple.documentation/documentation/PermissionKit/PermissionChoice/approve](doc://com.apple.documentation/documentation/PermissionKit/PermissionChoice/approve) |
| Ages 13 - 15, approved | 13 | 15 | [https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/guardianpaymentchecked](https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/guardianpaymentchecked) | True | [doc://com.apple.documentation/documentation/PermissionKit/PermissionChoice/approve](doc://com.apple.documentation/documentation/PermissionKit/PermissionChoice/approve) |
| Ages 16 - 17, declined | 16 | 17 | [https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/guardianpaymentchecked](https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/guardianpaymentchecked) | True | [doc://com.apple.documentation/documentation/PermissionKit/PermissionChoice/decline](doc://com.apple.documentation/documentation/PermissionKit/PermissionChoice/decline) |
| 18+, self declared | 18 | — | [https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/selfdeclared](https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/selfdeclared) | False | [doc://com.apple.documentation/documentation/PermissionKit/AskError/systemError(underlyingError:)](doc://com.apple.documentation/documentation/PermissionKit/AskError/systemError(underlyingError:)) |
| 18+, payment checked | 18 | — | [https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/paymentchecked](https://developer.apple.com/documentation/declaredagerange/agerangeservice/agerangedeclaration/paymentchecked) | False | [doc://com.apple.documentation/documentation/PermissionKit/AskError/systemError(underlyingError:)](doc://com.apple.documentation/documentation/PermissionKit/AskError/systemError(underlyingError:)) |

Check the `AgeRangeDeclaration` field in your Declared Age Range API responses to determine status.

### 

To test the notification when a parent or guardian revokes access to your app on behalf of their child, follow these steps:

1. Start with a Sandbox account.
2. From the Age Assurance settings, tap Revoke App Consent.
3. Enter your app’s Bundle ID (for example, com.example.bundle).
4. Tap Revoke Consent to simulate the revocation.
5. Confirm that the system displays “Notification Triggered” with the message “A notification will be sent to the developer server soon.”

If you have [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) enabled, your server receives a `RESCIND_CONSENT` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType). The notification payload includes an [doc://com.apple.documentation/documentation/AppStoreServerNotifications/appData](doc://com.apple.documentation/documentation/AppStoreServerNotifications/appData) object with app metadata, including the `bundleId` and `environment` fields that help you check the notification applies to the correct app and test environment.

---


## testing-an-auto-renewable-subscription

## 

Auto-renewable subscriptions behave differently in the sandbox environment and the production environment.

In the sandbox environment, subscription renewals happen at an accelerated rate, and auto-renewable subscriptions renew up to 12 times after the initial purchase. This enables you to test how your app handles a subscription renewal, a subscription lapse, and a subscription history that includes gaps.

You can choose a subscription renewal speed for each Sandbox Apple Account in App Store Connect. For a complete list of subscription durations within the sandbox environment and more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings/](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings/).

The accelerated expiration and renewal rates in the sandbox environment make it possible for subscriptions to expire before the system tries to renew them. When a subscription expires before the system tries to renew it, it results in a short lapse in the subscription period. These lapses are possible in production; verify that your app handles them appropriately.

## See Also

- [testing-resubscribing-from-the-subscriptions-page](../com.apple.storekit/StoreKit/testing-resubscribing-from-the-subscriptions-page.md)
- [testing-disabling-auto-renew](../com.apple.storekit/StoreKit/testing-disabling-auto-renew.md)

---


## testing-an-interrupted-purchase

## 

An interrupted purchase is a transaction that requires the user to perform some action outside of your app before completing their transaction. For example, the user may need to update their payment method or accept new terms and conditions before continuing with their transaction.

In sandbox testing, you can simulate an interrupted purchase by turning on the interrupted purchase feature in App Store Connect for a tester Sandbox Apple Account. This interrupts all purchase attempts by that Sandbox Apple Account until you agree to the updated terms and conditions on the iOS device, or until you turn off the feature in App Store Connect. To learn how to set up interrupted purchase testing, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#enable-interrupted-purchases-for-a-sandbox-apple-id](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#enable-interrupted-purchases-for-a-sandbox-apple-id).

### 

To enable interrupted purchases for the Sandbox Apple Account, log in to [https://appstoreconnect.apple.com/login](https://appstoreconnect.apple.com/login), and do the following:

1. From Users and Access, open the Users and Access Panel in the sidebar, under the Sandbox header, select Testers. On the right, you can view your Sandbox Apple Accounts.
2. Select a Sandbox Apple Account to use for testing interrupted purchases. If it’s already enabled, you’ll see a checkmark under the Interrupted Purchases column.
3. In the dialog that appears, select Interrupt Purchases for This Tester.

### 

After setting up interrupted purchase testing in App Store Connect, use the following steps to test your app:

1. On the test device, sign in with the Sandbox Apple Account that has interrupted purchases enabled.
2. In your app, select Buy or Subscribe to make an in-app purchase.
3. Observe that the system displays a payment sheet.
4. In Xcode, verify that the payment queue receives a new transaction in the state [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing).
5. On the device, authenticate the payment sheet.
6. In Xcode, observe that the payment fails. The payment queue receives an updated transaction in the state [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed).
7. Check that your code calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) to remove it from the queue.
8. On the device, observe that the system displays Terms & Conditions, interrupting the purchase (because you configured the sandbox environment to do so).
9. On the device, tap to agree to the Terms & Conditions.
10. In Xcode, verify that the payment queue receives a new transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state for the same [doc://com.apple.storekit/documentation/StoreKit/SKPayment/productIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKPayment/productIdentifier) and in the same quantity as the failed transaction.
11. In Xcode, validate the receipt. Check that your app provides the service or the product, and calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).
12. On the device, the user should observe a successful purchase.

### 

The Sandbox Apple Account continues to experience interrupted purchases until you disable it in App Store Connect, or until the user agrees to the terms and conditions on the device. To disable interrupted purchases in App Store Connect, deselect Interrupt Purchases for This Tester. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#enable-interrupted-purchases-for-a-sandbox-apple-id](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#enable-interrupted-purchases-for-a-sandbox-apple-id).

## See Also

- [testing-purchases-made-outside-your-app](../com.apple.storekit/StoreKit/testing-purchases-made-outside-your-app.md)
- [testing-win-back-offers-in-the-sandbox-environment](../com.apple.storekit/StoreKit/testing-win-back-offers-in-the-sandbox-environment.md)
- [testing-failing-subscription-renewals-and-in-app-purchases](../com.apple.storekit/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases.md)
- [testing-a-payment-request](../com.apple.storekit/StoreKit/testing-a-payment-request.md)

---


## testing-app-store-server-notifications

## 

If you enabled notifications from the App Store for your app, test your logic for transactions in the sandbox environment. To determine if a notification for a subscription event occurred in the test environment, check whether the value of the `environment` field equals `Sandbox` in the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/data](doc://com.apple.documentation/documentation/AppStoreServerNotifications/data) object of the App Store Server Notifications [doc://com.apple.documentation/documentation/AppStoreServerNotifications/responseBodyV2DecodedPayload](doc://com.apple.documentation/documentation/AppStoreServerNotifications/responseBodyV2DecodedPayload) object.

For more information about the App Store Server Notifications service, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications). To ask the App Store to send test notifications, and to get a history of notifications sent to your server, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/Request-a-Test-Notification](doc://com.apple.documentation/documentation/AppStoreServerAPI/Request-a-Test-Notification) and [doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-Notification-History](doc://com.apple.documentation/documentation/AppStoreServerAPI/Get-Notification-History) in the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI).

---


## testing-ask-to-buy-in-xcode

## 

With Ask to Buy, when a child wants to make an eligible purchase or download, the system sends the purchase request to the parent or guardian. For more information, see [https://support.apple.com/105055](https://support.apple.com/105055).

You can test approving and declining Ask to Buy purchases in the Xcode testing environment. Use the StoreKit configuration file to set up and control the test case.

### 

Before you can begin testing in Xcode, complete the steps in [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode), to create a StoreKit configuration file and enable StoreKit testing in Xcode.

### 

Open the StoreKit configuration editor in Xcode and define at least one in-app purchase. Then follow these steps in the StoreKit configuration editor:

1. In the left pane, select Configuration Settings.
2. Under the Purchase Options heading in the editor, enable Ask to Buy.

### 

To test approving a purchase, run your app in the Xcode environment and follow these steps:

1. In your app, attempt to purchase the in-app purchase.
2. When the Ask Permission dialog appears, select Ask.
3. In the Xcode StoreKit transaction manager, notice that the Pending Approval purchase appears with a state of Pending Ask to Buy. In your code, verify the purchase state is [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/pending](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/pending).
4. Control-click the transaction and select Approve.
5. In the Xcode StoreKit transaction manager, verify that the state is now Ask to Buy Approved. In your code, verify the purchase state is [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/success(_:)](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/success(_:)).
6. Check that the app unlocks the content and finishes the transaction.

### 

To test declining a purchase, run your app in the Xcode environment and follow these steps:

1. In your app, attempt to purchase the in-app purchase.
2. When the Ask Permission dialog appears, select Ask.
3. In the Xcode StoreKit transaction manager, notice that the Pending Approval purchase appears with a state of Pending Ask to Buy. In your code, verify the purchase state is [doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/pending](doc://com.apple.storekit/documentation/StoreKit/Product/PurchaseResult/pending).
4. Control-click the transaction and select Decline.
5. In the Xcode StoreKit transaction manager, verify that the state is now Ask to Buy Declined. Your app doesn’t receive a transaction because you declined Ask to Buy.

For more information about using the transaction manager, see [doc://com.apple.documentation/documentation/Xcode/testing-in-app-purchases-with-storeKit-transaction-manager-in-code](doc://com.apple.documentation/documentation/Xcode/testing-in-app-purchases-with-storeKit-transaction-manager-in-code).

### 

You can run the same test again without resetting state values. When you’re done, turn off Ask to Buy to prevent it from affecting future tests.

## See Also

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)
- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [testing-win-back-offers-in-xcode](../com.apple.storekit/StoreKit/testing-win-back-offers-in-xcode.md)

---


## testing-at-all-stages-of-development-with-xcode-and-the-sandbox

## 

Use the Apple sandbox and Xcode test environments to test your implementation of in-app purchases using the StoreKit framework. Comprehensive testing can help you:

- Ensure a seamless purchase flow to provide a positive customer experience in your app.
- Implement sound logic that covers all scenarios, such as purchases, restores, and subscription offers.
- Validate that purchases behave correctly in production after your app is available in the App Store.

The tools you need to test in-app purchases, non-renewing subscriptions, and auto-renewable subscriptions from early development through beta testing are:

Choose the tools that support the test scenarios you need. Make sure you’re able to perform the setup required for the tools you choose.

During the early stages of development, you may not be ready to configure in-app purchases in App Store Connect. StoreKit Testing in Xcode lets you configure the information locally. You can test StoreKit transactions before you create Sandbox Apple Accounts, without a network connection. You can test your app in Simulator or on real devices.

After you set up in-app purchases in App Store Connect, start using the sandbox environment to test the product information your app will use in production. Testing in the sandbox lets you test transactions from end-to-end and from your app to your server. You can also test any server-to-server functionalities your app depends on, such as transaction validation and [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications).

TestFlight lets you get feedback from members of your team or from external testers. TestFlight uses the sandbox environment for in-app purchases. Transactions and purchases that occur in the sandbox don’t incur charges. The following table compares the test environments and features:

| Test environment | Requires App Store Connect setup | Provides receipts and JSON Web Signature (JWS) transactions signed by the App Store | Provides subscription renewal information signed by the App Store |
| --- | --- | --- | --- |
| StoreKit Testing in Xcode | No | No (signed by Xcode) | No (signed by Xcode) |
| Sandbox | Yes | Yes | Yes |
| TestFlight (uses the sandbox) | Yes | Yes | Yes |

None of the test environments charge users when they test buying a product. The App Store doesn’t send emails for purchases or refunds made in the test environments.

### 

To set up and run test scenarios, you often need to control the test environment. For example, you may want to reset a test account to rerun the same test multiple times, or mimic actions users take outside your app that affect the test conditions. The following table shows the capabilities each tool has to control the test environment:

| Test scenario | Sandbox | StoreKit Testing in Xcode |
| --- | --- | --- |
| Test different storefronts to affect price tiers and locale | Yes | Limited (no price tiers) |
| Clear the purchase history | Yes | Yes |
| Test subscription upgrades, downgrades, cross-grades, and auto-renew cancellations | Yes | Yes |
| Reset eligibility for introductory offers | Yes | Yes |
| Introduce forced StoreKit errors for testing | No | Yes |
| Speed up or slow down the rate of time for testing subscription renewals | Yes | Yes |

For more information about speeding up renewal periods for testing, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases-main/test-in-app-purchases](https://developer.apple.com/help/app-store-connect/test-in-app-purchases-main/test-in-app-purchases).

### 

All apps that offer in-app purchases need to support restoring purchases, displaying in-app purchases to the customer, and handling basic transactions. The following table lists common test scenarios and whether they’re testable in the sandbox or Xcode:

| Test scenario | Sandbox | StoreKit Testing in Xcode |
| --- | --- | --- |
| Restore purchases | Yes | Yes |
| Finish a transaction with [doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()](doc://com.apple.storekit/documentation/StoreKit/Transaction/finish()) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) | Yes | Yes |
| Buy a consumable or non-consumable in-app purchase | Yes | Yes |
| Repurchase a non-consumable purchase for repeated testing | Yes | Yes |
| Purchase an auto-renewable subscription | Yes | Yes |
| Purchase a non-renewing subscription | Yes | Yes |
| Refund an in-app purchase | Yes | Yes |
| Test an interrupted purchase, where the user must complete actions outside the app | Yes | Yes |
| Test a failed purchase attempt when payment authorization fails | Yes | Yes |
| Retrieve configured in-app purchases from App Store Connect | Yes | Yes (optionally); can also retrieve data from a StoreKit configuration file |
| Manage subscriptions within your app with [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)) and [doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)](doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)) | Yes | Yes |
| Initiate a refund request. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests](doc://com.apple.storekit/documentation/StoreKit/testing-refund-requests). | Yes | Yes |

### 

Depending on the in-app purchases your app offers, you may need to test scenarios that involve auto-renewing subscriptions, introductory offers, promotional offers, and Ask to Buy. The following table lists test scenarios and whether they’re testable in the sandbox or Xcode:

| Test scenario | Sandbox | StoreKit Testing in Xcode |
| --- | --- | --- |
| Initiate an Ask to Buy transaction that results in a deferred state | Yes | Yes |
| Resolve an Ask to Buy transaction by approving or rejecting it | No | Yes |
| Redeem an introductory offer for an auto-renewable subscription | Yes | Yes |
| Redeem a promotional offer for an auto-renewable subscription | Yes | Yes |
| Redeem an offer code | No | Yes |
| Process a subscription renewal | Yes | Yes |
| Process a revoked or refunded subscription | Yes | Yes |
| Respond to a customer canceling a subscription and disabling auto-renew | Yes | Yes |
| Respond to an expired subscription | Yes | Yes |
| Process a subscription upgrade or downgrade | Yes | Yes |
| Process a subscription cross-grade with the same or different duration | Yes | Yes |
| Test a price increase for an auto-renewable subscription | No | Yes |
| Test billing retry and billing grace period | Yes | Yes |

For more information, see [https://support.apple.com/en-us/HT201089](https://support.apple.com/en-us/HT201089) and [doc://com.apple.storekit/documentation/StoreKit/testing-introductory-offers](doc://com.apple.storekit/documentation/StoreKit/testing-introductory-offers).

## See Also

- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)
- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [testing-win-back-offers-in-xcode](../com.apple.storekit/StoreKit/testing-win-back-offers-in-xcode.md)
- [testing-ask-to-buy-in-xcode](../com.apple.storekit/StoreKit/testing-ask-to-buy-in-xcode.md)

---


## testing-complete-transactions

## 

Locate where your app calls the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) method, and verify that your app completes all work related to the transaction before calling the method. For example, if the purchase includes downloadable content, verify your app downloaded the content to your test device as described in [doc://com.apple.storekit/documentation/StoreKit/persisting-a-purchase](doc://com.apple.storekit/documentation/StoreKit/persisting-a-purchase). Verify that you call [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) for every transaction, whether it succeeded or failed. For more information, see [doc://com.apple.storekit/documentation/StoreKit/finishing-a-transaction](doc://com.apple.storekit/documentation/StoreKit/finishing-a-transaction).

## See Also

- [testing-transaction-observer-code](../com.apple.storekit/StoreKit/testing-transaction-observer-code.md)
- [testing-a-successful-transaction](../com.apple.storekit/StoreKit/testing-a-successful-transaction.md)

---


## testing-disabling-auto-renew

## 

Customers can manage their active subscriptions, as well as their expired subscriptions for up to a year after expiry, in the Subscriptions page on iOS, tvOS, iPadOS, and macOS. In this test scenario, the customer cancels a subscription, which disables auto-renew.

To set up for this test, purchase an auto-renewable subscription for the Sandbox Apple Account.

### 

To test disabling auto-renew:

1. On the test iOS device, open Settings > Developer.
2. In the Sandbox Account section, tap your highlighted Sandbox Apple Account, and tap Manage.
3. In the sandbox Subscriptions page, select the subscription product that you want to cancel.
4. Tap the Cancel Subscription button.

Verify the change in the subscription status using either of these two methods:

- If you’ve configured App Store Connect settings to receive App Store server notifications, your server receives the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type) `DID_CHANGE_RENEWAL_STATUS` each time the subscription’s auto-renew status changes. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications).
- Verify the receipt by calling [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) with the latest receipt. Check that the [doc://com.apple.documentation/documentation/AppStoreReceipts/auto_renew_status](doc://com.apple.documentation/documentation/AppStoreReceipts/auto_renew_status) property of the [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary) object changes to `0`. The `auto_renew_status_change_date_ms` property of `responseBody` contains the timestamp of the change.

### 

After disabling auto-renew, reenable the subscription on the same Manage Subscriptions page by tapping the subscription and confirming payment.

Verify the change in the subscription status using either of these two methods:

- If you’ve configured App Store Connect settings to receive App Store server notifications, your server receives the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notification_type) `DID_CHANGE_RENEWAL_STATUS` each time the subscription’s auto-renew status changes. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications).
- Verify the receipt by calling [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) with the latest receipt. Check that the [doc://com.apple.documentation/documentation/AppStoreReceipts/auto_renew_status](doc://com.apple.documentation/documentation/AppStoreReceipts/auto_renew_status) property of the [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody/Pending_renewal_info-data.dictionary) object changes to `1`. The `auto_renew_status_change_date_ms` property of `responseBody` contains the timestamp of the change.

## See Also

- [testing-an-auto-renewable-subscription](../com.apple.storekit/StoreKit/testing-an-auto-renewable-subscription.md)
- [testing-resubscribing-from-the-subscriptions-page](../com.apple.storekit/StoreKit/testing-resubscribing-from-the-subscriptions-page.md)

---


## testing-failing-subscription-renewals-and-in-app-purchases

## 

Payments can fail unexpectedly at any stage of the billing cycle, such as when a payment card expires. Test your app’s user experience to ensure it handles these unexpected events, and provides appropriate levels of service when billing issues occur.

In sandbox testing, you can simulate billing issues that cause In-App Purchases to fail, and auto-renewable subscriptions not to renew. You can also enable Billing Grace Period for the sandbox environment. Use these sandbox features to test how your app handles auto-renewable subscriptions with billing issues that do or don’t recover.

The sandbox environment sends [doc://com.apple.documentation/documentation/AppStoreServerNotifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications) as you perform tests. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications).

The sandbox environment renews auto-renewable subscriptions up to 12 times. For more information about renewal rates in the sandbox environment, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#edit-subscription-renewal-speed](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#edit-subscription-renewal-speed).

For more information about subscription state changes when billing issues occur, see [doc://com.apple.storekit/documentation/StoreKit/reducing-involuntary-subscriber-churn](doc://com.apple.storekit/documentation/StoreKit/reducing-involuntary-subscriber-churn). For information about how apps determine access to subscription content, see [doc://com.apple.storekit/documentation/StoreKit/handling-subscriptions-billing](doc://com.apple.storekit/documentation/StoreKit/handling-subscriptions-billing).

### 

Follow these steps on a test device running iOS 16 or iPadOS 16, or later:

1. Sign in to the App Store using a Sandbox Apple Account.
2. Choose Settings > Developer > Sandbox Account > Manage > Account Settings.
3. Disable the Allow Purchases & Renewals setting.

Disabling this setting causes In-App Purchases to fail, and auto-renewable subscriptions to not renew in the sandbox environment.

> **NOTE:** This setting applies to all devices that the Sandbox Apple Account signs in to, and to all active auto-renewable subscriptions belonging to that account.

This setting stays in a disabled state until you reenable it. Reenable it to simulate a customer resolving a billing issue.

### 

To enable Billing Grace Period in the sandbox environment, log in to [https://appstoreconnect.apple.com/login](https://appstoreconnect.apple.com/login), and do the following:

1. From My Apps, select your app.
2. In the sidebar under Features, click Subscriptions.
3. In the Billing Grace Period section, click Set Up Billing Grace Period.
4. Select a duration from the drop-down menu.
5. Select whether to apply the grace period to all renewals or to only paid-to-paid renewals. For more information about the configurable settings, see [https://developer.apple.com/help/app-store-connect/manage-subscriptions/enable-billing-grace-period-for-auto-renewable-subscriptions](https://developer.apple.com/help/app-store-connect/manage-subscriptions/enable-billing-grace-period-for-auto-renewable-subscriptions).
6. Select Only Sandbox Environment to enable Billing Grace Period for testing only.
7. Click Next.
8. Click Confirm.

To test billing issues for subscriptions with Billing Grace Period, first, purchase an auto-renewable subscription, and then configure the setting to simulate billing issues (as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues)).

### 

Auto-renewable subscriptions expire and enter a billing retry state when a subscription fails to auto-renew.

This test case assumes that Billing Grace Period is in a disabled state for the sandbox enviroment. To test subscriptions entering a billing retry state:

1. Successfully purchase an auto-renewable subscription in your app.
2. Set the environment to simulate billing issues, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues).
3. Wait for the subscription period to renew. The renewal fails, and it enters a billing retry state.
4. Check that your app recognizes the state. Subscriptions in a billing retry state that aren’t in a billing grace period are not entitled to service. StoreKit provides the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/isInBillingRetry) value in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState) object.

### 

Auto-renewable subscriptions enter a billing grace period when both of the following occur:

- Billing Grace Period is enabled for your app
- The subscription fails to auto-renew

To test subscriptions entering a billing grace period:

1. Follow the steps as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Enable-Billing-Grace-Period-in-the-sandbox-environment](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Enable-Billing-Grace-Period-in-the-sandbox-environment).
2. Successfully purchase an auto-renewable subscription in your app.
3. Set the environment to simulate billing issues, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues).
4. Wait for the subscription period to renew. The subscription enters the billing grace period.
5. Check that your app recognizes the state and provides service for the subscription during the billing grace period. StoreKit provides the grace period expiration date in the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/gracePeriodExpirationDate) property of the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo) object.
6. Wait for the billing grace period to expire. The subscription remains in the billing retry state.
7. Check that your app recognizes the billing retry state. Subscriptions aren’t entitled to service after the billing grace period expires.

> **NOTE:** Auto-renewable subscriptions in a billing grace period state are entitled to service.

### 

Auto-renewable subscriptions expire and enter a billing retry state when a subscription fails to auto-renew. The system displays a Billing Problem message when your app launches, unless your app chooses to delay the [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue) message. Use these steps to trigger the message and test how your app responds to the message in various views. For more information about managing these system messages, see [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message).

To test when the system presents the Billing Problem sheet after subscriptions enter the billing retry state:

1. Successfully purchase an auto-renewable subscription in your app.
2. Set the environment to simulate billing issues, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues).
3. Wait for the subscription period to renew. The renewal fails, and enters a billing retry state.
4. The App Store sends the [doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue](doc://com.apple.storekit/documentation/StoreKit/Message/Reason-swift.struct/billingIssue) message. Launch the app or bring it to the foreground.
5. If your app doesn’t implement [doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property](doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property), the system presents the Billing Problem sheet.
6. If your app implements [doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property](doc://com.apple.storekit/documentation/StoreKit/Message/messages-swift.type.property) and delays the message, perform the steps your app requires for it to call [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)). As long as the billing issue is still active, the system presents the Billing Problem sheet. If you resolve the billing issue before the app calls [doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)](doc://com.apple.storekit/documentation/StoreKit/Message/display(in:)), the system doesn’t present the sheet.

You may perform this test with or without Billing Grace Period enabled.

### 

A subscription is *recovered* when a billing retry succeeds. It exits a billing retry or billing grace period state, and is active again.

To test recovered auto-renewable subscriptions, follow these steps:

1. Start with a subscription in the billing retry state, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-retry-state](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-retry-state).
2. Choose Settings > Developer > Sandbox Account > Manage > Account Settings, and enable the Allow Purchases & Renewals setting, which causes the next subscription renewal attempt to succeed.
3. Check that your app recognizes the active subscription state, which is entitled to service.

Repeat the test starting with a subscription in the billing grace period, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-grace-period](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-grace-period).

The subscription billing cycle for a subscription that recovers from a billing retry state starts on the recovery date. The billing cycle for a subscription that recovers during a billing grace period doesn’t change.

### 

Subscriptions exit a billing retry state when any of the following happens:

- The billing retry period expires without recovering the subscription.
- The customer cancels the subscription.
- The subscription is recovered because billing succeeds.

To test subscriptions that expire and don’t recover, follow these steps:

1. Start with a subscription in a billing retry state, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-retry-state](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-retry-state).
2. Wait for the billing retry period to expire — don’t enable the Allow Purchases & Renewals setting.
3. Check that your app recognizes the subscription state. The subscription is inactive and not entitled to service.

To test a subscription that a customer cancels, follow these steps:

1. Start with a subscription in a billing grace period, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-grace-period](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-grace-period).
2. Cancel the subscription by managing subscriptions in Settings, or by using your app’s implementation of [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)). For more information about managing subscriptions in Settings, see [https://support.apple.com/en-gb/HT202039](https://support.apple.com/en-gb/HT202039).
3. The system immediately cancels the subscription.
4. Check that your app recognizes the subscription state. The subscription is inactive and not entitled to service.

Repeat the test starting with a subscription in the billing retry state, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-retry-state](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Test-subscriptions-that-enter-a-billing-retry-state).

### 

To test a failed purchase attempt, follow these steps:

1. Set the environment to simulate billing issues, as described above in [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases#Configure-the-sandbox-environment-to-simulate-billing-issues).
2. In your app, attempt to buy an In-App Purchase product. The system displays an error message for the sandbox environment that shows the purchase failed.
3. To continue testing billing issues, select OK. Alternatively, to simulate a user resolving a billing issue, select Settings to return to Account Settings, where you can enable Allow Purchases & Renewals.

## See Also

- [testing-purchases-made-outside-your-app](../com.apple.storekit/StoreKit/testing-purchases-made-outside-your-app.md)
- [testing-win-back-offers-in-the-sandbox-environment](../com.apple.storekit/StoreKit/testing-win-back-offers-in-the-sandbox-environment.md)
- [testing-an-interrupted-purchase](../com.apple.storekit/StoreKit/testing-an-interrupted-purchase.md)
- [testing-a-payment-request](../com.apple.storekit/StoreKit/testing-a-payment-request.md)

---


## testing-family-sharing

## 

Family Sharing lets people share access to auto-renewable subscriptions or non-consumables that have Family Sharing enabled with up to five family members. You can use Sandbox Test Families to test whether your app works with Family Sharing as expected.

> **NOTE:** Changes that you make to product metadata in App Store Connect can take up to one hour to appear in the sandbox environment.

To test Family Sharing in your app:

- Ensure your in-app purchases are set up to support Family Sharing. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/turn-on-family-sharing-for-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/turn-on-family-sharing-for-in-app-purchases).
- Create two or more Sandbox Apple Accounts to add to a Sandbox Test Family, or use existing accounts. A family group can have up to six members. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-sandbox-apple-ids](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-sandbox-apple-ids).
- Create the Sandbox Test Family in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#create-a-sandbox-test-family](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#create-a-sandbox-test-family).
- To make testing easier, have a separate device to use for each test family member. You can also use a single device and sign in using each family member’s Sandbox Apple Account in turn.

### 

You can set the sharing status for each member of the Sandbox Test Family individually, as follows:

- *Sharing* indicates the family member shares their in-app purchases with the Sandbox Test Family, and gets access to in-app purchases shared by family members.
- *Not Sharing* indicates the family member isn’t sharing, and doesn’t get access to family-shared purchases. Changing the setting to Not Sharing revokes any family-shared purchases they have access to. In the test environment, turning off sharing is the equivalent of a family member leaving the group.



Modify the sharing status on the Family Sharing page in iOS by following these steps:

1. Open Settings and select Developer.
2. Select the Sandbox Apple Account.
3. On the popup sheet, select Manage.
4. On the Account Settings page, select Family Sharing.
5. Select a family member.
6. Select Stop Sharing Purchases or Start Sharing Purchases, as appropriate.

You can also change these settings in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#manage-a-sandbox-test-family](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings#manage-a-sandbox-test-family).

### 

The two main test cases for Family Sharing are a family member gaining and losing access to family-shared purchases. You can simulate these situations as follows.

To test family members gaining access to a shared purchase:

1. Start with a Sandbox Test Family where members are sharing.
2. In your app, purchase a shareable product.
3. Open your app on a device signed in with the Sandbox Apple Account of another test family member.
4. Verify that your app receives a transaction for the shared purchase and unlocks the content for the family member. Note that the transaction has a [doc://com.apple.storekit/documentation/StoreKit/Transaction/OwnershipType-swift.struct/familyShared](doc://com.apple.storekit/documentation/StoreKit/Transaction/OwnershipType-swift.struct/familyShared) ownership type.
5. When sharing auto-renewable subscriptions, if you have [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) enabled in the sandbox environment, your server receives a notification for each test family member that has sharing enabled. For more information, see the `SUBSCRIBED` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType).

### 

To test a family member losing access to shared purchases:

1. Start with a Sandbox Test Family with two or more members, and at least one shared purchase.
2. In Account Settings > Family Sharing, select a test family member that is receiving access to a shared in-app purchase.
3. Select Stop Sharing Purchases, and Stop Sharing to confirm.
4. The test family member loses accesses to shared purchases. Open your app using their Sandbox Apple Account and confirm that your app receives an updated transaction that includes a [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property).
5. If you have [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) enabled in the sandbox environment, your server receives a `REVOKE` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType) for the test family member that has sharing disabled.

Note that you can also change the sharing status using App Store Connect instead of Account Settings in iOS.

---


## testing-fetching-product-identifiers

## 

If you embed your product identifiers in your app, set a breakpoint in your code after the code loads the identifiers. Verify that the instance of [doc://com.apple.documentation/documentation/Foundation/NSArray](doc://com.apple.documentation/documentation/Foundation/NSArray) contains your expected list of product identifiers.

> **NOTE:** Changes that you make to product metadata in App Store Connect can take up to one hour to appear in the sandbox environment.

If your app fetches your product identifiers from a server, manually fetch the JSON file using a web browser such as Safari, or a command-line utility such as `curl`. Verify that the data your server returns contains the expected list of product identifiers and that your server correctly implements standard HTTP caching mechanisms.

For more information on fetching product identifiers, see [doc://com.apple.storekit/documentation/StoreKit/loading-in-app-product-identifiers](doc://com.apple.storekit/documentation/StoreKit/loading-in-app-product-identifiers).

## See Also

- [testing-invalid-product-identifier-handling](../com.apple.storekit/StoreKit/testing-invalid-product-identifier-handling.md)
- [testing-a-product-request](../com.apple.storekit/StoreKit/testing-a-product-request.md)

---


## testing-in-app-purchases-in-xcode

## 

Testing your StoreKit implementation in Xcode ensures that your app behaves correctly when your customers perform various tasks associated with subscriptions and In-App Purchase transactions. Be sure to test a variety of in-app purchase scenarios, such as receipt validation, promotional offers, interrupted purchases, introductory offers, subscription renewals, and purchase restoration.

### 

Before you begin StoreKit testing in Xcode, complete the steps in [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode), including creating a StoreKit configuration file, enabling StoreKit testing in Xcode, and preparing to validate receipts in the test environment. The test scenarios in this article require this basic setup.

Select the relevant test scenarios to build a test plan for your app. Each test scenario provides additional setup steps, if necessary, along with instructions about how to minimally reset the environment to repeat the test.

### 

Validating receipts is an integral part of handling and testing in-app purchases. As you test in-app purchases, StoreKit in Xcode generates receipts that are valid only in the test environment. Your app can validate the receipts locally using a certificate that Xcode provides.

> **IMPORTANT:** You can’t validate receipts from the test environment with [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) because the App Store doesn’t sign these receipts, and the verification fails.

The test environment’s certificate is a root certificate. There’s no certificate chain to validate when you verify the receipt signature. The following code example retrieves the local receipt:

```swift
// Get the receipt if it's available.
if let appStoreReceiptURL = Bundle.main.appStoreReceiptURL,
    FileManager.default.fileExists(atPath: appStoreReceiptURL.path) {
    do {
        let receiptData = try Data(contentsOf: appStoreReceiptURL, options: .alwaysMapped)
        let receiptString = receiptData.base64EncodedString(options: [])
        // Add code to read receiptData.
    }
    catch { 
        print("Couldn't read receipt data: " + error.localizedDescription) }
}
```

For more information, see [doc://com.apple.documentation/documentation/AppStoreReceipts/validating-receipts-on-the-device](doc://com.apple.documentation/documentation/AppStoreReceipts/validating-receipts-on-the-device).

### 

For this test scenario, let’s assume the app determines that customers are eligible for the promotional offer when the subscription expires. Use the test environment to speed up the time rate so the subscription expires. Then, you’re ready to test the offer eligibility logic in your app.

Additional setup steps for this test scenario are:

- Add a subscription offer to your StoreKit configuration file.
- In the app, purchase a subscription within the same subscription group to be eligible for a promotional offer.

Ensure your test user is eligible for the offer according to your app’s requirements, then purchase the subscription with the offer. Test users can redeem subscription offers if:

- They have an existing or expired subscription, including free, discount, or discounted with a subscription offers.
- They qualify for the offer according to criteria that you define.

See [doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-promotional-offers-in-your-app) for more information.

1. In Xcode, select the StoreKit configuration file in the Project navigator, and then choose Editor > Subscription Renewal Rate > Monthly Renewal Every 30 Seconds.
2. Wait until the subscription expires.
3. Reset the Subscription Renewal rate to Monthly Renewal Every 30 Minutes.
4. In the app, select the option to buy the subscription with the offer.
5. In your code, verify that the payment request includes the discount, [doc://com.apple.storekit/documentation/StoreKit/SKPayment/paymentDiscount](doc://com.apple.storekit/documentation/StoreKit/SKPayment/paymentDiscount).
6. Observe that the system displays the payment sheet with the promotional offer.
7. In your code, verify that [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) receives the transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing) state.
8. In the app, tap Confirm on the payment sheet.
9. In your code, verify that [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) receives the transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state.

To test the same promotional offer purchase again, delete the transaction. In Xcode, choose Debug > StoreKit > Manage Transactions. Select the transaction for the promotional offer purchase, and click Delete.

### 

An interrupted purchase is a transaction that requires the user to perform some action outside your app before the transaction can complete successfully. For example, the user may need to update a payment method or approve new terms and conditions. In Xcode, you can simulate a purchase interruption and its resolution to test how your code handles this scenario end-to-end. You can test this scenario for all in-app purchase product types.

1. In the Xcode Project navigator, select the StoreKit configuration file. Choose Editor > Enable Interrupted Purchases. Run the app in the simulator or on a device.
2. In the app, buy an in-app purchase.
3. Observe that the system displays the payment sheet in the app.
4. In your code, verify that your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) gets a callback on [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) with a transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing) state.
5. In the app, tap Confirm on the payment sheet.
6. In your code, observe that the payment fails (because you enabled interrupted purchases in the test environment). The payment queue receives a transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/failed) state.
7. Check that your code calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)) to remove it from the queue.
8. In Xcode, choose Debug > StoreKit > Manage Transactions.
9. Select the transaction and click Resolve. The test environment resumes a successful purchase.
10. In your code, verify that the payment queue receives a transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state for the same [doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKProduct/productIdentifier) in the same quantity as the failed transaction.
11. In your code, validate the receipt.
12. Check that your app provides the service or product, and then calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

To perform the test again for non-consumable products and subscriptions, delete the transaction to run the test again. To delete the transaction, choose Debug > StoreKit > Manage Transactions. Select the transaction and click Delete.

For consumable in-app purchases, you can test again without additional setup. To reset the test environment to its default behavior, select the StoreKit configuration file in Xcode, then choose Editor > Disable Interrupted Purchases.

### 

Customers are eligible to redeem an introductory offer one time. Configure an introductory offer for a subscription in your StoreKit configuration file. For more information, see [doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/implementing-introductory-offers-in-your-app).

Ensure that your app is eligible for an introductory offer by verifying there’s no subscription purchase for the product ID that includes the offer. Either verify the receipt in your code or check the transactions in Xcode by choosing Debug > StoreKit > Manage Transactions.

1. In the app, buy the subscription that has an introductory offer.
2. Observe that the system displays the payment sheet with the introductory offer in the app.
3. In your code, verify your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) receives a callback on [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) with the transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchasing) state.
4. In the app, tap Confirm on the payment sheet.
5. In your code, verify your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) receives a callback on [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) with the transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state.
6. In your code, validate the receipt.
7. Check that your app provides the service or product, and then calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

To retry the same test scenario, delete the transaction that contains the introductory offer purchase. In Xcode, choose Debug > StoreKit > Manage Transactions. Select the transaction and click Delete. This resets the eligibility for the test user.

### 

All apps need to provide a way for customers to restore purchases, such as by providing a Restore Purchases button. Test how your app handles this request when the customer has no existing purchases. For more information, see [doc://com.apple.storekit/documentation/StoreKit/restoring-purchased-products](doc://com.apple.storekit/documentation/StoreKit/restoring-purchased-products).

Include at least one non-consumable product, auto-renewable subscription, or non-renewable subscription in the StoreKit configuration file. To simulate a user account with no in-app purchases, delete all the transactions before starting the test. In Xcode, choose Debug > StoreKit > Manage Transactions, select all the transactions, and click Delete.

1. In the app, select the option your app provides to restore purchases.
2. In your code, verify that it calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions(withApplicationUsername:)).
3. In your code, verify that StoreKit notifies your observer that the restore is complete by calling [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueueRestoreCompletedTransactionsFinished(_:)). Note that StoreKit doesn’t notify the queue of any restored transactions.

You can repeat this test scenario without additional steps.

### 

Your app can present an App Store sheet that customers can use to manage their subscriptions.

Additional setup steps for this test scenario are:

- Include two auto-renewable subscriptions that belong to the same subscription group in the StoreKit configuration file.
- Subscribe the sandbox user to the subscription with the lowest level of service in that subscription group.
- In the app, implement a Manage Subscriptions button that invokes the [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)) or [doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)](doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)) method.

See [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)) and [doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)](doc://com.apple.documentation/documentation/SwiftUI/View/manageSubscriptionsSheet(isPresented:)) for more information.

1. In the app, tap the Manage Subscriptions button.
2. Observe that the system displays the App Store sheet for managing subscriptions.
3. Verify that the test user is a subscriber of the lower-grade subscription.
4. Upgrade the test user to the higher-grade subscription in that group.
5. Verify that the user is a subscriber of the higher-grade subscription.
6. Cancel the subscription and confirm it in the Confirm Cancellation dialog.
7. Verify that the user is no longer a subscriber of any subscription.

You can repeat this test scenario without additional steps.

### 

Your app can present a sheet to redeem preconfigured offer codes.

Additional setup steps for this test scenario are:

- Include one auto-renewable subscription in the StoreKit configuration file.
- Configure an offer code for the above subscription in your StoreKit configuration file under the Offer Codes heading.
- In the app, implement a Redeem Offer Code button that invokes the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()) method.

See [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/presentCodeRedemptionSheet()) for more information.

1. In the app, tap the Redeem Offer Code button.
2. Observe that the system displays the Redeem Offer Code sheet.
3. Select the offer code that you configured and redeem it.
4. Observe that the system displays the payment sheet with the applied offer.
5. In the app, tap Confirm on the payment sheet.
6. In your code, verify your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) receives a callback on [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) with the transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state.
7. Check that your app provides the service or product, and then calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)).

To retry the same test scenario, delete the transaction that contains the offer code purchase. In Xcode, choose Debug > StoreKit > Manage Transactions. Select the transaction and click Delete.

### 

When billing for a subscription renewal fails, such as due to an expired card, the App Store retries billing and attempts to recover the subscription. You can enable a billing grace period for your app in App Store Connect so your subscribers can continue accessing paid content while the App Store retries billing. For more information about the billing grace period, see [doc://com.apple.storekit/documentation/StoreKit/reducing-involuntary-subscriber-churn](doc://com.apple.storekit/documentation/StoreKit/reducing-involuntary-subscriber-churn).

Test these scenarios in Xcode to ensure your app detects subscriptions that are in billing retry or billing grace period states. In your code, look at the [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/Status-swift.struct/renewalInfo) for the subscription to inspect its [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalState). For subscriptions in a billing grace period state, ensure your app continues to provide uninterrupted subscription features.

Additional setup steps for this scenario are:

- Choose Editor > Enable Billing Grace Period. This step simulates enabling the billing grace period for your app in App Store Connect. To test billing retry without a billing grace period, leave this setting disabled.
- Choose Editor > Enable Billing Retry on Renewal. This step causes all subscription renewals to go into a billing retry state.
- Select your StoreKit configuration file in the Project navigator.
- Create an auto-renewable subscription in-app purchase in your StoreKit configuration file.
- Purchase the auto-renewable subscription in your app.
- Adjust the time rate of subscription renewals in the testing environment by choosing Editor > Subscription Renewal Rate, and select an option. For more information about the time rates available in the testing environment, see [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/timeRate-swift.property](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/timeRate-swift.property).

Test your app’s handling of a billing grace period:

1. In the testing environment, wait for the subscription period to elapse. The subscription goes into a billing retry state and a billing grace period.
2. Run your app, then choose Debug > StoreKit > Manage Transactions.
3. Find and select the subscription transaction.
4. Verify the subscription transaction is in the billing grace period state.
5. Test your app to verify that it supports the billing grace period by continuing to provide uninterrupted access to the features the subscription provides.

Test your app’s handling of a billing grace period expiration:

1. In the testing environment, wait until the billing grace period elapses for the subscription.
2. Run your app, then choose Debug > StoreKit > Manage Transactions.
3. Find and select the subscription transaction.
4. Verify the subscription transaction is in the billing retry state, and is no longer in the billing grace period state.
5. Test your app to verify that it works consistently with a subscription expiration.

Test resolving a billing issue for billing retry, either with a billing grace period or without:

1. In the testing environment, wait for the subscription period to elapse. Verify your app works consistently with a subscription expiration if you’re not testing a billing grace period.
2. Run your app, then choose Debug > StoreKit > Manage Transactions.
3. Find and select the subscription transaction.
4. Verify the subscription transaction is in either the billing grace period state or the billing retry state.
5. Click the Resolve Issues button to resolve the billing issue.
6. Test your app to verify that it provides access to the subscription features as you expect.

### 

When you increase the price of an auto-renewable subscription by an amount that requires user consent, the App Store gives the user an opportunity to consent to the price increase by presenting a sheet in your app. Your app may defer presentation of the sheet to prevent it from appearing at an inconvenient time in the user interface. Users may also consent to a price increase outside your app. Test these scenarios in Xcode to verify that your app handles deferring or displaying the sheet.

Additional setup steps for this scenario are:

- Create an auto-renewable subscription purchase in your StoreKit configuration file.
- Purchase the subscription in your app.
- Optionally, increase the price for your subscription in your StoreKit configuration file. You can still test this scenario without increasing the price.

Test for the deferred price increase consent sheet presentation:

1. Navigate to a place in your app where you defer presentation of the price increase consent sheet.
2. Run your app, then choose Debug > StoreKit > Manage Transactions.
3. Find and select the subscription transaction.
4. Click Request Price Increase Consent.
5. Verify that the price increase consent sheet doesn’t display in your app.
6. Navigate away from the view where you defer presentation.
7. Verify that the price increase consent sheet displays in your app.
8. On the price increase consent sheet in the app, select the Agree to New Price button to test a user consenting to the price increase, or select Close to test the user not giving consent for the price increase.

Test for the price increase consent sheet presentation:

1. Navigate to a place in your app where you don’t defer presenting the price increase consent sheet.
2. In the StoreKit transaction manager, select the subscription purchase, then click Request Price Increase Consent.
3. Verify that the price increase consent sheet displays in your app.
4. On the price increase consent sheet in the app, select the Agree to New Price button to test a user consenting to the price increase, or select Close to test the user not giving consent for the price increase.

For information about testing price increase consent in an automated test suite, see [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/requestPriceIncreaseConsentForTransaction(identifier:)](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/requestPriceIncreaseConsentForTransaction(identifier:)), [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/consentToPriceIncreaseForTransaction(identifier:)](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/consentToPriceIncreaseForTransaction(identifier:)), and [doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/declinePriceIncreaseForTransaction(identifier:)](doc://com.apple.documentation/documentation/StoreKitTest/SKTestSession/declinePriceIncreaseForTransaction(identifier:)).

## See Also

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [setting-up-storekit-testing-in-xcode](../com.apple.Xcode/setting-up-storekit-testing-in-xcode.md)
- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)

---


## testing-in-app-purchases-with-sandbox

## 

Use the Apple sandbox environment to test your implementation of In-App Purchases that use the StoreKit framework on devices with real product information from App Store Connect. Transactions from test accounts don’t incur charges because the sandbox environment simulates successful transactions using the App Store’s infrastructure without processing actual payments.

Apps in the development and beta-testing stages of your product cycle use the sandbox environment for In-App Purchases. These apps include:

- Development-signed apps you build and run from Xcode
- Apps you download from TestFlight

When you sign in to a Sandbox Apple Account on your device, you gain access to sandbox settings that control the test environment. Use these settings to change the subscription renewal rate, clear purchase history, simulate win-back offers, and more.

### 

Before you start testing In-App Purchases in the sandbox environment, make sure that:

1. Your Apple Developer Program account is active. For more information, see [https://developer.apple.com/programs/enroll/](https://developer.apple.com/programs/enroll/).
2. Your membership Account Holder has signed the Paid Applications Agreement, as described in [https://developer.apple.com/help/app-store-connect/manage-agreements/sign-and-update-agreements](https://developer.apple.com/help/app-store-connect/manage-agreements/sign-and-update-agreements).
3. You set up the product information in App Store Connect for the app you’re testing. At minimum, set up a product reference name, product ID, a localized name, and a price. For more information, see [https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases](https://developer.apple.com/help/app-store-connect/configure-in-app-purchase-settings/overview-for-configuring-in-app-purchases).
4. You create Sandbox Apple Accounts in App Store Connect. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-sandbox-apple-ids](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/create-sandbox-apple-ids).
5. You grant permission for locally installed apps to run on the device if you test a development-signed build on iOS, watchOS, or visionOS devices. For more information, see [doc://com.apple.documentation/documentation/Xcode/enabling-developer-mode-on-a-device](doc://com.apple.documentation/documentation/Xcode/enabling-developer-mode-on-a-device).

For more information on the workflow from signing agreements to testing, see [https://developer.apple.com/help/app-store-connect/get-started/app-store-connect-workflow](https://developer.apple.com/help/app-store-connect/get-started/app-store-connect-workflow).

Next, prepare your app to test:

- During developement, build and run your app from Xcode. At this stage, you don’t need to upload your app binary to App Store Connect to test it in the sandbox environment.
- During beta testing, download your app from TestFlight.

Finally, to gain access to the sandbox settings, follow the instructions below to sign in to your Sandbox Apple Account. The instructions differ for a development-signed app and for an app you download from TestFlight.

### 

In iOS and iPadOS, the sandbox account appears in Settings > Developer after the first time you use the device to attempt a purchase in a development-signed app. There’s no need to sign out of the non-Sandbox Apple Account. Sign in using a Sandbox Apple Account.

In macOS, the sandbox account appears in App Store Settings after the first time you use the device to make an In-App Purchase. Open App Store > Settings and click the Sign In button to sign in using a Sandbox Apple Account. When you’re done testing, sign out of the Sandbox Apple Account from the App Store Settings.

If your test device has macOS 11.1 or earlier installed, sign out of the Mac App Store, then build your app in Xcode and launch it from Finder.

The first time you make a purchase in a development-signed app, sign in to the App Store using your Sandbox Apple Account to begin testing. When you sign in, the text `[Environment: Sandbox]` appears, indicating that you’ve connected to the test environment. If `[Environment: Sandbox]` doesn’t appear, you’re using the production environment.

### 

Apps that you download from TestFlight always run in the sandbox environment. However, to access the sandbox controls for testing, you need to sign out of your production Apple Account in Media & Purchases, and sign in with a Sandbox Apple Account in Developer settings.

Follow these steps to access sandbox controls for TestFlight in iOS:

1. Download your beta app from TestFlight. You need to be signed in with a production Apple Account to download a beta app.  For more information, see [https://developer.apple.com/help/app-store-connect/test-a-beta-version/testflight-overview](https://developer.apple.com/help/app-store-connect/test-a-beta-version/testflight-overview).
2. Open Settings and select your Apple Account.
3. Select Media & Purchases.
4. On the pop-up menu, select Sign Out.
5. Next, open Settings and select Developer. (This option is available when you enable [doc://com.apple.documentation/documentation/Xcode/enabling-developer-mode-on-a-device](doc://com.apple.documentation/documentation/Xcode/enabling-developer-mode-on-a-device)).
6. Scroll to the bottom of the screen, and select Sign In under Sandbox Apple Account. Enter your Sandbox Apple Account credentials.

Your device now has access to the sandbox controls for testing your beta app, and In-App Purchases use your Sandbox Apple Account.

> **IMPORTANT:** Signing out of Media & Purchases can remove your access to purchased content in production apps on your device. Consider using a dedicated testing device when testing a TestFlight app with sandbox controls.

If you sign back in to your Apple Account in Media & Purchases, apps you install through TestFlight revert to attributing In-App Purchases to your Apple Account and not to your Sandbox Apple Account.

### 

Sandbox settings enable you to control the testing environment to set up your tests. You can manage the settings in App Store Connect or in iOS Account Settings, whichever you prefer. The settings affect the sandbox the same way, regardless of which method you choose. However, some settings are available only in App Store Connect. The following table compares the settings on both platforms:

| Sandbox setting or feature | Available in App Store Connect | Available in iOS |
| --- | --- | --- |
| Create or delete a Sandbox Apple Account | Yes | No |
| Create or delete a Sandbox Test Family | Yes | No |
| Remove a member from a Sandbox Test Family | Yes | No |
| Change the storefront country or region | Yes | No |
| Change the subscription renewal rate | Yes | Yes |
| Enable interrupted purchases | Yes | Yes |
| Clear purchase history for a Sandbox Apple Account | Yes | Yes |
| Change sharing status for a Sandbox Test Family member | Yes | Yes |
| Select whether to display win-back offer sheets in the app | No | Yes |

To access the Account Settings in iOS, follow these steps:

1. Open Settings and select Developer.
2. Select the Sandbox Apple Account.
3. On the pop-up sheet, select Manage. The Account Settings page appears.

> **NOTE:** Changes you make to product metadata in App Store Connect can take up to one hour to appear in the sandbox environment.

For information on all aspects of managing sandbox settings in App Store Connect, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/overview-of-testing-in-sandbox](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/overview-of-testing-in-sandbox).

### 

Along with testing In-App Purchase in your app, you can also test related server operations in the sandbox environment. To enable App Store Server Notifications for the sandbox environment, see [doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications](doc://com.apple.documentation/documentation/AppStoreServerNotifications/enabling-app-store-server-notifications).

As you test your app, your server receives notifications for In-App Purchase transactions. The notification payload identifies the sandbox environment in the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/environment](doc://com.apple.documentation/documentation/AppStoreServerNotifications/environment) property of the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/data](doc://com.apple.documentation/documentation/AppStoreServerNotifications/data) object. For more information, [doc://com.apple.storekit/documentation/StoreKit/testing-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/testing-app-store-server-notifications).

The [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI) is also available in the sandbox environment. Use the endpoints’ sandbox URLs to get information about transactions that occur during testing.

### 

In-app products you create through App Store Connect are available for sale in every App Store region. You can also maintain a list of product identifiers that you make available in specific regions. To test In-App Purchases in multiple regions using the same Sandbox Apple Account:

1. Open App Store Connect.
2. Click the Sandbox Apple Account.
3. Change the App Store Country or Region setting.

For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings).

To activate a storefront after you change the region in App Store Connect, sign out of the Sandbox Apple Account account on the device and sign back in. When testing this activation, you see the In-App Purchases appropriate to the region assigned to your Sandbox Apple Account. Changing the App Store Country or Region setting affects the storefront value in your app. For more information, see [doc://com.apple.storekit/documentation/StoreKit/Storefront](doc://com.apple.storekit/documentation/StoreKit/Storefront).

### 

To manage repeated testing using the same Sandbox Apple Account, clear its purchase history in App Store Connect or from Account Settings in iOS. On your iOS device, follow these steps:

1. Open Settings and select Developer.
2. Select the Sandbox Apple Account.
3. On the pop-up sheet, select Manage.
4. On the Account Settings page, select Clear Purchase History.
5. Sign out of the Sandbox Apple Account to clear the purchase history cache on the device. Sign back in to continue testing.

For information about clearing the purchase history from App Store Connect, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-id-settings).

Clearing the purchase history for Sandbox Apple Accounts with a high number of purchases can take longer than several minutes. When the process completes, the transaction history is empty and the Sandbox Apple Account is eligible for introductory offers. If you’re signed in with the Sandbox Apple Account, you can purchase subscriptions previously subscribed to without causing duplicate purchases.

> **NOTE:** Clearing the purchase history doesn’t affect In-App Purchases that customers make on the App Store.

## Topics

### Product identifiers and requests

- [testing-fetching-product-identifiers](../com.apple.storekit/StoreKit/testing-fetching-product-identifiers.md)
- [testing-invalid-product-identifier-handling](../com.apple.storekit/StoreKit/testing-invalid-product-identifier-handling.md)
- [testing-a-product-request](../com.apple.storekit/StoreKit/testing-a-product-request.md)

### Payment transactions

- [testing-purchases-made-outside-your-app](../com.apple.storekit/StoreKit/testing-purchases-made-outside-your-app.md)
- [testing-win-back-offers-in-the-sandbox-environment](../com.apple.storekit/StoreKit/testing-win-back-offers-in-the-sandbox-environment.md)
- [testing-an-interrupted-purchase](../com.apple.storekit/StoreKit/testing-an-interrupted-purchase.md)
- [testing-failing-subscription-renewals-and-in-app-purchases](../com.apple.storekit/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases.md)
- [testing-a-payment-request](../com.apple.storekit/StoreKit/testing-a-payment-request.md)

### Subscriptions

- [testing-an-auto-renewable-subscription](../com.apple.storekit/StoreKit/testing-an-auto-renewable-subscription.md)
- [testing-resubscribing-from-the-subscriptions-page](../com.apple.storekit/StoreKit/testing-resubscribing-from-the-subscriptions-page.md)
- [testing-disabling-auto-renew](../com.apple.storekit/StoreKit/testing-disabling-auto-renew.md)

### Family Sharing

- [testing-family-sharing](../com.apple.storekit/StoreKit/testing-family-sharing.md)

### Age Assurance

- [testing-age-assurance-in-sandbox](../com.apple.storekit/StoreKit/testing-age-assurance-in-sandbox.md)

### Refunds

- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)

### Server notifications

- [testing-app-store-server-notifications](../com.apple.storekit/StoreKit/testing-app-store-server-notifications.md)

### Transaction observer

- [testing-transaction-observer-code](../com.apple.storekit/StoreKit/testing-transaction-observer-code.md)
- [testing-a-successful-transaction](../com.apple.storekit/StoreKit/testing-a-successful-transaction.md)
- [testing-complete-transactions](../com.apple.storekit/StoreKit/testing-complete-transactions.md)

## See Also

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [testing-win-back-offers-in-xcode](../com.apple.storekit/StoreKit/testing-win-back-offers-in-xcode.md)
- [testing-ask-to-buy-in-xcode](../com.apple.storekit/StoreKit/testing-ask-to-buy-in-xcode.md)

---


## testing-introductory-offers

## 

To test introductory offers, verify that users see the same subscription and introductory offer prices in your app as they do in the App Store. As part of your test, make sure your app presents introductory offers only to users that are eligible for them.

To test introductory offers:

1. Configure test accounts, as described in [https://help.apple.com/app-store-connect/#/dev8b997bee1](https://help.apple.com/app-store-connect/#/dev8b997bee1). Create a variety of accounts that are eligible or ineligible for offers.
2. Initiate in-app purchases from within the app for each test user.
3. Verify that the user experience and pricing information dynamically represent the accurate price of your subscription.

Introductory offers are only offered once, but when testing your app, you can reset the status of the test account to allow you to redeem an introductory offer more than once. To reset offer eligibility for the sandbox account:

1. On the test iOS device, open Settings > Apple Account > Media & Purchases (or iTunes & App Store for iOS 13 and earlier). Under the Sandbox Account section, tap your highlighted Sandbox Apple Account then tap Manage to open the sandbox Subscription Management page.
2. Tap the expired subscription you want to reactivate. The subscription products that appear are those you configured in App Store Connect under the same subscription group.
3. If the test account used an introductory offer, then the system diplays a Reset Eligibility button that lets you reset and redeem another introductory offer.



## See Also

- [implementing-introductory-offers-in-your-app](../com.apple.storekit/StoreKit/implementing-introductory-offers-in-your-app.md)
- [SKProductDiscount](../com.apple.storekit/StoreKit/SKProductDiscount.md)

---


## testing-invalid-product-identifier-handling

## 

Intentionally include an invalid identifier in your app’s list of product identifiers. Then do one of the following:

- In a production build, verify that the app displays the rest of its store UI and that users can purchase the valid products.
- In a development build, verify that the app brings the issue to your attention.

Check the console log and verify that you can correctly identify the invalid product identifier. Make sure you remove it after testing.

For more information on fetching product identifiers, see [doc://com.apple.storekit/documentation/StoreKit/loading-in-app-product-identifiers](doc://com.apple.storekit/documentation/StoreKit/loading-in-app-product-identifiers).

## See Also

- [testing-fetching-product-identifiers](../com.apple.storekit/StoreKit/testing-fetching-product-identifiers.md)
- [testing-a-product-request](../com.apple.storekit/StoreKit/testing-a-product-request.md)

---


## testing-promoted-in-app-purchases

## 

Users can buy promoted In-App Purchases from the App Store, but you need to test this flow before making your product publicly available. Apple provides a system URL that triggers your app using the `itms-services://` protocol, so you can test In-App Purchases before they’re available in the App Store.

| **Protocol** | `itms-services://` |
| --- | --- |
| **Parameter** `action` | `purchaseIntent` |
| **Parameter** `bundleId` | The bundle ID for your app; for example:  `com.example.app` |
| **Parameter** `productIdentifier` | The In-App Purchase product ID you want to test; for example:  `com.example.product` |

The resulting URL looks like this:

`itms-services://?action=purchaseIntent&bundleId=com.example.app&productIdentifier=com.example.product`

Send this URL to yourself in an email or iMessage, and open it from your device. You’ll know the test is running when your app opens automatically. You can then test how your app handles the promoted In-App Purchase.

## See Also

- [supporting-promoted-in-app-purchases-in-your-app](../com.apple.storekit/StoreKit/supporting-promoted-in-app-purchases-in-your-app.md)
- [PurchaseIntent](../com.apple.storekit/StoreKit/PurchaseIntent.md)
- [PromotionInfo](../com.apple.storekit/StoreKit/Product/PromotionInfo.md)

---


## testing-purchases-made-outside-your-app

## 

When your app offers In-App Purchases, customers typically buy the products from within your app. However, purchase transactions can also occur on another device or even outside your app. Your app needs to handle these transactions when it launches. Use the Test Transactions feature in Account Settings in iOS to simulate and test such transactions in the sandbox environment.

### 

Several types of events result in a purchase transaction that occurs outside your app, including the following:

All of these events result in StoreKit sending a transaction to your app through the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) asynchronous sequence in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction). Test your app to be sure it receives and handles the transaction.

### 

To create a transaction outside your app for the testing environment, first open Account Settings on the iOS device, as follows:

1. Open Settings and select Developer.
2. Select the Sandbox Apple Account. If you’re not yet signed in, see [doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox#Sign-in-to-your-Sandbox-Apple-Account-for-a-development-signed-app](doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox#Sign-in-to-your-Sandbox-Apple-Account-for-a-development-signed-app).
3. Select Manage on the pop-up sheet. The Account Settings page appears.
4. Check that the Allow Purchases & Renewals toggle remains selected. If it’s deselected, all purchases fail, which represents a different test case. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases).

Next, you need the product ID for a product you set up in App Store Connect and your app’s bundle ID. If you’re testing win-back offers, see [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment) for further steps.

> **NOTE:** Changes that you make to product metadata in App Store Connect can take up to one hour to appear in the sandbox environment.

### 

To simulate a purchase outside your app, follow these steps:

1. On the Account Settings page, select Test Transactions.
2. Enter your product ID and the bundle ID in the applicable text boxes.
3. Select Test Transactions.
4. The system presents the App Store [Sandbox] payment sheet for the sandbox environment. Confirm the purchase. The sandbox environment doesn’t process actual payments. Instead, it returns transactions as if the system successfully processes them.

After you confirm the purchase, use the following steps to test your app:

1. Open your app. The system delivers the new transaction to your app through the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) asynchronous sequence in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).
2. Confirm that your app receives and processes the transaction to provide access to the purchased product.

### 

You can repeat the test by purchasing the product again through the Test Transactions feature in Account Settings. To repurchase some products, you might first need to clear the transactions for the Sandbox Apple Account, following these steps:

1. Open Settings and select Developer.
2. Select the Sandbox Apple Account.
3. Select Manage on the pop-up sheet.
4. On the Account Settings page, select Clear Purchase History.
5. Sign out of the Sandbox Apple Account to clear the purchase history cache on the device. Sign back in to continue testing.

Restart your app. The purchase history for the Sandbox Apple Account is empty and ready for testing. Clearing the purchase history for Sandbox Apple Accounts with a high number of purchases may take longer.

## See Also

- [testing-win-back-offers-in-the-sandbox-environment](../com.apple.storekit/StoreKit/testing-win-back-offers-in-the-sandbox-environment.md)
- [testing-an-interrupted-purchase](../com.apple.storekit/StoreKit/testing-an-interrupted-purchase.md)
- [testing-failing-subscription-renewals-and-in-app-purchases](../com.apple.storekit/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases.md)
- [testing-a-payment-request](../com.apple.storekit/StoreKit/testing-a-payment-request.md)

---


## testing-refund-requests

## 

The sandbox environment and StoreKit Testing in Xcode both support testing refund requests, which enable your customers to request a refund from within your app. Your app displays the refund request sheet by calling any of these methods: [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-65tph) , [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-63bvd](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-63bvd), [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(for:in:)-9mscy), [doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj](doc://com.apple.storekit/documentation/StoreKit/Transaction/beginRefundRequest(in:)-9k0pj), or [doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)](doc://com.apple.documentation/documentation/SwiftUI/View/refundRequestSheet(for:isPresented:onDismiss:)). While you’re testing your app, you fill out the sheet to submit the request.

Depending on your testing setup, the App Store automatically approves or declines the refund request in the testing environment. Note that the App Store doesn’t send emails for refund requests in testing environments.

### 

To set up a test for approved refunds, select any refund reason on the refund request sheet, and submit the sheet. The App Store automatically approves the refund request in the testing environment.

Your app receives a [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) with refund information in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property) properties. If you’re testing in the sandbox environment and your server receives [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) for the sandbox, it gets a notification with a `REFUND` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType).

### 

To set up a test for declined refunds, follow these steps on the refund request sheet with your app running in the sandbox environment:

1. Under Issue, select Other.
2. In the text box, type DECLINE.
3. Tap Request Refund.

The App Store automatically rejects the refund request in the testing environment.

If your server receives [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) for the sandbox environment, it gets a notification with a `REFUND_DECLINED` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType).

### 

To set up a test for prorated refunds, follow these steps on the refund request sheet with your app running in the sandbox environment:

1. Under Issue, select Other.
2. In the text box, type GRANT_PRORATED.
3. Tap Request Refund.

The testing environment determines the prorated percentages as follows:

- For auto-renewable subscriptions, it calculates the proration based on the time that remains on the subscription
- For consumables, non-consumables, and non-renewing subscriptions, it uses a default proration of 50%

In the testing environment, the App Store automatically approves the prorated refund.

Your app receives a [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) with refund information in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationDate) and [doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property](doc://com.apple.storekit/documentation/StoreKit/Transaction/revocationReason-swift.property) properties. If you’re testing in the sandbox environment and your server receives [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) for the sandbox, it gets a notification with a `REFUND` [doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType](doc://com.apple.documentation/documentation/AppStoreServerNotifications/notificationType). For prorated refunds, the transaction data includes the `revocationType` field with a value of `REFUND_PRORATED` and the `revocationPercentage` field.

### 

Another way to test prorated refunds is to provide the refund information by calling the [doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information](doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information), following these steps:

1. In your app, select any refund reason on the refund request sheet, and submit the sheet.
2. The App Store server sends a `CONSUMPTION_REQUEST` notification to your [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2) for the sandbox environment.
3. Respond by calling [doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information](doc://com.apple.documentation/documentation/AppStoreServerAPI/Send-Consumption-Information). Note that in the sandbox environment you need to respond to the notification within five minutes for the system to apply your consumption information to the refund request.

The values you provide in the [doc://com.apple.documentation/documentation/AppStoreServerAPI/ConsumptionRequest](doc://com.apple.documentation/documentation/AppStoreServerAPI/ConsumptionRequest) determine the outcome of the refund in the testing environment:

- Specify the `GRANT_PRORATED` value as the refund preference to get a prorated refund
- Specify a valid `consumptionPercentage`. The testing environment approves the prorated refund using your consumption percentage.

For more information on receiving server notifications for the sandbox environment, see [doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications](doc://com.apple.storekit/documentation/StoreKit/enabling-app-store-server-notifications). For more information on testing, see [doc://com.apple.storekit/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox](doc://com.apple.storekit/documentation/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox) and [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode).

## See Also

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)
- [testing-win-back-offers-in-xcode](../com.apple.storekit/StoreKit/testing-win-back-offers-in-xcode.md)
- [testing-ask-to-buy-in-xcode](../com.apple.storekit/StoreKit/testing-ask-to-buy-in-xcode.md)

---


## testing-resubscribing-from-the-subscriptions-page

## 

Customers can manage their active subscriptions, as well as their expired subscriptions for up to a year after expiry, on the Subscriptions page in iOS, tvOS, iPadOS, and macOS. From this page, customers can upgrade, downgrade, cancel, or change the type of their subscriptions.

In this test scenario, the customer resubscribes to an expired subscription from the Subscriptions page in the App Store.

### 

This test case requires one or more subscriptions configured in App Store Connect and an expired subscription for your Sandbox Apple Account. If you don’t already have an expired subscription, purchase an auto-renewable subscription and let it expire.

### 

To test resubscribing from the Subscriptions page:

1. On the test iOS device, open Settings > Developer.
2. In the Sandbox Account section, tap your highlighted Sandbox Apple Account, and tap Manage.
3. On devices running iOS 16 or later, tap Subscriptions on the Account Settings sheet.
4. In the sandbox Subscriptions page, select the expired subscription you want to reactivate. The subscription products that appear are those you configured in App Store Connect under the same subscription group.
5. Select a subscription product to resubscribe to.
6. To complete the purchase, authenticate the payment sheet that appears.
7. Open your app.
8. In Xcode, verify that your [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) gets a callback on [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedTransactions:)) with a transaction in the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionState/purchased) state.
9. Check that your app retrieves and verifies the app receipt. Verify that the successful transaction is in the receipt.
10. Check that your app makes the in-app purchase available and updates the subscriber’s status.
11. In Xcode, check that your app calls [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/finishTransaction(_:)). For more information, see [doc://com.apple.storekit/documentation/StoreKit/finishing-a-transaction](doc://com.apple.storekit/documentation/StoreKit/finishing-a-transaction).

### 

This test case requires no cleanup. For auto-renewable subscriptions, you can perform the test again when the subscription expires.

## See Also

- [testing-an-auto-renewable-subscription](../com.apple.storekit/StoreKit/testing-an-auto-renewable-subscription.md)
- [testing-disabling-auto-renew](../com.apple.storekit/StoreKit/testing-disabling-auto-renew.md)

---


## testing-transaction-observer-code

## 

Review the transaction observer’s implementation of the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) protocol. Verify that the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver) listens for transactions when:

- Your app isn’t displaying its store UI
- If you didn’t recently initiate a purchase

Locate the call to the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-5ciz2](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/add(_:)-5ciz2) method of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue) in your code. Verify that your app calls this method at app launch. For more information, see [doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue](doc://com.apple.storekit/documentation/StoreKit/setting-up-the-transaction-observer-for-the-payment-queue).

## See Also

- [testing-a-successful-transaction](../com.apple.storekit/StoreKit/testing-a-successful-transaction.md)
- [testing-complete-transactions](../com.apple.storekit/StoreKit/testing-complete-transactions.md)

---


## testing-transactions-that-use-custom-link-tokens

## 

When you test your app in the sandbox environment, the External Purchase API returns tokens that are valid only in that environment. These tokens have an [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/externalPurchaseId) that starts with the string `SANDBOX`. For more information about the token format, see [doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens](doc://com.apple.storekit/documentation/StoreKit/receiving-and-decoding-external-purchase-tokens).

Apps running in the sandbox environment need to satisfy the same requirements as they do in the production environment to receive external purchase tokens, including that they:

- Have an entitlement, such as [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link) or  [doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming](doc://com.apple.documentation/documentation/BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link-streaming)
- Configure the associated property list key if the entitlement requires one, such as [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions) or [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/SKExternalPurchaseLinkStreamingRegions)
- Check their eligibility to use the [doc://com.apple.storekit/documentation/StoreKit/external-purchase](doc://com.apple.storekit/documentation/StoreKit/external-purchase) API at runtime, with [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/isEligible) and [doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments](doc://com.apple.storekit/documentation/StoreKit/AppStore/canMakePayments)

### 

The [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink) API generates custom link tokens, which have a token type and an expiration date. There are two possible token types, `ACQUISITION` and `SERVICES`. Your app requests a token by calling the [doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)](doc://com.apple.storekit/documentation/StoreKit/ExternalPurchaseCustomLink/token(for:)) method and specifying the token type. The first time you request a token in the sandbox environment, the system creates the token and initiates an *active token period*.

> **NOTE:** In the sandbox environment, custom link tokens expire 1 hour after creation.

Apps can request tokens again at any time. If there’s an active token period, the system returns the token that corresponds to that active period. The returned token can be identical to the original token, or it can be a *refreshed* token. A refreshed token has the same creation and expiration dates as the original token, but a different `externalPurchaseId`. Use either an original token or a refreshed token to report transactions.

There’s a maximum of one active token period for `ACQUISITION` tokens, for each Sandbox Apple Account, for each app. After the `ACQUISITION` token expires, the Sandbox Apple Account can’t receive another `ACQUISITION` token for the same app. This reflects the behavior in the production environment, where apps have a maximum of one active period for the `ACQUISITION` token for each customer. To repeat tests for this token type after it expires, use another Sandbox Apple Account.

After a `SERVICES` token period expires, your app can request a new `SERVICES` token and you can continue testing. The new token has a new creation and expiration date, and starts a new active token period.

### 

To test your server’s token reporting implementation, send reports for sandbox tokens to the Sandbox URL of the [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/Send-External-Purchase-Report](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI/Send-External-Purchase-Report) endpoint. For more information about reporting tokens, see [doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI](doc://com.apple.documentation/documentation/ExternalPurchaseServerAPI).

To report transactions, you can use any token for the customer that’s active (not expired) at the time of the transaction.

## See Also

- [ExternalPurchaseCustomLink](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink.md)
- [Token](../com.apple.storekit/StoreKit/ExternalPurchaseCustomLink/Token.md)
- [com.apple.developer.storekit.custom-purchase-link.allowed-regions](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.custom-purchase-link.allowed-regions.md)
- [com.apple.developer.storekit.external-purchase-link](../com.apple.BundleResources/Entitlements/com.apple.developer.storekit.external-purchase-link.md)
- [SKExternalPurchaseCustomLinkRegions](../com.apple.BundleResources/Information-Property-List/SKExternalPurchaseCustomLinkRegions.md)

---


## testing-win-back-offers-in-the-sandbox-environment

## 

After you set up win-back offers for auto-renewable subscriptions in App Store Connect, you can begin testing them in the sandbox environment. You can merchandise win-back offers in multiple ways, enabling customers to discover and redeem them in the App Store, in their Apple Account in Subscription settings, in your own marketing channels, and in your app. Within your app, you can merchandise win-back offers by using the win-back offer sheet, StoreKit views, or other StoreKit APIs for full customization.

You can use the sandbox testing environment to simulate redeeming win-back offers in these ways:

Handle the resulting transactions in your app. StoreKit delivers them through the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) asynchronous sequence in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

> **NOTE:** In TestFlight testing, you can only test win-back offers if you implement them using StoreKit views or other StoreKit APIs. The win-back offer sheet and redemption through the App Store aren’t available for testing in TestFlight.

Other types of offers and transactions can also occur outside your app. For testing information, see [doc://com.apple.storekit/documentation/StoreKit/testing-purchases-made-outside-your-app](doc://com.apple.storekit/documentation/StoreKit/testing-purchases-made-outside-your-app). You can also test win-back offers in Xcode, which doesn’t rely on App Store Connect configurations. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-xcode](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-xcode).

### 

Before you begin testing in the sandbox environment, use App Store Connect to configure at least one auto-renewable subscription, and at least one win-back offer. Make a note of the product ID of the auto-renewable subscription and the corresponding win-back offer IDs to use in your tests.

> **NOTE:** Changes that you make to product metadata in App Store Connect can take up to one hour to appear in the sandbox environment.

On the iOS device, set up the testing environment by opening Account Settings, as follows:

1. Open Settings and select Developer.
2. Select the Sandbox Apple Account. If you’re not yet signed in, see [doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox#Sign-in-to-your-Sandbox-Apple-Account-for-a-development-signed-app](doc://com.apple.storekit/documentation/StoreKit/testing-in-app-purchases-with-sandbox#Sign-in-to-your-Sandbox-Apple-Account-for-a-development-signed-app) to sign in. A popover appears.
3. Select Manage on the popover. The Account Settings page appears.
4. Check that the Allow Purchases & Renewals toggle remains on. If it’s off, all purchases fail, which represents a different test case. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases](doc://com.apple.storekit/documentation/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases).
5. Turn on or off the Win-Back Offer Sheet toggle.  Turn it on to enable the [doc://com.apple.storekit/documentation/StoreKit/Message](doc://com.apple.storekit/documentation/StoreKit/Message) API to display the win-back offer sheet when you launch the app.  Turn it off to prevent the sheet from appearing, even if the customer is eligible for the offer. This toggle only affects sandbox testing.  In either case, StoreKit delivers the new transaction to your app through the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) asynchronous sequence in [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction).

### 

In the sandbox environment, test accounts are automatically eligible for win-back offers when they have an expired subscription. The account needs to have owned the subscription; having access through Family Sharing doesn’t qualify the account for a win-back offer. Also, the account can’t have any active subscriptions from the same subscription group.

To make your Sandbox Apple Account eligible for a win-back offer, follow these steps:

1. Cancel any subscriptions that are from the same subscription group as the win-back offer’s subscription.
2. If the test account has an active subscription through Family Sharing in the same subscription group, it’s ineligible for a win-back offer in that subscription group. To make the account eligible, leave the family group, or stop sharing the subscription with the family.
3. Wait for the subscription to expire. By default, a monthly subscription expires in 5 minutes in the sandbox. For more information, see [https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings/](https://developer.apple.com/help/app-store-connect/test-in-app-purchases/manage-sandbox-apple-account-settings/).
4. Subscribe to the auto-renewable subscription that has the win-back offer you’re testing.
5. Cancel the subscription and wait for it to expire.
6. Close the app.

The Sandbox Apple Account is now eligible for the win-back offer in the sandbox environment.

Repeat these steps to repeat a test.

### 

To simulate a win-back offer redemption outside your app, follow these steps:

1. Complete the steps in the preceding sections: [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings) and [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions). Close your app.
2. On the Account Settings page (Settings > Developer > Sandbox Apple Account > Manage), select Test Transactions.
3. Enter the auto-renewable subscription’s product ID and the bundle ID in the applicable text boxes.
4. Enter the win-back offer ID in the Win-Back ID text box. The win-back offer ID needs to be a valid offer for the product, that you configure in App Store Connect.
5. The system presents the App Store [Sandbox] payment sheet for the sandbox environment. Confirm the purchase.
6. Launch your app. StoreKit provides the transaction in the [doc://com.apple.storekit/documentation/StoreKit/Transaction/updates](doc://com.apple.storekit/documentation/StoreKit/Transaction/updates) asynchronous sequence.
7. Check that your app receives and processes the win-back offer transaction.

> **NOTE:** The sandbox environment doesn’t process actual payments. Instead, it returns transactions as if the system successfully processes them.

### 

To simulate a win-back offer redemption in your app, follow these steps:

1. Complete the steps in the preceding sections: [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings) and [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions). Close the app.
2. On the Account Settings page (Settings > Developer > Sandbox Apple Account > Manage), turn on the Display Win-back Offer Sheet toggle.
3. Launch your app. The system presents the win-back offer sheet.
4. Accept the offer. The system presents the App Store [Sandbox] payment sheet for the sandbox environment. Confirm the purchase.
5. Check that your app receives and processes the win-back offer transaction.

### 

If you merchandise the win-back offer using StoreKit views or other StoreKit APIs to fully customize the experience, you can test your implementation in the sandbox environment. Follow these steps:

1. Complete the steps in the preceding sections to ensure the test account is eligible for one or more win-back offers: [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings) and [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions). Close the app.
2. Optionally, on the Account Settings page (Settings > Developer > Sandbox Apple Account > Manage), turn off the Display Win-back Offer Sheet toggle to prevent the win-back offer sheet from appearing.
3. Launch your app. Open your app’s store and exercise the offer API.
4. StoreKit views automatically chooses an offer to display. If there are multiple offers, your app indicates a preference using the [doc://com.apple.documentation/documentation/SwiftUI/View/preferredSubscriptionOffer(_:)](doc://com.apple.documentation/documentation/SwiftUI/View/preferredSubscriptionOffer(_:)) API.

For more information about customizing your in-app experience, see [doc://com.apple.storekit/documentation/StoreKit/merchandising-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/merchandising-win-back-offers-in-your-app) and [doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app](doc://com.apple.storekit/documentation/StoreKit/supporting-win-back-offers-in-your-app).

### 

To repeat a test and redeem the same win-back offer, cancel the subscription and wait for it to expire. The test account in the sandbox environment is eligible for the same win-back offer after the subscription expires.

## See Also

- [testing-purchases-made-outside-your-app](../com.apple.storekit/StoreKit/testing-purchases-made-outside-your-app.md)
- [testing-an-interrupted-purchase](../com.apple.storekit/StoreKit/testing-an-interrupted-purchase.md)
- [testing-failing-subscription-renewals-and-in-app-purchases](../com.apple.storekit/StoreKit/testing-failing-subscription-renewals-and-in-app-purchases.md)
- [testing-a-payment-request](../com.apple.storekit/StoreKit/testing-a-payment-request.md)

---


## testing-win-back-offers-in-xcode

## 

A win-back offer is an offer for a discount on an auto-renewable subscription to a customer who was previously subscribed.

To test win-back offers in Xcode, first set up your StoreKit configuration file with auto-renewable subscriptions and win-back offers. Subscribe to an auto-renewable subscription with one or more win-back offers. Then, cancel the subscription and allow it to expire. If the win-back offer’s setting is Eligible, the testing system makes the win-back offer available to redeem immediately after the subscription expires.

Testing win-back offers in Xcode is convenient early in the development process, because it doesn’t rely on any product configurations in App Store Connect. However, you can also test win-back offers in the sandbox environment, which does rely on your App Store Connect configuration. For more information, see [doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment](doc://com.apple.storekit/documentation/StoreKit/testing-win-back-offers-in-the-sandbox-environment).

### 

Before you can begin testing in Xcode, complete the steps in [doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode](doc://com.apple.documentation/documentation/Xcode/setting-up-storekit-testing-in-xcode), including creating a StoreKit configuration file and enabling StoreKit testing in Xcode.

### 

Start by opening the StoreKit configuration editor in Xcode and defining at least one auto-renewable subscription and subscription group. Then follow these steps to configure one or more win-back offers:

1. In the left pane, select the subscription under the Auto-Renewable Subscriptions heading.
2. Under the Win-back Offers heading in the editor, click the Add button (+) to configure a new offer by filling out the offer details as follows, and then clicking Save.

> **NOTE:** The eligibility criteria that determine whether a customer can redeem a win-back offer can have many rules and states. Rather than requiring you to construct all the conditions before you can test win-back offers in your app, the testing UI provides a simplified Eligible or Not Eligible setting that bypasses any other eligibility criteria. Set the value to Eligible to test your app’s response when a customer receives a win-back offer.

### 

To display a win-back offer, run your app in the Xcode environment and follow these steps:

1. In your app, subscribe to an auto-renewable subscription that has at least one win-back offer.
2. In the StoreKit configuration, set the Eligibility setting for the win-back offer to Eligible.
3. Cancel the subscription. If your app implements subscription management, such as by calling [doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)](doc://com.apple.storekit/documentation/StoreKit/AppStore/showManageSubscriptions(in:)), cancel the subscription through your app. Otherwise, use the transaction manager in Xcode by choosing Debug > StoreKit > Manage Transactions, selecting the subscription transaction, and turning off the auto-renew option.
4. Wait for the canceled subscription to expire. The system makes the win-back offer available to redeem as soon as the subscription expires.
5. In your app, open your store. Examine your app’s implementation of the win-back offer. For example, if your app uses [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views), the eligible offers appear automatically when your app displays a [doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView](doc://com.apple.storekit/documentation/StoreKit/SubscriptionStoreView).

For more information about using the transaction manager, see [doc://com.apple.documentation/documentation/Xcode/testing-in-app-purchases-with-storeKit-transaction-manager-in-code](doc://com.apple.documentation/documentation/Xcode/testing-in-app-purchases-with-storeKit-transaction-manager-in-code).

### 

You can rerun the test without resetting any state values. Win-back offers that you set to be Eligible appear as soon as their related subscriptions expire.

## See Also

- [testing-at-all-stages-of-development-with-xcode-and-the-sandbox](../com.apple.storekit/StoreKit/testing-at-all-stages-of-development-with-xcode-and-the-sandbox.md)
- [testing-in-app-purchases-with-sandbox](../com.apple.storekit/StoreKit/testing-in-app-purchases-with-sandbox.md)
- [testing-refund-requests](../com.apple.storekit/StoreKit/testing-refund-requests.md)
- [testing-ask-to-buy-in-xcode](../com.apple.storekit/StoreKit/testing-ask-to-buy-in-xcode.md)

---


## transaction-properties

## Topics

### Getting the environment and storefront

- [environment](../com.apple.storekit/StoreKit/Transaction/environment.md)
- [storefront](../com.apple.storekit/StoreKit/Transaction/storefront.md)

### Getting the original transaction identifier

- [originalID](../com.apple.storekit/StoreKit/Transaction/originalID.md)
- [originalPurchaseDate](../com.apple.storekit/StoreKit/Transaction/originalPurchaseDate.md)

### Identifying a transaction

- [id](../com.apple.storekit/StoreKit/Transaction/id.md)
- [webOrderLineItemID](../com.apple.storekit/StoreKit/Transaction/webOrderLineItemID.md)

### Identifying the app and product

- [appBundleID](../com.apple.storekit/StoreKit/Transaction/appBundleID.md)
- [productID](../com.apple.storekit/StoreKit/Transaction/productID.md)
- [productType](../com.apple.storekit/StoreKit/Transaction/productType.md)
- [subscriptionGroupID](../com.apple.storekit/StoreKit/Transaction/subscriptionGroupID.md)

### Getting purchase and expiration dates

- [purchaseDate](../com.apple.storekit/StoreKit/Transaction/purchaseDate.md)
- [expirationDate](../com.apple.storekit/StoreKit/Transaction/expirationDate.md)

### Getting the product price and currency

- [price](../com.apple.storekit/StoreKit/Transaction/price.md)
- [currency](../com.apple.storekit/StoreKit/Transaction/currency.md)

### Getting purchase details

- [isUpgraded](../com.apple.storekit/StoreKit/Transaction/isUpgraded.md)
- [ownershipType-swift.property](../com.apple.storekit/StoreKit/Transaction/ownershipType-swift.property.md)
- [OwnershipType-swift.struct](../com.apple.storekit/StoreKit/Transaction/OwnershipType-swift.struct.md)
- [purchasedQuantity](../com.apple.storekit/StoreKit/Transaction/purchasedQuantity.md)

### Getting subscription status

- [subscriptionStatus](../com.apple.storekit/StoreKit/Transaction/subscriptionStatus.md)

### Getting transaction reason

- [reason-swift.property](../com.apple.storekit/StoreKit/Transaction/reason-swift.property.md)
- [Reason-swift.struct](../com.apple.storekit/StoreKit/Transaction/Reason-swift.struct.md)

### Identifying offers

- [offer-swift.property](../com.apple.storekit/StoreKit/Transaction/offer-swift.property.md)
- [Offer-swift.struct](../com.apple.storekit/StoreKit/Transaction/Offer-swift.struct.md)

### Getting revocation status

- [revocationDate](../com.apple.storekit/StoreKit/Transaction/revocationDate.md)
- [revocationReason-swift.property](../com.apple.storekit/StoreKit/Transaction/revocationReason-swift.property.md)
- [RevocationReason-swift.struct](../com.apple.storekit/StoreKit/Transaction/RevocationReason-swift.struct.md)

### Correlating transactions with accounts

- [appAccountToken](../com.apple.storekit/StoreKit/Transaction/appAccountToken.md)

### Getting the transaction information in JSON format

- [jsonRepresentation](../com.apple.storekit/StoreKit/Transaction/jsonRepresentation.md)

### Deprecated

- [currencyCode](../com.apple.storekit/StoreKit/Transaction/currencyCode.md)
- [environmentStringRepresentation](../com.apple.storekit/StoreKit/Transaction/environmentStringRepresentation.md)
- [offerID](../com.apple.storekit/StoreKit/Transaction/offerID.md)
- [offerPaymentModeStringRepresentation](../com.apple.storekit/StoreKit/Transaction/offerPaymentModeStringRepresentation.md)
- [offerType-swift.property](../com.apple.storekit/StoreKit/Transaction/offerType-swift.property.md)
- [reasonStringRepresentation](../com.apple.storekit/StoreKit/Transaction/reasonStringRepresentation.md)
- [storefrontCountryCode](../com.apple.storekit/StoreKit/Transaction/storefrontCountryCode.md)

## See Also

- [appTransactionID](../com.apple.storekit/StoreKit/Transaction/appTransactionID.md)

---


## understanding-storekit-workflows

## 

StoreKit offers an expansive API for creating an almost limitless variety of in-app stores. This sample app shows you precisely what you need to implement in order to get up and running with a store in your app that can implement several In-App Purchase (IAP) types, including subscriptions.

## 

The design of this sample doesn’t require any special setup, or even the creation of products in App Store Connect; it uses StoreKit Testing in Xcode and the Transaction Manager window in Xcode to test In-App Purchase.

This project comes with the following products set up locally:

- A consumable item
- A non-consumable item
- A collection of consumable items
- A monthly subscription
- A yearly (annual) subscription
- A premium yearly (annual) subscription, with a “1 month free” introductory offer.

For more information on the product types that App Store Connect supports, see [https://developer.apple.com/help/app-store-connect/reference/in-app-purchase-types/](https://developer.apple.com/help/app-store-connect/reference/in-app-purchase-types/)

> **NOTE:** The transactions this app demonstrates don’t get information from App Store Connect and don’t incur charges. Xcode simulates successful transactions without processing actual payments.

To see the pre-configured local StoreKit products, select the `LocalConfiguration` file in the project’s file navigator. This file lists all of the types, descriptions, and properties of the demo products the app supports.

For more information on using the `LocalConfiguration` file, including creating products and inspecting or modifying transactions, see [https://developer.apple.com/documentation/xcode/testing-in-app-purchases-with-storekit-transaction-manager-in-code](https://developer.apple.com/documentation/xcode/testing-in-app-purchases-with-storekit-transaction-manager-in-code).

To run the app, press the Xcode run button, or press command-R. To purchase any demo products, click or tap the buy button on a product, and the system presents the payment sheet that you can either accept (purchase) or cancel. The app shows the status and results of purchases on the status display near the top of the app’s window.

## 

After you purchase products in the sample app, to reset the product to its initial unpurchased state, select Debug > StoreKit > Manage Transactions. In the sample app’s Transactions panel, select each transaction you want to delete, then click the  minus (”-”) button at the bottom of the list to delete it. In addition, to reset the consumable item information that the app stores, run the command `defaults delete com.example.apple-samplecode.StoreKitWorkflows` in Terminal.

For more information on all the capabilities StoreKit provides for the construction of in-app stores and customized StoreKit Views, see [doc://com.apple.storekit/documentation/StoreKit/storekit-views](doc://com.apple.storekit/documentation/StoreKit/storekit-views).

## See Also

- [in-app-purchase](../com.apple.storekit/StoreKit/in-app-purchase.md)
- [getting-started-with-in-app-purchases-using-storekit-views](../com.apple.storekit/StoreKit/getting-started-with-in-app-purchases-using-storekit-views.md)

---


## unlocking-purchased-content

## 

After a purchase is complete, it’s your responsibility to make sure that you programmatically make the content available to the customer.

### 

For an in-app purchase product that enables app functionality, such as a premium subscription, set a Boolean value to enable the code path and update your user interface as needed. Consult your app’s persistent transaction record to determine the functionality to unlock. Your app needs to update this Boolean value whenever the user completes a purchase and at app launch. For information on making a persistent record, see [doc://com.apple.storekit/documentation/StoreKit/persisting-a-purchase](doc://com.apple.storekit/documentation/StoreKit/persisting-a-purchase).

For example, using the app receipt, your code might look like the following:

Or, using the user defaults system.

After you define the Boolean variable that represents the in-app purchase content, use the purchase information to enable the appropriate code paths in your app.

```swift
if (rocketCarEnabled) {
    // Use the rocket car.
} else {
    // Use the regular car.
}
```

### 

Your app needs to deliver any content associated with the purchased product to the user. For example, purchasing instruments in a music app requires delivering the sound files needed to let the user play those instruments. You can embed that content in your app bundle or download it as necessary. Each approach has its advantages and disadvantages.

Embed smaller files (up to a few megabytes) in your app, especially if you expect most users to buy that product. You can make the content in your app bundle available immediately after the user purchases it. However, to add or update content in your app bundle, you need to submit an updated version of your app.

Download larger files only when needed. Separating content from your app bundle keeps your app’s initial download small. For example, a game can include the first level in its app bundle and let users download additional levels as they purchase them. Assuming your app fetches its list of product identifiers from your server and the information isn’t hard-coded in the app bundle, you don’t need to resubmit your app to add or update content that your app downloads.

> **NOTE:** You can’t patch your app binary or download executable code. Your app needs to contain all executable code necessary to support all of its functionality when you submit it. If a new product requires code changes, submit an updated version of your app.

### 

Load local content using the `NSBundle` class as you load other resources from your app bundle.

### 

As with all interactions between your app and your server, the details and process of downloading content from your own server are your responsibility. The communication consists of, at a minimum, the following steps:

1. Your app sends the receipt to your server and requests the content.
2. Your server validates the receipt to establish that the user purchased the content, as described in [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).
3. Assuming the receipt is valid, your server responds to your app with the content.

Ensure that your app handles errors gracefully. For example, if the device runs out of disk space during a download, give the user the option to discard the partial download or to resume the download later when space becomes available.

Consider the security implications of how you host your content and how your app communicates with your server. For more information, see [https://developer.apple.com/library/archive/documentation/Security/Conceptual/Security_Overview/Introduction/Introduction.html#//apple_ref/doc/uid/TP30000976](https://developer.apple.com/library/archive/documentation/Security/Conceptual/Security_Overview/Introduction/Introduction.html#//apple_ref/doc/uid/TP30000976).

### 

You can use [https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/On_Demand_Resources_Guide/index.html](https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/On_Demand_Resources_Guide/index.html) (ODR) for flexibility in downloading data in your app. ODR is an Apple-hosted service you use to store in-app purchase data that your app downloads after you verify the user’s purchase using the app receipt. ODR doesn’t require a call to restore transactions and authenticate the user to download content hosted on Apple’s server.

### 

> **IMPORTANT:** [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) and its related functionality are deprecated. The following information is for apps that already host content on Apple’s servers and use [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload).

Apps can use Apple-hosted content for downloaded files. You create an Apple-hosted content bundle using the In-App Purchase Content target in Xcode and submit it to App Store Connect. Apple’s servers store your app’s content using the same infrastructure that supports other large-scale operations, such as the App Store. Apple-hosted content automatically downloads in the background even if your app isn’t running.

If you need to support older versions of iOS or share your server infrastructure across multiple platforms, you may choose to host your own content using your own server infrastructure.

When the user purchases a product that has associated Apple-hosted content, the transaction that passes to your transaction queue observer also includes an instance of [doc://com.apple.storekit/documentation/StoreKit/SKDownload](doc://com.apple.storekit/documentation/StoreKit/SKDownload) that lets you download the associated content.

To download the content, add the download objects from the transaction’s [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/downloads](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransaction/downloads) property to the transaction queue by calling the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/start(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/start(_:)) method of [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue). If the value of the `downloads` property is `nil`, there’s no Apple-hosted content for that transaction. Unlike downloading apps, downloading content doesn’t automatically require a Wi-Fi connection for content larger than a certain size. Avoid using cellular networks to download large files without an explicit action from the user.

Implement the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedDownloads:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentTransactionObserver/paymentQueue(_:updatedDownloads:)) method on the transaction queue observer to respond to changes in a download’s state, such as by updating progress in your UI. If a download fails, use the information in its [doc://com.apple.storekit/documentation/StoreKit/SKDownload/error](doc://com.apple.storekit/documentation/StoreKit/SKDownload/error) property to present the error to the user.

Ensure that your app handles errors gracefully. For example, if the device runs out of disk space during a download, give the user the option to discard the partial download or to resume the download later when space becomes available.

While the content is downloading, update your user interface using the values of the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/progress](doc://com.apple.storekit/documentation/StoreKit/SKDownload/progress) and [doc://com.apple.storekit/documentation/StoreKit/SKDownload/timeRemaining](doc://com.apple.storekit/documentation/StoreKit/SKDownload/timeRemaining) properties. You can use the [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/pause(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/pause(_:)), [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/resume(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/resume(_:)), and [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/cancel(_:)](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/cancel(_:)) methods of `SKPaymentQueue` from your UI to let the user control in-progress downloads. Use the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState](doc://com.apple.storekit/documentation/StoreKit/SKDownload/downloadState) property to determine whether the download completes. Don’t use the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/progress](doc://com.apple.storekit/documentation/StoreKit/SKDownload/progress) or [doc://com.apple.storekit/documentation/StoreKit/SKDownload/timeRemaining](doc://com.apple.storekit/documentation/StoreKit/SKDownload/timeRemaining) property of the download object to check its status; these properties are for updating your UI.

> **NOTE:** Download all Apple-hosted content before finishing the transaction. After a transaction is complete, its download objects become unusable.

In iOS, your app can manage the downloaded files. The StoreKit framework saves these files for you in the `Caches` directory with the backup flag unset. After the download completes, your app is responsible for moving these files to the appropriate location. For content that can be deleted if the device runs out of disk space (and downloaded again later by your app), keep the files in the `Caches` directory. Otherwise, move the files to the `Documents` folder and set the flag to exclude them from user backups.

In macOS, the system manages the downloaded files; your app can’t move or delete them directly. To locate the content after downloading it, use the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/contentURL](doc://com.apple.storekit/documentation/StoreKit/SKDownload/contentURL) property of the download object. To locate the file on subsequent launches, use the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/contentURL(forProductID:)](doc://com.apple.storekit/documentation/StoreKit/SKDownload/contentURL(forProductID:)) class method of `SKDownload`. To delete a file, use the [doc://com.apple.storekit/documentation/StoreKit/SKDownload/deleteContent(forProductID:)](doc://com.apple.storekit/documentation/StoreKit/SKDownload/deleteContent(forProductID:)) class method. For information about reading the app receipt, see [doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store](doc://com.apple.storekit/documentation/StoreKit/validating-receipts-with-the-app-store).

## See Also

- [persisting-a-purchase](../com.apple.storekit/StoreKit/persisting-a-purchase.md)
- [finishing-a-transaction](../com.apple.storekit/StoreKit/finishing-a-transaction.md)
- [SKDownload](../com.apple.storekit/StoreKit/SKDownload.md)

---


## validating-receipts-with-the-app-store

## 

> **IMPORTANT:** The [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) endpoint is deprecated. To validate receipts on your server, follow the steps in [doc://com.apple.documentation/documentation/AppStoreReceipts/validating-receipts-on-the-device](doc://com.apple.documentation/documentation/AppStoreReceipts/validating-receipts-on-the-device) on your server. To validate in-app purchases on your server without using receipts, call the [doc://com.apple.documentation/documentation/AppStoreServerAPI](doc://com.apple.documentation/documentation/AppStoreServerAPI) to get Apple-signed transaction and subscription information for your customers, or verify the [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) and [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction) signed data that your app obtains. You can also get the same signed transaction and subscription information from the [doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2](doc://com.apple.documentation/documentation/AppStoreServerNotifications/App-Store-Server-Notifications-V2).

An App Store receipt is a binary encrypted file signed with an Apple certificate. To read the contents of the encrypted file, you need to pass it through the [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) endpoint. The endpoint’s response includes a readable JSON body. Communication with the App Store is structured as JSON dictionaries, as defined in RFC 4627. Binary data is Base64-encoded, as defined in RFC 4648. Validate receipts with the App Store through a secure server. For information on establishing a secure network connection with the App Store, see [doc://com.apple.documentation/documentation/Security/preventing-insecure-network-connections](doc://com.apple.documentation/documentation/Security/preventing-insecure-network-connections).

> **WARNING:** Don’t call the App Store server [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt) endpoint from your app. You can’t build a trusted connection between a user’s device and the App Store directly because you don’t control either end of that connection, which makes it susceptible to a machine-in-the-middle attack.

### 

The app receipt is always present in the production environment on devices running macOS, iOS, and iPadOS. The app receipt is also always present in TestFlight on devices running macOS. In the sandbox environment and in StoreKit Testing in Xcode, the app receipt is present only after the tester makes the first in-app purchase. If the app calls [doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest](doc://com.apple.storekit/documentation/StoreKit/SKReceiptRefreshRequest) or [doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()](doc://com.apple.storekit/documentation/StoreKit/SKPaymentQueue/restoreCompletedTransactions()), the app receipt is present only if the app has at least one in-app purchase.

To retrieve the receipt data from the app on the device, use the [doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL](doc://com.apple.documentation/documentation/Foundation/Bundle/appStoreReceiptURL) method of [doc://com.apple.documentation/documentation/Foundation/Bundle](doc://com.apple.documentation/documentation/Foundation/Bundle) to locate the app’s receipt, and encode the data in Base64. Send this Base64-encoded data to your server.

### 

On your server, create a JSON object with the `receipt-data`, `password`, and `exclude-old-transactions` keys detailed in [doc://com.apple.documentation/documentation/AppStoreReceipts/requestBody](doc://com.apple.documentation/documentation/AppStoreReceipts/requestBody).

Submit this JSON object as the payload of an HTTP POST request. Use the test environment URL `https://sandbox.itunes.apple.com/verifyReceipt` when testing your app in the sandbox and while your app is in review. Use the production URL `https://buy.itunes.apple.com/verifyReceipt` when your app is live in the App Store. For more information, see [doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt](doc://com.apple.documentation/documentation/AppStoreReceipts/Verify-Receipt).

> **IMPORTANT:** Verify your receipt first with the production URL; then verify with the sandbox URL if you receive a `21007` status code. This approach ensures you don’t have to switch between URLs while your app is in testing, in review by App Review, or live in the App Store.

### 

The App Store’s response payload is a JSON object that contains the keys and values detailed in [doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody](doc://com.apple.documentation/documentation/AppStoreReceipts/responseBody).

The `in_app` array contains the non-consumable, non-renewing subscription, and auto-renewable subscription items that the user previously purchased. Check the values in the response for these in-app purchase types to verify transactions as needed.

For auto-renewable subscription items, parse the response to get information about the currently active subscription period. When you validate the receipt for a subscription, `latest_receipt` contains the latest encoded receipt, which is the same as the value for `receipt-data` in the request, and `latest_receipt_info` contains all the transactions for the subscription, including the initial purchase and subsequent renewals, but not including any restores.

You can use these values to check whether an auto-renewable subscription has expired. Use these values along with the [doc://com.apple.documentation/documentation/AppStoreReceipts/expiration_intent](doc://com.apple.documentation/documentation/AppStoreReceipts/expiration_intent) subscription field to get the reason for expiration.

## See Also

- [AppStoreReceipts](../com.apple.AppStoreReceipts.md)
- [choosing-a-receipt-validation-technique](../com.apple.storekit/StoreKit/choosing-a-receipt-validation-technique.md)
- [appStoreReceiptURL](../com.apple.Foundation/Bundle/appStoreReceiptURL.md)
- [SKReceiptRefreshRequest](../com.apple.storekit/StoreKit/SKReceiptRefreshRequest.md)

---


## verificationresult

## Declaration

**Platforms:** iOS, iPadOS, Mac Catalyst, macOS, tvOS, visionOS, watchOS

```swift
@frozen enum VerificationResult<SignedType>
```

## 

StoreKit automatically verifies the [doc://com.apple.storekit/documentation/StoreKit/Transaction](doc://com.apple.storekit/documentation/StoreKit/Transaction), [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo), and [doc://com.apple.storekit/documentation/StoreKit/AppTransaction](doc://com.apple.storekit/documentation/StoreKit/AppTransaction) values. To access the wrapped values, check whether the values are verified or unverified.

In addition to getting a verification result from StoreKit, you might want to verify the signed information yourself, either on the device, or on your server for the most control and security. Perform the verification on the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj) property for subscription renewal information, the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) property for transactions, and the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-6ma59) property for an app transaction.

To verify the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) on your server, consider using the verification functions in the App Store Server Library. The library provides the functions `verifyAndDecodeTransaction`, `verifyAndDecodeAppTransaction`, and `verifyAndDecodeRenewalInfo` in each language the library supports. For more information, see [doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library](doc://com.apple.documentation/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library).

The [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) string is in JWS Compact Serialization format and is the same as its counterpart in the App Store server APIs, as follows:

| StoreKit string | Equivalent in the App Store Server API | Equivalent in App Store Server Notifications |
| --- | --- | --- |
| [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-178oj) for subscription renewal information | [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfo](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSRenewalInfo) | [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSRenewalInfo](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSRenewalInfo) |
| [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) for transactions | [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction) | [doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerNotifications/JWSTransaction) |

The decoded payload of the [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) contains  two additional fields: `deviceVerification` and `deviceVerificationNonce`. Use these fields on the device to verify that JWS information belongs to the device. For more information, see [doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID](doc://com.apple.storekit/documentation/StoreKit/AppStore/deviceVerificationID).

> **IMPORTANT:** The decoded payloads of [doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo](doc://com.apple.storekit/documentation/StoreKit/VerificationResult/jwsRepresentation-21vgo) and [doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction](doc://com.apple.documentation/documentation/AppStoreServerAPI/JWSTransaction) strings contain [doc://com.apple.documentation/documentation/AppStoreServerAPI/price](doc://com.apple.documentation/documentation/AppStoreServerAPI/price) or [doc://com.apple.documentation/documentation/AppStoreServerAPI/renewalPrice](doc://com.apple.documentation/documentation/AppStoreServerAPI/renewalPrice) fields specified in *milliunits* of the currency.  StoreKit represents the `price` and [doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalPrice](doc://com.apple.storekit/documentation/StoreKit/Product/SubscriptionInfo/RenewalInfo/renewalPrice) values in is *units* of the currency. Take care not to confuse these two representations when working with both APIs.

## Topics

### Getting the verification results

- [verified(_:)](../com.apple.storekit/StoreKit/VerificationResult/verified(_:).md)
- [unverified(_:_:)](../com.apple.storekit/StoreKit/VerificationResult/unverified(_:_:).md)
- [payloadValue](../com.apple.storekit/StoreKit/VerificationResult/payloadValue.md)
- [unsafePayloadValue](../com.apple.storekit/StoreKit/VerificationResult/unsafePayloadValue.md)
- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

### Getting properties for transactions

- [jwsRepresentation-21vgo](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-21vgo.md)
- [deviceVerification-69lvx](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-69lvx.md)
- [deviceVerificationNonce-9dfrn](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-9dfrn.md)
- [signedDate-8x9bg](../com.apple.storekit/StoreKit/VerificationResult/signedDate-8x9bg.md)
- [headerData-9egfp](../com.apple.storekit/StoreKit/VerificationResult/headerData-9egfp.md)
- [payloadData-uyle](../com.apple.storekit/StoreKit/VerificationResult/payloadData-uyle.md)
- [signedData-56usp](../com.apple.storekit/StoreKit/VerificationResult/signedData-56usp.md)
- [signatureData-4pyv8](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pyv8.md)
- [signature-7t1ne](../com.apple.storekit/StoreKit/VerificationResult/signature-7t1ne.md)

### Getting properties for subscription renewal information

- [jwsRepresentation-178oj](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-178oj.md)
- [deviceVerification-5hvi9](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-5hvi9.md)
- [deviceVerificationNonce-6mzfc](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6mzfc.md)
- [signedDate-3tvo5](../com.apple.storekit/StoreKit/VerificationResult/signedDate-3tvo5.md)
- [headerData-3be0o](../com.apple.storekit/StoreKit/VerificationResult/headerData-3be0o.md)
- [payloadData-abfv](../com.apple.storekit/StoreKit/VerificationResult/payloadData-abfv.md)
- [signedData-1t80n](../com.apple.storekit/StoreKit/VerificationResult/signedData-1t80n.md)
- [signatureData-9uw8c](../com.apple.storekit/StoreKit/VerificationResult/signatureData-9uw8c.md)
- [signature-95r7x](../com.apple.storekit/StoreKit/VerificationResult/signature-95r7x.md)

### Getting properties for app transactions

- [jwsRepresentation-6ma59](../com.apple.storekit/StoreKit/VerificationResult/jwsRepresentation-6ma59.md)
- [deviceVerification-6c8xu](../com.apple.storekit/StoreKit/VerificationResult/deviceVerification-6c8xu.md)
- [deviceVerificationNonce-6082b](../com.apple.storekit/StoreKit/VerificationResult/deviceVerificationNonce-6082b.md)
- [signedDate-24zch](../com.apple.storekit/StoreKit/VerificationResult/signedDate-24zch.md)
- [headerData-3drrl](../com.apple.storekit/StoreKit/VerificationResult/headerData-3drrl.md)
- [payloadData-97acz](../com.apple.storekit/StoreKit/VerificationResult/payloadData-97acz.md)
- [signedData-99fyo](../com.apple.storekit/StoreKit/VerificationResult/signedData-99fyo.md)
- [signatureData-4pvv0](../com.apple.storekit/StoreKit/VerificationResult/signatureData-4pvv0.md)
- [signature-6d5ue](../com.apple.storekit/StoreKit/VerificationResult/signature-6d5ue.md)

## See Also

- [VerificationError](../com.apple.storekit/StoreKit/VerificationResult/VerificationError.md)

---


## verifying-an-install-validation-postback

## 

Install-validation postbacks contain data that validate an ad conversion. You need to verify the postback signature to make sure it’s signed by Apple before you count the conversion. Follow these steps to validate the postback:

1. Receive the postback at a URL you configure.
2. Respond to the postback when you receive it.
3. Check the postback version.
4. Recreate the byte array from the postback parameters in the version-specific order.
5. Verify Apple’s signature.
6. Count only unique postbacks with signatures you verify. For version 3 and later, check the `did-win` parameter to learn whether the postback represents a winning attribution.

### 

Devices send install-validation postbacks to ad networks and developers within a defined timeframe after a user installs and launches an advertised app. Ad networks receive postbacks at the URL they provide when they register to use SKAdNetwork. Developers who opt in receive copies of winning postbacks at the URL they configure in the app’s property list key, [doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint](doc://com.apple.documentation/documentation/BundleResources/Information-Property-List/NSAdvertisingAttributionReportEndpoint). For more information about setting up your postback URL, see [doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network](doc://com.apple.storekit/documentation/StoreKit/registering-an-ad-network) and [doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app](doc://com.apple.storekit/documentation/StoreKit/configuring-an-advertised-app).

For more information about the timeframe for receiving attribution, see [doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks](doc://com.apple.storekit/documentation/StoreKit/receiving-ad-attributions-and-postbacks) Starting with version 4, you may receive postbacks in three conversion windows. For more information, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

### 

When you receive a postback, respond with an HTTP status code `200` OK. If the device doesn’t receive the `200` status code, it attempts to send the postback up to nine times over a maximum of 9 days.

### 

Postbacks contain a `version` parameter, starting with SKAdNetwork 2. Use the version number to follow the version-specific instructions for verifying a postback signature. For a description of all the parameters in a postback, see [doc://com.apple.storekit/documentation/StoreKit/identifying-the-parameters-in-install-validation-postbacks](doc://com.apple.storekit/documentation/StoreKit/identifying-the-parameters-in-install-validation-postbacks).

The postback version you receive depends on the version number the ad network uses to sign the ad, the iOS version on the device, and the SDK version that the source app uses. Expect to receive the same version number in the postback as the ad network uses to sign the ad if the device runs the latest iOS version, and the source app uses the latest SDK. For more information about version dependencies, see [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes). For more information about signing, see [doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads](doc://com.apple.storekit/documentation/StoreKit/signing-and-providing-ads).

### 

To confirm that Apple sent the postback request, you need to verify Apple’s signature in the postback’s `attribution-signature` parameter. First, decode the signature with Apple’s public key. Next, compare the decoded signature to a byte array that you recreate using the postback parameters. To create the byte array, build a UTF-8 string by combining the parameter values with invisible separators, `‘\u2063’`, in an exact version-specific order.

Use the version-specific instructions that correspond to the postback’s version:

- For version 3-specific instructions and postback examples, see [doc://com.apple.storekit/documentation/StoreKit/combining-parameters-for-skadnetwork-3-postbacks](doc://com.apple.storekit/documentation/StoreKit/combining-parameters-for-skadnetwork-3-postbacks).
- For earlier versions, see [doc://com.apple.storekit/documentation/StoreKit/combining-parameters-for-previous-skadnetwork-postback-versions](doc://com.apple.storekit/documentation/StoreKit/combining-parameters-for-previous-skadnetwork-postback-versions).

For a version 4 postback, combine the postback parameter values in this order:

- `version`
- `ad-network-id`
- `source-identifier`` `
- `app-id`
- `transaction-id`
- `redownload` (Use the strings `“true”` or `“false”` to represent the Boolean value of the redownload parameter).
- `source-app-id` (or `source-domain` for web ads)
- `fidelity-type`
- `did-win`
- `postback-sequence-index`

For web ads, the postback may include a `source-domain` instead of a `source-app-id`.

The combined string doesn’t include all of the postback parameters. Include `source-app-id` only if you receive it in the postback. The signature doesn’t include `conversion-value` or `coarse-conversion-value`, even if either is present in the postback. Postbacks that win the attribution have a `did-win` value of `true`. Postbacks that don’t win the attribution have a `did-win` value of `false`, and don’t include `source-app-id`.

The following example of the UTF-8 string includes `source-app-id:`

```javascript
version + '\u2063' + ad-network-id + '\u2063' + source-identifier + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + source-app-id + '\u2063' + fidelity-type + '\u2063' + did-win + '\u2063' + postback-sequence-index
```

The following example of the UTF-8 string for a web ad includes `source-domain:`

```javascript
version + '\u2063' + ad-network-id + '\u2063' + source-identifier + '\u2063' + app-id + '\u2063' + transaction-id + '\u2063' + redownload + '\u2063' + source-domain + '\u2063' + fidelity-type + '\u2063' + did-win + '\u2063' + postback-sequence-index
```

The following example is a first postback from a web ad, in a high postback data tier. Notice that the `source-identifier` contains four digits, and the postback contains the fine-grained `conversion-value`.

```javascript
{
  "version": "4.0",
  "ad-network-id": "com.example",
  "source-identifier": "5239",
  "app-id": 525463029,
  "transaction-id": "6aafb7a5-0170-41b5-bbe4-fe71dedf1e30",
  "redownload": false,
  "source-domain": "example.com", 
  "fidelity-type": 1, 
  "did-win": true,
  "conversion-value": 63,
  "postback-sequence-index": 0,
  "attribution-signature": "MEUCIGRmSMrqedNu6uaHyhVcifs118R5z/AB6cvRaKrRRHWRAiEAv96ne3dKQ5kJpbsfk4eYiePmrZUU6sQmo+7zfP/1Bxo="
}
```

The following example is a first postback that results from a web ad, in a low postback data tier.  Notice that the `source-identifier` contains two digits, and the postback includes a `coarse-conversion-value`.

```javascript
{
  "version": "4.0",
  "ad-network-id": "com.example",
  "source-identifier": "39",
  "app-id": 525463029,
  "transaction-id": "6aafb7a5-0170-41b5-bbe4-fe71dedf1e31",
  "redownload": false,
  "source-domain": "example.com", 
  "fidelity-type": 1, 
  "did-win": true,
  "coarse-conversion-value": "high",
  "postback-sequence-index": 0,
  "attribution-signature": "MEUCIQD4rX6eh38qEhuUKHdap345UbmlzA7KEZ1bhWZuYM8MJwIgMnyiiZe6heabDkGwOaKBYrUXQhKtF3P/ERHqkR/XpuA="
}
```

The `attribution-signature` value in both examples is a verified signature. Use the parameter values and signature in the examples to test your code. For more information about the postback data tiers and the parameters available in each tier, see [doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows](doc://com.apple.storekit/documentation/StoreKit/receiving-postbacks-in-multiple-conversion-windows).

### 

Copy Apple’s public key, below, which you need for the remaining steps. Apple’s NIST P-256 public key that you use to verify signatures for versions 2.1 and later is:

```None
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWdp8GPcGqmhgzEFj9Z2nSpQVddayaPe4FMzqM9wib1+aHaaIzoHoLN9zW4K8y4SPykE3YVK3sVqW6Af0lfx3gg==
```

To verify a signature for version 1 or 2, get the version-appropriate public key from [doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes](doc://com.apple.storekit/documentation/StoreKit/skadnetwork-release-notes).

Then, complete these steps:

1. Decode Apple’s public key, which appears as a Base64-encoded string above. The result is a byte array.
2. Create an X.509 standard public key from the byte array.
3. Decode Apple’s signature string value from its Base64 format.
4. Verify Apple’s signed value from the `attribution-signature` parameter in the postback against the UTF-8 string you create by combining the postback parameters. Use Apple’s public key and a SHA-256 hash using the Elliptic Curve Digital Signature Algorithm (ECDSA).

If your verification passes, the postback is valid.

> **IMPORTANT:** If the `attribution-signature` fails your verification, consider the postback message invalid. Don’t use it to count a conversion.

For version 3 and later, valid postbacks with a `did-win` value of `true` represent an ad attribution.

### 

Use the `transaction-id` value to ensure you’re counting unique ad conversions. If you receive more than one ad-conversion message with the same `transaction-id`, discard the duplicate message.

### 

In test scenarios, the postback always contains the `source-app-id` and `conversion-value` parameters with values of `0`. To trigger test scenarios, use a development-signed source app with an [doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier](doc://com.apple.storekit/documentation/StoreKit/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier) value equal to `0`.

## Topics

### SKAdNetworks 3 and earlier postbacks

- [combining-parameters-for-skadnetwork-3-postbacks](../com.apple.storekit/StoreKit/combining-parameters-for-skadnetwork-3-postbacks.md)
- [combining-parameters-for-previous-skadnetwork-postback-versions](../com.apple.storekit/StoreKit/combining-parameters-for-previous-skadnetwork-postback-versions.md)

## See Also

- [identifying-the-parameters-in-install-validation-postbacks](../com.apple.storekit/StoreKit/identifying-the-parameters-in-install-validation-postbacks.md)

---

